{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>Welcome</p>"},{"location":"2017-09-02-Spring%E6%A1%86%E6%9E%B6Bean%E4%BD%9C%E7%94%A8%E5%9F%9F/","title":"2017 09 02 Spring\u6846\u67b6Bean\u4f5c\u7528\u57df","text":"<p>\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSpring\u5e94\u7528\u4e0a\u4e0b\u6587\u4e2d\u6240\u6709bean\u90fd\u662f\u4f5c\u4e3a\u4ee5\u5355\u4f8b\uff08singleton\uff09\u7684\u5f62\u5f0f\u521b\u5efa\u7684\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0d\u7ba1\u7ed9\u5b9a\u7684\u4e00\u4e2abean\u88ab\u6ce8\u5165\u5230\u5176\u4ed6bean\u591a\u5c11\u6b21\uff0c\u6bcf\u6b21\u6240\u6ce8\u5165\u7684\u90fd\u662f\u540c\u4e00\u4e2a\u5b9e\u4f8b\u3002</p> <p>\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u5355\u4f8bbean\u662f\u5f88\u7406\u60f3\u7684\u65b9\u6848\u3002\u521d\u59cb\u5316\u548c\u5783\u573e\u56de\u6536\u5bf9\u8c61\u5b9e\u4f8b\u6240\u5e26\u6765\u7684\u6210\u672c\u53ea\u7559\u7ed9\u4e00\u4e9b\u5c0f\u89c4\u6a21\u4efb\u52a1\uff0c\u5728\u8fd9\u4e9b\u4efb\u52a1\u4e2d\uff0c\u8ba9\u5bf9\u8c61\u4fdd\u6301\u65e0\u72b6\u6001\u5e76\u4e14\u5728\u5e94\u7528\u4e2d\u53cd\u590d\u91cd\u7528\u8fd9\u4e9b\u5bf9\u8c61\u53ef\u80fd\u5e76\u4e0d\u5408\u7406\u3002</p> <p>\u6709\u65f6\u5019\uff0c\u53ef\u80fd\u4f1a\u53d1\u73b0\uff0c\u4f60\u6240\u4f7f\u7528\u7684\u7c7b\u662f\u6613\u53d8\u7684\uff08mutable\uff09\uff0c\u5b83\u4eec\u4f1a\u4fdd\u6301\u4e00\u4e9b\u72b6\u6001\uff0c\u56e0\u6b64\u91cd\u7528\u662f\u4e0d\u5b89\u5168\u7684\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5c06class\u58f0\u660e\u4e3a\u5355\u4f8b\u7684bean\u5c31\u4e0d\u662f\u4ec0\u4e48\u597d\u4e3b\u610f\u4e86\uff0c\u56e0\u4e3a\u5bf9\u8c61\u4f1a\u88ab\u6c61\u67d3\uff0c\u7a0d\u540e\u91cd\u7528\u7684\u65f6\u5019\u4f1a\u51fa\u73b0\u610f\u60f3\u4e0d\u5230\u7684\u95ee\u9898\u3002</p> <p>Spring\u5b9a\u4e49\u4e86\u591a\u79cd\u4f5c\u7528\u57df\uff0c\u53ef\u4ee5\u57fa\u4e8e\u8fd9\u4e9b\u4f5c\u7528\u57df\u521b\u5efabean\uff0c\u5305\u62ec\uff1a</p> <ul> <li>\u5355\u4f8b\uff08Singleton\uff09\uff1a\u5728\u6574\u4e2a\u5e94\u7528\u4e2d\uff0c\u53ea\u521b\u5efabean\u7684\u4e00\u4e2a\u5b9e\u4f8b\u3002</li> <li>\u539f\u578b\uff08Prototype\uff09\uff1a\u6bcf\u6b21\u6ce8\u5165\u6216\u8005\u901a\u8fc7Spring\u5e94\u7528\u4e0a\u4e0b\u6587\u83b7\u53d6\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684bean\u5b9e\u4f8b\u3002</li> <li>\u4f1a\u8bdd\uff08Session\uff09\uff1a\u5728Web\u5e94\u7528\u4e2d\uff0c\u4e3a\u6bcf\u4e2a\u4f1a\u8bdd\u521b\u5efa\u4e00\u4e2abean\u5b9e\u4f8b\u3002</li> <li>\u8bf7\u6c42\uff08Rquest\uff09\uff1a\u5728Web\u5e94\u7528\u4e2d\uff0c\u4e3a\u6bcf\u4e2a\u8bf7\u6c42\u521b\u5efa\u4e00\u4e2abean\u5b9e\u4f8b\u3002</li> </ul> <p>\u5355\u4f8b\u662f\u9ed8\u8ba4\u7684\u4f5c\u7528\u57df\uff0c\u4f46\u662f\u6b63\u5982\u4e4b\u524d\u6240\u8ff0\uff0c\u5bf9\u4e8e\u6613\u53d8\u7684\u7c7b\u578b\uff0c\u8fd9\u5e76\u4e0d\u5408\u9002\u3002\u5982\u679c\u9009\u62e9\u5176\u4ed6\u7684\u4f5c\u7528\u57df\uff0c\u8981\u4f7f\u7528@Scope\u6ce8\u89e3\uff0c\u5b83\u53ef\u4ee5\u4e0e<code>@Component</code>\u6216<code>@Bean</code>\u4e00\u8d77\u4f7f\u7528\u3002</p> <p>\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u4f7f\u7528\u7ec4\u4ef6\u626b\u63cf\u6765\u53d1\u73b0\u548c\u58f0\u660ebean\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u5728bean\u7684\u7c7b\u4e0a\u4f7f\u7528<code>*@Scope</code>*\u6ce8\u89e3\uff0c\u5c06\u5176\u58f0\u660e\u4e3a\u539f\u578bbean\uff1a</p> <pre><code>@Component\n@Scope(ConfigurableBeanFactory.SCOPE_PROTOTYPE)\npublic class Notepad { ... }\n</code></pre> <p>\u8fd9\u91cc\uff0c\u4f7f\u7528<code>ConfigurableBeanFactory</code>\u7c7b\u7684<code>SCOPE_PROTOTYPE</code>\u5e38\u91cf\u8bbe\u7f6e\u4e86\u539f\u578b\u4f5c\u7528\u57df\u3002\u4f60\u5f53\u7136\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>@Scope(\"prototype\")</code>\uff0c\u4f46\u662f\u4f7f\u7528<code>SCOPE_PROTOTYPE</code>\u5e38\u91cf\u66f4\u52a0\u5b89\u5168\u5e76\u4e14\u4e0d\u6613\u51fa\u9519\u3002</p> <p>\u5982\u679c\u4f60\u60f3\u5728Java\u914d\u7f6e\u4e2d\u5c06Notepad\u58f0\u660e\u4e3a\u539f\u578bbean\uff0c\u90a3\u4e48\u53ef\u4ee5\u7ec4\u5408\u4f7f\u7528<code>@Scope</code>\u548c<code>@Bean</code>\u6765\u6307\u5b9a\u6240\u9700\u7684\u4f5c\u7528\u57df\uff1a</p> <pre><code>@Bean\n@Scope(ConfigurableBeanFactory.SCOPE_PROTOTYPE)\npublic Notepad notepad() {\nreturn new Notepad();\n}\n</code></pre> <p>\u540c\u6837\uff0c\u5982\u679c\u4f60\u4f7f\u7528XML\u6765\u914d\u7f6ebean\u7684\u8bdd\uff0c\u53ef\u4ee5\u4f7f\u7528<code>&lt;bean&gt;</code>\u5143\u7d20\u7684<code>scope</code>\u5c5e\u6027\u6765\u8bbe\u7f6e\u4f5c\u7528\u57df\uff1a</p> <pre><code>&lt;bean id=\"notepad\"\nclass=\"com.myapp.Notepad\"\nscope=\"prototype\" /&gt;\n</code></pre> <p>\u4e0d\u7ba1\u4f60\u4f7f\u7528\u54ea\u79cd\u65b9\u5f0f\u6765\u58f0\u660e\u539f\u578b\u4f5c\u7528\u57df\uff0c\u6bcf\u6b21\u6ce8\u5165\u6216\u4eceSpring\u5e94\u7528\u4e0a\u4e0b\u6587\u4e2d\u68c0\u7d22\u8be5bean\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u521b\u5efa\u65b0\u7684\u5b9e\u4f8b\u3002\u8fd9\u6837\u6240\u5bfc\u81f4\u7684\u7ed3\u679c\u5c31\u662f\u6bcf\u6b21\u64cd\u4f5c\u90fd\u80fd\u5f97\u5230\u81ea\u5df1\u7684Notepad\u5b9e\u4f8b\u3002</p>"},{"location":"2017-09-02-Spring%E6%A1%86%E6%9E%B6Bean%E4%BD%9C%E7%94%A8%E5%9F%9F/#1","title":"1 \u4f7f\u7528\u4f1a\u8bdd\u548c\u8bf7\u6c42\u4f5c\u7528\u57df","text":"<p>\u5728Web\u5e94\u7528\u4e2d\uff0c\u5982\u679c\u80fd\u591f\u5b9e\u4f8b\u5316\u5728\u4f1a\u8bdd\u548c\u8bf7\u6c42\u8303\u56f4\u5185\u5171\u4eab\u7684bean\uff0c\u90a3\u5c06\u662f\u975e\u5e38\u6709\u4ef7\u503c\u7684\u4e8b\u60c5\u3002\u4f8b\u5982\uff0c\u5728\u5178\u578b\u7684\u7535\u5b50\u5546\u52a1\u5e94\u7528\u4e2d\uff0c\u53ef\u80fd\u4f1a\u6709\u4e00\u4e2abean\u4ee3\u8868<code>\u7528\u6237\u7684\u8d2d\u7269\u8f66</code>\u3002\u5982\u679c\u8d2d\u7269\u8f66\u662f\u5355\u4f8b\u7684\u8bdd\uff0c\u90a3\u4e48\u5c06\u4f1a\u5bfc\u81f4\u6240\u6709\u7684\u7528\u6237\u90fd\u4f1a\u5411\u540c\u4e00\u4e2a\u8d2d\u7269\u8f66\u4e2d\u6dfb\u52a0\u5546\u54c1\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u5982\u679c\u8d2d\u7269\u8f66\u662f\u539f\u578b\u4f5c\u7528\u57df\u7684\uff0c\u90a3\u4e48\u5728\u5e94\u7528\u4e2d\u67d0\u4e00\u4e2a\u5730\u65b9\u5f80\u8d2d\u7269\u8f66\u4e2d\u6dfb\u52a0\u5546\u54c1\uff0c\u5728\u5e94\u7528\u7684\u53e6\u5916\u4e00\u4e2a\u5730\u65b9\u53ef\u80fd\u5c31\u4e0d\u53ef\u7528\u4e86\uff0c\u56e0\u4e3a\u5728\u8fd9\u91cc\u6ce8\u5165\u7684\u662f\u53e6\u5916\u4e00\u4e2a\u539f\u578b\u4f5c\u7528\u57df\u7684\u8d2d\u7269\u8f66\u3002</p> <p>\u5c31\u8d2d\u7269\u8f66bean\u6765\u8bf4\uff0c<code>\u4f1a\u8bdd\u4f5c\u7528\u57df</code>\u662f\u6700\u4e3a\u5408\u9002\u7684\uff0c\u56e0\u4e3a\u5b83<code>\u4e0e\u7ed9\u5b9a\u7684\u7528\u6237</code>\u5173\u8054\u6027\u6700\u5927\u3002\u8981\u6307\u5b9a\u4f1a\u8bdd\u4f5c\u7528\u57df\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>@Scope</code>\u6ce8\u89e3\uff0c\u5b83\u7684\u4f7f\u7528\u65b9\u5f0f\u4e0e\u6307\u5b9a\u539f\u578b\u4f5c\u7528\u57df\u662f\u76f8\u540c\u7684\uff1a</p> <pre><code>@Component\n@Scope(\nvalue=WebApplicationContext.SCOPE_SESSION,\nproxyMode=ScopedProxyMode.INTERFACES)\npublic ShoppingCart cart() { ... }\n</code></pre> <p>\u8fd9\u91cc\uff0c\u6211\u4eec\u5c06value\u8bbe\u7f6e\u6210\u4e86WebApplicationContext\u4e2d\u7684SCOPE_SESSION\u5e38\u91cf\uff08\u5b83\u7684\u503c\u662fsession\uff09\u3002\u8fd9\u4f1a\u544a\u8bc9Spring\u4e3aWeb\u5e94\u7528\u4e2d\u7684\u6bcf\u4e2a\u4f1a\u8bdd\u521b\u5efa\u4e00\u4e2aShoppingCart\u3002\u8fd9\u4f1a\u521b\u5efa\u591a\u4e2aShoppingCart bean\u7684\u5b9e\u4f8b\uff0c\u4f46\u662f\u5bf9\u4e8e\u7ed9\u5b9a\u7684\u4f1a\u8bdd\u53ea\u4f1a\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u5728\u5f53\u524d\u4f1a\u8bdd\u76f8\u5173\u7684\u64cd\u4f5c\u4e2d\uff0c\u8fd9\u4e2abean\u5b9e\u9645\u4e0a\u76f8\u5f53\u4e8e\u5355\u4f8b\u7684\u3002</p> <p>\u8981\u6ce8\u610f\u7684\u662f\uff0c<code>@Scope</code>\u540c\u65f6\u8fd8\u6709\u4e00\u4e2a<code>proxyMode</code>\u5c5e\u6027\uff0c\u5b83\u88ab\u8bbe\u7f6e\u6210\u4e86<code>ScopedProxyMode.INTERFACES</code>\u3002\u8fd9\u4e2a\u5c5e\u6027\u89e3\u51b3\u4e86\u5c06\u4f1a\u8bdd\u6216\u8bf7\u6c42\u4f5c\u7528\u57df\u7684bean\u6ce8\u5165\u5230\u5355\u4f8bbean\u4e2d\u6240\u9047\u5230\u7684\u95ee\u9898\u3002\u5728\u63cf\u8ff0proxyMode\u5c5e\u6027\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0bproxyMode\u6240\u89e3\u51b3\u95ee\u9898\u7684\u573a\u666f\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u8981\u5c06ShoppingCart bean\u6ce8\u5165\u5230\u5355\u4f8bStoreService bean\u7684Setter\u65b9\u6cd5\u4e2d\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>@Component\npublic class StoreService {\n\n@Autowired\npublic void setShoppingCart(ShoppingCart shoppingCart) {\nthis.shoppingCart = shoppingCart;\n}\n...\n}\n</code></pre> <p>\u56e0\u4e3aStoreService\u662f\u4e00\u4e2a\u5355\u4f8b\u7684bean\uff0c\u4f1a\u5728Spring\u5e94\u7528\u4e0a\u4e0b\u6587\u52a0\u8f7d\u7684\u65f6\u5019\u521b\u5efa\u3002\u5f53\u5b83\u521b\u5efa\u7684\u65f6\u5019\uff0cSpring\u4f1a\u8bd5\u56fe\u5c06ShoppingCart bean\u6ce8\u5165\u5230setShoppingCart()\u65b9\u6cd5\u4e2d\u3002\u4f46\u662fShoppingCart bean\u662f<code>\u4f1a\u8bdd\u4f5c\u7528\u57df</code>\u7684\uff0c\u6b64\u65f6\u5e76\u4e0d\u5b58\u5728\u3002\u76f4\u5230\u67d0\u4e2a\u7528\u6237\u8fdb\u5165\u7cfb\u7edf\uff0c\u521b\u5efa\u4e86\u4f1a\u8bdd\u4e4b\u540e\uff0c\u624d\u4f1a\u51fa\u73b0ShoppingCart\u5b9e\u4f8b\u3002</p> <p>\u53e6\u5916\uff0c\u7cfb\u7edf\u4e2d\u5c06\u4f1a\u6709\u591a\u4e2aShoppingCart\u5b9e\u4f8b\uff1a<code>\u6bcf\u4e2a\u7528\u6237\u4e00\u4e2a</code>\u3002\u6211\u4eec\u5e76\u4e0d\u60f3\u8ba9Spring\u6ce8\u5165\u67d0\u4e2a\u56fa\u5b9a\u7684ShoppingCart\u5b9e\u4f8b\u5230StoreService\u4e2d\u3002\u6211\u4eec\u5e0c\u671b\u7684\u662f\u5f53StoreService\u5904\u7406\u8d2d\u7269\u8f66\u529f\u80fd\u65f6\uff0c\u5b83\u6240\u4f7f\u7528\u7684ShoppingCart\u5b9e\u4f8b\u6070\u597d\u662f\u5f53\u524d\u4f1a\u8bdd\u6240\u5bf9\u5e94\u7684\u90a3\u4e00\u4e2a\u3002</p> <p>Spring<code>\u5e76\u4e0d\u4f1a</code>\u5c06\u5b9e\u9645\u7684ShoppingCart bean\u6ce8\u5165\u5230StoreService\u4e2d\uff0cSpring\u4f1a\u6ce8\u5165\u4e00\u4e2a\u5230<code>ShoppingCart bean\u7684\u4ee3\u7406</code>\uff0c\u5982\u56fe3.1\u6240\u793a\u3002\u8fd9\u4e2a\u4ee3\u7406\u4f1a\u66b4\u9732\u4e0eShoppingCart\u76f8\u540c\u7684\u65b9\u6cd5\uff0c\u6240\u4ee5StoreService\u4f1a\u8ba4\u4e3a\u5b83\u5c31\u662f\u4e00\u4e2a\u8d2d\u7269\u8f66\u3002\u4f46\u662f\uff0c\u5f53StoreService\u8c03\u7528ShoppingCart\u7684\u65b9\u6cd5\u65f6\uff0c\u4ee3\u7406\u4f1a\u5bf9\u5176\u8fdb\u884c<code>\u61d2\u89e3\u6790</code>\u5e76\u5c06\u8c03\u7528<code>\u59d4\u6258</code>\u7ed9\u4f1a\u8bdd\u4f5c\u7528\u57df\u5185\u771f\u6b63\u7684ShoppingCart bean\u3002</p> <p>\u73b0\u5728\uff0c\u6211\u4eec\u5e26\u7740\u5bf9\u8fd9\u4e2a\u4f5c\u7528\u57df\u7684\u7406\u89e3\uff0c\u8ba8\u8bba\u4e00\u4e0bproxyMode\u5c5e\u6027\u3002\u5982\u914d\u7f6e\u6240\u793a\uff0cproxyMode\u5c5e\u6027\u88ab\u8bbe\u7f6e\u6210\u4e86ScopedProxyMode.INTERFACES\uff0c\u8fd9<code>\u8868\u660e\u8fd9\u4e2a\u4ee3\u7406\u8981\u5b9e\u73b0ShoppingCart\u63a5\u53e3</code>\uff0c\u5e76\u5c06\u8c03\u7528\u59d4\u6258\u7ed9\u5b9e\u73b0bean\u3002</p> <p>\u5982\u679cShoppingCart\u662f\u63a5\u53e3\u800c\u4e0d\u662f\u7c7b\u7684\u8bdd\uff0c\u8fd9\u662f\u53ef\u4ee5\u7684\uff08\u4e5f\u662f\u6700\u4e3a\u7406\u60f3\u7684\u4ee3\u7406\u6a21\u5f0f\uff09\u3002\u4f46\u5982\u679cShoppingCart\u662f\u4e00\u4e2a\u5177\u4f53\u7684\u7c7b\u7684\u8bdd\uff0cSpring\u5c31\u6ca1\u6709\u529e\u6cd5\u521b\u5efa\u57fa\u4e8e\u63a5\u53e3\u7684\u4ee3\u7406\u4e86\u3002\u6b64\u65f6\uff0c\u5b83\u5fc5\u987b\u4f7f\u7528<code>CGLib</code>\u6765\u751f\u6210<code>\u57fa\u4e8e\u7c7b\u7684\u4ee3\u7406</code>\u3002\u6240\u4ee5\uff0c\u5982\u679cbean\u7c7b\u578b\u662f\u5177\u4f53\u7c7b\u7684\u8bdd\uff0c\u6211\u4eec\u5fc5\u987b\u8981\u5c06proxyMode\u5c5e\u6027\u8bbe\u7f6e\u4e3a<code>ScopedProxyMode.TARGET_CLASS</code>\uff0c\u4ee5\u6b64\u6765\u8868\u660e\u8981\u4ee5\u751f\u6210\u76ee\u6807\u7c7b\u6269\u5c55\u7684\u65b9\u5f0f\u521b\u5efa\u4ee3\u7406\u3002</p> <p>\u5c3d\u7ba1\u6211\u4e3b\u8981\u5173\u6ce8\u4e86\u4f1a\u8bdd\u4f5c\u7528\u57df\uff0c\u4f46\u662f\u8bf7\u6c42\u4f5c\u7528\u57df\u7684bean\u4f1a\u9762\u4e34\u76f8\u540c\u7684\u88c5\u914d\u95ee\u9898\u3002\u56e0\u6b64\uff0c\u8bf7\u6c42\u4f5c\u7528\u57df\u7684bean\u5e94\u8be5\u4e5f\u4ee5\u4f5c\u7528\u57df\u4ee3\u7406\u7684\u65b9\u5f0f\u8fdb\u884c\u6ce8\u5165\u3002</p> <p></p> <p>\u56fe3.1\u3000\u4f5c\u7528\u57df\u4ee3\u7406\u80fd\u591f\u5ef6\u8fdf\u6ce8\u5165\u8bf7\u6c42\u548c\u4f1a\u8bdd\u4f5c\u7528\u57df\u7684bean</p>"},{"location":"2017-09-02-Spring%E6%A1%86%E6%9E%B6Bean%E4%BD%9C%E7%94%A8%E5%9F%9F/#2-xml","title":"2 \u5728XML\u4e2d\u58f0\u660e\u4f5c\u7528\u57df\u4ee3\u7406","text":"<p>\u5982\u679c\u4f60\u9700\u8981\u4f7f\u7528XML\u6765\u58f0\u660e\u4f1a\u8bdd\u6216\u8bf7\u6c42\u4f5c\u7528\u57df\u7684bean\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u4f7f\u7528@Scope\u6ce8\u89e3\u53ca\u5176proxyMode\u5c5e\u6027\u4e86\u3002<code>&lt;bean&gt;</code>\u5143\u7d20\u7684<code>scope\u5c5e\u6027</code>\u80fd\u591f\u8bbe\u7f6ebean\u7684\u4f5c\u7528\u57df\uff0c\u4f46\u662f\u8be5\u600e\u6837\u6307\u5b9a\u4ee3\u7406\u6a21\u5f0f\u5462\uff1f</p> <p>\u8981\u8bbe\u7f6e\u4ee3\u7406\u6a21\u5f0f\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528Spring aop\u547d\u540d\u7a7a\u95f4\u7684\u4e00\u4e2a\u65b0\u5143\u7d20\uff1a</p> <pre><code>&lt;bean id=\"cart\"\nclass=\"com.myapp.ShoppingCart\"\nscope=\"session\"&gt;\n&lt;aop:scoped-proxy /&gt;\n&lt;/bean&gt;\n</code></pre> <p><code>&lt;aop:scoped-proxy&gt;</code>\u662f\u4e0e<code>@Scope</code>\u6ce8\u89e3\u7684proxyMode\u5c5e\u6027\u529f\u80fd\u76f8\u540c\u7684Spring XML\u914d\u7f6e\u5143\u7d20\u3002\u5b83\u4f1a\u544a\u8bc9Spring\u4e3abean\u521b\u5efa\u4e00\u4e2a\u4f5c\u7528\u57df\u4ee3\u7406\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u4f1a<code>\u4f7f\u7528CGLib\u521b\u5efa\u76ee\u6807\u7c7b\u7684\u4ee3\u7406</code>\u3002\u4f46\u662f\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06<code>proxy-target-class</code>\u5c5e\u6027\u8bbe\u7f6e\u4e3afalse\uff0c\u8fdb\u800c\u8981\u6c42\u5b83\u751f\u6210\u57fa\u4e8e\u63a5\u53e3\u7684\u4ee3\u7406\uff1a</p> <pre><code>&lt;bean id=\"cart\"\nclass=\"com.myapp.ShoppingCart\"\nscope=\"session\"&gt;\n&lt;aop:scoped-proxy proxy-target-class=\"false\" /&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u4e3a\u4e86\u4f7f\u7528<code>&lt;aop:scoped-proxy&gt;</code>\u5143\u7d20\uff0c\u6211\u4eec\u5fc5\u987b\u5728XML\u914d\u7f6e\u4e2d\u58f0\u660eSpring\u7684aop\u547d\u540d\u7a7a\u95f4\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns:aop=\"http://www.springframework.org/schema/aop\"\nxsi:schemaLocation=\"\n    http://www.springframework.org/schema/aop\n    http://www.springframework.org/schema/aop/spring-aop.xsd\n    http://www.springframework.org/schema/beans\n    http://www.springframework.org/schema/beans/spring-beans.xsd\"&gt;\n...\n&lt;/beans&gt;\n</code></pre>"},{"location":"2017-09-10-Spring%E6%A1%86%E6%9E%B6%E8%BF%90%E8%A1%8C%E6%97%B6%E5%80%BC%E6%B3%A8%E5%85%A5/","title":"Spring\u6846\u67b6\u8fd0\u884c\u65f6\u503c\u6ce8\u5165","text":"<p>\u5f53\u8ba8\u8bba\u4f9d\u8d56\u6ce8\u5165\u7684\u65f6\u5019\uff0c\u6211\u4eec\u901a\u5e38\u6240\u8ba8\u8bba\u7684\u662f\u5c06\u4e00\u4e2abean\u5f15\u7528\u6ce8\u5165\u5230\u53e6\u4e00\u4e2abean\u7684\u5c5e\u6027\u6216\u6784\u9020\u5668\u53c2\u6570\u4e2d\u3002\u5b83\u901a\u5e38\u6765\u8bb2\u6307\u7684\u662f\u5c06\u4e00\u4e2a\u5bf9\u8c61\u4e0e\u53e6\u4e00\u4e2a\u5bf9\u8c61\u8fdb\u884c\u5173\u8054\u3002</p> <p>\u4f46\u662fbean\u88c5\u914d\u7684\u53e6\u5916\u4e00\u4e2a\u65b9\u9762\u6307\u7684\u662f\u5c06\u4e00\u4e2a\u503c\u6ce8\u5165\u5230bean\u7684\u5c5e\u6027\u6216\u8005\u6784\u9020\u5668\u53c2\u6570\u4e2d\u3002\u6211\u4eec\u5728\u7b2c2\u7ae0\u4e2d\u5df2\u7ecf\u8fdb\u884c\u4e86\u5f88\u591a\u503c\u88c5\u914d\uff0c\u5982\u5c06\u4e13\u8f91\u7684\u540d\u5b57\u88c5\u914d\u5230BlankDisc bean\u7684\u6784\u9020\u5668\u6216title\u5c5e\u6027\u4e2d\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u80fd\u6309\u7167\u8fd9\u6837\u7684\u65b9\u5f0f\u6765\u7ec4\u88c5BlankDisc\uff1a</p> <pre><code>@Bean\npublic CompactDisc sgtPeppers() {\nreturn new BlankDisc(\n\"Sgt. Pepper's Lonely Hearts Club Band\",\n\"The Beatles\");\n}\n</code></pre> <p>\u5c3d\u7ba1\u8fd9\u5b9e\u73b0\u4e86\u4f60\u7684\u9700\u6c42\uff0c\u4e5f\u5c31\u662f\u4e3aBlankDisc bean\u8bbe\u7f6etitle\u548cartist\uff0c\u4f46\u5b83\u5728\u5b9e\u73b0\u7684\u65f6\u5019\u662f\u5c06\u503c\u786c\u7f16\u7801\u5728\u914d\u7f6e\u7c7b\u4e2d\u7684\u3002\u4e0e\u4e4b\u7c7b\u4f3c\uff0c\u5982\u679c\u4f7f\u7528XML\u7684\u8bdd\uff0c\u90a3\u4e48\u503c\u4e5f\u4f1a\u662f\u786c\u7f16\u7801\u7684\uff1a</p> <pre><code>&lt;bean id=\"sgtPeppers\"\nclass=\"soundsystem.BlankDisc\"\nc:_title=\"Sgt. Pepper's Lonely Hearts Club Band\"\nc:_artist=\"The Beatles\" /&gt;\n</code></pre> <p>\u6709\u65f6\u5019\u786c\u7f16\u7801\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u6709\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u5e0c\u671b\u907f\u514d\u786c\u7f16\u7801\u503c\uff0c\u800c\u662f\u60f3\u8ba9\u8fd9\u4e9b\u503c\u5728\u8fd0\u884c\u65f6\u518d\u786e\u5b9a\u3002\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e9b\u529f\u80fd\uff0cSpring\u63d0\u4f9b\u4e86\u4e24\u79cd\u5728\u8fd0\u884c\u65f6\u6c42\u503c\u7684\u65b9\u5f0f\uff1a</p> <ul> <li>\u5c5e\u6027\u5360\u4f4d\u7b26\uff08Property placeholder\uff09\u3002</li> <li>Spring\u8868\u8fbe\u5f0f\u8bed\u8a00\uff08SpEL\uff09\u3002</li> </ul> <p>\u5f88\u5feb\u4f60\u5c31\u4f1a\u53d1\u73b0\u8fd9\u4e24\u79cd\u6280\u672f\u7684\u7528\u6cd5\u662f\u7c7b\u4f3c\u7684\uff0c\u4e0d\u8fc7\u5b83\u4eec\u7684\u76ee\u7684\u548c\u884c\u4e3a\u662f\u6709\u6240\u5dee\u522b\u7684\u3002\u8ba9\u6211\u4eec\u5148\u770b\u4e00\u4e0b\u5c5e\u6027\u5360\u4f4d\u7b26\uff0c\u5728\u8fd9\u4e24\u8005\u4e2d\u5b83\u8f83\u4e3a\u7b80\u5355\uff0c\u7136\u540e\u518d\u770b\u4e00\u4e0b\u66f4\u4e3a\u5f3a\u5927\u7684SpEL\u3002</p>"},{"location":"2017-09-10-Spring%E6%A1%86%E6%9E%B6%E8%BF%90%E8%A1%8C%E6%97%B6%E5%80%BC%E6%B3%A8%E5%85%A5/#1","title":"1 \u6ce8\u5165\u5916\u90e8\u7684\u503c","text":"<p>\u5728Spring\u4e2d\uff0c\u5904\u7406\u5916\u90e8\u503c\u7684\u6700\u7b80\u5355\u65b9\u5f0f\u5c31\u662f\u58f0\u660e\u5c5e\u6027\u6e90\u5e76\u901a\u8fc7Spring\u7684Environment\u6765\u68c0\u7d22\u5c5e\u6027\u3002\u4f8b\u5982\uff0c\u7a0b\u5e8f\u6e05\u53553.7\u5c55\u73b0\u4e86\u4e00\u4e2a\u57fa\u672c\u7684Spring\u914d\u7f6e\u7c7b\uff0c\u5b83\u4f7f\u7528\u5916\u90e8\u7684\u5c5e\u6027\u6765\u88c5\u914dBlankDisc bean\u3002</p> <p></p> <p>\u5728\u672c\u4f8b\u4e2d\uff0c@PropertySource\u5f15\u7528\u4e86\u7c7b\u8def\u5f84\u4e2d\u4e00\u4e2a\u540d\u4e3aapp.properties\u7684\u6587\u4ef6\u3002\u5b83\u5927\u81f4\u4f1a\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>disc.title=Sgt. Peppers Lonely Hearts Club Band\ndisc.artist=The Beatles\n</code></pre> <p>\u8fd9\u4e2a\u5c5e\u6027\u6587\u4ef6\u4f1a\u52a0\u8f7d\u5230Spring\u7684Environment\u4e2d\uff0c\u7a0d\u540e\u53ef\u4ee5\u4ece\u8fd9\u91cc\u68c0\u7d22\u5c5e\u6027\u3002\u540c\u65f6\uff0c\u5728disc()\u65b9\u6cd5\u4e2d\uff0c\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684BlankDisc\uff0c\u5b83\u7684\u6784\u9020\u5668\u53c2\u6570\u662f\u4ece\u5c5e\u6027\u6587\u4ef6\u4e2d\u83b7\u53d6\u7684\uff0c\u800c\u8fd9\u662f\u901a\u8fc7\u8c03\u7528getProperty()\u5b9e\u73b0\u7684\u3002</p>"},{"location":"2017-09-10-Spring%E6%A1%86%E6%9E%B6%E8%BF%90%E8%A1%8C%E6%97%B6%E5%80%BC%E6%B3%A8%E5%85%A5/#springenvironment","title":"\u6df1\u5165\u5b66\u4e60Spring\u7684Environment","text":"<p>\u5f53\u6211\u4eec\u53bb\u4e86\u89e3Environment\u7684\u65f6\u5019\u4f1a\u53d1\u73b0\uff0c\u7a0b\u5e8f\u6e05\u53553.7\u6240\u793a\u7684getProperty()\u65b9\u6cd5\u5e76\u4e0d\u662f\u83b7\u53d6\u5c5e\u6027\u503c\u7684\u552f\u4e00\u65b9\u6cd5\uff0cgetProperty()\u65b9\u6cd5\u6709\u56db\u4e2a\u91cd\u8f7d\u7684\u53d8\u79cd\u5f62\u5f0f\uff1a</p> <ul> <li><code>String getProperty(String key)</code></li> <li><code>String getProperty(String key, String defaultValue)</code></li> <li><code>T getProperty(String key, Class&lt;T&gt; type)</code></li> <li><code>T getProperty(String key, Class&lt;T&gt; type, T defaultValue)</code></li> </ul> <p>\u524d\u4e24\u79cd\u5f62\u5f0f\u7684getProperty()\u65b9\u6cd5\u90fd\u4f1a\u8fd4\u56deString\u7c7b\u578b\u7684\u503c\u3002\u6211\u4eec\u5df2\u7ecf\u5728\u7a0b\u5e8f\u6e05\u53553.7\u4e2d\u770b\u5230\u4e86\u5982\u4f55\u4f7f\u7528\u7b2c\u4e00\u79cdgetProperty()\u65b9\u6cd5\u3002\u4f46\u662f\uff0c\u4f60\u53ef\u4ee5\u7a0d\u5fae\u5bf9@Bean\u65b9\u6cd5\u8fdb\u884c\u4e00\u4e0b\u4fee\u6539\uff0c\u8fd9\u6837\u5728\u6307\u5b9a\u5c5e\u6027\u4e0d\u5b58\u5728\u7684\u65f6\u5019\uff0c\u4f1a\u4f7f\u7528\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff1a</p> <pre><code>@Bean\npublic BlankDisc disc() {\nreturn new BlankDisc(\nenv.getProperty(\"disc.title\", \"Rattle and Hum\"),\nenv.getProperty(\"disc.artist\", \"U2\"));\n}\n</code></pre> <p>\u5269\u4e0b\u7684\u4e24\u79cdgetProperty()\u65b9\u6cd5\u4e0e\u524d\u9762\u7684\u4e24\u79cd\u975e\u5e38\u7c7b\u4f3c\uff0c\u4f46\u662f\u5b83\u4eec\u4e0d\u4f1a\u5c06\u6240\u6709\u7684\u503c\u90fd\u89c6\u4e3aString\u7c7b\u578b\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u4f60\u60f3\u8981\u83b7\u53d6\u7684\u503c\u6240\u4ee3\u8868\u7684\u542b\u4e49\u662f\u8fde\u63a5\u6c60\u4e2d\u6240\u7ef4\u6301\u7684\u8fde\u63a5\u6570\u91cf\u3002\u5982\u679c\u6211\u4eec\u4ece\u5c5e\u6027\u6587\u4ef6\u4e2d\u5f97\u5230\u7684\u662f\u4e00\u4e2aString\u7c7b\u578b\u7684\u503c\uff0c\u90a3\u4e48\u5728\u4f7f\u7528\u4e4b\u524d\u8fd8\u9700\u8981\u5c06\u5176\u8f6c\u6362\u4e3aInteger\u7c7b\u578b\u3002\u4f46\u662f\uff0c\u5982\u679c\u4f7f\u7528\u91cd\u8f7d\u5f62\u5f0f\u7684getProperty()\u7684\u8bdd\uff0c\u5c31\u80fd\u975e\u5e38\u4fbf\u5229\u5730\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a</p> <pre><code>int connectionCount =\nenv.getProperty(\"db.connection.count\", Integer.class, 30);\n</code></pre> <p>Environment\u8fd8\u63d0\u4f9b\u4e86\u51e0\u4e2a\u4e0e\u5c5e\u6027\u76f8\u5173\u7684\u65b9\u6cd5\uff0c\u5982\u679c\u4f60\u5728\u4f7f\u7528getProperty()\u65b9\u6cd5\u7684\u65f6\u5019\u6ca1\u6709\u6307\u5b9a\u9ed8\u8ba4\u503c\uff0c\u5e76\u4e14\u8fd9\u4e2a\u5c5e\u6027\u6ca1\u6709\u5b9a\u4e49\u7684\u8bdd\uff0c\u83b7\u53d6\u5230\u7684\u503c\u662fnull\u3002\u5982\u679c\u4f60\u5e0c\u671b\u8fd9\u4e2a\u5c5e\u6027\u5fc5\u987b\u8981\u5b9a\u4e49\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f7f\u7528getRequiredProperty()\u65b9\u6cd5\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>@Bean\npublic BlankDisc disc() {\nreturn new BlankDisc(\nenv.getRequiredProperty(\"disc.title\"),\nenv.getRequiredProperty(\"disc.artist\"));\n}\n</code></pre> <p>\u5728\u8fd9\u91cc\uff0c\u5982\u679cdisc.title\u6216disc.artist\u5c5e\u6027\u6ca1\u6709\u5b9a\u4e49\u7684\u8bdd\uff0c\u5c06\u4f1a\u629b\u51faIllegalStateException\u5f02\u5e38\u3002</p> <p>\u5982\u679c\u60f3\u68c0\u67e5\u4e00\u4e0b\u67d0\u4e2a\u5c5e\u6027\u662f\u5426\u5b58\u5728\u7684\u8bdd\uff0c\u90a3\u4e48\u53ef\u4ee5\u8c03\u7528Environment\u7684containsProperty()\u65b9\u6cd5\uff1a</p> <pre><code>boolean titleExists = env.containsProperty(\"disc.title\");\n</code></pre> <p>\u6700\u540e\uff0c\u5982\u679c\u60f3\u5c06\u5c5e\u6027\u89e3\u6790\u4e3a\u7c7b\u7684\u8bdd\uff0c\u53ef\u4ee5\u4f7f\u7528getPropertyAsClass()\u65b9\u6cd5\uff1a</p> <pre><code>Class&lt;CompactDisc&gt; cdClass =\nenv.getPropertyAsClass(\"disc.class\", CompactDisc.class);\n</code></pre> <p>\u9664\u4e86\u5c5e\u6027\u76f8\u5173\u7684\u529f\u80fd\u4ee5\u5916\uff0cEnvironment\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e9b\u65b9\u6cd5\u6765\u68c0\u67e5\u54ea\u4e9bprofile\u5904\u4e8e\u6fc0\u6d3b\u72b6\u6001\uff1a</p> <ul> <li>String[] getActiveProfiles()\uff1a\u8fd4\u56de\u6fc0\u6d3bprofile\u540d\u79f0\u7684\u6570\u7ec4\uff1b</li> <li>String[] getDefaultProfiles()\uff1a\u8fd4\u56de\u9ed8\u8ba4profile\u540d\u79f0\u7684\u6570\u7ec4\uff1b</li> <li>boolean acceptsProfiles(String... profiles)\uff1a\u5982\u679cenvironment\u652f\u6301\u7ed9\u5b9aprofile\u7684\u8bdd\uff0c\u5c31\u8fd4\u56detrue\u3002</li> </ul> <p>\u5728\u7a0b\u5e8f\u6e05\u53553.6\u4e2d\uff0c\u6211\u4eec\u5df2\u7ecf\u770b\u5230\u4e86\u5982\u4f55\u4f7f\u7528acceptsProfiles()\u3002\u5728\u90a3\u4e2a\u4f8b\u5b50\u4e2d\uff0cEnvironment\u662f\u4eceConditionContext\u4e2d\u83b7\u53d6\u5230\u7684\uff0c\u5728bean\u521b\u5efa\u4e4b\u524d\uff0c\u4f7f\u7528acceptsProfiles()\u65b9\u6cd5\u6765\u786e\u4fdd\u7ed9\u5b9abean\u6240\u9700\u7684profile\u5904\u4e8e\u6fc0\u6d3b\u72b6\u6001\u3002\u901a\u5e38\u6765\u8bb2\uff0c\u6211\u4eec\u5e76\u4e0d\u4f1a\u9891\u7e41\u4f7f\u7528Environment\u76f8\u5173\u7684\u65b9\u6cd5\uff0c\u4f46\u662f\u77e5\u9053\u6709\u8fd9\u4e9b\u65b9\u6cd5\u8fd8\u662f\u6709\u597d\u5904\u7684\u3002</p> <p>\u76f4\u63a5\u4eceEnvironment\u4e2d\u68c0\u7d22\u5c5e\u6027\u662f\u975e\u5e38\u65b9\u4fbf\u7684\uff0c\u5c24\u5176\u662f\u5728Java\u914d\u7f6e\u4e2d\u88c5\u914dbean\u7684\u65f6\u5019\u3002\u4f46\u662f\uff0cSpring\u4e5f\u63d0\u4f9b\u4e86\u901a\u8fc7\u5360\u4f4d\u7b26\u88c5\u914d\u5c5e\u6027\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u5360\u4f4d\u7b26\u7684\u503c\u4f1a\u6765\u6e90\u4e8e\u4e00\u4e2a\u5c5e\u6027\u6e90\u3002</p>"},{"location":"2017-09-10-Spring%E6%A1%86%E6%9E%B6%E8%BF%90%E8%A1%8C%E6%97%B6%E5%80%BC%E6%B3%A8%E5%85%A5/#_1","title":"\u89e3\u6790\u5c5e\u6027\u5360\u4f4d\u7b26","text":"<p>Spring\u4e00\u76f4\u652f\u6301\u5c06\u5c5e\u6027\u5b9a\u4e49\u5230\u5916\u90e8\u7684\u5c5e\u6027\u7684\u6587\u4ef6\u4e2d\uff0c\u5e76\u4f7f\u7528\u5360\u4f4d\u7b26\u503c\u5c06\u5176\u63d2\u5165\u5230Spring bean\u4e2d\u3002\u5728Spring\u88c5\u914d\u4e2d\uff0c\u5360\u4f4d\u7b26\u7684\u5f62\u5f0f\u4e3a\u4f7f\u7528\u201c${ ... }\u201d\u5305\u88c5\u7684\u5c5e\u6027\u540d\u79f0\u3002\u4f5c\u4e3a\u6837\u4f8b\uff0c\u6211\u4eec\u53ef\u4ee5\u5728XML\u4e2d\u6309\u7167\u5982\u4e0b\u7684\u65b9\u5f0f\u89e3\u6790BlankDisc\u6784\u9020\u5668\u53c2\u6570\uff1a</p> <pre><code>&lt;bean id=\"sgtPeppers\"\nclass=\"soundsystem.BlankDisc\"\nc:_title=\"${disc.title}\"\nc:_artist=\"${disc.artist}\" /&gt;\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0ctitle\u6784\u9020\u5668\u53c2\u6570\u6240\u7ed9\u5b9a\u7684\u503c\u662f\u4ece\u4e00\u4e2a\u5c5e\u6027\u4e2d\u89e3\u6790\u5f97\u5230\u7684\uff0c\u8fd9\u4e2a\u5c5e\u6027\u7684\u540d\u79f0\u4e3adisc.title\u3002artist\u53c2\u6570\u88c5\u914d\u7684\u662f\u540d\u4e3adisc.artist\u7684\u5c5e\u6027\u503c\u3002\u6309\u7167\u8fd9\u79cd\u65b9\u5f0f\uff0cXML\u914d\u7f6e\u6ca1\u6709\u4f7f\u7528\u4efb\u4f55\u786c\u7f16\u7801\u7684\u503c\uff0c\u5b83\u7684\u503c\u662f\u4ece\u914d\u7f6e\u6587\u4ef6\u4ee5\u5916\u7684\u4e00\u4e2a\u6e90\u4e2d\u89e3\u6790\u5f97\u5230\u7684\u3002\uff08\u6211\u4eec\u7a0d\u540e\u4f1a\u8ba8\u8bba\u8fd9\u4e9b\u5c5e\u6027\u662f\u5982\u4f55\u89e3\u6790\u7684\u3002\uff09</p> <p>\u5982\u679c\u6211\u4eec\u4f9d\u8d56\u4e8e\u7ec4\u4ef6\u626b\u63cf\u548c\u81ea\u52a8\u88c5\u914d\u6765\u521b\u5efa\u548c\u521d\u59cb\u5316\u5e94\u7528\u7ec4\u4ef6\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u6ca1\u6709\u6307\u5b9a\u5360\u4f4d\u7b26\u7684\u914d\u7f6e\u6587\u4ef6\u6216\u7c7b\u4e86\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528@Value\u6ce8\u89e3\uff0c\u5b83\u7684\u4f7f\u7528\u65b9\u5f0f\u4e0e@Autowired\u6ce8\u89e3\u975e\u5e38\u76f8\u4f3c\u3002\u6bd4\u5982\uff0c\u5728BlankDisc\u7c7b\u4e2d\uff0c\u6784\u9020\u5668\u53ef\u4ee5\u6539\u6210\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>public BlankDisc(\n@Value(\"${disc.title}\") String title,\n@Value(\"${disc.artist}\") String artist) {\nthis.title = title;\nthis.artist = artist;\n}\n</code></pre> <p>\u4e3a\u4e86\u4f7f\u7528\u5360\u4f4d\u7b26\uff0c\u6211\u4eec\u5fc5\u987b\u8981\u914d\u7f6e\u4e00\u4e2aPropertyPlaceholderConfigurer bean\u6216PropertySourcesPlaceholderConfigurer bean\u3002\u4eceSpring 3.1\u5f00\u59cb\uff0c\u63a8\u8350\u4f7f\u7528PropertySourcesPlaceholderConfigurer\uff0c\u56e0\u4e3a\u5b83\u80fd\u591f\u57fa\u4e8eSpring Environment\u53ca\u5176\u5c5e\u6027\u6e90\u6765\u89e3\u6790\u5360\u4f4d\u7b26\u3002</p> <p>\u5982\u4e0b\u7684@Bean\u65b9\u6cd5\u5728Java\u4e2d\u914d\u7f6e\u4e86PropertySourcesPlaceholderConfigurer\uff1a</p> <pre><code>@Bean\npublic\nstatic PropertySourcesPlaceholderConfigurer placeholderConfigurer() {\nreturn new PropertySourcesPlaceholderConfigurer();\n}\n</code></pre> <p>\u5982\u679c\u4f60\u60f3\u4f7f\u7528XML\u914d\u7f6e\u7684\u8bdd\uff0cSpring context\u547d\u540d\u7a7a\u95f4\u4e2d\u7684<code>&lt;context:propertyplaceholder&gt;</code>\u5143\u7d20\u5c06\u4f1a\u4e3a\u4f60\u751f\u6210PropertySourcesPlaceholderConfigurer bean\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns:context=\"http://www.springframework.org/schema/context\"\nxsi:schemaLocation=\"\n    http://www.springframework.org/schema/beans\n    http://www.springframework.org/schema/beans/spring-beans.xsd\n    http://www.springframework.org/schema/context\n    http://www.springframework.org/schema/context/spring-context.xsd\"&gt;\n\n&lt;context:property-placeholder /&gt;\n\n&lt;/beans&gt;\n</code></pre> <p>\u89e3\u6790\u5916\u90e8\u5c5e\u6027\u80fd\u591f\u5c06\u503c\u7684\u5904\u7406\u63a8\u8fdf\u5230\u8fd0\u884c\u65f6\uff0c\u4f46\u662f\u5b83\u7684\u5173\u6ce8\u70b9\u5728\u4e8e\u6839\u636e\u540d\u79f0\u89e3\u6790\u6765\u81ea\u4e8eSpring Environment\u548c\u5c5e\u6027\u6e90\u7684\u5c5e\u6027\u3002\u800cSpring\u8868\u8fbe\u5f0f\u8bed\u8a00\u63d0\u4f9b\u4e86\u4e00\u79cd\u66f4\u901a\u7528\u7684\u65b9\u5f0f\u5728\u8fd0\u884c\u65f6\u8ba1\u7b97\u6240\u8981\u6ce8\u5165\u7684\u503c\u3002</p>"},{"location":"2017-09-10-Spring%E6%A1%86%E6%9E%B6%E8%BF%90%E8%A1%8C%E6%97%B6%E5%80%BC%E6%B3%A8%E5%85%A5/#2-spring","title":"2 \u4f7f\u7528Spring\u8868\u8fbe\u5f0f\u8bed\u8a00\u8fdb\u884c\u88c5\u914d","text":"<p>Spring 3\u5f15\u5165\u4e86Spring\u8868\u8fbe\u5f0f\u8bed\u8a00\uff08Spring Expression Language\uff0cSpEL\uff09\uff0c\u5b83\u80fd\u591f\u4ee5\u4e00\u79cd\u5f3a\u5927\u548c\u7b80\u6d01\u7684\u65b9\u5f0f\u5c06\u503c\u88c5\u914d\u5230bean\u5c5e\u6027\u548c\u6784\u9020\u5668\u53c2\u6570\u4e2d\uff0c\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u6240\u4f7f\u7528\u7684\u8868\u8fbe\u5f0f\u4f1a\u5728\u8fd0\u884c\u65f6\u8ba1\u7b97\u5f97\u5230\u503c\u3002\u4f7f\u7528SpEL\uff0c\u4f60\u53ef\u4ee5\u5b9e\u73b0\u8d85\u4e4e\u60f3\u8c61\u7684\u88c5\u914d\u6548\u679c\uff0c\u8fd9\u662f\u4f7f\u7528\u5176\u4ed6\u7684\u88c5\u914d\u6280\u672f\u96be\u4ee5\u505a\u5230\u7684\uff08\u751a\u81f3\u662f\u4e0d\u53ef\u80fd\u7684\uff09\u3002</p> <p>SpEL\u62e5\u6709\u5f88\u591a\u7279\u6027\uff0c\u5305\u62ec\uff1a</p> <ul> <li>\u4f7f\u7528bean\u7684ID\u6765\u5f15\u7528bean\uff1b</li> <li>\u8c03\u7528\u65b9\u6cd5\u548c\u8bbf\u95ee\u5bf9\u8c61\u7684\u5c5e\u6027\uff1b</li> <li>\u5bf9\u503c\u8fdb\u884c\u7b97\u672f\u3001\u5173\u7cfb\u548c\u903b\u8f91\u8fd0\u7b97\uff1b</li> <li>\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff1b</li> <li>\u96c6\u5408\u64cd\u4f5c\u3002</li> </ul> <p>\u5728\u672c\u4e66\u540e\u9762\u7684\u5185\u5bb9\u4e2d\u4f60\u53ef\u4ee5\u770b\u5230\uff0cSpEL\u80fd\u591f\u7528\u5728\u4f9d\u8d56\u6ce8\u5165\u4ee5\u5916\u7684\u5176\u4ed6\u5730\u65b9\u3002\u4f8b\u5982\uff0cSpring Security\u652f\u6301\u4f7f\u7528SpEL\u8868\u8fbe\u5f0f\u5b9a\u4e49\u5b89\u5168\u9650\u5236\u89c4\u5219\u3002\u53e6\u5916\uff0c\u5982\u679c\u4f60\u5728Spring MVC\u5e94\u7528\u4e2d\u4f7f\u7528Thymeleaf\u6a21\u677f\u4f5c\u4e3a\u89c6\u56fe\u7684\u8bdd\uff0c\u90a3\u4e48\u8fd9\u4e9b\u6a21\u677f\u53ef\u4ee5\u4f7f\u7528SpEL\u8868\u8fbe\u5f0f\u5f15\u7528\u6a21\u578b\u6570\u636e\u3002</p> <p>\u4f5c\u4e3a\u8d77\u6b65\uff0c\u6211\u4eec\u770b\u51e0\u4e2aSpEL\u8868\u8fbe\u5f0f\u7684\u6837\u4f8b\uff0c\u4ee5\u53ca\u5982\u4f55\u5c06\u5176\u6ce8\u5165\u5230bean\u4e2d\u3002\u7136\u540e\u6211\u4eec\u4f1a\u6df1\u5165\u5b66\u4e60\u4e00\u4e9bSpEL\u7684\u57fa\u7840\u8868\u8fbe\u5f0f\uff0c\u5b83\u4eec\u80fd\u591f\u7ec4\u5408\u8d77\u6765\u5f62\u6210\u66f4\u4e3a\u5f3a\u5927\u7684\u8868\u8fbe\u5f0f\u3002</p>"},{"location":"2017-09-10-Spring%E6%A1%86%E6%9E%B6%E8%BF%90%E8%A1%8C%E6%97%B6%E5%80%BC%E6%B3%A8%E5%85%A5/#spel","title":"SpEL\u6837\u4f8b","text":"<p>SpEL\u662f\u4e00\u79cd\u975e\u5e38\u7075\u6d3b\u7684\u8868\u8fbe\u5f0f\u8bed\u8a00\uff0c\u6240\u4ee5\u5728\u672c\u4e66\u4e2d\u4e0d\u53ef\u80fd\u9762\u9762\u4ff1\u5230\u5730\u4ecb\u7ecd\u5b83\u7684\u5404\u79cd\u7528\u6cd5\u3002\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u5c55\u793a\u51e0\u4e2a\u57fa\u672c\u7684\u4f8b\u5b50\uff0c\u8fd9\u4e9b\u4f8b\u5b50\u4f1a\u6fc0\u53d1\u4f60\u7684\u7075\u611f\uff0c\u6709\u52a9\u4e8e\u4f60\u7f16\u5199\u81ea\u5df1\u7684\u8868\u8fbe\u5f0f\u3002</p> <p>\u9700\u8981\u4e86\u89e3\u7684\u7b2c\u4e00\u4ef6\u4e8b\u60c5\u5c31\u662fSpEL\u8868\u8fbe\u5f0f\u8981\u653e\u5230\u201c#{ ... }\u201d\u4e4b\u4e2d\uff0c\u8fd9\u4e0e\u5c5e\u6027\u5360\u4f4d\u7b26\u6709\u4e9b\u7c7b\u4f3c\uff0c\u5c5e\u6027\u5360\u4f4d\u7b26\u9700\u8981\u653e\u5230\u201c${ ... }\u201d\u4e4b\u4e2d\u3002\u4e0b\u9762\u6240\u5c55\u73b0\u7684\u53ef\u80fd\u662f\u6700\u7b80\u5355\u7684SpEL\u8868\u8fbe\u5f0f\u4e86\uff1a</p> <pre><code>#{1}\n</code></pre> <p>\u9664\u53bb\u201c#{ ... }\u201d\u6807\u8bb0\u4e4b\u540e\uff0c\u5269\u4e0b\u7684\u5c31\u662fSpEL\u8868\u8fbe\u5f0f\u4f53\u4e86\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u6570\u5b57\u5e38\u91cf\u3002\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u7684\u8ba1\u7b97\u7ed3\u679c\u5c31\u662f\u6570\u5b571\uff0c\u8fd9\u6050\u6015\u5e76\u4e0d\u4f1a\u8ba9\u4f60\u611f\u5230\u4e1d\u6beb\u60ca\u8bb6\u3002</p> <p>\u5f53\u7136\uff0c\u5728\u5b9e\u9645\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u6211\u4eec\u53ef\u80fd\u5e76\u4e0d\u4f1a\u4f7f\u7528\u8fd9\u4e48\u7b80\u5355\u7684\u8868\u8fbe\u5f0f\u3002\u6211\u4eec\u53ef\u80fd\u4f1a\u4f7f\u7528\u66f4\u52a0\u6709\u610f\u601d\u7684\u8868\u8fbe\u5f0f\uff0c\u5982\uff1a</p> <pre><code>#{T(System).currentTimeMillis()}\n</code></pre> <p>\u5b83\u7684\u6700\u7ec8\u7ed3\u679c\u662f\u8ba1\u7b97\u8868\u8fbe\u5f0f\u7684\u90a3\u4e00\u523b\u5f53\u524d\u65f6\u95f4\u7684\u6beb\u79d2\u6570\u3002T()\u8868\u8fbe\u5f0f\u4f1a\u5c06java.lang.System\u89c6\u4e3aJava\u4e2d\u5bf9\u5e94\u7684\u7c7b\u578b\uff0c\u56e0\u6b64\u53ef\u4ee5\u8c03\u7528\u5176static\u4fee\u9970\u7684currentTimeMillis()\u65b9\u6cd5\u3002</p> <p>SpEL\u8868\u8fbe\u5f0f\u4e5f\u53ef\u4ee5\u5f15\u7528\u5176\u4ed6\u7684bean\u6216\u5176\u4ed6bean\u7684\u5c5e\u6027\u3002\u4f8b\u5982\uff0c\u5982\u4e0b\u7684\u8868\u8fbe\u5f0f\u4f1a\u8ba1\u7b97\u5f97\u5230ID\u4e3asgtPeppers\u7684bean\u7684artist\u5c5e\u6027\uff1a</p> <pre><code>#{sgtPeppers.artist}\n</code></pre> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7systemProperties\u5bf9\u8c61\u5f15\u7528\u7cfb\u7edf\u5c5e\u6027\uff1a</p> <pre><code>#{systemProperties['disc.title']}\n</code></pre> <p>\u8fd9\u53ea\u662fSpEL\u7684\u51e0\u4e2a\u57fa\u7840\u6837\u4f8b\u3002\u5728\u672c\u7ae0\u7ed3\u675f\u4e4b\u524d\uff0c\u4f60\u8fd8\u4f1a\u770b\u5230\u5f88\u591a\u8fd9\u6837\u7684\u8868\u8fbe\u5f0f\u3002\u4f46\u662f\uff0c\u5728\u6b64\u4e4b\u524d\uff0c\u8ba9\u6211\u4eec\u770b\u4e00\u4e0b\u5728bean\u88c5\u914d\u7684\u65f6\u5019\u5982\u4f55\u4f7f\u7528\u8fd9\u4e9b\u8868\u8fbe\u5f0f\u3002</p> <p>\u5982\u679c\u901a\u8fc7\u7ec4\u4ef6\u626b\u63cf\u521b\u5efabean\u7684\u8bdd\uff0c\u5728\u6ce8\u5165\u5c5e\u6027\u548c\u6784\u9020\u5668\u53c2\u6570\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528@Value\u6ce8\u89e3\uff0c\u8fd9\u4e0e\u4e4b\u524d\u770b\u5230\u7684\u5c5e\u6027\u5360\u4f4d\u7b26\u975e\u5e38\u7c7b\u4f3c\u3002\u4e0d\u8fc7\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u6240\u4f7f\u7528\u7684\u4e0d\u662f\u5360\u4f4d\u7b26\u8868\u8fbe\u5f0f\uff0c\u800c\u662fSpEL\u8868\u8fbe\u5f0f\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u6837\u4f8b\u5c55\u73b0\u4e86BlankDisc\uff0c\u5b83\u4f1a\u4ece\u7cfb\u7edf\u5c5e\u6027\u4e2d\u83b7\u53d6\u4e13\u8f91\u540d\u79f0\u548c\u827a\u672f\u5bb6\u7684\u540d\u5b57\uff1a</p> <pre><code>public BlankDisc(\n@Value(\"#{systemProperties['disc.title']}\") String title,\n@Value(\"#{systemProperties['disc.artist']}\") String artist) {\nthis.title = title;\nthis.artist = artist;\n}\n</code></pre> <p>\u5728XML\u914d\u7f6e\u4e2d\uff0c\u4f60\u53ef\u4ee5\u5c06SpEL\u8868\u8fbe\u5f0f\u4f20\u5165<code>&lt;property&gt;</code>\u6216<code>&lt;constructor-arg&gt;</code>\u7684value\u5c5e\u6027\u4e2d\uff0c\u6216\u8005\u5c06\u5176\u4f5c\u4e3ap-\u547d\u540d\u7a7a\u95f4\u6216c-\u547d\u540d\u7a7a\u95f4\u6761\u76ee\u7684\u503c\u3002\u4f8b\u5982\uff0c\u5728\u5982\u4e0bBlankDisc bean\u7684XML\u58f0\u660e\u4e2d\uff0c\u6784\u9020\u5668\u53c2\u6570\u5c31\u662f\u901a\u8fc7SpEL\u8868\u8fbe\u5f0f\u8bbe\u7f6e\u7684\uff1a</p> <pre><code>&lt;bean id=\"sgtPeppers\"\nclass=\"soundsystem.BlankDisc\"\nc:_title=\"#{systemProperties['disc.title']}\"\nc:_artist=\"#{systemProperties['disc.artist']}\" /&gt;\n</code></pre> <p>\u6211\u4eec\u5df2\u7ecf\u770b\u8fc7\u4e86\u51e0\u4e2a\u7b80\u5355\u7684\u6837\u4f8b\uff0c\u4e5f\u5b66\u4e60\u4e86\u5982\u4f55\u5c06SpEL\u89e3\u6790\u5f97\u5230\u7684\u503c\u6ce8\u5165\u5230bean\u4e2d\uff0c\u90a3\u73b0\u5728\u5c31\u6765\u7ee7\u7eed\u5b66\u4e60\u4e00\u4e0bSpEL\u6240\u652f\u6301\u7684\u57fa\u7840\u8868\u8fbe\u5f0f\u5427\u3002</p>"},{"location":"2017-09-10-Spring%E6%A1%86%E6%9E%B6%E8%BF%90%E8%A1%8C%E6%97%B6%E5%80%BC%E6%B3%A8%E5%85%A5/#_2","title":"\u8868\u793a\u5b57\u9762\u503c","text":"<p>\u6211\u4eec\u5728\u524d\u9762\u5df2\u7ecf\u770b\u5230\u4e86\u4e00\u4e2a\u4f7f\u7528SpEL\u6765\u8868\u793a\u6574\u6570\u5b57\u9762\u91cf\u7684\u6837\u4f8b\u3002\u5b83\u5b9e\u9645\u4e0a\u8fd8\u53ef\u4ee5\u7528\u6765\u8868\u793a\u6d6e\u70b9\u6570\u3001String\u503c\u4ee5\u53caBoolean\u503c\u3002</p> <p>\u4e0b\u9762\u7684SpEL\u8868\u8fbe\u5f0f\u6837\u4f8b\u6240\u8868\u793a\u7684\u5c31\u662f\u6d6e\u70b9\u503c\uff1a</p> <pre><code>#{3.14159}\n</code></pre> <p>\u6570\u503c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u79d1\u5b66\u8bb0\u6570\u6cd5\u7684\u65b9\u5f0f\u8fdb\u884c\u8868\u793a\u3002\u5982\u4e0b\u9762\u7684\u8868\u8fbe\u5f0f\u8ba1\u7b97\u5f97\u5230\u7684\u503c\u5c31\u662f98,700\uff1a</p> <pre><code>#{9.87E4}\n</code></pre> <p>SpEL\u8868\u8fbe\u5f0f\u4e5f\u53ef\u4ee5\u7528\u6765\u8ba1\u7b97String\u7c7b\u578b\u7684\u5b57\u9762\u503c\uff0c\u5982\uff1a</p> <pre><code>#{'Hello'}\n</code></pre> <p>\u6700\u540e\uff0c\u5b57\u9762\u503ctrue\u548cfalse\u7684\u8ba1\u7b97\u7ed3\u679c\u5c31\u662f\u5b83\u4eec\u5bf9\u5e94\u7684Boolean\u7c7b\u578b\u7684\u503c\u3002\u4f8b\u5982\uff1a</p> <pre><code>#{false}\n</code></pre> <p>\u5728SpEL\u4e2d\u4f7f\u7528\u5b57\u9762\u503c\u5176\u5b9e\u6ca1\u6709\u592a\u5927\u7684\u610f\u601d\uff0c\u6bd5\u7adf\u5c06\u6574\u578b\u5c5e\u6027\u8bbe\u7f6e\u4e3a1\uff0c\u6216\u8005\u5c06Boolean\u5c5e\u6027\u8bbe\u7f6e\u4e3afalse\u65f6\uff0c\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u4f7f\u7528SpEL\u3002\u6211\u627f\u8ba4\u5728SpEL\u8868\u8fbe\u5f0f\u4e2d\uff0c\u53ea\u5305\u542b\u5b57\u9762\u503c\u60c5\u51b5\u5e76\u6ca1\u6709\u592a\u5927\u7684\u7528\u5904\u3002\u4f46\u9700\u8981\u8bb0\u4f4f\u7684\u4e00\u70b9\u662f\uff0c\u66f4\u6709\u610f\u601d\u7684SpEL\u8868\u8fbe\u5f0f\u662f\u7531\u66f4\u7b80\u5355\u7684\u8868\u8fbe\u5f0f\u7ec4\u6210\u7684\uff0c\u56e0\u6b64\u4e86\u89e3\u5728SpEL\u4e2d\u5982\u4f55\u4f7f\u7528\u5b57\u9762\u91cf\u8fd8\u662f\u5f88\u6709\u7528\u5904\u7684\u3002\u5f53\u7ec4\u5408\u66f4\u4e3a\u590d\u6742\u7684\u8868\u8fbe\u5f0f\u65f6\uff0c\u4f60\u8fdf\u65e9\u4f1a\u7528\u5230\u5b83\u4eec\u3002</p>"},{"location":"2017-09-10-Spring%E6%A1%86%E6%9E%B6%E8%BF%90%E8%A1%8C%E6%97%B6%E5%80%BC%E6%B3%A8%E5%85%A5/#bean","title":"\u5f15\u7528bean\u3001\u5c5e\u6027\u548c\u65b9\u6cd5","text":"<p>SpEL\u6240\u80fd\u505a\u7684\u53e6\u5916\u4e00\u4ef6\u57fa\u7840\u7684\u4e8b\u60c5\u5c31\u662f\u901a\u8fc7ID\u5f15\u7528\u5176\u4ed6\u7684bean\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528SpEL\u5c06\u4e00\u4e2abean\u88c5\u914d\u5230\u53e6\u5916\u4e00\u4e2abean\u7684\u5c5e\u6027\u4e2d\uff0c\u6b64\u65f6\u8981\u4f7f\u7528bean ID\u4f5c\u4e3aSpEL\u8868\u8fbe\u5f0f\uff08\u5728\u672c\u4f8b\u4e2d\uff0c\u4e5f\u5c31\u662fsgtPeppers\uff09\uff1a</p> <pre><code>#{sgtPeppers}\n</code></pre> <p>\u73b0\u5728\uff0c\u5047\u8bbe\u6211\u4eec\u60f3\u5728\u4e00\u4e2a\u8868\u8fbe\u5f0f\u4e2d\u5f15\u7528sgtPeppers\u7684artist\u5c5e\u6027\uff1a</p> <pre><code>#{sgtPeppers.artist}\n</code></pre> <p>\u8868\u8fbe\u5f0f\u4e3b\u4f53\u7684\u7b2c\u4e00\u90e8\u5206\u5f15\u7528\u4e86\u4e00\u4e2aID\u4e3asgtPeppers\u7684bean\uff0c\u5206\u5272\u7b26\u4e4b\u540e\u662f\u5bf9artist\u5c5e\u6027\u7684\u5f15\u7528\u3002</p> <p>\u9664\u4e86\u5f15\u7528bean\u7684\u5c5e\u6027\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u8c03\u7528bean\u4e0a\u7684\u65b9\u6cd5\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u6709\u53e6\u5916\u4e00\u4e2abean\uff0c\u5b83\u7684ID\u4e3aartistSelector\uff0c\u6211\u4eec\u53ef\u4ee5\u5728SpEL\u8868\u8fbe\u5f0f\u4e2d\u6309\u7167\u5982\u4e0b\u7684\u65b9\u5f0f\u6765\u8c03\u7528bean\u7684selectArtist()\u65b9\u6cd5\uff1a</p> <pre><code>#{artistSelector.selectArtist()}\n</code></pre> <p>\u5bf9\u4e8e\u88ab\u8c03\u7528\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u6765\u8bf4\uff0c\u6211\u4eec\u540c\u6837\u53ef\u4ee5\u8c03\u7528\u5b83\u7684\u65b9\u6cd5\u3002\u4f8b\u5982\uff0c\u5982\u679cselectArtist()\u65b9\u6cd5\u8fd4\u56de\u7684\u662f\u4e00\u4e2aString\uff0c\u90a3\u4e48\u53ef\u4ee5\u8c03\u7528toUpperCase()\u5c06\u6574\u4e2a\u827a\u672f\u5bb6\u7684\u540d\u5b57\u6539\u4e3a\u5927\u5199\u5b57\u6bcd\u5f62\u5f0f\uff1a</p> <pre><code>#{artistSelector.selectArtist().toUpperCase()}\n</code></pre> <p>\u5982\u679cselectArtist()\u7684\u8fd4\u56de\u503c\u4e0d\u662fnull\u7684\u8bdd\uff0c\u8fd9\u6ca1\u6709\u4ec0\u4e48\u95ee\u9898\u3002\u4e3a\u4e86\u907f\u514d\u51fa\u73b0NullPointerException\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7c7b\u578b\u5b89\u5168\u7684\u8fd0\u7b97\u7b26\uff1a</p> <pre><code>#{artistSelector.selectArtist()?.toUpperCase()}\n</code></pre> <p>\u4e0e\u4e4b\u524d\u53ea\u662f\u4f7f\u7528\u70b9\u53f7\uff08.\uff09\u6765\u8bbf\u95eetoUpperCase()\u65b9\u6cd5\u4e0d\u540c\uff0c\u73b0\u5728\u6211\u4eec\u4f7f\u7528\u4e86\u201c?.\u201d\u8fd0\u7b97\u7b26\u3002\u8fd9\u4e2a\u8fd0\u7b97\u7b26\u80fd\u591f\u5728\u8bbf\u95ee\u5b83\u53f3\u8fb9\u7684\u5185\u5bb9\u4e4b\u524d\uff0c\u786e\u4fdd\u5b83\u6240\u5bf9\u5e94\u7684\u5143\u7d20\u4e0d\u662fnull\u3002\u6240\u4ee5\uff0c\u5982\u679cselectArtist()\u7684\u8fd4\u56de\u503c\u662fnull\u7684\u8bdd\uff0c\u90a3\u4e48SpEL\u5c06\u4e0d\u4f1a\u8c03\u7528toUpperCase()\u65b9\u6cd5\u3002\u8868\u8fbe\u5f0f\u7684\u8fd4\u56de\u503c\u4f1a\u662fnull\u3002</p>"},{"location":"2017-09-10-Spring%E6%A1%86%E6%9E%B6%E8%BF%90%E8%A1%8C%E6%97%B6%E5%80%BC%E6%B3%A8%E5%85%A5/#_3","title":"\u5728\u8868\u8fbe\u5f0f\u4e2d\u4f7f\u7528\u7c7b\u578b","text":"<p>\u5982\u679c\u8981\u5728SpEL\u4e2d\u8bbf\u95ee\u7c7b\u4f5c\u7528\u57df\u7684\u65b9\u6cd5\u548c\u5e38\u91cf\u7684\u8bdd\uff0c\u8981\u4f9d\u8d56T()\u8fd9\u4e2a\u5173\u952e\u7684\u8fd0\u7b97\u7b26\u3002\u4f8b\u5982\uff0c\u4e3a\u4e86\u5728SpEL\u4e2d\u8868\u8fbeJava\u7684Math\u7c7b\uff0c\u9700\u8981\u6309\u7167\u5982\u4e0b\u7684\u65b9\u5f0f\u4f7f\u7528T()\u8fd0\u7b97\u7b26\uff1a</p> <pre><code>T(java.lang.Math)\n</code></pre> <p>\u8fd9\u91cc\u6240\u793a\u7684T()\u8fd0\u7b97\u7b26\u7684\u7ed3\u679c\u4f1a\u662f\u4e00\u4e2aClass\u5bf9\u8c61\uff0c\u4ee3\u8868\u4e86<code>java.lang.Math</code>\u3002\u5982\u679c\u9700\u8981\u7684\u8bdd\uff0c\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u5c06\u5176\u88c5\u914d\u5230\u4e00\u4e2aClass\u7c7b\u578b\u7684bean\u5c5e\u6027\u4e2d\u3002\u4f46\u662fT()\u8fd0\u7b97\u7b26\u7684\u771f\u6b63\u4ef7\u503c\u5728\u4e8e\u5b83\u80fd\u591f\u8bbf\u95ee\u76ee\u6807\u7c7b\u578b\u7684\u9759\u6001\u65b9\u6cd5\u548c\u5e38\u91cf\u3002</p> <p>\u4f8b\u5982\uff0c\u5047\u5982\u4f60\u9700\u8981\u5c06PI\u503c\u88c5\u914d\u5230bean\u5c5e\u6027\u4e2d\u3002\u5982\u4e0b\u7684SpEL\u5c31\u80fd\u5b8c\u6210\u8be5\u4efb\u52a1\uff1a</p> <pre><code>T(java.lang.Math).PI\n</code></pre> <p>\u4e0e\u4e4b\u7c7b\u4f3c\uff0c\u6211\u4eec\u53ef\u4ee5\u8c03\u7528T()\u8fd0\u7b97\u7b26\u6240\u5f97\u5230\u7c7b\u578b\u7684\u9759\u6001\u65b9\u6cd5\u3002\u6211\u4eec\u5df2\u7ecf\u770b\u5230\u4e86\u901a\u8fc7T()\u8c03\u7528System.currentTimeMillis()\u3002\u5982\u4e0b\u7684\u8fd9\u4e2a\u6837\u4f8b\u4f1a\u8ba1\u7b97\u5f97\u5230\u4e00\u4e2a0\u52301\u4e4b\u95f4\u7684\u968f\u673a\u6570\uff1a</p> <pre><code>T(java.lang.Math).random()\n</code></pre>"},{"location":"2017-09-10-Spring%E6%A1%86%E6%9E%B6%E8%BF%90%E8%A1%8C%E6%97%B6%E5%80%BC%E6%B3%A8%E5%85%A5/#spel_1","title":"SpEL\u8fd0\u7b97\u7b26","text":"<p>SpEL\u63d0\u4f9b\u4e86\u591a\u4e2a\u8fd0\u7b97\u7b26\uff0c\u8fd9\u4e9b\u8fd0\u7b97\u7b26\u53ef\u4ee5\u7528\u5728SpEL\u8868\u8fbe\u5f0f\u7684\u503c\u4e0a\u3002\u88683.1\u6982\u8ff0\u4e86\u8fd9\u4e9b\u8fd0\u7b97\u7b26\u3002</p> <p>\u88683.1 \u7528\u6765\u64cd\u4f5c\u8868\u8fbe\u5f0f\u503c\u7684SpEL\u8fd0\u7b97\u7b26</p> \u8fd0\u7b97\u7b26\u7c7b\u578b \u8fd0\u7b97\u7b26 \u7b97\u672f\u8fd0\u7b97 +\u3001-\u3001 * \u3001/\u3001%\u3001^ \u6bd4\u8f83\u8fd0\u7b97 &lt; \u3001 &gt; \u3001 == \u3001 &lt;= \u3001 &gt;= \u3001 lt \u3001 gt \u3001 eq \u3001 le \u3001 ge \u903b\u8f91\u8fd0\u7b97 and \u3001 or \u3001 not \u3001\u2502 \u6761\u4ef6\u8fd0\u7b97 ?: (ternary) \u3001 ?: (Elvis) \u6b63\u5219\u8868\u8fbe\u5f0f matches <p>\u4f5c\u4e3a\u4f7f\u7528\u4e0a\u8ff0\u8fd0\u7b97\u7b26\u7684\u4e00\u4e2a\u7b80\u5355\u6837\u4f8b\uff0c\u6211\u4eec\u770b\u4e00\u4e0b\u4e0b\u9762\u8fd9\u4e2aSpEL\u8868\u8fbe\u5f0f\uff1a</p> <pre><code>#{2 * T(java.lang.Math).PI * circle.radius}\n</code></pre> <p>\u8fd9\u4e0d\u4ec5\u662f\u4f7f\u7528SpEL\u4e2d\u4e58\u6cd5\u8fd0\u7b97\u7b26\uff08*\uff09\u7684\u7edd\u4f73\u6837\u4f8b\uff0c\u5b83\u4e5f\u4e3a\u4f60\u5c55\u73b0\u4e86\u5982\u4f55\u5c06\u7b80\u5355\u7684\u8868\u8fbe\u5f0f\u7ec4\u5408\u4e3a\u66f4\u4e3a\u590d\u6742\u7684\u8868\u8fbe\u5f0f\u3002\u5728\u8fd9\u91ccPI\u7684\u503c\u4e58\u4ee52\uff0c\u7136\u540e\u518d\u4e58\u4ee5radius\u5c5e\u6027\u7684\u503c\uff0c\u8fd9\u4e2a\u5c5e\u6027\u6765\u6e90\u4e8eID\u4e3acircle\u7684bean\u3002\u5b9e\u9645\u4e0a\uff0c\u5b83\u8ba1\u7b97\u4e86circle bean\u4e2d\u6240\u5b9a\u4e49\u5706\u7684\u5468\u957f\u3002</p> <p>\u7c7b\u4f3c\u5730\uff0c\u4f60\u8fd8\u53ef\u4ee5\u5728\u8868\u8fbe\u5f0f\u4e2d\u4f7f\u7528\u4e58\u65b9\u8fd0\u7b97\u7b26\uff08^\uff09\u6765\u8ba1\u7b97\u5706\u7684\u9762\u79ef\uff1a</p> <pre><code>#{T(java.lang.Math).PI * circle.radius ^ 2}\n</code></pre> <p>\u201c^\u201d\u662f\u7528\u4e8e\u4e58\u65b9\u8ba1\u7b97\u7684\u8fd0\u7b97\u7b26\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u5b83\u6765\u8ba1\u7b97\u5706\u534a\u5f84\u7684\u5e73\u65b9\u3002</p> <p>\u5f53\u4f7f\u7528String\u7c7b\u578b\u7684\u503c\u65f6\uff0c\u201c+\u201d\u8fd0\u7b97\u7b26\u6267\u884c\u7684\u662f\u8fde\u63a5\u64cd\u4f5c\uff0c\u4e0e\u5728Java\u4e2d\u662f\u4e00\u6837\u7684\uff1a</p> <pre><code>#{disc.title + ' by ' + disc.artist}\n</code></pre> <p>SpEL\u540c\u65f6\u8fd8\u63d0\u4f9b\u4e86\u6bd4\u8f83\u8fd0\u7b97\u7b26\uff0c\u7528\u6765\u5728\u8868\u8fbe\u5f0f\u4e2d\u5bf9\u503c\u8fdb\u884c\u5bf9\u6bd4\u3002\u6ce8\u610f\u5728\u88683.1\u4e2d\uff0c\u6bd4\u8f83\u8fd0\u7b97\u7b26\u6709\u4e24\u79cd\u5f62\u5f0f\uff1a\u7b26\u53f7\u5f62\u5f0f\u548c\u6587\u672c\u5f62\u5f0f\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u7b26\u53f7\u8fd0\u7b97\u7b26\u4e0e\u5bf9\u5e94\u7684\u6587\u672c\u8fd0\u7b97\u7b26\u4f5c\u7528\u662f\u76f8\u540c\u7684\uff0c\u4f7f\u7528\u54ea\u4e00\u79cd\u5f62\u5f0f\u5747\u53ef\u4ee5\u3002</p> <p>\u4f8b\u5982\uff0c\u8981\u6bd4\u8f83\u4e24\u4e2a\u6570\u5b57\u662f\u4e0d\u662f\u76f8\u7b49\uff0c\u53ef\u4ee5\u4f7f\u7528\u53cc\u7b49\u53f7\u8fd0\u7b97\u7b26\uff08==\uff09\uff1a</p> <pre><code>#{counter.total == 100}\n</code></pre> <p>\u6216\u8005\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u6587\u672c\u578b\u7684eq\u8fd0\u7b97\u7b26\uff1a</p> <pre><code>#{counter.total eq 100}\n</code></pre> <p>\u4e24\u79cd\u65b9\u5f0f\u7684\u7ed3\u679c\u90fd\u662f\u4e00\u6837\u7684\u3002\u8868\u8fbe\u5f0f\u7684\u8ba1\u7b97\u7ed3\u679c\u662f\u4e2aBoolean\u503c\uff1a\u5982\u679ccounter.total\u7b49\u4e8e100\u7684\u8bdd\uff0c\u4e3atrue\uff0c\u5426\u5219\u4e3afalse\u3002</p> <p>SpEL\u8fd8\u63d0\u4f9b\u4e86\u4e09\u5143\u8fd0\u7b97\u7b26\uff08ternary\uff09\uff0c\u5b83\u4e0eJava\u4e2d\u7684\u4e09\u5143\u8fd0\u7b97\u7b26\u975e\u5e38\u7c7b\u4f3c\u3002\u4f8b\u5982\uff0c\u5982\u4e0b\u7684\u8868\u8fbe\u5f0f\u4f1a\u5224\u65ad\u5982\u679cscoreboard.score&gt;1000\u7684\u8bdd\uff0c\u8ba1\u7b97\u7ed3\u679c\u4e3aString\u7c7b\u578b\u7684\u201cWinner\uff01\u201d\uff0c\u5426\u5219\u7684\u8bdd\uff0c\u7ed3\u679c\u4e3aLoser\uff1a</p> <pre><code>#{scoreboard.score &gt; 1000 ? \"Winner!\" : \"Loser\"}\n</code></pre> <p>\u4e09\u5143\u8fd0\u7b97\u7b26\u7684\u4e00\u4e2a\u5e38\u89c1\u573a\u666f\u5c31\u662f\u68c0\u67e5null\u503c\uff0c\u5e76\u7528\u4e00\u4e2a\u9ed8\u8ba4\u503c\u6765\u66ff\u4ee3null\u3002\u4f8b\u5982\uff0c\u5982\u4e0b\u7684\u8868\u8fbe\u5f0f\u4f1a\u5224\u65addisc.title\u7684\u503c\u662f\u4e0d\u662fnull\uff0c\u5982\u679c\u662fnull\u7684\u8bdd\uff0c\u90a3\u4e48\u8868\u8fbe\u5f0f\u7684\u8ba1\u7b97\u7ed3\u679c\u5c31\u4f1a\u662f\u201cRattle and Hum\u201d\uff1a</p> <pre><code>#{disc.title ?: 'Rattle and Hum'}\n</code></pre> <p>\u8fd9\u79cd\u8868\u8fbe\u5f0f\u901a\u5e38\u79f0\u4e3aElvis\u8fd0\u7b97\u7b26\u3002\u8fd9\u4e2a\u5947\u602a\u540d\u79f0\u7684\u6765\u5386\u662f\uff0c\u5f53\u4f7f\u7528\u7b26\u53f7\u6765\u8868\u793a\u8868\u60c5\u65f6\uff0c\u95ee\u53f7\u770b\u8d77\u6765\u5f88\u50cf\u662f\u732b\u738b\uff08Elvis Presley\uff09\u7684\u5934\u53d1\u3002</p>"},{"location":"2017-09-10-Spring%E6%A1%86%E6%9E%B6%E8%BF%90%E8%A1%8C%E6%97%B6%E5%80%BC%E6%B3%A8%E5%85%A5/#_4","title":"\u8ba1\u7b97\u6b63\u5219\u8868\u8fbe\u5f0f","text":"<p>\u5f53\u5904\u7406\u6587\u672c\u65f6\uff0c\u6709\u65f6\u68c0\u67e5\u6587\u672c\u662f\u5426\u5339\u914d\u67d0\u79cd\u6a21\u5f0f\u662f\u975e\u5e38\u6709\u7528\u7684\u3002SpEL\u901a\u8fc7matches\u8fd0\u7b97\u7b26\u652f\u6301\u8868\u8fbe\u5f0f\u4e2d\u7684\u6a21\u5f0f\u5339\u914d\u3002matches\u8fd0\u7b97\u7b26\u5bf9String\u7c7b\u578b\u7684\u6587\u672c\uff08\u4f5c\u4e3a\u5de6\u8fb9\u53c2\u6570\uff09\u5e94\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\uff08\u4f5c\u4e3a\u53f3\u8fb9\u53c2\u6570\uff09\u3002matches\u7684\u8fd0\u7b97\u7ed3\u679c\u4f1a\u8fd4\u56de\u4e00\u4e2aBoolean\u7c7b\u578b\u7684\u503c\uff1a\u5982\u679c\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f\u76f8\u5339\u914d\uff0c\u5219\u8fd4\u56detrue\uff1b\u5426\u5219\u8fd4\u56defalse\u3002</p> <p>\u4e3a\u4e86\u8fdb\u4e00\u6b65\u89e3\u91camatches\u8fd0\u7b97\u7b26\uff0c\u5047\u8bbe\u6211\u4eec\u60f3\u5224\u65ad\u4e00\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u5305\u542b\u6709\u6548\u7684\u90ae\u4ef6\u5730\u5740\u3002\u5728\u8fd9\u4e2a\u573a\u666f\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528matches\u8fd0\u7b97\u7b26\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>#{admin.email matches '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\\\.com'}\n</code></pre> <p>\u63a2\u5bfb\u6b63\u5219\u8868\u8fbe\u5f0f\u8bed\u6cd5\u7684\u79d8\u5bc6\u8d85\u51fa\u4e86\u672c\u4e66\u7684\u8303\u56f4\uff0c\u540c\u65f6\u6211\u4eec\u4e5f\u5e94\u8be5\u610f\u8bc6\u5230\u8fd9\u91cc\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u8fd8\u4e0d\u8db3\u591f\u5065\u58ee\u6765\u6db5\u76d6\u6240\u6709\u7684\u573a\u666f\u3002\u4f46\u5bf9\u4e8e\u6f14\u793amatches\u8fd0\u7b97\u7b26\u7684\u7528\u6cd5\uff0c\u8fd9\u5df2\u7ecf\u8db3\u591f\u4e86\u3002</p> <p>\u8ba1\u7b97\u96c6\u5408 SpEL\u4e2d\u6700\u4ee4\u4eba\u60ca\u5947\u7684\u4e00\u4e9b\u6280\u5de7\u662f\u4e0e\u96c6\u5408\u548c\u6570\u7ec4\u76f8\u5173\u7684\u3002\u6700\u7b80\u5355\u7684\u4e8b\u60c5\u53ef\u80fd\u5c31\u662f\u5f15\u7528\u5217\u8868\u4e2d\u7684\u4e00\u4e2a\u5143\u7d20\u4e86\uff1a</p> <pre><code>#{jukebox.songs[4].title}\n</code></pre> <p>\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u4f1a\u8ba1\u7b97songs\u96c6\u5408\u4e2d\u7b2c\u4e94\u4e2a\uff08\u57fa\u4e8e\u96f6\u5f00\u59cb\uff09\u5143\u7d20\u7684title\u5c5e\u6027\uff0c\u8fd9\u4e2a\u96c6\u5408\u6765\u6e90\u4e8eID\u4e3ajukebox bean\u3002</p> <p>\u4e3a\u4e86\u8ba9\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u66f4\u4e30\u5bcc\u4e00\u4e9b\uff0c\u5047\u8bbe\u6211\u4eec\u8981\u4ecejukebox\u4e2d\u968f\u673a\u9009\u62e9\u4e00\u9996\u6b4c\uff1a</p> <pre><code>#{jukebox.songs[T(java.lang.Math).random() *\n                         jukebox.songs.size()].title}\n</code></pre> <p>\u201c[]\u201d\u8fd0\u7b97\u7b26\u7528\u6765\u4ece\u96c6\u5408\u6216\u6570\u7ec4\u4e2d\u6309\u7167\u7d22\u5f15\u83b7\u53d6\u5143\u7d20\uff0c\u5b9e\u9645\u4e0a\uff0c\u5b83\u8fd8\u53ef\u4ee5\u4eceString\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5b57\u7b26\u3002\u6bd4\u5982\uff1a</p> <pre><code>#{'This is a test'[3]}\n</code></pre> <p>\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u5f15\u7528\u4e86String\u4e2d\u7684\u7b2c\u56db\u4e2a\uff08\u57fa\u4e8e\u96f6\u5f00\u59cb\uff09\u5b57\u7b26\uff0c\u4e5f\u5c31\u662f\u201cs\u201d\u3002[2]</p> <p>SpEL\u8fd8\u63d0\u4f9b\u4e86\u67e5\u8be2\u8fd0\u7b97\u7b26\uff08.?[]\uff09\uff0c\u5b83\u4f1a\u7528\u6765\u5bf9\u96c6\u5408\u8fdb\u884c\u8fc7\u6ee4\uff0c\u5f97\u5230\u96c6\u5408\u7684\u4e00\u4e2a\u5b50\u96c6\u3002\u4f5c\u4e3a\u9610\u8ff0\u7684\u6837\u4f8b\uff0c\u5047\u8bbe\u4f60\u5e0c\u671b\u5f97\u5230jukebox\u4e2dartist\u5c5e\u6027\u4e3aAerosmith\u7684\u6240\u6709\u6b4c\u66f2\u3002\u5982\u4e0b\u7684\u8868\u8fbe\u5f0f\u5c31\u4f7f\u7528\u67e5\u8be2\u8fd0\u7b97\u7b26\u5f97\u5230\u4e86Aerosmith\u7684\u6240\u6709\u6b4c\u66f2\uff1a</p> <pre><code>#{jukebox.songs.?[artist eq 'Aerosmith']}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u9009\u62e9\u8fd0\u7b97\u7b26\u5728\u5b83\u7684\u65b9\u62ec\u53f7\u4e2d\u63a5\u53d7\u53e6\u4e00\u4e2a\u8868\u8fbe\u5f0f\u3002\u5f53SpEL\u8fed\u4ee3\u6b4c\u66f2\u5217\u8868\u7684\u65f6\u5019\uff0c\u4f1a\u5bf9\u6b4c\u66f2\u96c6\u5408\u4e2d\u7684\u6bcf\u4e00\u4e2a\u6761\u76ee\u8ba1\u7b97\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u3002\u5982\u679c\u8868\u8fbe\u5f0f\u7684\u8ba1\u7b97\u7ed3\u679c\u4e3atrue\u7684\u8bdd\uff0c\u90a3\u4e48\u6761\u76ee\u4f1a\u653e\u5230\u65b0\u7684\u96c6\u5408\u4e2d\u3002\u5426\u5219\u7684\u8bdd\uff0c\u5b83\u5c31\u4e0d\u4f1a\u653e\u5230\u65b0\u96c6\u5408\u4e2d\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u5185\u90e8\u7684\u8868\u8fbe\u5f0f\u4f1a\u68c0\u67e5\u6b4c\u66f2\u7684artist\u5c5e\u6027\u662f\u4e0d\u662f\u7b49\u4e8eAerosmith\u3002</p> <p>SpEL\u8fd8\u63d0\u4f9b\u4e86\u53e6\u5916\u4e24\u4e2a\u67e5\u8be2\u8fd0\u7b97\u7b26\uff1a<code>.^[]</code>\u548c<code>.$[]</code>\uff0c\u5b83\u4eec\u5206\u522b\u7528\u6765\u5728\u96c6\u5408\u4e2d\u67e5\u8be2\u7b2c\u4e00\u4e2a\u5339\u914d\u9879\u548c\u6700\u540e\u4e00\u4e2a\u5339\u914d\u9879\u3002\u4f8b\u5982\uff0c\u8003\u8651\u4e0b\u9762\u7684\u8868\u8fbe\u5f0f\uff0c\u5b83\u4f1a\u67e5\u627e\u5217\u8868\u4e2d\u7b2c\u4e00\u4e2aartist\u5c5e\u6027\u4e3aAerosmith\u7684\u6b4c\u66f2\uff1a</p> <pre><code>#{jukebox.songs.^[artist eq 'Aerosmith']}\n</code></pre> <p>\u6700\u540e\uff0cSpEL\u8fd8\u63d0\u4f9b\u4e86\u6295\u5f71\u8fd0\u7b97\u7b26\uff08.![]\uff09\uff0c\u5b83\u4f1a\u4ece\u96c6\u5408\u7684\u6bcf\u4e2a\u6210\u5458\u4e2d\u9009\u62e9\u7279\u5b9a\u7684\u5c5e\u6027\u653e\u5230\u53e6\u5916\u4e00\u4e2a\u96c6\u5408\u4e2d\u3002\u4f5c\u4e3a\u6837\u4f8b\uff0c\u5047\u8bbe\u6211\u4eec\u4e0d\u60f3\u8981\u6b4c\u66f2\u5bf9\u8c61\u7684\u96c6\u5408\uff0c\u800c\u662f\u6240\u6709\u6b4c\u66f2\u540d\u79f0\u7684\u96c6\u5408\u3002\u5982\u4e0b\u7684\u8868\u8fbe\u5f0f\u4f1a\u5c06title\u5c5e\u6027\u6295\u5f71\u5230\u4e00\u4e2a\u65b0\u7684String\u7c7b\u578b\u7684\u96c6\u5408\u4e2d\uff1a</p> <pre><code>#{jukebox.songs.![title]}\n</code></pre> <p>\u5b9e\u9645\u4e0a\uff0c\u6295\u5f71\u64cd\u4f5c\u53ef\u4ee5\u4e0e\u5176\u4ed6\u4efb\u610f\u7684SpEL\u8fd0\u7b97\u7b26\u4e00\u8d77\u4f7f\u7528\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u7684\u8868\u8fbe\u5f0f\u83b7\u5f97Aerosmith\u6240\u6709\u6b4c\u66f2\u7684\u540d\u79f0\u5217\u8868\uff1a</p> <pre><code>#{jukebox.songs.?[artist eq 'Aerosmith'].![title]}\n</code></pre> <p>\u6211\u4eec\u6240\u4ecb\u7ecd\u7684\u53ea\u662fSpEL\u529f\u80fd\u7684\u4e00\u4e2a\u76ae\u6bdb\u3002\u5728\u672c\u4e66\u4e2d\u8fd8\u6709\u66f4\u591a\u7684\u673a\u4f1a\u7ee7\u7eed\u4ecb\u7ecdSpEL\uff0c\u5c24\u5176\u662f\u5728\u5b9a\u4e49\u5b89\u5168\u89c4\u5219\u7684\u65f6\u5019\u3002</p> <p>\u73b0\u5728\u5bf9SpEL\u7684\u4ecb\u7ecd\u8981\u544a\u4e00\u6bb5\u843d\u4e86\uff0c\u4e0d\u8fc7\u5728\u6b64\u4e4b\u524d\uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u63d0\u793a\u3002\u5728\u52a8\u6001\u6ce8\u5165\u503c\u5230Spring bean\u65f6\uff0cSpEL\u662f\u4e00\u79cd\u5f88\u4fbf\u5229\u548c\u5f3a\u5927\u7684\u65b9\u5f0f\u3002\u6211\u4eec\u6709\u65f6\u4f1a\u5fcd\u4e0d\u4f4f\u7f16\u5199\u5f88\u590d\u6742\u7684\u8868\u8fbe\u5f0f\u3002\u4f46\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e0d\u8981\u8ba9\u4f60\u7684\u8868\u8fbe\u5f0f\u592a\u667a\u80fd\u3002\u4f60\u7684\u8868\u8fbe\u5f0f\u8d8a\u667a\u80fd\uff0c\u5bf9\u5b83\u7684\u6d4b\u8bd5\u5c31\u8d8a\u91cd\u8981\u3002SpEL\u6bd5\u7adf\u53ea\u662fString\u7c7b\u578b\u7684\u503c\uff0c\u53ef\u80fd\u6d4b\u8bd5\u8d77\u6765\u5f88\u56f0\u96be\u3002\u9274\u4e8e\u8fd9\u4e00\u70b9\uff0c\u6211\u5efa\u8bae\u5c3d\u53ef\u80fd\u8ba9\u8868\u8fbe\u5f0f\u4fdd\u6301\u7b80\u6d01\uff0c\u8fd9\u6837\u6d4b\u8bd5\u4e0d\u4f1a\u662f\u4ec0\u4e48\u5927\u95ee\u9898\u3002</p>"},{"location":"2017-09-14-%E4%BD%BF%E7%94%A8Tomcat%20JDBC%20Pool%E6%8B%A6%E6%88%AA%E5%99%A8%E6%89%93%E5%8D%B0%E5%B8%A6%E5%8F%82%E6%95%B0%E7%9A%84SQL%E8%AF%AD%E5%8F%A5/","title":"2017 09 14 \u4f7f\u7528Tomcat JDBC Pool\u62e6\u622a\u5668\u6253\u5370\u5e26\u53c2\u6570\u7684SQL\u8bed\u53e5","text":""},{"location":"2017-09-14-%E4%BD%BF%E7%94%A8Tomcat%20JDBC%20Pool%E6%8B%A6%E6%88%AA%E5%99%A8%E6%89%93%E5%8D%B0%E5%B8%A6%E5%8F%82%E6%95%B0%E7%9A%84SQL%E8%AF%AD%E5%8F%A5/#1","title":"1 \u601d\u8def","text":"<p>\u81ea\u5b9a\u4e49\u4e00\u4e2a\u62e6\u622a\u5668\uff0c\u7ee7\u627f<code>org.apache.tomcat.jdbc.pool.interceptor.StatementCache</code>\uff0c\u91cd\u5199\u5176\u8bed\u53e5\u7f13\u5b58\u65b9\u6cd5<code>cacheStatement</code>\uff0c\u5728\u6b64\u8fc7\u7a0b\u4e2d\u6253\u5370\u5e26\u53c2\u6570\u7684SQL\u8bed\u53e5</p>"},{"location":"2017-09-14-%E4%BD%BF%E7%94%A8Tomcat%20JDBC%20Pool%E6%8B%A6%E6%88%AA%E5%99%A8%E6%89%93%E5%8D%B0%E5%B8%A6%E5%8F%82%E6%95%B0%E7%9A%84SQL%E8%AF%AD%E5%8F%A5/#2","title":"2 \u5b9e\u8df5","text":"<p>\u65b0\u5efa\u4e00\u4e2a\u62e6\u622a\u5668\uff0c\u7ee7\u627f<code>org.apache.tomcat.jdbc.pool.interceptor.StatementCache</code>\uff0c\u5982\u4e0b\uff1a</p> <pre><code>@Slf4j\npublic class MyJdbcInterceptor extends StatementCache {\n\n/**\n     * \u91cd\u5199cacheStatement\u65b9\u6cd5\uff0c\u6253\u5370statementProxy\n     */\n@Override\npublic boolean cacheStatement(CachedStatement proxy) {\nlog.info(proxy.getDelegate().toString()); //\u6ce8\u610f\u70b91\nreturn super.cacheStatement(proxy);\n}\n}\n</code></pre> <ul> <li>\u6ce8\u610f\u70b91 - proxy.getDelegate().toString()\u5373\u53ef\u6253\u5370\u5e26\u53c2\u6570\u7684SQL</li> </ul> <p>\u5728\u9879\u76ee\u8bbe\u7f6e\u4e2d\u8bbe\u7f6e\u76d1\u542c\u5668\uff0c\u5728<code>application.properties</code>\u6587\u4ef6\u4e2d\u6dfb\u52a0\uff1a</p> <pre><code>spring.datasource.tomcat.jdbc-interceptors=org.cdjavaer.learning.mybatis.interceptor.MyJdbcInterceptor\n</code></pre>"},{"location":"2017-09-14-%E4%BD%BF%E7%94%A8Tomcat%20JDBC%20Pool%E6%8B%A6%E6%88%AA%E5%99%A8%E6%89%93%E5%8D%B0%E5%B8%A6%E5%8F%82%E6%95%B0%E7%9A%84SQL%E8%AF%AD%E5%8F%A5/#3","title":"3 \u53c2\u8003","text":"<ul> <li>http://wiki.jikexueyuan.com/project/tomcat/tomcat-jdbc-pool.html</li> <li>https://stackoverflow.com/questions/15527791/tomcat-connection-pooling-with-prepared-statement-cache</li> <li>http://tomcat.apache.org/tomcat-8.5-doc/jdbc-pool.html#org.apache.tomcat.jdbc.pool.interceptor.StatementCache</li> </ul>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/","title":"2017 10 02 Spring\u6846\u67b6\uff1a\u4ec0\u4e48\u662f\u9762\u5411\u5207\u9762\u7f16\u7a0b","text":"<p>\u5207\u9762\u80fd\u5e2e\u52a9\u6211\u4eec\u6a21\u5757\u5316\u6a2a\u5207\u5173\u6ce8\u70b9\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u6a2a\u5207\u5173\u6ce8\u70b9\u53ef\u4ee5\u88ab\u63cf\u8ff0\u4e3a\u5f71\u54cd\u5e94\u7528\u591a\u5904\u7684\u529f\u80fd\u3002\u4f8b\u5982\uff0c\u5b89\u5168\u5c31\u662f\u4e00\u4e2a\u6a2a\u5207\u5173\u6ce8\u70b9\uff0c\u5e94\u7528\u4e2d\u7684\u8bb8\u591a\u65b9\u6cd5\u90fd\u4f1a\u6d89\u53ca\u5230\u5b89\u5168\u89c4\u5219\u3002\u56fe4.1\u76f4\u89c2\u5448\u73b0\u4e86\u6a2a\u5207\u5173\u6ce8\u70b9\u7684\u6982\u5ff5\u3002</p> <p></p> <p>\u56fe4.1\u3000\u5207\u9762\u5b9e\u73b0\u4e86\u6a2a\u5207\u5173\u6ce8\u70b9\uff08\u8de8\u591a\u4e2a\u5e94\u7528\u5bf9\u8c61\u7684\u903b\u8f91\uff09\u7684\u6a21\u5757\u5316</p> <p>\u56fe4.1\u5c55\u73b0\u4e86\u4e00\u4e2a\u88ab\u5212\u5206\u4e3a\u6a21\u5757\u7684\u5178\u578b\u5e94\u7528\u3002\u6bcf\u4e2a\u6a21\u5757\u7684\u6838\u5fc3\u529f\u80fd\u90fd\u662f\u4e3a\u7279\u5b9a\u4e1a\u52a1\u9886\u57df\u63d0\u4f9b\u670d\u52a1\uff0c\u4f46\u662f\u8fd9\u4e9b\u6a21\u5757\u90fd\u9700\u8981\u7c7b\u4f3c\u7684\u8f85\u52a9\u529f\u80fd\uff0c\u4f8b\u5982\u5b89\u5168\u548c\u4e8b\u52a1\u7ba1\u7406\u3002</p> <p>\u5982\u679c\u8981\u91cd\u7528\u901a\u7528\u529f\u80fd\u7684\u8bdd\uff0c\u6700\u5e38\u89c1\u7684\u9762\u5411\u5bf9\u8c61\u6280\u672f\u662f\u7ee7\u627f\uff08inheritance\uff09\u6216\u59d4\u6258\uff08delegation\uff09\u3002\u4f46\u662f\uff0c\u5982\u679c\u5728\u6574\u4e2a\u5e94\u7528\u4e2d\u90fd\u4f7f\u7528\u76f8\u540c\u7684\u57fa\u7c7b\uff0c\u7ee7\u627f\u5f80\u5f80\u4f1a\u5bfc\u81f4\u4e00\u4e2a\u8106\u5f31\u7684\u5bf9\u8c61\u4f53\u7cfb\uff1b\u800c\u4f7f\u7528\u59d4\u6258\u53ef\u80fd\u9700\u8981\u5bf9\u59d4\u6258\u5bf9\u8c61\u8fdb\u884c\u590d\u6742\u7684\u8c03\u7528\u3002</p> <p>\u5207\u9762\u63d0\u4f9b\u4e86\u53d6\u4ee3\u7ee7\u627f\u548c\u59d4\u6258\u7684\u53e6\u4e00\u79cd\u53ef\u9009\u65b9\u6848\uff0c\u800c\u4e14\u5728\u5f88\u591a\u573a\u666f\u4e0b\u66f4\u6e05\u6670\u7b80\u6d01\u3002\u5728\u4f7f\u7528\u9762\u5411\u5207\u9762\u7f16\u7a0b\u65f6\uff0c\u6211\u4eec\u4ecd\u7136\u5728\u4e00\u4e2a\u5730\u65b9\u5b9a\u4e49\u901a\u7528\u529f\u80fd\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7\u58f0\u660e\u7684\u65b9\u5f0f\u5b9a\u4e49\u8fd9\u4e2a\u529f\u80fd\u8981\u4ee5\u4f55\u79cd\u65b9\u5f0f\u5728\u4f55\u5904\u5e94\u7528\uff0c\u800c\u65e0\u9700\u4fee\u6539\u53d7\u5f71\u54cd\u7684\u7c7b\u3002\u6a2a\u5207\u5173\u6ce8\u70b9\u53ef\u4ee5\u88ab\u6a21\u5757\u5316\u4e3a\u7279\u6b8a\u7684\u7c7b\uff0c\u8fd9\u4e9b\u7c7b\u88ab\u79f0\u4e3a\u5207\u9762\uff08aspect\uff09\u3002\u8fd9\u6837\u505a\u6709\u4e24\u4e2a\u597d\u5904\uff1a</p> <ol> <li>\u9996\u5148\uff0c\u73b0\u5728\u6bcf\u4e2a\u5173\u6ce8\u70b9\u90fd\u96c6\u4e2d\u4e8e\u4e00\u4e2a\u5730\u65b9\uff0c\u800c\u4e0d\u662f\u5206\u6563\u5230\u591a\u5904\u4ee3\u7801\u4e2d\uff1b</li> <li>\u5176\u6b21\uff0c\u670d\u52a1\u6a21\u5757\u66f4\u7b80\u6d01\uff0c\u56e0\u4e3a\u5b83\u4eec\u53ea\u5305\u542b\u4e3b\u8981\u5173\u6ce8\u70b9\uff08\u6216\u6838\u5fc3\u529f\u80fd\uff09\u7684\u4ee3\u7801\uff0c\u800c\u6b21\u8981\u5173\u6ce8\u70b9\u7684\u4ee3\u7801\u88ab\u8f6c\u79fb\u5230\u5207\u9762\u4e2d\u4e86\u3002</li> </ol>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#aop","title":"\u5b9a\u4e49AOP\u672f\u8bed","text":"<p>\u4e0e\u5927\u591a\u6570\u6280\u672f\u4e00\u6837\uff0cAOP\u5df2\u7ecf\u5f62\u6210\u4e86\u81ea\u5df1\u7684\u672f\u8bed\u3002\u63cf\u8ff0\u5207\u9762\u7684\u5e38\u7528\u672f\u8bed\u6709\u901a\u77e5\uff08advice\uff09\u3001\u5207\u70b9\uff08pointcut\uff09\u548c\u8fde\u63a5\u70b9\uff08join point\uff09\u3002\u56fe4.2\u5c55\u793a\u4e86\u8fd9\u4e9b\u6982\u5ff5\u662f\u5982\u4f55\u5173\u8054\u5728\u4e00\u8d77\u7684\u3002</p> <p></p> <p>\u56fe4.2\u3000\u5728\u4e00\u4e2a\u6216\u591a\u4e2a\u8fde\u63a5\u70b9\u4e0a\uff0c\u53ef\u4ee5\u628a\u5207\u9762\u7684\u529f\u80fd\uff08\u901a\u77e5\uff09\u7ec7\u5165\u5230\u7a0b\u5e8f\u7684\u6267\u884c\u8fc7\u7a0b\u4e2d</p> <p>\u9057\u61be\u7684\u662f\uff0c\u5927\u591a\u6570\u7528\u4e8e\u63cf\u8ff0AOP\u529f\u80fd\u7684\u672f\u8bed\u5e76\u4e0d\u76f4\u89c2\uff0c\u5c3d\u7ba1\u5982\u6b64\uff0c\u5b83\u4eec\u73b0\u5728\u5df2\u7ecf\u662fAOP\u884c\u8bdd\u7684\u7ec4\u6210\u90e8\u5206\u4e86\uff0c\u4e3a\u4e86\u7406\u89e3AOP\uff0c\u6211\u4eec\u5fc5\u987b\u4e86\u89e3\u8fd9\u4e9b\u672f\u8bed\u3002\u5728\u6211\u4eec\u8fdb\u5165\u67d0\u4e2a\u9886\u57df\u4e4b\u524d\uff0c\u5fc5\u987b\u5b66\u4f1a\u5728\u8fd9\u4e2a\u9886\u57df\u8be5\u5982\u4f55\u8bf4\u8bdd\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#advice","title":"\u901a\u77e5\uff08Advice\uff09","text":"<p>\u5f53\u6284\u8868\u5458\u51fa\u73b0\u5728\u6211\u4eec\u5bb6\u95e8\u53e3\u65f6\uff0c\u4ed6\u4eec\u8981\u767b\u8bb0\u7528\u7535\u91cf\u5e76\u56de\u53bb\u5411\u7535\u529b\u516c\u53f8\u62a5\u544a\u3002\u663e\u7136\uff0c\u4ed6\u4eec\u5fc5\u987b\u6709\u4e00\u4efd\u9700\u8981\u6284\u8868\u7684\u4f4f\u6237\u6e05\u5355\uff0c\u4ed6\u4eec\u6240\u6c47\u62a5\u7684\u4fe1\u606f\u4e5f\u5f88\u91cd\u8981\uff0c\u4f46\u8bb0\u5f55\u7528\u7535\u91cf\u624d\u662f\u6284\u8868\u5458\u7684\u4e3b\u8981\u5de5\u4f5c\u3002</p> <p>\u7c7b\u4f3c\u5730\uff0c\u5207\u9762\u4e5f\u6709\u76ee\u6807\u2014\u2014\u5b83\u5fc5\u987b\u8981\u5b8c\u6210\u7684\u5de5\u4f5c\u3002\u5728AOP\u672f\u8bed\u4e2d\uff0c\u5207\u9762\u7684\u5de5\u4f5c\u88ab\u79f0\u4e3a\u901a\u77e5\u3002</p> <p>\u901a\u77e5\u5b9a\u4e49\u4e86\u5207\u9762\u662f\u4ec0\u4e48\u4ee5\u53ca\u4f55\u65f6\u4f7f\u7528\u3002\u9664\u4e86\u63cf\u8ff0\u5207\u9762\u8981\u5b8c\u6210\u7684\u5de5\u4f5c\uff0c\u901a\u77e5\u8fd8\u89e3\u51b3\u4e86\u4f55\u65f6\u6267\u884c\u8fd9\u4e2a\u5de5\u4f5c\u7684\u95ee\u9898\u3002\u5b83\u5e94\u8be5\u5e94\u7528\u5728\u67d0\u4e2a\u65b9\u6cd5\u88ab\u8c03\u7528\u4e4b\u524d\uff1f\u4e4b\u540e\uff1f\u4e4b\u524d\u548c\u4e4b\u540e\u90fd\u8c03\u7528\uff1f\u8fd8\u662f\u53ea\u5728\u65b9\u6cd5\u629b\u51fa\u5f02\u5e38\u65f6\u8c03\u7528\uff1f</p> <p>Spring\u5207\u9762\u53ef\u4ee5\u5e94\u75285\u79cd\u7c7b\u578b\u7684\u901a\u77e5\uff1a</p> <ul> <li>\u524d\u7f6e\u901a\u77e5\uff08Before\uff09\uff1a\u5728\u76ee\u6807\u65b9\u6cd5\u88ab\u8c03\u7528\u4e4b\u524d\u8c03\u7528\u901a\u77e5\u529f\u80fd\uff1b</li> <li>\u540e\u7f6e\u901a\u77e5\uff08After\uff09\uff1a\u5728\u76ee\u6807\u65b9\u6cd5\u5b8c\u6210\u4e4b\u540e\u8c03\u7528\u901a\u77e5\uff0c\u6b64\u65f6\u4e0d\u4f1a\u5173\u5fc3\u65b9\u6cd5\u7684\u8f93\u51fa\u662f\u4ec0\u4e48\uff1b</li> <li>\u8fd4\u56de\u901a\u77e5\uff08After-returning\uff09\uff1a\u5728\u76ee\u6807\u65b9\u6cd5\u6210\u529f\u6267\u884c\u4e4b\u540e\u8c03\u7528\u901a\u77e5\uff1b</li> <li>\u5f02\u5e38\u901a\u77e5\uff08After-throwing\uff09\uff1a\u5728\u76ee\u6807\u65b9\u6cd5\u629b\u51fa\u5f02\u5e38\u540e\u8c03\u7528\u901a\u77e5\uff1b</li> <li>\u73af\u7ed5\u901a\u77e5\uff08Around\uff09\uff1a\u901a\u77e5\u5305\u88f9\u4e86\u88ab\u901a\u77e5\u7684\u65b9\u6cd5\uff0c\u5728\u88ab\u901a\u77e5\u7684\u65b9\u6cd5\u8c03\u7528\u4e4b\u524d\u548c\u8c03\u7528\u4e4b\u540e\u6267\u884c\u81ea\u5b9a\u4e49\u7684\u884c\u4e3a\u3002</li> </ul>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#join-point","title":"\u8fde\u63a5\u70b9\uff08Join point\uff09","text":"<p>\u7535\u529b\u516c\u53f8\u4e3a\u591a\u4e2a\u4f4f\u6237\u63d0\u4f9b\u670d\u52a1\uff0c\u751a\u81f3\u53ef\u80fd\u662f\u6574\u4e2a\u57ce\u5e02\u3002\u6bcf\u5bb6\u90fd\u6709\u4e00\u4e2a\u7535\u8868\uff0c\u8fd9\u4e9b\u7535\u8868\u4e0a\u7684\u6570\u5b57\u90fd\u9700\u8981\u8bfb\u53d6\uff0c\u56e0\u6b64\u6bcf\u5bb6\u90fd\u662f\u6284\u8868\u5458\u7684\u6f5c\u5728\u76ee\u6807\u3002\u6284\u8868\u5458\u4e5f\u8bb8\u80fd\u591f\u8bfb\u53d6\u5404\u79cd\u7c7b\u578b\u7684\u8bbe\u5907\uff0c\u4f46\u662f\u4e3a\u4e86\u5b8c\u6210\u4ed6\u7684\u5de5\u4f5c\uff0c\u4ed6\u7684\u76ee\u6807\u5e94\u8be5\u623f\u5c4b\u5185\u6240\u5b89\u88c5\u7684\u7535\u8868\u3002</p> <p>\u540c\u6837\uff0c\u6211\u4eec\u7684\u5e94\u7528\u53ef\u80fd\u4e5f\u6709\u6570\u4ee5\u5343\u8ba1\u7684\u65f6\u673a\u5e94\u7528\u901a\u77e5\u3002\u8fd9\u4e9b\u65f6\u673a\u88ab\u79f0\u4e3a\u8fde\u63a5\u70b9\u3002\u8fde\u63a5\u70b9\u662f\u5728\u5e94\u7528\u6267\u884c\u8fc7\u7a0b\u4e2d\u80fd\u591f\u63d2\u5165\u5207\u9762\u7684\u4e00\u4e2a\u70b9\u3002\u8fd9\u4e2a\u70b9\u53ef\u4ee5\u662f\u8c03\u7528\u65b9\u6cd5\u65f6\u3001\u629b\u51fa\u5f02\u5e38\u65f6\u3001\u751a\u81f3\u4fee\u6539\u4e00\u4e2a\u5b57\u6bb5\u65f6\u3002\u5207\u9762\u4ee3\u7801\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u70b9\u63d2\u5165\u5230\u5e94\u7528\u7684\u6b63\u5e38\u6d41\u7a0b\u4e4b\u4e2d\uff0c\u5e76\u6dfb\u52a0\u65b0\u7684\u884c\u4e3a\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#poincut","title":"\u5207\u70b9\uff08Poincut\uff09","text":"<p>\u5982\u679c\u8ba9\u4e00\u4f4d\u6284\u8868\u5458\u8bbf\u95ee\u7535\u529b\u516c\u53f8\u6240\u670d\u52a1\u7684\u6240\u6709\u4f4f\u6237\uff0c\u90a3\u80af\u5b9a\u662f\u4e0d\u73b0\u5b9e\u7684\u3002\u5b9e\u9645\u4e0a\uff0c\u7535\u529b\u516c\u53f8\u4e3a\u6bcf\u4e00\u4e2a\u6284\u8868\u5458\u90fd\u5206\u522b\u6307\u5b9a\u67d0\u4e00\u5757\u533a\u57df\u7684\u4f4f\u6237\u3002\u7c7b\u4f3c\u5730\uff0c\u4e00\u4e2a\u5207\u9762\u5e76\u4e0d\u9700\u8981\u901a\u77e5\u5e94\u7528\u7684\u6240\u6709\u8fde\u63a5\u70b9\u3002\u5207\u70b9\u6709\u52a9\u4e8e\u7f29\u5c0f\u5207\u9762\u6240\u901a\u77e5\u7684\u8fde\u63a5\u70b9\u7684\u8303\u56f4\u3002</p> <p>\u5982\u679c\u8bf4\u901a\u77e5\u5b9a\u4e49\u4e86\u5207\u9762\u7684\u201c\u4ec0\u4e48\u201d\u548c\u201c\u4f55\u65f6\u201d\u7684\u8bdd\uff0c\u90a3\u4e48\u5207\u70b9\u5c31\u5b9a\u4e49\u4e86\u201c\u4f55\u5904\u201d\u3002\u5207\u70b9\u7684\u5b9a\u4e49\u4f1a\u5339\u914d\u901a\u77e5\u6240\u8981\u7ec7\u5165\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u8fde\u63a5\u70b9\u3002\u6211\u4eec\u901a\u5e38\u4f7f\u7528\u660e\u786e\u7684\u7c7b\u548c\u65b9\u6cd5\u540d\u79f0\uff0c\u6216\u662f\u5229\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u5b9a\u4e49\u6240\u5339\u914d\u7684\u7c7b\u548c\u65b9\u6cd5\u540d\u79f0\u6765\u6307\u5b9a\u8fd9\u4e9b\u5207\u70b9\u3002\u6709\u4e9bAOP\u6846\u67b6\u5141\u8bb8\u6211\u4eec\u521b\u5efa\u52a8\u6001\u7684\u5207\u70b9\uff0c\u53ef\u4ee5\u6839\u636e\u8fd0\u884c\u65f6\u7684\u51b3\u7b56\uff08\u6bd4\u5982\u65b9\u6cd5\u7684\u53c2\u6570\u503c\uff09\u6765\u51b3\u5b9a\u662f\u5426\u5e94\u7528\u901a\u77e5\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#aspect","title":"\u5207\u9762\uff08Aspect\uff09","text":"<p>\u5f53\u6284\u8868\u5458\u5f00\u59cb\u4e00\u5929\u7684\u5de5\u4f5c\u65f6\uff0c\u4ed6\u77e5\u9053\u81ea\u5df1\u8981\u505a\u7684\u4e8b\u60c5\uff08\u62a5\u544a\u7528\u7535\u91cf\uff09\u548c\u4ece\u54ea\u4e9b\u623f\u5c4b\u6536\u96c6\u4fe1\u606f\u3002\u56e0\u6b64\uff0c\u4ed6\u77e5\u9053\u8981\u5b8c\u6210\u5de5\u4f5c\u6240\u9700\u8981\u7684\u4e00\u5207\u4e1c\u897f\u3002</p> <p>\u5207\u9762\u662f\u901a\u77e5\u548c\u5207\u70b9\u7684\u7ed3\u5408\u3002\u901a\u77e5\u548c\u5207\u70b9\u5171\u540c\u5b9a\u4e49\u4e86\u5207\u9762\u7684\u5168\u90e8\u5185\u5bb9\u2014\u2014\u5b83\u662f\u4ec0\u4e48\uff0c\u5728\u4f55\u65f6\u548c\u4f55\u5904\u5b8c\u6210\u5176\u529f\u80fd\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#introduction","title":"\u5f15\u5165\uff08Introduction\uff09","text":"<p>\u5f15\u5165\u5141\u8bb8\u6211\u4eec\u5411\u73b0\u6709\u7684\u7c7b\u6dfb\u52a0\u65b0\u65b9\u6cd5\u6216\u5c5e\u6027\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2aAuditable\u901a\u77e5\u7c7b\uff0c\u8be5\u7c7b\u8bb0\u5f55\u4e86\u5bf9\u8c61\u6700\u540e\u4e00\u6b21\u4fee\u6539\u65f6\u7684\u72b6\u6001\u3002\u8fd9\u5f88\u7b80\u5355\uff0c\u53ea\u9700\u4e00\u4e2a\u65b9\u6cd5\uff0csetLastModified(Date)\uff0c\u548c\u4e00\u4e2a\u5b9e\u4f8b\u53d8\u91cf\u6765\u4fdd\u5b58\u8fd9\u4e2a\u72b6\u6001\u3002\u7136\u540e\uff0c\u8fd9\u4e2a\u65b0\u65b9\u6cd5\u548c\u5b9e\u4f8b\u53d8\u91cf\u5c31\u53ef\u4ee5\u88ab\u5f15\u5165\u5230\u73b0\u6709\u7684\u7c7b\u4e2d\uff0c\u4ece\u800c\u53ef\u4ee5\u5728\u65e0\u9700\u4fee\u6539\u8fd9\u4e9b\u73b0\u6709\u7684\u7c7b\u7684\u60c5\u51b5\u4e0b\uff0c\u8ba9\u5b83\u4eec\u5177\u6709\u65b0\u7684\u884c\u4e3a\u548c\u72b6\u6001\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#weaving","title":"\u7ec7\u5165\uff08Weaving\uff09","text":"<p>\u7ec7\u5165\u662f\u628a\u5207\u9762\u5e94\u7528\u5230\u76ee\u6807\u5bf9\u8c61\u5e76\u521b\u5efa\u65b0\u7684\u4ee3\u7406\u5bf9\u8c61\u7684\u8fc7\u7a0b\u3002\u5207\u9762\u5728\u6307\u5b9a\u7684\u8fde\u63a5\u70b9\u88ab\u7ec7\u5165\u5230\u76ee\u6807\u5bf9\u8c61\u4e2d\u3002\u5728\u76ee\u6807\u5bf9\u8c61\u7684\u751f\u547d\u5468\u671f\u91cc\u6709\u591a\u4e2a\u70b9\u53ef\u4ee5\u8fdb\u884c\u7ec7\u5165\uff1a</p> <ul> <li>\u7f16\u8bd1\u671f\uff1a\u5207\u9762\u5728\u76ee\u6807\u7c7b\u7f16\u8bd1\u65f6\u88ab\u7ec7\u5165\u3002\u8fd9\u79cd\u65b9\u5f0f\u9700\u8981\u7279\u6b8a\u7684\u7f16\u8bd1\u5668\u3002AspectJ\u7684\u7ec7\u5165\u7f16\u8bd1\u5668\u5c31\u662f\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u7ec7\u5165\u5207\u9762\u7684\u3002</li> <li>\u7c7b\u52a0\u8f7d\u671f\uff1a\u5207\u9762\u5728\u76ee\u6807\u7c7b\u52a0\u8f7d\u5230JVM\u65f6\u88ab\u7ec7\u5165\u3002\u8fd9\u79cd\u65b9\u5f0f\u9700\u8981\u7279\u6b8a\u7684\u7c7b\u52a0\u8f7d\u5668\uff08ClassLoader\uff09\uff0c\u5b83\u53ef\u4ee5\u5728\u76ee\u6807\u7c7b\u88ab\u5f15\u5165\u5e94\u7528\u4e4b\u524d\u589e\u5f3a\u8be5\u76ee\u6807\u7c7b\u7684\u5b57\u8282\u7801\u3002AspectJ 5\u7684\u52a0\u8f7d\u65f6\u7ec7\u5165\uff08load-time weaving\uff0cLTW\uff09\u5c31\u652f\u6301\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u7ec7\u5165\u5207\u9762\u3002</li> <li>\u8fd0\u884c\u671f\uff1a\u5207\u9762\u5728\u5e94\u7528\u8fd0\u884c\u7684\u67d0\u4e2a\u65f6\u523b\u88ab\u7ec7\u5165\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u5728\u7ec7\u5165\u5207\u9762\u65f6\uff0cAOP\u5bb9\u5668\u4f1a\u4e3a\u76ee\u6807\u5bf9\u8c61\u52a8\u6001\u5730\u521b\u5efa\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\u3002Spring AOP\u5c31\u662f\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u7ec7\u5165\u5207\u9762\u7684\u3002</li> </ul> <p>\u8981\u638c\u63e1\u7684\u65b0\u672f\u8bed\u53ef\u771f\u4e0d\u5c11\u554a\u3002\u518d\u770b\u4e00\u4e0b\u56fe4.1\uff0c\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86\u5982\u4e0b\u7684\u77e5\u8bc6\uff0c\u901a\u77e5\u5305\u542b\u4e86\u9700\u8981\u7528\u4e8e\u591a\u4e2a\u5e94\u7528\u5bf9\u8c61\u7684\u6a2a\u5207\u884c\u4e3a\uff1b\u8fde\u63a5\u70b9\u662f\u7a0b\u5e8f\u6267\u884c\u8fc7\u7a0b\u4e2d\u80fd\u591f\u5e94\u7528\u901a\u77e5\u7684\u6240\u6709\u70b9\uff1b\u5207\u70b9\u5b9a\u4e49\u4e86\u901a\u77e5\u88ab\u5e94\u7528\u7684\u5177\u4f53\u4f4d\u7f6e\uff08\u5728\u54ea\u4e9b\u8fde\u63a5\u70b9\uff09\u3002\u5176\u4e2d\u5173\u952e\u7684\u6982\u5ff5\u662f\u5207\u70b9\u5b9a\u4e49\u4e86\u54ea\u4e9b\u8fde\u63a5\u70b9\u4f1a\u5f97\u5230\u901a\u77e5\u3002</p> <p>\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86\u4e00\u4e9b\u57fa\u7840\u7684AOP\u672f\u8bed\uff0c\u73b0\u5728\u8ba9\u6211\u4eec\u518d\u770b\u770b\u8fd9\u4e9bAOP\u7684\u6838\u5fc3\u6982\u5ff5\u662f\u5982\u4f55\u5728Spring\u4e2d\u5b9e\u73b0\u7684\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#springaop","title":"Spring\u5bf9AOP\u7684\u652f\u6301","text":"<p>\u5e76\u4e0d\u662f\u6240\u6709\u7684AOP\u6846\u67b6\u90fd\u662f\u76f8\u540c\u7684\uff0c\u5b83\u4eec\u5728\u8fde\u63a5\u70b9\u6a21\u578b\u4e0a\u53ef\u80fd\u6709\u5f3a\u5f31\u4e4b\u5206\u3002\u6709\u4e9b\u5141\u8bb8\u5728\u5b57\u6bb5\u4fee\u9970\u7b26\u7ea7\u522b\u5e94\u7528\u901a\u77e5\uff0c\u800c\u53e6\u4e00\u4e9b\u53ea\u652f\u6301\u4e0e\u65b9\u6cd5\u8c03\u7528\u76f8\u5173\u7684\u8fde\u63a5\u70b9\u3002\u5b83\u4eec\u7ec7\u5165\u5207\u9762\u7684\u65b9\u5f0f\u548c\u65f6\u673a\u4e5f\u6709\u6240\u4e0d\u540c\u3002\u4f46\u662f\u65e0\u8bba\u5982\u4f55\uff0c\u521b\u5efa\u5207\u70b9\u6765\u5b9a\u4e49\u5207\u9762\u6240\u7ec7\u5165\u7684\u8fde\u63a5\u70b9\u662fAOP\u6846\u67b6\u7684\u57fa\u672c\u529f\u80fd\u3002</p> <p>\u56e0\u4e3a\u8fd9\u662f\u4e00\u672c\u4ecb\u7ecdSpring\u7684\u56fe\u4e66\uff0c\u6240\u4ee5\u6211\u4eec\u4f1a\u5173\u6ce8Spring AOP\u3002\u867d\u7136\u5982\u6b64\uff0cSpring\u548cAspectJ\u9879\u76ee\u4e4b\u95f4\u6709\u5927\u91cf\u7684\u534f\u4f5c\uff0c\u800c\u4e14Spring\u5bf9AOP\u7684\u652f\u6301\u5728\u5f88\u591a\u65b9\u9762\u501f\u9274\u4e86AspectJ\u9879\u76ee\u3002</p> <p>Spring\u63d0\u4f9b\u4e864\u79cd\u7c7b\u578b\u7684AOP\u652f\u6301\uff1a</p> <ul> <li>\u57fa\u4e8e\u4ee3\u7406\u7684\u7ecf\u5178Spring AOP\uff1b</li> <li>\u7eafPOJO\u5207\u9762\uff1b</li> <li>@AspectJ\u6ce8\u89e3\u9a71\u52a8\u7684\u5207\u9762\uff1b</li> <li>\u6ce8\u5165\u5f0fAspectJ\u5207\u9762\uff08\u9002\u7528\u4e8eSpring\u5404\u7248\u672c\uff09\u3002</li> </ul> <p>\u524d\u4e09\u79cd\u90fd\u662fSpring AOP\u5b9e\u73b0\u7684\u53d8\u4f53\uff0cSpring AOP\u6784\u5efa\u5728\u52a8\u6001\u4ee3\u7406\u57fa\u7840\u4e4b\u4e0a\uff0c\u56e0\u6b64\uff0cSpring\u5bf9AOP\u7684\u652f\u6301\u5c40\u9650\u4e8e\u65b9\u6cd5\u62e6\u622a\u3002</p> <p>\u672f\u8bed\u201c\u7ecf\u5178\u201d\u901a\u5e38\u610f\u5473\u7740\u662f\u5f88\u597d\u7684\u4e1c\u897f\u3002\u8001\u7237\u8f66\u3001\u7ecf\u5178\u9ad8\u5c14\u592b\u7403\u8d5b\u3001\u53ef\u53e3\u53ef\u4e50\u7cbe\u54c1\u90fd\u662f\u597d\u4e1c\u897f\u3002\u4f46\u662fSpring\u7684\u7ecf\u5178AOP\u7f16\u7a0b\u6a21\u578b\u5e76\u4e0d\u600e\u4e48\u6837\u3002\u5f53\u7136\uff0c\u66fe\u7ecf\u5b83\u7684\u786e\u975e\u5e38\u68d2\u3002\u4f46\u662f\u73b0\u5728Spring\u63d0\u4f9b\u4e86\u66f4\u7b80\u6d01\u548c\u5e72\u51c0\u7684\u9762\u5411\u5207\u9762\u7f16\u7a0b\u65b9\u5f0f\u3002\u5f15\u5165\u4e86\u7b80\u5355\u7684\u58f0\u660e\u5f0fAOP\u548c\u57fa\u4e8e\u6ce8\u89e3\u7684AOP\u4e4b\u540e\uff0cSpring\u7ecf\u5178\u7684AOP\u770b\u8d77\u6765\u5c31\u663e\u5f97\u975e\u5e38\u7b28\u91cd\u548c\u8fc7\u4e8e\u590d\u6742\uff0c\u76f4\u63a5\u4f7f\u7528 ProxyFactory Bean\u4f1a\u8ba9\u4eba\u611f\u89c9\u538c\u70e6\u3002\u6240\u4ee5\u5728\u672c\u4e66\u4e2d\u6211\u4e0d\u4f1a\u518d\u4ecb\u7ecd\u7ecf\u5178\u7684Spring AOP\u3002</p> <p>\u501f\u52a9Spring\u7684aop\u547d\u540d\u7a7a\u95f4\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u7eafPOJO\u8f6c\u6362\u4e3a\u5207\u9762\u3002\u5b9e\u9645\u4e0a\uff0c\u8fd9\u4e9bPOJO\u53ea\u662f\u63d0\u4f9b\u4e86\u6ee1\u8db3\u5207\u70b9\u6761\u4ef6\u65f6\u6240\u8981\u8c03\u7528\u7684\u65b9\u6cd5\u3002\u9057\u61be\u7684\u662f\uff0c\u8fd9\u79cd\u6280\u672f\u9700\u8981XML\u914d\u7f6e\uff0c\u4f46\u8fd9\u7684\u786e\u662f\u58f0\u660e\u5f0f\u5730\u5c06\u5bf9\u8c61\u8f6c\u6362\u4e3a\u5207\u9762\u7684\u7b80\u4fbf\u65b9\u5f0f\u3002</p> <p>Spring\u501f\u9274\u4e86AspectJ\u7684\u5207\u9762\uff0c\u4ee5\u63d0\u4f9b\u6ce8\u89e3\u9a71\u52a8\u7684AOP\u3002\u672c\u8d28\u4e0a\uff0c\u5b83\u4f9d\u7136\u662fSpring\u57fa\u4e8e\u4ee3\u7406\u7684AOP\uff0c\u4f46\u662f\u7f16\u7a0b\u6a21\u578b\u51e0\u4e4e\u4e0e\u7f16\u5199\u6210\u719f\u7684AspectJ\u6ce8\u89e3\u5207\u9762\u5b8c\u5168\u4e00\u81f4\u3002\u8fd9\u79cdAOP\u98ce\u683c\u7684\u597d\u5904\u5728\u4e8e\u80fd\u591f\u4e0d\u4f7f\u7528XML\u6765\u5b8c\u6210\u529f\u80fd\u3002</p> <p>\u5982\u679c\u4f60\u7684AOP\u9700\u6c42\u8d85\u8fc7\u4e86\u7b80\u5355\u7684\u65b9\u6cd5\u8c03\u7528\uff08\u5982\u6784\u9020\u5668\u6216\u5c5e\u6027\u62e6\u622a\uff09\uff0c\u90a3\u4e48\u4f60\u9700\u8981\u8003\u8651\u4f7f\u7528AspectJ\u6765\u5b9e\u73b0\u5207\u9762\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e0a\u6587\u6240\u793a\u7684\u7b2c\u56db\u79cd\u7c7b\u578b\u80fd\u591f\u5e2e\u52a9\u4f60\u5c06\u503c\u6ce8\u5165\u5230AspectJ\u9a71\u52a8\u7684\u5207\u9762\u4e2d\u3002</p> <p>\u6211\u4eec\u5728\u5c06\u5728\u672c\u7ae0\u5c55\u793a\u66f4\u591a\u7684Spring AOP\u6280\u672f\uff0c\u4f46\u662f\u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u6211\u4eec\u5fc5\u987b\u8981\u4e86\u89e3Spring AOP\u6846\u67b6\u7684\u4e00\u4e9b\u5173\u952e\u77e5\u8bc6\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#springjava","title":"Spring\u901a\u77e5\u662fJava\u7f16\u5199\u7684","text":"<p>Spring\u6240\u521b\u5efa\u7684\u901a\u77e5\u90fd\u662f\u7528\u6807\u51c6\u7684Java\u7c7b\u7f16\u5199\u7684\u3002\u8fd9\u6837\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e0e\u666e\u901aJava\u5f00\u53d1\u4e00\u6837\u7684\u96c6\u6210\u5f00\u53d1\u73af\u5883\uff08IDE\uff09\u6765\u5f00\u53d1\u5207\u9762\u3002\u800c\u4e14\uff0c\u5b9a\u4e49\u901a\u77e5\u6240\u5e94\u7528\u7684\u5207\u70b9\u901a\u5e38\u4f1a\u4f7f\u7528\u6ce8\u89e3\u6216\u5728Spring\u914d\u7f6e\u6587\u4ef6\u91cc\u91c7\u7528XML\u6765\u7f16\u5199\uff0c\u8fd9\u4e24\u79cd\u8bed\u6cd5\u5bf9\u4e8eJava\u5f00\u53d1\u8005\u6765\u8bf4\u90fd\u662f\u76f8\u5f53\u719f\u6089\u7684\u3002</p> <p>AspectJ\u4e0e\u4e4b\u76f8\u53cd\u3002\u867d\u7136AspectJ\u73b0\u5728\u652f\u6301\u57fa\u4e8e\u6ce8\u89e3\u7684\u5207\u9762\uff0c\u4f46AspectJ\u6700\u521d\u662f\u4ee5Java\u8bed\u8a00\u6269\u5c55\u7684\u65b9\u5f0f\u5b9e\u73b0\u7684\u3002\u8fd9\u79cd\u65b9\u5f0f\u6709\u4f18\u70b9\u4e5f\u6709\u7f3a\u70b9\u3002\u901a\u8fc7\u7279\u6709\u7684AOP\u8bed\u8a00\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u66f4\u5f3a\u5927\u548c\u7ec6\u7c92\u5ea6\u7684\u63a7\u5236\uff0c\u4ee5\u53ca\u66f4\u4e30\u5bcc\u7684AOP\u5de5\u5177\u96c6\uff0c\u4f46\u662f\u6211\u4eec\u9700\u8981\u989d\u5916\u5b66\u4e60\u65b0\u7684\u5de5\u5177\u548c\u8bed\u6cd5\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#spring","title":"Spring\u5728\u8fd0\u884c\u65f6\u901a\u77e5\u5bf9\u8c61","text":"<p>\u901a\u8fc7\u5728\u4ee3\u7406\u7c7b\u4e2d\u5305\u88f9\u5207\u9762\uff0cSpring\u5728\u8fd0\u884c\u671f\u628a\u5207\u9762\u7ec7\u5165\u5230Spring\u7ba1\u7406\u7684bean\u4e2d\u3002\u5982\u56fe4.3\u6240\u793a\uff0c\u4ee3\u7406\u7c7b\u5c01\u88c5\u4e86\u76ee\u6807\u7c7b\uff0c\u5e76\u62e6\u622a\u88ab\u901a\u77e5\u65b9\u6cd5\u7684\u8c03\u7528\uff0c\u518d\u628a\u8c03\u7528\u8f6c\u53d1\u7ed9\u771f\u6b63\u7684\u76ee\u6807bean\u3002\u5f53\u4ee3\u7406\u62e6\u622a\u5230\u65b9\u6cd5\u8c03\u7528\u65f6\uff0c\u5728\u8c03\u7528\u76ee\u6807bean\u65b9\u6cd5\u4e4b\u524d\uff0c\u4f1a\u6267\u884c\u5207\u9762\u903b\u8f91\u3002</p> <p></p> <p>\u56fe4.3\u3000Spring\u7684\u5207\u9762\u7531\u5305\u88f9\u4e86\u76ee\u6807\u5bf9\u8c61\u7684\u4ee3\u7406\u7c7b\u5b9e\u73b0\u3002\u4ee3\u7406\u7c7b\u5904\u7406\u65b9\u6cd5\u7684\u8c03\u7528\uff0c\u6267\u884c\u989d\u5916\u7684\u5207\u9762\u903b\u8f91\uff0c\u5e76\u8c03\u7528\u76ee\u6807\u65b9\u6cd5</p> <p>\u76f4\u5230\u5e94\u7528\u9700\u8981\u88ab\u4ee3\u7406\u7684bean\u65f6\uff0cSpring\u624d\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\u3002\u5982\u679c\u4f7f\u7528\u7684\u662fApplicationContext\u7684\u8bdd\uff0c\u5728ApplicationContext\u4eceBeanFactory\u4e2d\u52a0\u8f7d\u6240\u6709bean\u7684\u65f6\u5019\uff0cSpring\u624d\u4f1a\u521b\u5efa\u88ab\u4ee3\u7406\u7684\u5bf9\u8c61\u3002\u56e0\u4e3aSpring\u8fd0\u884c\u65f6\u624d\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u9700\u8981\u7279\u6b8a\u7684\u7f16\u8bd1\u5668\u6765\u7ec7\u5165Spring AOP\u7684\u5207\u9762\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#spring_1","title":"Spring\u53ea\u652f\u6301\u65b9\u6cd5\u7ea7\u522b\u7684\u8fde\u63a5\u70b9","text":"<p>\u6b63\u5982\u524d\u9762\u6240\u63a2\u8ba8\u8fc7\u7684\uff0c\u901a\u8fc7\u4f7f\u7528\u5404\u79cdAOP\u65b9\u6848\u53ef\u4ee5\u652f\u6301\u591a\u79cd\u8fde\u63a5\u70b9\u6a21\u578b\u3002\u56e0\u4e3aSpring\u57fa\u4e8e\u52a8\u6001\u4ee3\u7406\uff0c\u6240\u4ee5Spring\u53ea\u652f\u6301\u65b9\u6cd5\u8fde\u63a5\u70b9\u3002\u8fd9\u4e0e\u4e00\u4e9b\u5176\u4ed6\u7684AOP\u6846\u67b6\u662f\u4e0d\u540c\u7684\uff0c\u4f8b\u5982AspectJ\u548cJBoss\uff0c\u9664\u4e86\u65b9\u6cd5\u5207\u70b9\uff0c\u5b83\u4eec\u8fd8\u63d0\u4f9b\u4e86\u5b57\u6bb5\u548c\u6784\u9020\u5668\u63a5\u5165\u70b9\u3002Spring\u7f3a\u5c11\u5bf9\u5b57\u6bb5\u8fde\u63a5\u70b9\u7684\u652f\u6301\uff0c\u65e0\u6cd5\u8ba9\u6211\u4eec\u521b\u5efa\u7ec6\u7c92\u5ea6\u7684\u901a\u77e5\uff0c\u4f8b\u5982\u62e6\u622a\u5bf9\u8c61\u5b57\u6bb5\u7684\u4fee\u6539\u3002\u800c\u4e14\u5b83\u4e0d\u652f\u6301\u6784\u9020\u5668\u8fde\u63a5\u70b9\uff0c\u6211\u4eec\u5c31\u65e0\u6cd5\u5728bean\u521b\u5efa\u65f6\u5e94\u7528\u901a\u77e5\u3002</p> <p>\u4f46\u662f\u65b9\u6cd5\u62e6\u622a\u53ef\u4ee5\u6ee1\u8db3\u7edd\u5927\u90e8\u5206\u7684\u9700\u6c42\u3002\u5982\u679c\u9700\u8981\u65b9\u6cd5\u62e6\u622a\u4e4b\u5916\u7684\u8fde\u63a5\u70b9\u62e6\u622a\u529f\u80fd\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5229\u7528Aspect\u6765\u8865\u5145Spring AOP\u7684\u529f\u80fd\u3002</p> <p>\u5bf9\u4e8e\u4ec0\u4e48\u662fAOP\u4ee5\u53caSpring\u5982\u4f55\u652f\u6301AOP\u7684\uff0c\u6211\u4eec\u73b0\u5728\u5df2\u7ecf\u6709\u4e86\u4e00\u4e2a\u5927\u81f4\u7684\u4e86\u89e3\u3002\u73b0\u5728\u662f\u65f6\u5019\u5b66\u4e60\u5982\u4f55\u5728Spring\u4e2d\u521b\u5efa\u5207\u9762\u4e86\uff0c\u8ba9\u6211\u4eec\u5148\u4eceSpring\u7684\u58f0\u660e\u5f0fAOP\u6a21\u578b\u5f00\u59cb\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#_1","title":"\u901a\u8fc7\u5207\u70b9\u6765\u9009\u62e9\u8fde\u63a5\u70b9","text":"<p>\u6b63\u5982\u4e4b\u524d\u6240\u63d0\u8fc7\u7684\uff0c\u5207\u70b9\u7528\u4e8e\u51c6\u786e\u5b9a\u4f4d\u5e94\u8be5\u5728\u4ec0\u4e48\u5730\u65b9\u5e94\u7528\u5207\u9762\u7684\u901a\u77e5\u3002\u901a\u77e5\u548c\u5207\u70b9\u662f\u5207\u9762\u7684\u6700\u57fa\u672c\u5143\u7d20\u3002\u56e0\u6b64\uff0c\u4e86\u89e3\u5982\u4f55\u7f16\u5199\u5207\u70b9\u975e\u5e38\u91cd\u8981\u3002</p> <p>\u5728Spring AOP\u4e2d\uff0c\u8981\u4f7f\u7528AspectJ\u7684\u5207\u70b9\u8868\u8fbe\u5f0f\u8bed\u8a00\u6765\u5b9a\u4e49\u5207\u70b9\u3002\u5982\u679c\u4f60\u5df2\u7ecf\u5f88\u719f\u6089AspectJ\uff0c\u90a3\u4e48\u5728Spring\u4e2d\u5b9a\u4e49\u5207\u70b9\u5c31\u611f\u89c9\u975e\u5e38\u81ea\u7136\u3002\u4f46\u662f\u5982\u679c\u4f60\u4e00\u70b9\u90fd\u4e0d\u4e86\u89e3AspectJ\u7684\u8bdd\uff0c\u672c\u5c0f\u8282\u6211\u4eec\u5c06\u5feb\u901f\u4ecb\u7ecd\u4e00\u4e0b\u5982\u4f55\u7f16\u5199AspectJ\u98ce\u683c\u7684\u5207\u70b9\u3002\u5982\u679c\u4f60\u60f3\u8fdb\u4e00\u6b65\u4e86\u89e3AspectJ\u548cAspectJ\u5207\u70b9\u8868\u8fbe\u5f0f\u8bed\u8a00\uff0c\u6211\u5f3a\u70c8\u63a8\u8350Ramniva Laddad\u7f16\u5199\u7684\u300aAspectJ in Action\u300b\u7b2c\u4e8c\u7248\uff08Manning\uff0c2009\uff0cwww.manning.com/laddad2/\uff09\u3002</p> <p>\u5173\u4e8eSpring AOP\u7684AspectJ\u5207\u70b9\uff0c\u6700\u91cd\u8981\u7684\u4e00\u70b9\u5c31\u662fSpring\u4ec5\u652f\u6301AspectJ\u5207\u70b9\u6307\u793a\u5668\uff08pointcut designator\uff09\u7684\u4e00\u4e2a\u5b50\u96c6\u3002\u8ba9\u6211\u4eec\u56de\u987e\u4e0b\uff0cSpring\u662f\u57fa\u4e8e\u4ee3\u7406\u7684\uff0c\u800c\u67d0\u4e9b\u5207\u70b9\u8868\u8fbe\u5f0f\u662f\u4e0e\u57fa\u4e8e\u4ee3\u7406\u7684AOP\u65e0\u5173\u7684\u3002\u88684.1\u5217\u51fa\u4e86Spring AOP\u6240\u652f\u6301\u7684AspectJ\u5207\u70b9\u6307\u793a\u5668\u3002</p> <p>\u88684.1\u3000Spring\u501f\u52a9AspectJ\u7684\u5207\u70b9\u8868\u8fbe\u5f0f\u8bed\u8a00\u6765\u5b9a\u4e49Spring\u5207\u9762</p> AspectJ\u6307\u793a\u5668 \u63cf\u8ff0 arg() \u9650\u5236\u8fde\u63a5\u70b9\u5339\u914d\u53c2\u6570\u4e3a\u6307\u5b9a\u7c7b\u578b\u7684\u6267\u884c\u65b9\u6cd5 @args \u9650\u5236\u8fde\u63a5\u70b9\u5339\u914d\u53c2\u6570\u7531\u6307\u5b9a\u6ce8\u89e3\u6807\u6ce8\u7684\u6267\u884c\u65b9\u6cd5 execution() \u7528\u4e8e\u5339\u914d\u662f\u8fde\u63a5\u70b9\u7684\u6267\u884c\u65b9\u6cd5 this() \u9650\u5236\u8fde\u63a5\u70b9\u5339\u914dAOP\u4ee3\u7406\u7684bean\u5f15\u7528\u4e3a\u6307\u5b9a\u7c7b\u578b\u7684\u7c7b target \u9650\u5236\u8fde\u63a5\u70b9\u5339\u914d\u76ee\u6807\u5bf9\u8c61\u4e3a\u6307\u5b9a\u7c7b\u578b\u7684\u7c7b @target() \u9650\u5236\u8fde\u63a5\u70b9\u5339\u914d\u7279\u5b9a\u7684\u6267\u884c\u5bf9\u8c61\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u5bf9\u5e94\u7684\u7c7b\u8981\u5177\u6709\u6307\u5b9a\u7c7b\u578b\u7684\u6ce8\u89e3 within() \u9650\u5236\u8fde\u63a5\u70b9\u5339\u914d\u6307\u5b9a\u7684\u7c7b\u578b @within() \u9650\u5236\u8fde\u63a5\u70b9\u5339\u914d\u6307\u5b9a\u6ce8\u89e3\u6240\u6807\u6ce8\u7684\u7c7b\u578b\uff08\u5f53\u4f7f\u7528Spring AOP\u65f6\uff0c\u65b9\u6cd5\u5b9a\u4e49\u5728\u7531\u6307\u5b9a\u7684\u6ce8\u89e3\u6240\u6807\u6ce8\u7684\u7c7b\u91cc\uff09 @annotation \u9650\u5b9a\u5339\u914d\u5e26\u6709\u6307\u5b9a\u6ce8\u89e3\u7684\u8fde\u63a5\u70b9 <p>\u5728Spring\u4e2d\u5c1d\u8bd5\u4f7f\u7528AspectJ\u5176\u4ed6\u6307\u793a\u5668\u65f6\uff0c\u5c06\u4f1a\u629b\u51faIllegalArgument-Exception\u5f02\u5e38\u3002</p> <p>\u5f53\u6211\u4eec\u67e5\u770b\u5982\u4e0a\u6240\u5c55\u793a\u7684\u8fd9\u4e9bSpring\u652f\u6301\u7684\u6307\u793a\u5668\u65f6\uff0c\u6ce8\u610f\u53ea\u6709execution\u6307\u793a\u5668\u662f\u5b9e\u9645\u6267\u884c\u5339\u914d\u7684\uff0c\u800c\u5176\u4ed6\u7684\u6307\u793a\u5668\u90fd\u662f\u7528\u6765\u9650\u5236\u5339\u914d\u7684\u3002\u8fd9\u8bf4\u660eexecution\u6307\u793a\u5668\u662f\u6211\u4eec\u5728\u7f16\u5199\u5207\u70b9\u5b9a\u4e49\u65f6\u6700\u4e3b\u8981\u4f7f\u7528\u7684\u6307\u793a\u5668\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u6211\u4eec\u4f7f\u7528\u5176\u4ed6\u6307\u793a\u5668\u6765\u9650\u5236\u6240\u5339\u914d\u7684\u5207\u70b9\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#_2","title":"\u7f16\u5199\u5207\u70b9","text":"<p>\u4e3a\u4e86\u9610\u8ff0Spring\u4e2d\u7684\u5207\u9762\uff0c\u6211\u4eec\u9700\u8981\u6709\u4e2a\u4e3b\u9898\u6765\u5b9a\u4e49\u5207\u9762\u7684\u5207\u70b9\u3002\u4e3a\u6b64\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2aPerformance\u63a5\u53e3\uff1a</p> <pre><code>package concert;\n\npublic interface Performance {\npublic void perform();\n}\n</code></pre> <p>Performance\u53ef\u4ee5\u4ee3\u8868\u4efb\u4f55\u7c7b\u578b\u7684\u73b0\u573a\u8868\u6f14\uff0c\u5982\u821e\u53f0\u5267\u3001\u7535\u5f71\u6216\u97f3\u4e50\u4f1a\u3002\u5047\u8bbe\u6211\u4eec\u60f3\u7f16\u5199Performance\u7684perform()\u65b9\u6cd5\u89e6\u53d1\u7684\u901a\u77e5\u3002\u56fe4.4\u5c55\u73b0\u4e86\u4e00\u4e2a\u5207\u70b9\u8868\u8fbe\u5f0f\uff0c\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u80fd\u591f\u8bbe\u7f6e\u5f53perform()\u65b9\u6cd5\u6267\u884c\u65f6\u89e6\u53d1\u901a\u77e5\u7684\u8c03\u7528\u3002</p> <p></p> <p>\u6211\u4eec\u4f7f\u7528execution()\u6307\u793a\u5668\u9009\u62e9Performance\u7684perform()\u65b9\u6cd5\u3002\u65b9\u6cd5\u8868\u8fbe\u5f0f\u4ee5\u201c*\u201d\u53f7\u5f00\u59cb\uff0c\u8868\u660e\u4e86\u6211\u4eec\u4e0d\u5173\u5fc3\u65b9\u6cd5\u8fd4\u56de\u503c\u7684\u7c7b\u578b\u3002\u7136\u540e\uff0c\u6211\u4eec\u6307\u5b9a\u4e86\u5168\u9650\u5b9a\u7c7b\u540d\u548c\u65b9\u6cd5\u540d\u3002\u5bf9\u4e8e\u65b9\u6cd5\u53c2\u6570\u5217\u8868\uff0c\u6211\u4eec\u4f7f\u7528\u4e24\u4e2a\u70b9\u53f7\uff08..\uff09\u8868\u660e\u5207\u70b9\u8981\u9009\u62e9\u4efb\u610f\u7684perform()\u65b9\u6cd5\uff0c\u65e0\u8bba\u8be5\u65b9\u6cd5\u7684\u5165\u53c2\u662f\u4ec0\u4e48\u3002</p> <p>\u73b0\u5728\u5047\u8bbe\u6211\u4eec\u9700\u8981\u914d\u7f6e\u7684\u5207\u70b9\u4ec5\u5339\u914dconcert\u5305\u3002\u5728\u6b64\u573a\u666f\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528within()\u6307\u793a\u5668\u6765\u9650\u5236\u5339\u914d\uff0c\u5982\u56fe4.5\u6240\u793a\u3002</p> <p></p> <p>\u8bf7\u6ce8\u610f\u6211\u4eec\u4f7f\u7528\u4e86\u201c&amp;&amp;\u201d\u64cd\u4f5c\u7b26\u628aexecution()\u548cwithin()\u6307\u793a\u5668\u8fde\u63a5\u5728\u4e00\u8d77\u5f62\u6210\u4e0e\uff08and\uff09\u5173\u7cfb\uff08\u5207\u70b9\u5fc5\u987b\u5339\u914d\u6240\u6709\u7684\u6307\u793a\u5668\uff09\u3002\u7c7b\u4f3c\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u201c||\u201d\u64cd\u4f5c\u7b26\u6765\u6807\u8bc6\u6216\uff08or\uff09\u5173\u7cfb\uff0c\u800c\u4f7f\u7528\u201c!\u201d\u64cd\u4f5c\u7b26\u6765\u6807\u8bc6\u975e\uff08not\uff09\u64cd\u4f5c\u3002</p> <p>\u56e0\u4e3a\u201c&amp;\u201d\u5728XML\u4e2d\u6709\u7279\u6b8a\u542b\u4e49\uff0c\u6240\u4ee5\u5728Spring\u7684XML\u914d\u7f6e\u91cc\u9762\u63cf\u8ff0\u5207\u70b9\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528and\u6765\u4ee3\u66ff\u201c&amp;&amp;\u201d\u3002\u540c\u6837\uff0cor\u548cnot\u53ef\u4ee5\u5206\u522b\u7528\u6765\u4ee3\u66ff\u201c||\u201d\u548c\u201c!\u201d\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#bean","title":"\u5728\u5207\u70b9\u4e2d\u9009\u62e9bean","text":"<p>\u9664\u4e86\u88684.1\u6240\u5217\u7684\u6307\u793a\u5668\u5916\uff0cSpring\u8fd8\u5f15\u5165\u4e86\u4e00\u4e2a\u65b0\u7684bean()\u6307\u793a\u5668\uff0c\u5b83\u5141\u8bb8\u6211\u4eec\u5728\u5207\u70b9\u8868\u8fbe\u5f0f\u4e2d\u4f7f\u7528bean\u7684ID\u6765\u6807\u8bc6bean\u3002bean()\u4f7f\u7528bean ID\u6216bean\u540d\u79f0\u4f5c\u4e3a\u53c2\u6570\u6765\u9650\u5236\u5207\u70b9\u53ea\u5339\u914d\u7279\u5b9a\u7684bean\u3002</p> <p>\u4f8b\u5982\uff0c\u8003\u8651\u5982\u4e0b\u7684\u5207\u70b9\uff1a</p> <pre><code>execution(* concert.Performance.perform())\n        and bean('woodstock')\n</code></pre> <p>\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u5e0c\u671b\u5728\u6267\u884cPerformance\u7684perform()\u65b9\u6cd5\u65f6\u5e94\u7528\u901a\u77e5\uff0c\u4f46\u9650\u5b9abean\u7684ID\u4e3awoodstock\u3002</p> <p>\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u9650\u5b9a\u5207\u70b9\u4e3a\u6307\u5b9a\u7684bean\u6216\u8bb8\u5f88\u6709\u610f\u4e49\uff0c\u4f46\u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528\u975e\u64cd\u4f5c\u4e3a\u9664\u4e86\u7279\u5b9aID\u4ee5\u5916\u7684\u5176\u4ed6bean\u5e94\u7528\u901a\u77e5\uff1a</p> <pre><code>execution(* concert.Performance.perform())\n        and !bean('woodstock')\n</code></pre> <p>\u5728\u6b64\u573a\u666f\u4e0b\uff0c\u5207\u9762\u7684\u901a\u77e5\u4f1a\u88ab\u7f16\u7ec7\u5230\u6240\u6709ID\u4e0d\u4e3awoodstock\u7684bean\u4e2d\u3002</p> <p>\u73b0\u5728\uff0c\u6211\u4eec\u5df2\u7ecf\u8bb2\u89e3\u4e86\u7f16\u5199\u5207\u70b9\u7684\u57fa\u7840\u77e5\u8bc6\uff0c\u8ba9\u6211\u4eec\u518d\u4e86\u89e3\u4e00\u4e0b\u5982\u4f55\u7f16\u5199\u901a\u77e5\u548c\u4f7f\u7528\u8fd9\u4e9b\u5207\u70b9\u58f0\u660e\u5207\u9762\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#_3","title":"\u4f7f\u7528\u6ce8\u89e3\u521b\u5efa\u5207\u9762","text":"<p>\u4f7f\u7528\u6ce8\u89e3\u6765\u521b\u5efa\u5207\u9762\u662fAspectJ 5\u6240\u5f15\u5165\u7684\u5173\u952e\u7279\u6027\u3002AspectJ 5\u4e4b\u524d\uff0c\u7f16\u5199AspectJ\u5207\u9762\u9700\u8981\u5b66\u4e60\u4e00\u79cdJava\u8bed\u8a00\u7684\u6269\u5c55\uff0c\u4f46\u662fAspectJ\u9762\u5411\u6ce8\u89e3\u7684\u6a21\u578b\u53ef\u4ee5\u975e\u5e38\u7b80\u4fbf\u5730\u901a\u8fc7\u5c11\u91cf\u6ce8\u89e3\u628a\u4efb\u610f\u7c7b\u8f6c\u53d8\u4e3a\u5207\u9762\u3002</p> <p>\u6211\u4eec\u5df2\u7ecf\u5b9a\u4e49\u4e86Performance\u63a5\u53e3\uff0c\u5b83\u662f\u5207\u9762\u4e2d\u5207\u70b9\u7684\u76ee\u6807\u5bf9\u8c61\u3002\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u4f7f\u7528AspecJ\u6ce8\u89e3\u6765\u5b9a\u4e49\u5207\u9762\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#_4","title":"\u5b9a\u4e49\u5207\u9762","text":"<p>\u5982\u679c\u4e00\u573a\u6f14\u51fa\u6ca1\u6709\u89c2\u4f17\u7684\u8bdd\uff0c\u90a3\u4e0d\u80fd\u79f0\u4e4b\u4e3a\u6f14\u51fa\u3002\u5bf9\u4e0d\u5bf9\uff1f\u4ece\u6f14\u51fa\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u89c2\u4f17\u662f\u975e\u5e38\u91cd\u8981\u7684\uff0c\u4f46\u662f\u5bf9\u6f14\u51fa\u672c\u8eab\u7684\u529f\u80fd\u6765\u8bb2\uff0c\u5b83\u5e76\u4e0d\u662f\u6838\u5fc3\uff0c\u8fd9\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u5173\u6ce8\u70b9\u3002\u56e0\u6b64\uff0c\u5c06\u89c2\u4f17\u5b9a\u4e49\u4e3a\u4e00\u4e2a\u5207\u9762\uff0c\u5e76\u5c06\u5176\u5e94\u7528\u5230\u6f14\u51fa\u4e0a\u5c31\u662f\u8f83\u4e3a\u660e\u667a\u7684\u505a\u6cd5\u3002</p> <p>\u7a0b\u5e8f\u6e05\u53554.1\u5c55\u73b0\u4e86Audience\u7c7b\uff0c\u5b83\u5b9a\u4e49\u4e86\u6211\u4eec\u6240\u9700\u7684\u4e00\u4e2a\u5207\u9762\u3002</p> <p>\u7a0b\u5e8f\u6e05\u53554.1\u3000Audience\u7c7b\uff1a\u89c2\u770b\u6f14\u51fa\u7684\u5207\u9762</p> <p></p> <p>Audience\u7c7b\u4f7f\u7528@AspectJ\u6ce8\u89e3\u8fdb\u884c\u4e86\u6807\u6ce8\u3002\u8be5\u6ce8\u89e3\u8868\u660eAudience\u4e0d\u4ec5\u4ec5\u662f\u4e00\u4e2aPOJO\uff0c\u8fd8\u662f\u4e00\u4e2a\u5207\u9762\u3002Audience\u7c7b\u4e2d\u7684\u65b9\u6cd5\u90fd\u4f7f\u7528\u6ce8\u89e3\u6765\u5b9a\u4e49\u5207\u9762\u7684\u5177\u4f53\u884c\u4e3a\u3002</p> <p>Audience\u6709\u56db\u4e2a\u65b9\u6cd5\uff0c\u5b9a\u4e49\u4e86\u4e00\u4e2a\u89c2\u4f17\u5728\u89c2\u770b\u6f14\u51fa\u65f6\u53ef\u80fd\u4f1a\u505a\u7684\u4e8b\u60c5\u3002\u5728\u6f14\u51fa\u4e4b\u524d\uff0c\u89c2\u4f17\u8981\u5c31\u5750\uff08takeSeats()\uff09\u5e76\u5c06\u624b\u673a\u8c03\u81f3\u9759\u97f3\u72b6\u6001\uff08silenceCellPhones()\uff09\u3002\u5982\u679c\u6f14\u51fa\u5f88\u7cbe\u5f69\u7684\u8bdd\uff0c\u89c2\u4f17\u5e94\u8be5\u4f1a\u9f13\u638c\u559d\u5f69\uff08applause()\uff09\u3002\u4e0d\u8fc7\uff0c\u5982\u679c\u6f14\u51fa\u6ca1\u6709\u8fbe\u5230\u89c2\u4f17\u9884\u671f\u7684\u8bdd\uff0c\u89c2\u4f17\u4f1a\u8981\u6c42\u9000\u6b3e\uff08demandRefund()\uff09\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u4f7f\u7528\u4e86\u901a\u77e5\u6ce8\u89e3\u6765\u8868\u660e\u5b83\u4eec\u5e94\u8be5\u5728\u4ec0\u4e48\u65f6\u5019\u8c03\u7528\u3002AspectJ\u63d0\u4f9b\u4e86\u4e94\u4e2a\u6ce8\u89e3\u6765\u5b9a\u4e49\u901a\u77e5\uff0c\u5982\u88684.2\u6240\u793a\u3002</p> <p>\u88684.2\u3000Spring\u4f7f\u7528AspectJ\u6ce8\u89e3\u6765\u58f0\u660e\u901a\u77e5\u65b9\u6cd5</p> \u6ce8\u89e3 \u901a\u77e5 @After \u901a\u77e5\u65b9\u6cd5\u4f1a\u5728\u76ee\u6807\u65b9\u6cd5\u8fd4\u56de\u6216\u629b\u51fa\u5f02\u5e38\u540e\u8c03\u7528 @AfterReturning \u901a\u77e5\u65b9\u6cd5\u4f1a\u5728\u76ee\u6807\u65b9\u6cd5\u8fd4\u56de\u540e\u8c03\u7528 @AfterThrowing \u901a\u77e5\u65b9\u6cd5\u4f1a\u5728\u76ee\u6807\u65b9\u6cd5\u629b\u51fa\u5f02\u5e38\u540e\u8c03\u7528 @Around \u901a\u77e5\u65b9\u6cd5\u4f1a\u5c06\u76ee\u6807\u65b9\u6cd5\u5c01\u88c5\u8d77\u6765 @Before \u901a\u77e5\u65b9\u6cd5\u4f1a\u5728\u76ee\u6807\u65b9\u6cd5\u8c03\u7528\u4e4b\u524d\u6267\u884c <p>Audience\u4f7f\u7528\u5230\u4e86\u524d\u9762\u4e94\u4e2a\u6ce8\u89e3\u4e2d\u7684\u4e09\u4e2a\u3002takeSeats()\u548csilence CellPhones()\u65b9\u6cd5\u90fd\u7528\u5230\u4e86@Before\u6ce8\u89e3\uff0c\u8868\u660e\u5b83\u4eec\u5e94\u8be5\u5728\u6f14\u51fa\u5f00\u59cb\u4e4b\u524d\u8c03\u7528\u3002applause()\u65b9\u6cd5\u4f7f\u7528\u4e86@AfterReturning\u6ce8\u89e3\uff0c\u5b83\u4f1a\u5728\u6f14\u51fa\u6210\u529f\u8fd4\u56de\u540e\u8c03\u7528\u3002demandRefund()\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u4e86@AfterThrowing\u6ce8\u89e3\uff0c\u8fd9\u8868\u660e\u5b83\u4f1a\u5728\u629b\u51fa\u5f02\u5e38\u4ee5\u540e\u6267\u884c\u3002</p> <p>\u4f60\u53ef\u80fd\u5df2\u7ecf\u6ce8\u610f\u5230\u4e86\uff0c\u6240\u6709\u7684\u8fd9\u4e9b\u6ce8\u89e3\u90fd\u7ed9\u5b9a\u4e86\u4e00\u4e2a\u5207\u70b9\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u5b83\u7684\u503c\uff0c\u540c\u65f6\uff0c\u8fd9\u56db\u4e2a\u65b9\u6cd5\u7684\u5207\u70b9\u8868\u8fbe\u5f0f\u90fd\u662f\u76f8\u540c\u7684\u3002\u5176\u5b9e\uff0c\u5b83\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u6210\u4e0d\u540c\u7684\u5207\u70b9\u8868\u8fbe\u5f0f\uff0c\u4f46\u662f\u5728\u8fd9\u91cc\uff0c\u8fd9\u4e2a\u5207\u70b9\u8868\u8fbe\u5f0f\u5c31\u80fd\u6ee1\u8db3\u6240\u6709\u901a\u77e5\u65b9\u6cd5\u7684\u9700\u6c42\u3002\u8ba9\u6211\u4eec\u8fd1\u8ddd\u79bb\u770b\u4e00\u4e0b\u8fd9\u4e2a\u8bbe\u7f6e\u7ed9\u901a\u77e5\u6ce8\u89e3\u7684\u5207\u70b9\u8868\u8fbe\u5f0f\uff0c\u6211\u4eec\u53d1\u73b0\u5b83\u4f1a\u5728Performance\u7684perform()\u65b9\u6cd5\u6267\u884c\u65f6\u89e6\u53d1\u3002</p> <p>\u76f8\u540c\u7684\u5207\u70b9\u8868\u8fbe\u5f0f\u6211\u4eec\u91cd\u590d\u4e86\u56db\u904d\uff0c\u8fd9\u53ef\u771f\u4e0d\u662f\u4ec0\u4e48\u5149\u5f69\u7684\u4e8b\u60c5\u3002\u8fd9\u6837\u7684\u91cd\u590d\u8ba9\u4eba\u611f\u89c9\u6709\u4e9b\u4e0d\u5bf9\u52b2\u3002\u5982\u679c\u6211\u4eec\u53ea\u5b9a\u4e49\u8fd9\u4e2a\u5207\u70b9\u4e00\u6b21\uff0c\u7136\u540e\u6bcf\u6b21\u9700\u8981\u7684\u65f6\u5019\u5f15\u7528\u5b83\uff0c\u90a3\u4e48\u8fd9\u4f1a\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u65b9\u6848\u3002</p> <p>\u5e78\u597d\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u8fd9\u6837\u505a\uff1a@Pointcut\u6ce8\u89e3\u80fd\u591f\u5728\u4e00\u4e2a@AspectJ\u5207\u9762\u5185\u5b9a\u4e49\u53ef\u91cd\u7528\u7684\u5207\u70b9\u3002\u63a5\u4e0b\u6765\u7684\u7a0b\u5e8f\u6e05\u53554.2\u5c55\u73b0\u4e86\u65b0\u7684Audience\uff0c\u73b0\u5728\u5b83\u4f7f\u7528\u4e86@Pointcut\u3002</p> <p>\u7a0b\u5e8f\u6e05\u53554.2\u3000\u901a\u8fc7@Pointcut\u6ce8\u89e3\u58f0\u660e\u9891\u7e41\u4f7f\u7528\u7684\u5207\u70b9\u8868\u8fbe\u5f0f</p> <p></p> <p>\u5728Audience\u4e2d\uff0cperformance()\u65b9\u6cd5\u4f7f\u7528\u4e86@Pointcut\u6ce8\u89e3\u3002\u4e3a@Pointcut\u6ce8\u89e3\u8bbe\u7f6e\u7684\u503c\u662f\u4e00\u4e2a\u5207\u70b9\u8868\u8fbe\u5f0f\uff0c\u5c31\u50cf\u4e4b\u524d\u5728\u901a\u77e5\u6ce8\u89e3\u4e0a\u6240\u8bbe\u7f6e\u7684\u90a3\u6837\u3002\u901a\u8fc7\u5728performance()\u65b9\u6cd5\u4e0a\u6dfb\u52a0@Pointcut\u6ce8\u89e3\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u6269\u5c55\u4e86\u5207\u70b9\u8868\u8fbe\u5f0f\u8bed\u8a00\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u4efb\u4f55\u7684\u5207\u70b9\u8868\u8fbe\u5f0f\u4e2d\u4f7f\u7528performance()\u4e86\uff0c\u5982\u679c\u4e0d\u8fd9\u6837\u505a\u7684\u8bdd\uff0c\u4f60\u9700\u8981\u5728\u8fd9\u4e9b\u5730\u65b9\u4f7f\u7528\u90a3\u4e2a\u66f4\u957f\u7684\u5207\u70b9\u8868\u8fbe\u5f0f\u3002\u6211\u4eec\u73b0\u5728\u628a\u6240\u6709\u901a\u77e5\u6ce8\u89e3\u4e2d\u7684\u957f\u8868\u8fbe\u5f0f\u90fd\u66ff\u6362\u6210\u4e86performance()\u3002</p> <p>performance()\u65b9\u6cd5\u7684\u5b9e\u9645\u5185\u5bb9\u5e76\u4e0d\u91cd\u8981\uff0c\u5728\u8fd9\u91cc\u5b83\u5b9e\u9645\u4e0a\u5e94\u8be5\u662f\u7a7a\u7684\u3002\u5176\u5b9e\u8be5\u65b9\u6cd5\u672c\u8eab\u53ea\u662f\u4e00\u4e2a\u6807\u8bc6\uff0c\u4f9b@Pointcut\u6ce8\u89e3\u4f9d\u9644\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u9664\u4e86\u6ce8\u89e3\u548c\u6ca1\u6709\u5b9e\u9645\u64cd\u4f5c\u7684performance()\u65b9\u6cd5\uff0cAudience\u7c7b\u4f9d\u7136\u662f\u4e00\u4e2aPOJO\u3002\u6211\u4eec\u80fd\u591f\u50cf\u4f7f\u7528\u5176\u4ed6\u7684Java\u7c7b\u90a3\u6837\u8c03\u7528\u5b83\u7684\u65b9\u6cd5\uff0c\u5b83\u7684\u65b9\u6cd5\u4e5f\u80fd\u591f\u72ec\u7acb\u5730\u8fdb\u884c\u5355\u5143\u6d4b\u8bd5\uff0c\u8fd9\u4e0e\u5176\u4ed6\u7684Java\u7c7b\u5e76\u6ca1\u6709\u4ec0\u4e48\u533a\u522b\u3002Audience\u53ea\u662f\u4e00\u4e2aJava\u7c7b\uff0c\u53ea\u4e0d\u8fc7\u5b83\u901a\u8fc7\u6ce8\u89e3\u8868\u660e\u4f1a\u4f5c\u4e3a\u5207\u9762\u4f7f\u7528\u800c\u5df2\u3002</p> <p>\u50cf\u5176\u4ed6\u7684Java\u7c7b\u4e00\u6837\uff0c\u5b83\u53ef\u4ee5\u88c5\u914d\u4e3aSpring\u4e2d\u7684bean\uff1a</p> <pre><code>@Bean\npublic Audience audience() {\nreturn new Audience();\n}\n</code></pre> <p>\u5982\u679c\u4f60\u5c31\u6b64\u6b62\u6b65\u7684\u8bdd\uff0cAudience\u53ea\u4f1a\u662fSpring\u5bb9\u5668\u4e2d\u7684\u4e00\u4e2abean\u3002\u5373\u4fbf\u4f7f\u7528\u4e86AspectJ\u6ce8\u89e3\uff0c\u4f46\u5b83\u5e76\u4e0d\u4f1a\u88ab\u89c6\u4e3a\u5207\u9762\uff0c\u8fd9\u4e9b\u6ce8\u89e3\u4e0d\u4f1a\u89e3\u6790\uff0c\u4e5f\u4e0d\u4f1a\u521b\u5efa\u5c06\u5176\u8f6c\u6362\u4e3a\u5207\u9762\u7684\u4ee3\u7406\u3002</p> <p>\u5982\u679c\u4f60\u4f7f\u7528JavaConfig\u7684\u8bdd\uff0c\u53ef\u4ee5\u5728\u914d\u7f6e\u7c7b\u7684\u7c7b\u7ea7\u522b\u4e0a\u901a\u8fc7\u4f7f\u7528EnableAspectJ-AutoProxy\u6ce8\u89e3\u542f\u7528\u81ea\u52a8\u4ee3\u7406\u529f\u80fd\u3002\u7a0b\u5e8f\u6e05\u53554.3\u5c55\u73b0\u4e86\u5982\u4f55\u5728JavaConfig\u4e2d\u542f\u7528\u81ea\u52a8\u4ee3\u7406\u3002</p> <p>\u7a0b\u5e8f\u6e05\u53554.3\u3000\u5728JavaConfig\u4e2d\u542f\u7528AspectJ\u6ce8\u89e3\u7684\u81ea\u52a8\u4ee3\u7406</p> <p></p> <p>\u5047\u5982\u4f60\u5728Spring\u4e2d\u8981\u4f7f\u7528XML\u6765\u88c5\u914dbean\u7684\u8bdd\uff0c\u90a3\u4e48\u9700\u8981\u4f7f\u7528Spring aop\u547d\u540d\u7a7a\u95f4\u4e2d\u7684<code>&lt;aop:aspectj-autoproxy&gt;</code>\u5143\u7d20\u3002\u4e0b\u9762\u7684XML\u914d\u7f6e\u5c55\u73b0\u4e86\u5982\u4f55\u5b8c\u6210\u8be5\u529f\u80fd\u3002</p> <p>\u7a0b\u5e8f\u6e05\u53554.4\u3000\u5728XML\u4e2d\uff0c\u901a\u8fc7Spring\u7684aop\u547d\u540d\u7a7a\u95f4\u542f\u7528AspectJ\u81ea\u52a8\u4ee3\u7406</p> <p></p> <p>\u4e0d\u7ba1\u4f60\u662f\u4f7f\u7528JavaConfig\u8fd8\u662fXML\uff0cAspectJ\u81ea\u52a8\u4ee3\u7406\u90fd\u4f1a\u4e3a\u4f7f\u7528@Aspect\u6ce8\u89e3\u7684bean\u521b\u5efa\u4e00\u4e2a\u4ee3\u7406\uff0c\u8fd9\u4e2a\u4ee3\u7406\u4f1a\u56f4\u7ed5\u7740\u6240\u6709\u8be5\u5207\u9762\u7684\u5207\u70b9\u6240\u5339\u914d\u7684bean\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5c06\u4f1a\u4e3aConcertbean\u521b\u5efa\u4e00\u4e2a\u4ee3\u7406\uff0cAudience\u7c7b\u4e2d\u7684\u901a\u77e5\u65b9\u6cd5\u5c06\u4f1a\u5728perform()\u8c03\u7528\u524d\u540e\u6267\u884c\u3002</p> <p>\u6211\u4eec\u9700\u8981\u8bb0\u4f4f\u7684\u662f\uff0cSpring\u7684AspectJ\u81ea\u52a8\u4ee3\u7406\u4ec5\u4ec5\u4f7f\u7528@AspectJ\u4f5c\u4e3a\u521b\u5efa\u5207\u9762\u7684\u6307\u5bfc\uff0c\u5207\u9762\u4f9d\u7136\u662f\u57fa\u4e8e\u4ee3\u7406\u7684\u3002\u5728\u672c\u8d28\u4e0a\uff0c\u5b83\u4f9d\u7136\u662fSpring\u57fa\u4e8e\u4ee3\u7406\u7684\u5207\u9762\u3002\u8fd9\u4e00\u70b9\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u8fd9\u610f\u5473\u7740\u5c3d\u7ba1\u4f7f\u7528\u7684\u662f@AspectJ\u6ce8\u89e3\uff0c\u4f46\u6211\u4eec\u4ecd\u7136\u9650\u4e8e\u4ee3\u7406\u65b9\u6cd5\u7684\u8c03\u7528\u3002\u5982\u679c\u60f3\u5229\u7528AspectJ\u7684\u6240\u6709\u80fd\u529b\uff0c\u6211\u4eec\u5fc5\u987b\u5728\u8fd0\u884c\u65f6\u4f7f\u7528AspectJ\u5e76\u4e14\u4e0d\u4f9d\u8d56Spring\u6765\u521b\u5efa\u57fa\u4e8e\u4ee3\u7406\u7684\u5207\u9762\u3002</p> <p>\u5230\u73b0\u5728\u4e3a\u6b62\uff0c\u6211\u4eec\u7684\u5207\u9762\u5728\u5b9a\u4e49\u65f6\uff0c\u4f7f\u7528\u4e86\u4e0d\u540c\u7684\u901a\u77e5\u65b9\u6cd5\u6765\u5b9e\u73b0\u524d\u7f6e\u901a\u77e5\u548c\u540e\u7f6e\u901a\u77e5\u3002\u4f46\u662f\u88684.2\u8fd8\u63d0\u5230\u4e86\u53e6\u5916\u7684\u4e00\u79cd\u901a\u77e5\uff1a\u73af\u7ed5\u901a\u77e5\uff08around advice\uff09\u3002\u73af\u7ed5\u901a\u77e5\u4e0e\u5176\u4ed6\u7c7b\u578b\u7684\u901a\u77e5\u6709\u6240\u4e0d\u540c\uff0c\u56e0\u6b64\u503c\u5f97\u82b1\u70b9\u65f6\u95f4\u6765\u4ecb\u7ecd\u5982\u4f55\u8fdb\u884c\u7f16\u5199\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#_5","title":"\u521b\u5efa\u73af\u7ed5\u901a\u77e5","text":"<p>\u73af\u7ed5\u901a\u77e5\u662f\u6700\u4e3a\u5f3a\u5927\u7684\u901a\u77e5\u7c7b\u578b\u3002\u5b83\u80fd\u591f\u8ba9\u4f60\u6240\u7f16\u5199\u7684\u903b\u8f91\u5c06\u88ab\u901a\u77e5\u7684\u76ee\u6807\u65b9\u6cd5\u5b8c\u5168\u5305\u88c5\u8d77\u6765\u3002\u5b9e\u9645\u4e0a\u5c31\u50cf\u5728\u4e00\u4e2a\u901a\u77e5\u65b9\u6cd5\u4e2d\u540c\u65f6\u7f16\u5199\u524d\u7f6e\u901a\u77e5\u548c\u540e\u7f6e\u901a\u77e5\u3002</p> <p>\u4e3a\u4e86\u9610\u8ff0\u73af\u7ed5\u901a\u77e5\uff0c\u6211\u4eec\u91cd\u5199Audience\u5207\u9762\u3002\u8fd9\u6b21\uff0c\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u73af\u7ed5\u901a\u77e5\u6765\u4ee3\u66ff\u4e4b\u524d\u591a\u4e2a\u4e0d\u540c\u7684\u524d\u7f6e\u901a\u77e5\u548c\u540e\u7f6e\u901a\u77e5\u3002</p> <p>\u7a0b\u5e8f\u6e05\u53554.5\u3000\u4f7f\u7528\u73af\u7ed5\u901a\u77e5\u91cd\u65b0\u5b9e\u73b0Audience\u5207\u9762</p> <p></p> <p>\u5728\u8fd9\u91cc\uff0c@Around\u6ce8\u89e3\u8868\u660ewatchPerformance()\u65b9\u6cd5\u4f1a\u4f5c\u4e3aperformance()\u5207\u70b9\u7684\u73af\u7ed5\u901a\u77e5\u3002\u5728\u8fd9\u4e2a\u901a\u77e5\u4e2d\uff0c\u89c2\u4f17\u5728\u6f14\u51fa\u4e4b\u524d\u4f1a\u5c06\u624b\u673a\u8c03\u81f3\u9759\u97f3\u5e76\u5c31\u5750\uff0c\u6f14\u51fa\u7ed3\u675f\u540e\u4f1a\u9f13\u638c\u559d\u5f69\u3002\u50cf\u524d\u9762\u4e00\u6837\uff0c\u5982\u679c\u6f14\u51fa\u5931\u8d25\u7684\u8bdd\uff0c\u89c2\u4f17\u4f1a\u8981\u6c42\u9000\u6b3e\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e2a\u901a\u77e5\u6240\u8fbe\u5230\u7684\u6548\u679c\u4e0e\u4e4b\u524d\u7684\u524d\u7f6e\u901a\u77e5\u548c\u540e\u7f6e\u901a\u77e5\u662f\u4e00\u6837\u7684\u3002\u4f46\u662f\uff0c\u73b0\u5728\u5b83\u4eec\u4f4d\u4e8e\u540c\u4e00\u4e2a\u65b9\u6cd5\u4e2d\uff0c\u4e0d\u50cf\u4e4b\u524d\u90a3\u6837\u5206\u6563\u5728\u56db\u4e2a\u4e0d\u540c\u7684\u901a\u77e5\u65b9\u6cd5\u91cc\u9762\u3002</p> <p>\u5173\u4e8e\u8fd9\u4e2a\u65b0\u7684\u901a\u77e5\u65b9\u6cd5\uff0c\u4f60\u9996\u5148\u6ce8\u610f\u5230\u7684\u53ef\u80fd\u662f\u5b83\u63a5\u53d7ProceedingJoinPoint\u4f5c\u4e3a\u53c2\u6570\u3002\u8fd9\u4e2a\u5bf9\u8c61\u662f\u5fc5\u987b\u8981\u6709\u7684\uff0c\u56e0\u4e3a\u4f60\u8981\u5728\u901a\u77e5\u4e2d\u901a\u8fc7\u5b83\u6765\u8c03\u7528\u88ab\u901a\u77e5\u7684\u65b9\u6cd5\u3002\u901a\u77e5\u65b9\u6cd5\u4e2d\u53ef\u4ee5\u505a\u4efb\u4f55\u7684\u4e8b\u60c5\uff0c\u5f53\u8981\u5c06\u63a7\u5236\u6743\u4ea4\u7ed9\u88ab\u901a\u77e5\u7684\u65b9\u6cd5\u65f6\uff0c\u5b83\u9700\u8981\u8c03\u7528ProceedingJoinPoint\u7684proceed()\u65b9\u6cd5\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u522b\u5fd8\u8bb0\u8c03\u7528proceed()\u65b9\u6cd5\u3002\u5982\u679c\u4e0d\u8c03\u8fd9\u4e2a\u65b9\u6cd5\u7684\u8bdd\uff0c\u90a3\u4e48\u4f60\u7684\u901a\u77e5\u5b9e\u9645\u4e0a\u4f1a\u963b\u585e\u5bf9\u88ab\u901a\u77e5\u65b9\u6cd5\u7684\u8c03\u7528\u3002\u6709\u53ef\u80fd\u8fd9\u5c31\u662f\u4f60\u60f3\u8981\u7684\u6548\u679c\uff0c\u4f46\u66f4\u591a\u7684\u60c5\u51b5\u662f\u4f60\u5e0c\u671b\u5728\u67d0\u4e2a\u70b9\u4e0a\u6267\u884c\u88ab\u901a\u77e5\u7684\u65b9\u6cd5\u3002</p> <p>\u6709\u610f\u601d\u7684\u662f\uff0c\u4f60\u53ef\u4ee5\u4e0d\u8c03\u7528proceed()\u65b9\u6cd5\uff0c\u4ece\u800c\u963b\u585e\u5bf9\u88ab\u901a\u77e5\u65b9\u6cd5\u7684\u8bbf\u95ee\uff0c\u4e0e\u4e4b\u7c7b\u4f3c\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5728\u901a\u77e5\u4e2d\u5bf9\u5b83\u8fdb\u884c\u591a\u6b21\u8c03\u7528\u3002\u8981\u8fd9\u6837\u505a\u7684\u4e00\u4e2a\u573a\u666f\u5c31\u662f\u5b9e\u73b0\u91cd\u8bd5\u903b\u8f91\uff0c\u4e5f\u5c31\u662f\u5728\u88ab\u901a\u77e5\u65b9\u6cd5\u5931\u8d25\u540e\uff0c\u8fdb\u884c\u91cd\u590d\u5c1d\u8bd5\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#_6","title":"\u5904\u7406\u901a\u77e5\u4e2d\u7684\u53c2\u6570","text":"<p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u7684\u5207\u9762\u90fd\u5f88\u7b80\u5355\uff0c\u6ca1\u6709\u4efb\u4f55\u53c2\u6570\u3002\u552f\u4e00\u7684\u4f8b\u5916\u662f\u6211\u4eec\u4e3a\u73af\u7ed5\u901a\u77e5\u6240\u7f16\u5199\u7684watchPerformance()\u793a\u4f8b\u65b9\u6cd5\u4e2d\u4f7f\u7528\u4e86ProceedingJoinPoint\u4f5c\u4e3a\u53c2\u6570\u3002\u9664\u4e86\u73af\u7ed5\u901a\u77e5\uff0c\u6211\u4eec\u7f16\u5199\u7684\u5176\u4ed6\u901a\u77e5\u4e0d\u9700\u8981\u5173\u6ce8\u4f20\u9012\u7ed9\u88ab\u901a\u77e5\u65b9\u6cd5\u7684\u4efb\u610f\u53c2\u6570\u3002\u8fd9\u5f88\u6b63\u5e38\uff0c\u56e0\u4e3a\u6211\u4eec\u6240\u901a\u77e5\u7684perform()\u65b9\u6cd5\u672c\u8eab\u6ca1\u6709\u4efb\u4f55\u53c2\u6570\u3002</p> <p>\u4f46\u662f\uff0c\u5982\u679c\u5207\u9762\u6240\u901a\u77e5\u7684\u65b9\u6cd5\u786e\u5b9e\u6709\u53c2\u6570\u8be5\u600e\u4e48\u529e\u5462\uff1f\u5207\u9762\u80fd\u8bbf\u95ee\u548c\u4f7f\u7528\u4f20\u9012\u7ed9\u88ab\u901a\u77e5\u65b9\u6cd5\u7684\u53c2\u6570\u5417\uff1f</p> <p>\u4e3a\u4e86\u9610\u8ff0\u8fd9\u4e2a\u95ee\u9898\uff0c\u8ba9\u6211\u4eec\u91cd\u65b0\u770b\u4e00\u4e0b2.4.4\u5c0f\u8282\u4e2d\u7684BlankDisc\u6837\u4f8b\u3002play()\u65b9\u6cd5\u4f1a\u5faa\u73af\u6240\u6709\u7684\u78c1\u9053\u5e76\u8c03\u7528playTrack()\u65b9\u6cd5\u3002\u4f46\u662f\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7playTrack()\u65b9\u6cd5\u76f4\u63a5\u64ad\u653e\u67d0\u4e00\u4e2a\u78c1\u9053\u4e2d\u7684\u6b4c\u66f2\u3002</p> <p>\u5047\u8bbe\u4f60\u60f3\u8bb0\u5f55\u6bcf\u4e2a\u78c1\u9053\u88ab\u64ad\u653e\u7684\u6b21\u6570\u3002\u4e00\u79cd\u65b9\u6cd5\u5c31\u662f\u4fee\u6539playTrack()\u65b9\u6cd5\uff0c\u76f4\u63a5\u5728\u6bcf\u6b21\u8c03\u7528\u7684\u65f6\u5019\u8bb0\u5f55\u8fd9\u4e2a\u6570\u91cf\u3002\u4f46\u662f\uff0c\u8bb0\u5f55\u78c1\u9053\u7684\u64ad\u653e\u6b21\u6570\u4e0e\u64ad\u653e\u672c\u8eab\u662f\u4e0d\u540c\u7684\u5173\u6ce8\u70b9\uff0c\u56e0\u6b64\u4e0d\u5e94\u8be5\u5c5e\u4e8eplayTrack()\u65b9\u6cd5\u3002\u770b\u8d77\u6765\uff0c\u8fd9\u5e94\u8be5\u662f\u5207\u9762\u8981\u5b8c\u6210\u7684\u4efb\u52a1\u3002</p> <p>\u4e3a\u4e86\u8bb0\u5f55\u6bcf\u4e2a\u78c1\u9053\u6240\u64ad\u653e\u7684\u6b21\u6570\uff0c\u6211\u4eec\u521b\u5efa\u4e86TrackCounter\u7c7b\uff0c\u5b83\u662f\u901a\u77e5playTrack()\u65b9\u6cd5\u7684\u4e00\u4e2a\u5207\u9762\u3002\u4e0b\u9762\u7684\u7a0b\u5e8f\u6e05\u5355\u5c55\u793a\u4e86\u8fd9\u4e2a\u5207\u9762\u3002</p> <p>\u7a0b\u5e8f\u6e05\u53554.6\u3000\u4f7f\u7528\u53c2\u6570\u5316\u7684\u901a\u77e5\u6765\u8bb0\u5f55\u78c1\u9053\u64ad\u653e\u7684\u6b21\u6570</p> <p></p> <p>\u50cf\u4e4b\u524d\u6240\u521b\u5efa\u7684\u5207\u9762\u4e00\u6837\uff0c\u8fd9\u4e2a\u5207\u9762\u4f7f\u7528@Pointcut\u6ce8\u89e3\u5b9a\u4e49\u547d\u540d\u7684\u5207\u70b9\uff0c\u5e76\u4f7f\u7528@Before\u5c06\u4e00\u4e2a\u65b9\u6cd5\u58f0\u660e\u4e3a\u524d\u7f6e\u901a\u77e5\u3002\u4f46\u662f\uff0c\u8fd9\u91cc\u7684\u4e0d\u540c\u70b9\u5728\u4e8e\u5207\u70b9\u8fd8\u58f0\u660e\u4e86\u8981\u63d0\u4f9b\u7ed9\u901a\u77e5\u65b9\u6cd5\u7684\u53c2\u6570\u3002\u56fe4.6\u5c06\u5207\u70b9\u8868\u8fbe\u5f0f\u8fdb\u884c\u4e86\u5206\u89e3\uff0c\u4ee5\u5c55\u73b0\u53c2\u6570\u662f\u5728\u4ec0\u4e48\u5730\u65b9\u6307\u5b9a\u7684\u3002</p> <p></p> <p>\u56fe4.6\u3000\u5728\u5207\u70b9\u8868\u8fbe\u5f0f\u4e2d\u58f0\u660e\u53c2\u6570\uff0c\u8fd9\u4e2a\u53c2\u6570\u4f20\u5165\u5230\u901a\u77e5\u65b9\u6cd5\u4e2d</p> <p>\u5728\u56fe4.6\u4e2d\u9700\u8981\u5173\u6ce8\u7684\u662f\u5207\u70b9\u8868\u8fbe\u5f0f\u4e2d\u7684args(trackNumber)\u9650\u5b9a\u7b26\u3002\u5b83\u8868\u660e\u4f20\u9012\u7ed9playTrack()\u65b9\u6cd5\u7684int\u7c7b\u578b\u53c2\u6570\u4e5f\u4f1a\u4f20\u9012\u5230\u901a\u77e5\u4e2d\u53bb\u3002\u53c2\u6570\u7684\u540d\u79f0trackNumber\u4e5f\u4e0e\u5207\u70b9\u65b9\u6cd5\u7b7e\u540d\u4e2d\u7684\u53c2\u6570\u76f8\u5339\u914d\u3002</p> <p>\u8fd9\u4e2a\u53c2\u6570\u4f1a\u4f20\u9012\u5230\u901a\u77e5\u65b9\u6cd5\u4e2d\uff0c\u8fd9\u4e2a\u901a\u77e5\u65b9\u6cd5\u662f\u901a\u8fc7@Before\u6ce8\u89e3\u548c\u547d\u540d\u5207\u70b9trackPlayed(trackNumber)\u5b9a\u4e49\u7684\u3002\u5207\u70b9\u5b9a\u4e49\u4e2d\u7684\u53c2\u6570\u4e0e\u5207\u70b9\u65b9\u6cd5\u4e2d\u7684\u53c2\u6570\u540d\u79f0\u662f\u4e00\u6837\u7684\uff0c\u8fd9\u6837\u5c31\u5b8c\u6210\u4e86\u4ece\u547d\u540d\u5207\u70b9\u5230\u901a\u77e5\u65b9\u6cd5\u7684\u53c2\u6570\u8f6c\u79fb\u3002</p> <p>\u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u5728Spring\u914d\u7f6e\u4e2d\u5c06BlankDisc\u548cTrackCounter\u5b9a\u4e49\u4e3abean\uff0c\u5e76\u542f\u7528AspectJ\u81ea\u52a8\u4ee3\u7406\uff0c\u5982\u7a0b\u5e8f\u6e05\u53554.7\u6240\u793a\u3002</p> <p>\u7a0b\u5e8f\u6e05\u53554.7\u3000\u914d\u7f6eTrackCount\u8bb0\u5f55\u6bcf\u4e2a\u78c1\u9053\u64ad\u653e\u7684\u6b21\u6570</p> <p></p> <p>\u6700\u540e\uff0c\u4e3a\u4e86\u8bc1\u660e\u5b83\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u4f60\u53ef\u4ee5\u7f16\u5199\u5982\u4e0b\u7684\u7b80\u5355\u6d4b\u8bd5\u3002\u5b83\u4f1a\u64ad\u653e\u51e0\u4e2a\u78c1\u9053\u5e76\u901a\u8fc7TrackCounter\u65ad\u8a00\u64ad\u653e\u7684\u6570\u91cf\u3002</p> <p>\u7a0b\u5e8f\u6e05\u53554.8\u3000\u6d4b\u8bd5TrackCounter\u5207\u9762</p> <p></p> <p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u5728\u6211\u4eec\u6240\u4f7f\u7528\u7684\u5207\u9762\u4e2d\uff0c\u6240\u5305\u88c5\u7684\u90fd\u662f\u88ab\u901a\u77e5\u5bf9\u8c61\u7684\u5df2\u6709\u65b9\u6cd5\u3002\u4f46\u662f\uff0c\u65b9\u6cd5\u5305\u88c5\u4ec5\u4ec5\u662f\u5207\u9762\u6240\u80fd\u5b9e\u73b0\u7684\u529f\u80fd\u4e4b\u4e00\u3002\u8ba9\u6211\u4eec\u770b\u4e00\u4e0b\u5982\u4f55\u901a\u8fc7\u7f16\u5199\u5207\u9762\uff0c\u4e3a\u88ab\u901a\u77e5\u7684\u5bf9\u8c61\u5f15\u5165\u5168\u65b0\u7684\u529f\u80fd\u3002</p>"},{"location":"2017-10-02-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/#_7","title":"\u901a\u8fc7\u6ce8\u89e3\u5f15\u5165\u65b0\u529f\u80fd","text":"<p>\u4e00\u4e9b\u7f16\u7a0b\u8bed\u8a00\uff0c\u4f8b\u5982Ruby\u548cGroovy\uff0c\u6709\u5f00\u653e\u7c7b\u7684\u7406\u5ff5\u3002\u5b83\u4eec\u53ef\u4ee5\u4e0d\u7528\u76f4\u63a5\u4fee\u6539\u5bf9\u8c61\u6216\u7c7b\u7684\u5b9a\u4e49\u5c31\u80fd\u591f\u4e3a\u5bf9\u8c61\u6216\u7c7b\u589e\u52a0\u65b0\u7684\u65b9\u6cd5\u3002\u4e0d\u8fc7\uff0cJava\u5e76\u4e0d\u662f\u52a8\u6001\u8bed\u8a00\u3002\u4e00\u65e6\u7c7b\u7f16\u8bd1\u5b8c\u6210\u4e86\uff0c\u6211\u4eec\u5c31\u5f88\u96be\u518d\u4e3a\u8be5\u7c7b\u6dfb\u52a0\u65b0\u7684\u529f\u80fd\u4e86\u3002</p> <p>\u4f46\u662f\u5982\u679c\u4ed4\u7ec6\u60f3\u60f3\uff0c\u6211\u4eec\u5728\u672c\u7ae0\u4e2d\u4e0d\u662f\u4e00\u76f4\u5728\u4f7f\u7528\u5207\u9762\u8fd9\u6837\u505a\u5417\uff1f\u5f53\u7136\uff0c\u6211\u4eec\u8fd8\u6ca1\u6709\u4e3a\u5bf9\u8c61\u589e\u52a0\u4efb\u4f55\u65b0\u7684\u65b9\u6cd5\uff0c\u4f46\u662f\u5df2\u7ecf\u4e3a\u5bf9\u8c61\u62e5\u6709\u7684\u65b9\u6cd5\u6dfb\u52a0\u4e86\u65b0\u529f\u80fd\u3002\u5982\u679c\u5207\u9762\u80fd\u591f\u4e3a\u73b0\u6709\u7684\u65b9\u6cd5\u589e\u52a0\u989d\u5916\u7684\u529f\u80fd\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u4e3a\u4e00\u4e2a\u5bf9\u8c61\u589e\u52a0\u65b0\u7684\u65b9\u6cd5\u5462\uff1f\u5b9e\u9645\u4e0a\uff0c\u5229\u7528\u88ab\u79f0\u4e3a\u5f15\u5165\u7684AOP\u6982\u5ff5\uff0c\u5207\u9762\u53ef\u4ee5\u4e3aSpring bean\u6dfb\u52a0\u65b0\u65b9\u6cd5\u3002</p> <p>\u56de\u987e\u4e00\u4e0b\uff0c\u5728Spring\u4e2d\uff0c\u5207\u9762\u53ea\u662f\u5b9e\u73b0\u4e86\u5b83\u4eec\u6240\u5305\u88c5bean\u76f8\u540c\u63a5\u53e3\u7684\u4ee3\u7406\u3002\u5982\u679c\u9664\u4e86\u5b9e\u73b0\u8fd9\u4e9b\u63a5\u53e3\uff0c\u4ee3\u7406\u4e5f\u80fd\u66b4\u9732\u65b0\u63a5\u53e3\u7684\u8bdd\uff0c\u4f1a\u600e\u4e48\u6837\u5462\uff1f\u90a3\u6837\u7684\u8bdd\uff0c\u5207\u9762\u6240\u901a\u77e5\u7684bean\u770b\u8d77\u6765\u50cf\u662f\u5b9e\u73b0\u4e86\u65b0\u7684\u63a5\u53e3\uff0c\u5373\u4fbf\u5e95\u5c42\u5b9e\u73b0\u7c7b\u5e76\u6ca1\u6709\u5b9e\u73b0\u8fd9\u4e9b\u63a5\u53e3\u4e5f\u65e0\u6240\u8c13\u3002\u56fe4.7\u5c55\u793a\u4e86\u5b83\u4eec\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u3002</p> <p></p> <p>\u56fe4.7\u3000\u4f7f\u7528Spring AOP\uff0c\u6211\u4eec\u53ef\u4ee5\u4e3abean\u5f15\u5165\u65b0\u7684\u65b9\u6cd5\u3002\u4ee3\u7406\u62e6\u622a\u8c03\u7528\u5e76\u59d4\u6258\u7ed9\u5b9e\u73b0\u8be5\u65b9\u6cd5\u7684\u5176\u4ed6\u5bf9\u8c61</p> <p>\u6211\u4eec\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5f53\u5f15\u5165\u63a5\u53e3\u7684\u65b9\u6cd5\u88ab\u8c03\u7528\u65f6\uff0c\u4ee3\u7406\u4f1a\u628a\u6b64\u8c03\u7528\u59d4\u6258\u7ed9\u5b9e\u73b0\u4e86\u65b0\u63a5\u53e3\u7684\u67d0\u4e2a\u5176\u4ed6\u5bf9\u8c61\u3002\u5b9e\u9645\u4e0a\uff0c\u4e00\u4e2abean\u7684\u5b9e\u73b0\u88ab\u62c6\u5206\u5230\u4e86\u591a\u4e2a\u7c7b\u4e2d\u3002</p> <p>\u4e3a\u4e86\u9a8c\u8bc1\u8be5\u4e3b\u610f\u80fd\u884c\u5f97\u901a\uff0c\u6211\u4eec\u4e3a\u793a\u4f8b\u4e2d\u7684\u6240\u6709\u7684Performance\u5b9e\u73b0\u5f15\u5165\u4e0b\u9762\u7684Encoreable\u63a5\u53e3\uff1a</p> <pre><code>package concert;\n\npublic interface Encoreable {\nvoid performEncore();\n}\n</code></pre> <p>\u6682\u4e14\u5148\u4e0d\u7ba1Encoreable\u662f\u4e0d\u662f\u4e00\u4e2a\u771f\u6b63\u5b58\u5728\u7684\u5355\u8bcd\uff0c\u6211\u4eec\u9700\u8981\u6709\u4e00\u79cd\u65b9\u5f0f\u5c06\u8fd9\u4e2a\u63a5\u53e3\u5e94\u7528\u5230Performance\u5b9e\u73b0\u4e2d\u3002\u6211\u4eec\u73b0\u5728\u5047\u8bbe\u4f60\u80fd\u591f\u8bbf\u95eePerformance\u7684\u6240\u6709\u5b9e\u73b0\uff0c\u5e76\u5bf9\u5176\u8fdb\u884c\u4fee\u6539\uff0c\u8ba9\u5b83\u4eec\u90fd\u5b9e\u73b0Encoreable\u63a5\u53e3\u3002\u4f46\u662f\uff0c\u4ece\u8bbe\u8ba1\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u8fd9\u5e76\u4e0d\u662f\u6700\u597d\u7684\u505a\u6cd5\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684Performance\u90fd\u662f\u5177\u6709Encoreable\u7279\u6027\u7684\u3002\u53e6\u5916\u4e00\u65b9\u9762\uff0c\u6709\u53ef\u80fd\u65e0\u6cd5\u4fee\u6539\u6240\u6709\u7684Performance\u5b9e\u73b0\uff0c\u5f53\u4f7f\u7528\u7b2c\u4e09\u65b9\u5b9e\u73b0\u5e76\u4e14\u6ca1\u6709\u6e90\u7801\u7684\u65f6\u5019\u66f4\u662f\u5982\u6b64\u3002</p> <p>\u503c\u5f97\u5e86\u5e78\u7684\u662f\uff0c\u501f\u52a9\u4e8eAOP\u7684\u5f15\u5165\u529f\u80fd\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0d\u5fc5\u5728\u8bbe\u8ba1\u4e0a\u59a5\u534f\u6216\u8005\u4fb5\u5165\u6027\u5730\u6539\u53d8\u73b0\u6709\u7684\u5b9e\u73b0\u3002\u4e3a\u4e86\u5b9e\u73b0\u8be5\u529f\u80fd\uff0c\u6211\u4eec\u8981\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5207\u9762\uff1a</p> <pre><code>package concert;\n\nimport org.aspectj.lang.annotation.Aspect;\nimport org.aspectj.lang.annotation.DeclareParents;\n\n@Aspect\npublic class EncoreableIntroducer {\n\n@DeclareParents(value=\"concert.Performance+\",\ndefaultImpl=DefaultEncoreable.class)\npublic static Encoreable encoreable;\n\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0cEncoreableIntroducer\u662f\u4e00\u4e2a\u5207\u9762\u3002\u4f46\u662f\uff0c\u5b83\u4e0e\u6211\u4eec\u4e4b\u524d\u6240\u521b\u5efa\u7684\u5207\u9762\u4e0d\u540c\uff0c\u5b83\u5e76\u6ca1\u6709\u63d0\u4f9b\u524d\u7f6e\u3001\u540e\u7f6e\u6216\u73af\u7ed5\u901a\u77e5\uff0c\u800c\u662f\u901a\u8fc7@DeclareParents\u6ce8\u89e3\uff0c\u5c06Encoreable\u63a5\u53e3\u5f15\u5165\u5230Performance bean\u4e2d\u3002</p> <p>@DeclareParents\u6ce8\u89e3\u7531\u4e09\u90e8\u5206\u7ec4\u6210\uff1a</p> <ul> <li><code>value</code>\u5c5e\u6027\u6307\u5b9a\u4e86\u54ea\u79cd\u7c7b\u578b\u7684bean\u8981\u5f15\u5165\u8be5\u63a5\u53e3\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u4e5f\u5c31\u662f\u6240\u6709\u5b9e\u73b0Performance\u7684\u7c7b\u578b\u3002\uff08\u6807\u8bb0\u7b26\u540e\u9762\u7684\u52a0\u53f7\u8868\u793a\u662fPerformance\u7684\u6240\u6709\u5b50\u7c7b\u578b\uff0c\u800c\u4e0d\u662fPerformance\u672c\u8eab\u3002\uff09</li> <li><code>defaultImpl</code>\u5c5e\u6027\u6307\u5b9a\u4e86\u4e3a\u5f15\u5165\u529f\u80fd\u63d0\u4f9b\u5b9e\u73b0\u7684\u7c7b\u3002\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u6307\u5b9a\u7684\u662fDefaultEncoreable\u63d0\u4f9b\u5b9e\u73b0\u3002</li> <li><code>@DeclareParents</code>\u6ce8\u89e3\u6240\u6807\u6ce8\u7684\u9759\u6001\u5c5e\u6027\u6307\u660e\u4e86\u8981\u5f15\u5165\u4e86\u63a5\u53e3\u3002\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u6240\u5f15\u5165\u7684\u662fEncoreable\u63a5\u53e3\u3002</li> </ul> <p>\u548c\u5176\u4ed6\u7684\u5207\u9762\u4e00\u6837\uff0c\u6211\u4eec\u9700\u8981\u5728Spring\u5e94\u7528\u4e2d\u5c06<code>EncoreableIntroducer</code>\u58f0\u660e\u4e3a\u4e00\u4e2abean\uff1a</p> <pre><code>&lt;bean class=\"concert.EncoreableIntroducer\" /&gt;\n</code></pre> <p>Spring\u7684\u81ea\u52a8\u4ee3\u7406\u673a\u5236\u5c06\u4f1a\u83b7\u53d6\u5230\u5b83\u7684\u58f0\u660e\uff0c\u5f53Spring\u53d1\u73b0\u4e00\u4e2abean\u4f7f\u7528\u4e86@Aspect\u6ce8\u89e3\u65f6\uff0cSpring\u5c31\u4f1a\u521b\u5efa\u4e00\u4e2a\u4ee3\u7406\uff0c\u7136\u540e\u5c06\u8c03\u7528\u59d4\u6258\u7ed9\u88ab\u4ee3\u7406\u7684bean\u6216\u88ab\u5f15\u5165\u7684\u5b9e\u73b0\uff0c\u8fd9\u53d6\u51b3\u4e8e\u8c03\u7528\u7684\u65b9\u6cd5\u5c5e\u4e8e\u88ab\u4ee3\u7406\u7684bean\u8fd8\u662f\u5c5e\u4e8e\u88ab\u5f15\u5165\u7684\u63a5\u53e3\u3002</p> <p>\u5728Spring\u4e2d\uff0c\u6ce8\u89e3\u548c\u81ea\u52a8\u4ee3\u7406\u63d0\u4f9b\u4e86\u4e00\u79cd\u5f88\u4fbf\u5229\u7684\u65b9\u5f0f\u6765\u521b\u5efa\u5207\u9762\u3002\u5b83\u975e\u5e38\u7b80\u5355\uff0c\u5e76\u4e14\u53ea\u6d89\u53ca\u5230\u6700\u5c11\u7684Spring\u914d\u7f6e\u3002\u4f46\u662f\uff0c\u9762\u5411\u6ce8\u89e3\u7684\u5207\u9762\u58f0\u660e\u6709\u4e00\u4e2a\u660e\u663e\u7684\u52a3\u52bf\uff1a\u4f60\u5fc5\u987b\u80fd\u591f\u4e3a\u901a\u77e5\u7c7b\u6dfb\u52a0\u6ce8\u89e3\u3002\u4e3a\u4e86\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u5fc5\u987b\u8981\u6709\u6e90\u7801\u3002</p>"},{"location":"2017-10-27-Logback%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F%E8%AE%BE%E5%AE%9A/","title":"2017 10 27 Logback\u65e5\u5fd7\u683c\u5f0f\u8bbe\u5b9a","text":""},{"location":"2017-10-27-Logback%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F%E8%AE%BE%E5%AE%9A/#1","title":"1 \u8bbe\u5b9a","text":"<p>\u5728<code>logback-spring.xml</code>\u4e2d\u8bbe\u7f6e\u9644\u52a0\u5668\uff1a</p> <pre><code>&lt;appender name=\"MY_APPENDER\" class=\"ch.qos.logback.core.ConsoleAppender\"&gt;\n&lt;encoder&gt;\n&lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} - %msg%n&lt;/pattern&gt;\n&lt;charset&gt;utf8&lt;/charset&gt;\n&lt;/encoder&gt;\n&lt;/appender&gt;\n</code></pre> <p>\u4fee\u6539\u540e\u7684\u65e5\u5fd7\u914d\u7f6e\u6587\u4ef6\u4e3a:</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n&lt;configuration&gt;\n&lt;include resource=\"org/springframework/boot/logging/logback/defaults.xml\"/&gt;\n&lt;property name=\"LOG_FILE\" value=\"${LOG_FILE:-${LOG_PATH:-${LOG_TEMP:-${java.io.tmpdir:-/tmp}}}/omts-cloud-service.log}\"/&gt;\n\n&lt;appender name=\"DAILY_ROLLING\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\"&gt;\n&lt;File&gt;${LOG_FILE}&lt;/File&gt;\n&lt;rollingPolicy class=\"ch.qos.logback.core.rolling.TimeBasedRollingPolicy\"&gt;\n&lt;FileNamePattern&gt;${LOG_FILE}-%d{yyyy-MM-dd}.log&lt;/FileNamePattern&gt;\n&lt;maxHistory&gt;60&lt;/maxHistory&gt;\n&lt;/rollingPolicy&gt;\n&lt;encoder&gt;\n&lt;Pattern&gt;${FILE_LOG_PATTERN}&lt;/Pattern&gt;\n&lt;/encoder&gt;\n&lt;/appender&gt;\n\n&lt;appender name=\"MY_APPENDER\" class=\"ch.qos.logback.core.ConsoleAppender\"&gt;\n&lt;encoder&gt;\n&lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} - %msg%n&lt;/pattern&gt;\n&lt;charset&gt;utf8&lt;/charset&gt;\n&lt;/encoder&gt;\n&lt;/appender&gt;\n\n&lt;root level=\"INFO\"&gt;\n&lt;appender-ref ref=\"DAILY_ROLLING\"/&gt;\n&lt;appender-ref ref=\"MY_APPENDER\"/&gt;\n&lt;/root&gt;\n\n&lt;/configuration&gt;\n</code></pre> <p>\u4fee\u6539\u540e\uff0c\u5f97\u5230\u7684\u65e5\u5fd7\u4f8b\u5982\uff1a</p> <pre><code>2017-10-27 10:24:01.704 - Starting Servlet Engine: Apache Tomcat/8.5.23\n</code></pre>"},{"location":"2017-10-27-Logback%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F%E8%AE%BE%E5%AE%9A/#2","title":"2 \u53c2\u8003","text":"<ul> <li>https://www.mkyong.com/logging/logback-xml-example/</li> <li>https://logback.qos.ch/documentation.html</li> </ul>"},{"location":"2017-11-01-Spring%E6%A1%86%E6%9E%B6%EF%BC%9A%E6%B3%A8%E5%85%A5AspectJ%E5%88%87%E9%9D%A2/","title":"2017 11 01 Spring\u6846\u67b6\uff1a\u6ce8\u5165AspectJ\u5207\u9762","text":"<p>\u867d\u7136Spring AOP\u80fd\u591f\u6ee1\u8db3\u8bb8\u591a\u5e94\u7528\u7684\u5207\u9762\u9700\u6c42\uff0c\u4f46\u662f\u4e0eAspectJ\u76f8\u6bd4\uff0cSpring AOP \u662f\u4e00\u4e2a\u529f\u80fd\u6bd4\u8f83\u5f31\u7684AOP\u89e3\u51b3\u65b9\u6848\u3002AspectJ\u63d0\u4f9b\u4e86Spring AOP\u6240\u4e0d\u80fd\u652f\u6301\u7684\u8bb8\u591a\u7c7b\u578b\u7684\u5207\u70b9\u3002</p> <p>\u4f8b\u5982\uff0c\u5f53\u6211\u4eec\u9700\u8981\u5728\u521b\u5efa\u5bf9\u8c61\u65f6\u5e94\u7528\u901a\u77e5\uff0c\u6784\u9020\u5668\u5207\u70b9\u5c31\u975e\u5e38\u65b9\u4fbf\u3002\u4e0d\u50cf\u67d0\u4e9b\u5176\u4ed6\u9762\u5411\u5bf9\u8c61\u8bed\u8a00\u4e2d\u7684\u6784\u9020\u5668\uff0cJava\u6784\u9020\u5668\u4e0d\u540c\u4e8e\u5176\u4ed6\u7684\u6b63\u5e38\u65b9\u6cd5\u3002\u8fd9\u4f7f\u5f97Spring\u57fa\u4e8e\u4ee3\u7406\u7684AOP\u65e0\u6cd5\u628a\u901a\u77e5\u5e94\u7528\u4e8e\u5bf9\u8c61\u7684\u521b\u5efa\u8fc7\u7a0b\u3002</p> <p>\u5bf9\u4e8e\u5927\u90e8\u5206\u529f\u80fd\u6765\u8bb2\uff0cAspectJ\u5207\u9762\u4e0eSpring\u662f\u76f8\u4e92\u72ec\u7acb\u7684\u3002\u867d\u7136\u5b83\u4eec\u53ef\u4ee5\u7ec7\u5165\u5230\u4efb\u610f\u7684Java\u5e94\u7528\u4e2d\uff0c\u8fd9\u4e5f\u5305\u62ec\u4e86Spring\u5e94\u7528\uff0c\u4f46\u662f\u5728\u5e94\u7528AspectJ\u5207\u9762\u65f6\u51e0\u4e4e\u4e0d\u4f1a\u6d89\u53ca\u5230Spring\u3002</p> <p>\u4f46\u662f\u7cbe\u5fc3\u8bbe\u8ba1\u4e14\u6709\u610f\u4e49\u7684\u5207\u9762\u5f88\u53ef\u80fd\u4f9d\u8d56\u5176\u4ed6\u7c7b\u6765\u5b8c\u6210\u5b83\u4eec\u7684\u5de5\u4f5c\u3002\u5982\u679c\u5728\u6267\u884c\u901a\u77e5\u65f6\uff0c\u5207\u9762\u4f9d\u8d56\u4e8e\u4e00\u4e2a\u6216\u591a\u4e2a\u7c7b\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u5207\u9762\u5185\u90e8\u5b9e\u4f8b\u5316\u8fd9\u4e9b\u534f\u4f5c\u7684\u5bf9\u8c61\u3002\u4f46\u66f4\u597d\u7684\u65b9\u5f0f\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9Spring\u7684\u4f9d\u8d56\u6ce8\u5165\u628abean\u88c5\u914d\u8fdbAspectJ\u5207\u9762\u4e2d\u3002</p> <p>\u4e3a\u4e86\u6f14\u793a\uff0c\u6211\u4eec\u4e3a\u4e0a\u9762\u7684\u6f14\u51fa\u521b\u5efa\u4e00\u4e2a\u65b0\u5207\u9762\u3002\u5177\u4f53\u6765\u8bb2\uff0c\u6211\u4eec\u4ee5\u5207\u9762\u7684\u65b9\u5f0f\u521b\u5efa\u4e00\u4e2a\u8bc4\u8bba\u5458\u7684\u89d2\u8272\uff0c\u4ed6\u4f1a\u89c2\u770b\u6f14\u51fa\u5e76\u4e14\u4f1a\u5728\u6f14\u51fa\u4e4b\u540e\u63d0\u4f9b\u4e00\u4e9b\u6279\u8bc4\u610f\u89c1\u3002\u4e0b\u9762\u7684CriticAspect\u5c31\u662f\u4e00\u4e2a\u8fd9\u6837\u7684\u5207\u9762\u3002</p> <p>\u7a0b\u5e8f\u6e05\u53554.15\u3000\u4f7f\u7528AspectJ\u5b9e\u73b0\u8868\u6f14\u7684\u8bc4\u8bba\u5458</p> <p></p> <p>CriticAspect\u7684\u4e3b\u8981\u804c\u8d23\u662f\u5728\u8868\u6f14\u7ed3\u675f\u540e\u4e3a\u8868\u6f14\u53d1\u8868\u8bc4\u8bba\u3002\u7a0b\u5e8f\u6e05\u53554.15\u4e2d\u7684performance()\u5207\u70b9\u5339\u914dperform()\u65b9\u6cd5\u3002\u5f53\u5b83\u4e0eafterReturning()\u901a\u77e5\u4e00\u8d77\u914d\u5408\u4f7f\u7528\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9\u8be5\u5207\u9762\u5728\u8868\u6f14\u7ed3\u675f\u65f6\u8d77\u4f5c\u7528\u3002</p> <p>\u7a0b\u5e8f\u6e05\u53554.15\u6709\u8da3\u7684\u5730\u65b9\u5728\u4e8e\u5e76\u4e0d\u662f\u8bc4\u8bba\u5458\u81ea\u5df1\u53d1\u8868\u8bc4\u8bba\uff0c\u5b9e\u9645\u4e0a\uff0cCriticAspect\u4e0e\u4e00\u4e2aCriticismEngine\u5bf9\u8c61\u76f8\u534f\u4f5c\uff0c\u5728\u8868\u6f14\u7ed3\u675f\u65f6\uff0c\u8c03\u7528\u8be5\u5bf9\u8c61\u7684getCriticism()\u65b9\u6cd5\u6765\u53d1\u8868\u4e00\u4e2a\u82db\u523b\u7684\u8bc4\u8bba\u3002\u4e3a\u4e86\u907f\u514dCriticAspect\u548cCriticismEngine\u4e4b\u95f4\u4ea7\u751f\u4e0d\u5fc5\u8981\u7684\u8026\u5408\uff0c\u6211\u4eec\u901a\u8fc7Setter\u4f9d\u8d56\u6ce8\u5165\u4e3aCriticAspect\u8bbe\u7f6eCriticismEngine\u3002\u56fe4.9\u5c55\u793a\u4e86\u6b64\u5173\u7cfb\u3002</p> <p></p> <p>\u56fe4.9\u3000\u5207\u9762\u4e5f\u9700\u8981\u6ce8\u5165\u3002\u50cf\u5176\u4ed6\u7684bean\u4e00\u6837\uff0cSpring\u53ef\u4ee5\u4e3aAspectJ\u5207\u9762\u6ce8\u5165\u4f9d\u8d56</p> <p>CriticismEngine\u81ea\u8eab\u662f\u58f0\u660e\u4e86\u4e00\u4e2a\u7b80\u5355getCriticism()\u65b9\u6cd5\u7684\u63a5\u53e3\u3002\u7a0b\u5e8f\u6e05\u53554.16\u4e3aCriticismEngine\u7684\u5b9e\u73b0\u3002</p> <p>\u7a0b\u5e8f\u6e05\u53554.16\u3000\u8981\u6ce8\u5165\u5230CriticAspect\u4e2d\u7684CriticismEngine\u5b9e\u73b0</p> <pre><code>package com.springinaction.springidol;\npublic class CriticismEngineImpl implements CriticismEngine {\npublic CriticismEngineImpl() {}\n\npublic String getCriticism() {\nint i = (int) (Math.random() * criticismPool.length);\nreturn criticismPool[i];\n}\n\n// injected\nprivate String[] criticismPool;\npublic void setCriticismPool(String[] criticismPool) {\nthis.criticismPool = criticismPool;\n}\n}\n</code></pre> <p>CriticismEngineImpl\u5b9e\u73b0\u4e86CriticismEngine\u63a5\u53e3\uff0c\u901a\u8fc7\u4ece\u6ce8\u5165\u7684\u8bc4\u8bba\u6c60\u4e2d\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u82db\u523b\u7684\u8bc4\u8bba\u3002\u8fd9\u4e2a\u7c7b\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u7684XML\u58f0\u660e\u4e3a\u4e00\u4e2aSpring bean\u3002</p> <pre><code>&lt;bean id=\"criticismEngine\"\nclass=\"com.springinaction.springidol.CriticismEngineImpl\"&gt;\n&lt;property name=\"criticisms\"&gt;\n&lt;list&gt;\n&lt;value&gt;Worst performance ever!&lt;/value&gt;\n&lt;value&gt;I laughed, I cried, then I realized I was at the\n             wrong show.&lt;/value&gt;\n&lt;value&gt;A must see show!&lt;/value&gt;\n&lt;/list&gt;\n&lt;/property&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u4e00\u5207\u987a\u5229\u3002\u6211\u4eec\u73b0\u5728\u6709\u4e86\u4e00\u4e2a\u8981\u8d4b\u4e88CriticAspect\u7684Criticism-Engine\u5b9e\u73b0\u3002\u5269\u4e0b\u7684\u5c31\u662f\u4e3aCriticAspect\u88c5\u914dCriticismEngineImple\u3002</p> <p>\u5728\u5c55\u793a\u5982\u4f55\u5b9e\u73b0\u6ce8\u5165\u4e4b\u524d\uff0c\u6211\u4eec\u5fc5\u987b\u6e05\u695aAspectJ\u5207\u9762\u6839\u672c\u4e0d\u9700\u8981Spring\u5c31\u53ef\u4ee5\u7ec7\u5165\u5230\u6211\u4eec\u7684\u5e94\u7528\u4e2d\u3002\u5982\u679c\u60f3\u4f7f\u7528Spring\u7684\u4f9d\u8d56\u6ce8\u5165\u4e3aAspectJ\u5207\u9762\u6ce8\u5165\u534f\u4f5c\u8005\uff0c\u90a3\u6211\u4eec\u5c31\u9700\u8981\u5728Spring\u914d\u7f6e\u4e2d\u628a\u5207\u9762\u58f0\u660e\u4e3a\u4e00\u4e2aSpring\u914d\u7f6e\u4e2d\u7684<code>&lt;bean&gt;</code>\u3002\u5982\u4e0b\u7684<code>&lt;bean&gt;</code>\u58f0\u660e\u4f1a\u628acriticismEnginebean\u6ce8\u5165\u5230CriticAspect\u4e2d\uff1a</p> <pre><code>&lt;bean class=\"com.springinaction.springidol.CriticAspect\"\nfactory-method=\"aspectOf\"&gt;\n&lt;property name=\"criticismEngine\" ref=\"criticismEngine\" /&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u5f88\u5927\u7a0b\u5ea6\u4e0a\uff0c<code>&lt;bean&gt;</code>\u7684\u58f0\u660e\u4e0e\u6211\u4eec\u5728Spring\u4e2d\u6240\u770b\u5230\u7684\u5176\u4ed6<code>&lt;bean&gt;</code>\u914d\u7f6e\u5e76\u6ca1\u6709\u592a\u591a\u7684\u533a\u522b\uff0c\u4f46\u662f\u6700\u5927\u7684\u4e0d\u540c\u5728\u4e8e\u4f7f\u7528\u4e86factory-method\u5c5e\u6027\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0cSpring bean\u7531Spring\u5bb9\u5668\u521d\u59cb\u5316\uff0c\u4f46\u662fAspectJ\u5207\u9762\u662f\u7531AspectJ\u5728\u8fd0\u884c\u671f\u521b\u5efa\u7684\u3002\u7b49\u5230Spring\u6709\u673a\u4f1a\u4e3aCriticAspect\u6ce8\u5165CriticismEngine\u65f6\uff0cCriticAspect\u5df2\u7ecf\u88ab\u5b9e\u4f8b\u5316\u4e86\u3002</p> <p>\u56e0\u4e3aSpring\u4e0d\u80fd\u8d1f\u8d23\u521b\u5efaCriticAspect\uff0c\u90a3\u5c31\u4e0d\u80fd\u5728 Spring\u4e2d\u7b80\u5355\u5730\u628aCriticAspect\u58f0\u660e\u4e3a\u4e00\u4e2abean\u3002\u76f8\u53cd\uff0c\u6211\u4eec\u9700\u8981\u4e00\u79cd\u65b9\u5f0f\u4e3aSpring\u83b7\u5f97\u5df2\u7ecf\u7531AspectJ\u521b\u5efa\u7684CriticAspect\u5b9e\u4f8b\u7684\u53e5\u67c4\uff0c\u4ece\u800c\u53ef\u4ee5\u6ce8\u5165CriticismEngine\u3002\u5e78\u597d\uff0c\u6240\u6709\u7684AspectJ\u5207\u9762\u90fd\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9759\u6001\u7684aspectOf()\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u8fd4\u56de\u5207\u9762\u7684\u4e00\u4e2a\u5355\u4f8b\u3002\u6240\u4ee5\u4e3a\u4e86\u83b7\u5f97\u5207\u9762\u7684\u5b9e\u4f8b\uff0c\u6211\u4eec\u5fc5\u987b\u4f7f\u7528factory-method\u6765\u8c03\u7528asepctOf()\u65b9\u6cd5\u800c\u4e0d\u662f\u8c03\u7528CriticAspect\u7684\u6784\u9020\u5668\u65b9\u6cd5\u3002</p> <p>\u7b80\u800c\u8a00\u4e4b\uff0cSpring\u4e0d\u80fd\u50cf\u4e4b\u524d\u90a3\u6837\u4f7f\u7528<code>&lt;bean&gt;</code>\u58f0\u660e\u6765\u521b\u5efa\u4e00\u4e2aCriticAspect\u5b9e\u4f8b\u2014\u2014\u5b83\u5df2\u7ecf\u5728\u8fd0\u884c\u65f6\u7531AspectJ\u521b\u5efa\u5b8c\u6210\u4e86\u3002Spring\u9700\u8981\u901a\u8fc7aspectOf()\u5de5\u5382\u65b9\u6cd5\u83b7\u5f97\u5207\u9762\u7684\u5f15\u7528\uff0c\u7136\u540e\u50cf<code>&lt;bean&gt;</code>\u5143\u7d20\u89c4\u5b9a\u7684\u90a3\u6837\u5728\u8be5\u5bf9\u8c61\u4e0a\u6267\u884c\u4f9d\u8d56\u6ce8\u5165\u3002</p>"},{"location":"2017-11-09-%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8FC%E8%AF%AD%E8%A8%80%E9%80%92%E5%BD%92%E5%AE%9E%E7%8E%B0/","title":"2017 11 09 \u5feb\u901f\u6392\u5e8fC\u8bed\u8a00\u9012\u5f52\u5b9e\u73b0","text":"<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#define SIZE 10\n\nvoid quick_sort(int a[], int lo, int hi) {\n    if (lo &lt; hi) {\n        int i = partition(a, lo, hi);\n        quick_sort(a, lo, i - 1);\n        quick_sort(a, i + 1, hi);\n    }\n}\n\nint partition(int a[], int lo, int hi) {\n    int pivot, i, j, t;\n    pivot = a[lo];\n    i = lo;\n    j = hi + 1;\n\n    while(1) {\n        do ++i; while(a[i] &lt;= pivot &amp;&amp; i &lt;= hi);\n        do --j; while(a[j] &gt; pivot);\n        if (i &gt;= j) break;\n\n        t = a[i], a[i] = a[j], a[j] = t;\n    }\n\n    t = a[lo], a[lo] = a[j], a[j] = t;\n    return j;\n}\n\nint main(){\n    int array[SIZE] = {5, 4, 3, 1, -1, -3, 0, 10, 9, 8};\n    quick_sort(array, 0, SIZE - 1);\n\n    int i;\n    for(i = 0; i &lt; SIZE; ++i)\n        printf(\"%d\\n\", array[i]);\n    return EXIT_SUCCESS;\n}\n</code></pre>"},{"location":"2017-11-18-Spring%E6%A1%86%E6%9E%B6%EF%BC%9ASpring%20MVC%E8%B5%B7%E6%AD%A5/","title":"Spring\u6846\u67b6\uff1aSpring MVC\u8d77\u6b65","text":"<p>\u4f60\u89c1\u5230\u8fc7\u5b69\u5b50\u4eec\u7684\u6355\u9f20\u5668\u6e38\u620f\u5417\uff1f\u8fd9\u771f\u662f\u4e00\u4e2a\u75af\u72c2\u7684\u6e38\u620f\uff0c\u5b83\u7684\u76ee\u6807\u662f\u53d1\u9001\u4e00\u4e2a\u5c0f\u94a2\u7403\uff0c\u8ba9\u5b83\u7ecf\u8fc7\u4e00\u7cfb\u5217\u7a00\u5947\u53e4\u602a\u7684\u88c5\u7f6e\uff0c\u6700\u540e\u89e6\u53d1\u6355\u9f20\u5668\u3002\u5c0f\u94a2\u7403\u7a7f\u8fc7\u5404\u79cd\u590d\u6742\u7684\u914d\u4ef6\uff0c\u4ece\u4e00\u4e2a\u659c\u5761\u4e0a\u6eda\u4e0b\u6765\uff0c\u88ab\u8df7\u8df7\u677f\u5f39\u8d77\uff0c\u7ed5\u8fc7\u4e00\u4e2a\u5fae\u578b\u6469\u5929\u8f6e\uff0c\u7136\u540e\u88ab\u6a61\u80f6\u9774\u4ece\u6876\u4e2d\u8e22\u51fa\u53bb\u3002\u7ecf\u8fc7\u8fd9\u4e9b\u540e\uff0c\u5c0f\u94a2\u7403\u4f1a\u5bf9\u90a3\u53ea\u53ef\u601c\u53c8\u65e0\u8f9c\u7684\u6a61\u80f6\u8001\u9f20\u8fdb\u884c\u6355\u83b7\u3002</p> <p>\u4e4d\u770b\u4e0a\u53bb\uff0c\u4f60\u4f1a\u8ba4\u4e3aSpring MVC\u6846\u67b6\u4e0e\u6355\u9f20\u5668\u6709\u4e9b\u7c7b\u4f3c\u3002Spring\u5c06\u8bf7\u6c42\u5728\u8c03\u5ea6Servlet\u3001\u5904\u7406\u5668\u6620\u5c04\uff08handler mapping\uff09\u3001\u63a7\u5236\u5668\u4ee5\u53ca\u89c6\u56fe\u89e3\u6790\u5668\uff08view resolver\uff09\u4e4b\u95f4\u79fb\u52a8\uff0c\u800c\u6355\u9f20\u5668\u4e2d\u7684\u94a2\u7403\u5219\u4f1a\u5728\u5404\u79cd\u659c\u5761\u3001\u8df7\u8df7\u677f\u4ee5\u53ca\u6469\u5929\u8f6e\u4e4b\u95f4\u6eda\u52a8\u3002\u4f46\u662f\uff0c\u4e0d\u8981\u5c06Spring MVC\u4e0eRube Goldberg-esque\u6355\u9f20\u5668\u6e38\u620f\u505a\u8fc7\u591a\u6bd4\u8f83\u3002\u6bcf\u4e00\u4e2aSpring MVC\u4e2d\u7684\u7ec4\u4ef6\u90fd\u6709\u7279\u5b9a\u7684\u76ee\u7684\uff0c\u5e76\u4e14\u5b83\u4e5f\u6ca1\u6709\u90a3\u4e48\u590d\u6742\u3002</p> <p>\u8ba9\u6211\u4eec\u770b\u4e00\u4e0b\u8bf7\u6c42\u662f\u5982\u4f55\u4ece\u5ba2\u6237\u7aef\u53d1\u8d77\uff0c\u7ecf\u8fc7Spring MVC\u4e2d\u7684\u7ec4\u4ef6\uff0c\u6700\u7ec8\u518d\u8fd4\u56de\u5230\u5ba2\u6237\u7aef\u7684\u3002</p>"},{"location":"2017-11-18-Spring%E6%A1%86%E6%9E%B6%EF%BC%9ASpring%20MVC%E8%B5%B7%E6%AD%A5/#spring-mvc","title":"\u8ddf\u8e2aSpring MVC\u7684\u8bf7\u6c42","text":"<p>\u6bcf\u5f53\u7528\u6237\u5728Web\u6d4f\u89c8\u5668\u4e2d\u70b9\u51fb\u94fe\u63a5\u6216\u63d0\u4ea4\u8868\u5355\u7684\u65f6\u5019\uff0c\u8bf7\u6c42\u5c31\u5f00\u59cb\u5de5\u4f5c\u4e86\u3002\u5bf9\u8bf7\u6c42\u7684\u5de5\u4f5c\u63cf\u8ff0\u5c31\u50cf\u662f\u5feb\u9012\u6295\u9001\u5458\u3002\u4e0e\u90ae\u5c40\u6295\u9012\u5458\u6216FedEx\u6295\u9001\u5458\u4e00\u6837\uff0c\u8bf7\u6c42\u4f1a\u5c06\u4fe1\u606f\u4ece\u4e00\u4e2a\u5730\u65b9\u5e26\u5230\u53e6\u4e00\u4e2a\u5730\u65b9\u3002</p> <p>\u8bf7\u6c42\u662f\u4e00\u4e2a\u5341\u5206\u7e41\u5fd9\u7684\u5bb6\u4f19\u3002\u4ece\u79bb\u5f00\u6d4f\u89c8\u5668\u5f00\u59cb\u5230\u83b7\u53d6\u54cd\u5e94\u8fd4\u56de\uff0c\u5b83\u4f1a\u7ecf\u5386\u597d\u591a\u7ad9\uff0c\u5728\u6bcf\u7ad9\u90fd\u4f1a\u7559\u4e0b\u4e00\u4e9b\u4fe1\u606f\u540c\u65f6\u4e5f\u4f1a\u5e26\u4e0a\u5176\u4ed6\u4fe1\u606f\u3002\u56fe5.1\u5c55\u793a\u4e86\u8bf7\u6c42\u4f7f\u7528Spring MVC\u6240\u7ecf\u5386\u7684\u6240\u6709\u7ad9\u70b9\u3002</p> <p></p> <p>\u5728\u8bf7\u6c42\u79bb\u5f00\u6d4f\u89c8\u5668\u65f6(1)\uff0c\u4f1a\u5e26\u6709\u7528\u6237\u6240\u8bf7\u6c42\u5185\u5bb9\u7684\u4fe1\u606f\uff0c\u81f3\u5c11\u4f1a\u5305\u542b\u8bf7\u6c42\u7684URL\u3002\u4f46\u662f\u8fd8\u53ef\u80fd\u5e26\u6709\u5176\u4ed6\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u7528\u6237\u63d0\u4ea4\u7684\u8868\u5355\u4fe1\u606f\u3002</p> <p>\u8bf7\u6c42\u65c5\u7a0b\u7684\u7b2c\u4e00\u7ad9\u662fSpring\u7684DispatcherServlet\u3002\u4e0e\u5927\u591a\u6570\u57fa\u4e8eJava\u7684Web\u6846\u67b6\u4e00\u6837\uff0cSpring MVC\u6240\u6709\u7684\u8bf7\u6c42\u90fd\u4f1a\u901a\u8fc7\u4e00\u4e2a\u524d\u7aef\u63a7\u5236\u5668\uff08front controller\uff09Servlet\u3002\u524d\u7aef\u63a7\u5236\u5668\u662f\u5e38\u7528\u7684Web\u5e94\u7528\u7a0b\u5e8f\u6a21\u5f0f\uff0c\u5728\u8fd9\u91cc\u4e00\u4e2a\u5355\u5b9e\u4f8b\u7684Servlet\u5c06\u8bf7\u6c42\u59d4\u6258\u7ed9\u5e94\u7528\u7a0b\u5e8f\u7684\u5176\u4ed6\u7ec4\u4ef6\u6765\u6267\u884c\u5b9e\u9645\u7684\u5904\u7406\u3002\u5728Spring MVC\u4e2d\uff0cDispatcherServlet\u5c31\u662f\u524d\u7aef\u63a7\u5236\u5668\u3002</p> <p>DispatcherServlet\u7684\u4efb\u52a1\u662f\u5c06\u8bf7\u6c42\u53d1\u9001\u7ed9Spring MVC\u63a7\u5236\u5668\uff08controller\uff09\u3002\u63a7\u5236\u5668\u662f\u4e00\u4e2a\u7528\u4e8e\u5904\u7406\u8bf7\u6c42\u7684Spring\u7ec4\u4ef6\u3002\u5728\u5178\u578b\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u53ef\u80fd\u4f1a\u6709\u591a\u4e2a\u63a7\u5236\u5668\uff0cDispatcherServlet\u9700\u8981\u77e5\u9053\u5e94\u8be5\u5c06\u8bf7\u6c42\u53d1\u9001\u7ed9\u54ea\u4e2a\u63a7\u5236\u5668\u3002\u6240\u4ee5DispatcherServlet\u4ee5\u4f1a\u67e5\u8be2\u4e00\u4e2a\u6216\u591a\u4e2a\u5904\u7406\u5668\u6620\u5c04\uff08handler mapping\uff09(2)\u6765\u786e\u5b9a\u8bf7\u6c42\u7684\u4e0b\u4e00\u7ad9\u5728\u54ea\u91cc\u3002\u5904\u7406\u5668\u6620\u5c04\u4f1a\u6839\u636e\u8bf7\u6c42\u6240\u643a\u5e26\u7684URL\u4fe1\u606f\u6765\u8fdb\u884c\u51b3\u7b56\u3002</p> <p>\u4e00\u65e6\u9009\u62e9\u4e86\u5408\u9002\u7684\u63a7\u5236\u5668\uff0cDispatcherServlet\u4f1a\u5c06\u8bf7\u6c42\u53d1\u9001\u7ed9\u9009\u4e2d\u7684\u63a7\u5236\u5668(3)\u3002\u5230\u4e86\u63a7\u5236\u5668\uff0c\u8bf7\u6c42\u4f1a\u5378\u4e0b\u5176\u8d1f\u8f7d\uff08\u7528\u6237\u63d0\u4ea4\u7684\u4fe1\u606f\uff09\u5e76\u8010\u5fc3\u7b49\u5f85\u63a7\u5236\u5668\u5904\u7406\u8fd9\u4e9b\u4fe1\u606f\u3002\uff08\u5b9e\u9645\u4e0a\uff0c\u8bbe\u8ba1\u826f\u597d\u7684\u63a7\u5236\u5668\u672c\u8eab\u53ea\u5904\u7406\u5f88\u5c11\u751a\u81f3\u4e0d\u5904\u7406\u5de5\u4f5c\uff0c\u800c\u662f\u5c06\u4e1a\u52a1\u903b\u8f91\u59d4\u6258\u7ed9\u4e00\u4e2a\u6216\u591a\u4e2a\u670d\u52a1\u5bf9\u8c61\u8fdb\u884c\u5904\u7406\u3002\uff09</p> <p>\u63a7\u5236\u5668\u5728\u5b8c\u6210\u903b\u8f91\u5904\u7406\u540e\uff0c\u901a\u5e38\u4f1a\u4ea7\u751f\u4e00\u4e9b\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u9700\u8981\u8fd4\u56de\u7ed9\u7528\u6237\u5e76\u5728\u6d4f\u89c8\u5668\u4e0a\u663e\u793a\u3002\u8fd9\u4e9b\u4fe1\u606f\u88ab\u79f0\u4e3a\u6a21\u578b\uff08model\uff09\u3002\u4e0d\u8fc7\u4ec5\u4ec5\u7ed9\u7528\u6237\u8fd4\u56de\u539f\u59cb\u7684\u4fe1\u606f\u662f\u4e0d\u591f\u7684\u2014\u2014\u8fd9\u4e9b\u4fe1\u606f\u9700\u8981\u4ee5\u7528\u6237\u53cb\u597d\u7684\u65b9\u5f0f\u8fdb\u884c\u683c\u5f0f\u5316\uff0c\u4e00\u822c\u4f1a\u662fHTML\u3002\u6240\u4ee5\uff0c\u4fe1\u606f\u9700\u8981\u53d1\u9001\u7ed9\u4e00\u4e2a\u89c6\u56fe\uff08view\uff09\uff0c\u901a\u5e38\u4f1a\u662fJSP\u3002</p> <p>\u63a7\u5236\u5668\u6240\u505a\u7684\u6700\u540e\u4e00\u4ef6\u4e8b\u5c31\u662f\u5c06\u6a21\u578b\u6570\u636e\u6253\u5305\uff0c\u5e76\u4e14\u6807\u793a\u51fa\u7528\u4e8e\u6e32\u67d3\u8f93\u51fa\u7684\u89c6\u56fe\u540d\u3002\u5b83\u63a5\u4e0b\u6765\u4f1a\u5c06\u8bf7\u6c42\u8fde\u540c\u6a21\u578b\u548c\u89c6\u56fe\u540d\u53d1\u9001\u56deDispatcherServlet(4)\u3002</p> <p>\u8fd9\u6837\uff0c\u63a7\u5236\u5668\u5c31\u4e0d\u4f1a\u4e0e\u7279\u5b9a\u7684\u89c6\u56fe\u76f8\u8026\u5408\uff0c\u4f20\u9012\u7ed9DispatcherServlet\u7684\u89c6\u56fe\u540d\u5e76\u4e0d\u76f4\u63a5\u8868\u793a\u67d0\u4e2a\u7279\u5b9a\u7684JSP\u3002\u5b9e\u9645\u4e0a\uff0c\u5b83\u751a\u81f3\u5e76\u4e0d\u80fd\u786e\u5b9a\u89c6\u56fe\u5c31\u662fJSP\u3002\u76f8\u53cd\uff0c\u5b83\u4ec5\u4ec5\u4f20\u9012\u4e86\u4e00\u4e2a\u903b\u8f91\u540d\u79f0\uff0c\u8fd9\u4e2a\u540d\u5b57\u5c06\u4f1a\u7528\u6765\u67e5\u627e\u4ea7\u751f\u7ed3\u679c\u7684\u771f\u6b63\u89c6\u56fe\u3002DispatcherServlet\u5c06\u4f1a\u4f7f\u7528\u89c6\u56fe\u89e3\u6790\u5668\uff08view resolver\uff09(5)\u6765\u5c06\u903b\u8f91\u89c6\u56fe\u540d\u5339\u914d\u4e3a\u4e00\u4e2a\u7279\u5b9a\u7684\u89c6\u56fe\u5b9e\u73b0\uff0c\u5b83\u53ef\u80fd\u662f\u4e5f\u53ef\u80fd\u4e0d\u662fJSP\u3002</p> <p>\u65e2\u7136DispatcherServlet\u5df2\u7ecf\u77e5\u9053\u7531\u54ea\u4e2a\u89c6\u56fe\u6e32\u67d3\u7ed3\u679c\uff0c\u90a3\u8bf7\u6c42\u7684\u4efb\u52a1\u57fa\u672c\u4e0a\u4e5f\u5c31\u5b8c\u6210\u4e86\u3002\u5b83\u7684\u6700\u540e\u4e00\u7ad9\u662f\u89c6\u56fe\u7684\u5b9e\u73b0\uff08\u53ef\u80fd\u662fJSP\uff09(6)\uff0c\u5728\u8fd9\u91cc\u5b83\u4ea4\u4ed8\u6a21\u578b\u6570\u636e\u3002\u8bf7\u6c42\u7684\u4efb\u52a1\u5c31\u5b8c\u6210\u4e86\u3002\u89c6\u56fe\u5c06\u4f7f\u7528\u6a21\u578b\u6570\u636e\u6e32\u67d3\u8f93\u51fa\uff0c\u8fd9\u4e2a\u8f93\u51fa\u4f1a\u901a\u8fc7\u54cd\u5e94\u5bf9\u8c61\u4f20\u9012\u7ed9\u5ba2\u6237\u7aef\uff08\u4e0d\u4f1a\u50cf\u542c\u4e0a\u53bb\u90a3\u6837\u786c\u7f16\u7801\uff09(7)\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8bf7\u6c42\u8981\u7ecf\u8fc7\u5f88\u591a\u7684\u6b65\u9aa4\uff0c\u6700\u7ec8\u624d\u80fd\u5f62\u6210\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u7684\u54cd\u5e94\u3002\u5927\u591a\u6570\u7684\u6b65\u9aa4\u90fd\u662f\u5728Spring\u6846\u67b6\u5185\u90e8\u5b8c\u6210\u7684\uff0c\u4e5f\u5c31\u662f\u56fe5.1\u6240\u793a\u7684\u7ec4\u4ef6\u4e2d\u3002\u5c3d\u7ba1\u672c\u7ae0\u7684\u4e3b\u8981\u5185\u5bb9\u90fd\u5173\u6ce8\u4e8e\u5982\u4f55\u7f16\u5199\u63a7\u5236\u5668\uff0c\u4f46\u5728\u6b64\u4e4b\u524d\u6211\u4eec\u9996\u5148\u770b\u4e00\u4e0b\u5982\u4f55\u642d\u5efaSpring MVC\u7684\u57fa\u7840\u7ec4\u4ef6\u3002</p>"},{"location":"2017-11-18-Spring%E6%A1%86%E6%9E%B6%EF%BC%9ASpring%20MVC%E8%B5%B7%E6%AD%A5/#spring-mvc_1","title":"\u642d\u5efaSpring MVC","text":"<p>\u57fa\u4e8e\u56fe5.1\uff0c\u770b\u4e0a\u53bb\u6211\u4eec\u9700\u8981\u914d\u7f6e\u5f88\u591a\u7684\u7ec4\u6210\u90e8\u5206\u3002\u5e78\u597d\uff0c\u501f\u52a9\u4e8e\u6700\u8fd1\u51e0\u4e2aSpring\u65b0\u7248\u672c\u7684\u529f\u80fd\u589e\u5f3a\uff0c\u5f00\u59cb\u4f7f\u7528Spring MVC\u53d8\u5f97\u975e\u5e38\u7b80\u5355\u4e86\u3002\u73b0\u5728\uff0c\u6211\u4eec\u8981\u4f7f\u7528\u6700\u7b80\u5355\u7684\u65b9\u5f0f\u6765\u914d\u7f6eSpring MVC\uff1a\u6240\u8981\u5b9e\u73b0\u7684\u529f\u80fd\u4ec5\u9650\u4e8e\u8fd0\u884c\u6211\u4eec\u6240\u521b\u5efa\u7684\u63a7\u5236\u5668\u3002\u5728\u7b2c7\u7ae0\u4e2d\uff0c\u6211\u4eec\u4f1a\u770b\u4e00\u4e9b\u5176\u4ed6\u7684\u914d\u7f6e\u9009\u9879\u3002</p> <p>\u914d\u7f6eDispatcherServlet DispatcherServlet\u662fSpring MVC\u7684\u6838\u5fc3\u3002\u5728\u8fd9\u91cc\u8bf7\u6c42\u4f1a\u7b2c\u4e00\u6b21\u63a5\u89e6\u5230\u6846\u67b6\uff0c\u5b83\u8981\u8d1f\u8d23\u5c06\u8bf7\u6c42\u8def\u7531\u5230\u5176\u4ed6\u7684\u7ec4\u4ef6\u4e4b\u4e2d\u3002</p> <p>\u6309\u7167\u4f20\u7edf\u7684\u65b9\u5f0f\uff0c\u50cfDispatcherServlet\u8fd9\u6837\u7684Servlet\u4f1a\u914d\u7f6e\u5728web.xml\u6587\u4ef6\u4e2d\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u653e\u5230\u5e94\u7528\u7684WAR\u5305\u91cc\u9762\u3002\u5f53\u7136\uff0c\u8fd9\u662f\u914d\u7f6eDispatcherServlet\u7684\u65b9\u6cd5\u4e4b\u4e00\u3002\u4f46\u662f\uff0c\u501f\u52a9\u4e8eServlet 3\u89c4\u8303\u548cSpring 3.1\u7684\u529f\u80fd\u589e\u5f3a\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5df2\u7ecf\u4e0d\u662f\u552f\u4e00\u7684\u65b9\u6848\u4e86\uff0c\u8fd9\u4e5f\u4e0d\u662f\u6211\u4eec\u672c\u7ae0\u6240\u4f7f\u7528\u7684\u914d\u7f6e\u65b9\u6cd5\u3002</p> <p>\u6211\u4eec\u4f1a\u4f7f\u7528Java\u5c06DispatcherServlet\u914d\u7f6e\u5728Servlet\u5bb9\u5668\u4e2d\uff0c\u800c\u4e0d\u4f1a\u518d\u4f7f\u7528web.xml\u6587\u4ef6\u3002\u5982\u4e0b\u7684\u7a0b\u5e8f\u6e05\u5355\u5c55\u793a\u4e86\u6240\u9700\u7684Java\u7c7b\u3002</p> <p>\u7a0b\u5e8f\u6e05\u53555.1\u3000\u914d\u7f6eDispatcherServlet</p> <p></p> <p>\u5728\u6211\u4eec\u6df1\u5165\u4ecb\u7ecd\u7a0b\u5e8f\u6e05\u53555.1\u4e4b\u524d\uff0c\u4f60\u53ef\u80fd\u60f3\u77e5\u9053spittr\u5230\u5e95\u662f\u4ec0\u4e48\u610f\u601d\u3002\u8fd9\u4e2a\u7c7b\u7684\u540d\u5b57\u662fSpittrWebAppInitializer\uff0c\u5b83\u4f4d\u4e8e\u540d\u4e3aspittr.config\u7684\u5305\u4e2d\u3002\u6211\u7a0d\u540e\u4f1a\u5bf9\u5176\u8fdb\u884c\u4ecb\u7ecd\uff08\u57285.1.3\u5c0f\u8282\u4e2d\uff09\uff0c\u4f46\u73b0\u5728\uff0c\u4f60\u53ea\u9700\u8981\u77e5\u9053\u6211\u4eec\u6240\u8981\u521b\u5efa\u7684\u5e94\u7528\u540d\u4e3aSpittr\u3002</p> <p>\u8981\u7406\u89e3\u7a0b\u5e8f\u6e05\u53555.1\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u6211\u4eec\u53ef\u80fd\u53ea\u9700\u8981\u77e5\u9053\u6269\u5c55AbstractAnnotation-ConfigDispatcherServletInitializer\u7684\u4efb\u610f\u7c7b\u90fd\u4f1a\u81ea\u52a8\u5730\u914d\u7f6eDispatcher-Servlet\u548cSpring\u5e94\u7528\u4e0a\u4e0b\u6587\uff0cSpring\u7684\u5e94\u7528\u4e0a\u4e0b\u6587\u4f1a\u4f4d\u4e8e\u5e94\u7528\u7a0b\u5e8f\u7684Servlet\u4e0a\u4e0b\u6587\u4e4b\u4e2d\u3002</p>"},{"location":"2017-11-18-Spring%E6%A1%86%E6%9E%B6%EF%BC%9ASpring%20MVC%E8%B5%B7%E6%AD%A5/#abstractannotationconfigdispatcherservletinitializer","title":"AbstractAnnotationConfigDispatcherServletInitializer\u5256\u6790","text":"<p>\u5982\u679c\u4f60\u575a\u6301\u8981\u4e86\u89e3\u66f4\u591a\u7ec6\u8282\u7684\u8bdd\uff0c\u90a3\u5c31\u770b\u8fd9\u91cc\u5427\u3002\u5728Servlet 3.0\u73af\u5883\u4e2d\uff0c\u5bb9\u5668\u4f1a\u5728\u7c7b\u8def\u5f84\u4e2d\u67e5\u627e\u5b9e\u73b0javax.servlet.ServletContainerInitializer\u63a5\u53e3\u7684\u7c7b\uff0c\u5982\u679c\u80fd\u53d1\u73b0\u7684\u8bdd\uff0c\u5c31\u4f1a\u7528\u5b83\u6765\u914d\u7f6eServlet\u5bb9\u5668\u3002</p> <p>Spring\u63d0\u4f9b\u4e86\u8fd9\u4e2a\u63a5\u53e3\u7684\u5b9e\u73b0\uff0c\u540d\u4e3aSpringServletContainerInitializer\uff0c\u8fd9\u4e2a\u7c7b\u53cd\u8fc7\u6765\u53c8\u4f1a\u67e5\u627e\u5b9e\u73b0WebApplicationInitializer\u7684\u7c7b\u5e76\u5c06\u914d\u7f6e\u7684\u4efb\u52a1\u4ea4\u7ed9\u5b83\u4eec\u6765\u5b8c\u6210\u3002Spring 3.2\u5f15\u5165\u4e86\u4e00\u4e2a\u4fbf\u5229\u7684WebApplicationInitializer\u57fa\u7840\u5b9e\u73b0\uff0c\u4e5f\u5c31\u662fAbstractAnnotationConfigDispatcherServletInitializer\u3002\u56e0\u4e3a\u6211\u4eec\u7684Spittr-WebAppInitializer\u6269\u5c55\u4e86AbstractAnnotationConfig DispatcherServlet-Initializer\uff08\u540c\u65f6\u4e5f\u5c31\u5b9e\u73b0\u4e86WebApplicationInitializer\uff09\uff0c\u56e0\u6b64\u5f53\u90e8\u7f72\u5230Servlet 3.0\u5bb9\u5668\u4e2d\u7684\u65f6\u5019\uff0c\u5bb9\u5668\u4f1a\u81ea\u52a8\u53d1\u73b0\u5b83\uff0c\u5e76\u7528\u5b83\u6765\u914d\u7f6eServlet\u4e0a\u4e0b\u6587\u3002</p> <p>\u5c3d\u7ba1\u5b83\u7684\u540d\u5b57\u5f88\u957f\uff0c\u4f46\u662fAbstractAnnotationConfigDispatcherServlet-Initializer\u4f7f\u7528\u8d77\u6765\u5f88\u7b80\u4fbf\u3002\u5728\u7a0b\u5e8f\u6e05\u53555.1\u4e2d\uff0cSpittrWebAppInitializer\u91cd\u5199\u4e86\u4e09\u4e2a\u65b9\u6cd5\u3002</p> <p>\u7b2c\u4e00\u4e2a\u65b9\u6cd5\u662fgetServletMappings()\uff0c\u5b83\u4f1a\u5c06\u4e00\u4e2a\u6216\u591a\u4e2a\u8def\u5f84\u6620\u5c04\u5230DispatcherServlet\u4e0a\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u5b83\u6620\u5c04\u7684\u662f\u201c/\u201d\uff0c\u8fd9\u8868\u793a\u5b83\u4f1a\u662f\u5e94\u7528\u7684\u9ed8\u8ba4Servlet\u3002\u5b83\u4f1a\u5904\u7406\u8fdb\u5165\u5e94\u7528\u7684\u6240\u6709\u8bf7\u6c42\u3002</p> <p>\u4e3a\u4e86\u7406\u89e3\u5176\u4ed6\u7684\u4e24\u4e2a\u65b9\u6cd5\uff0c\u6211\u4eec\u9996\u5148\u8981\u7406\u89e3DispatcherServlet\u548c\u4e00\u4e2aServlet\u76d1\u542c\u5668\uff08\u4e5f\u5c31\u662fContextLoaderListener\uff09\u7684\u5173\u7cfb\u3002</p>"},{"location":"2017-11-18-Spring%E6%A1%86%E6%9E%B6%EF%BC%9ASpring%20MVC%E8%B5%B7%E6%AD%A5/#_1","title":"\u4e24\u4e2a\u5e94\u7528\u4e0a\u4e0b\u6587\u4e4b\u95f4\u7684\u6545\u4e8b","text":"<p>\u5f53DispatcherServlet\u542f\u52a8\u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u521b\u5efaSpring\u5e94\u7528\u4e0a\u4e0b\u6587\uff0c\u5e76\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\u6216\u914d\u7f6e\u7c7b\u4e2d\u6240\u58f0\u660e\u7684bean\u3002\u5728\u7a0b\u5e8f\u6e05\u53555.1\u7684getServletConfigClasses()\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u8981\u6c42DispatcherServlet\u52a0\u8f7d\u5e94\u7528\u4e0a\u4e0b\u6587\u65f6\uff0c\u4f7f\u7528\u5b9a\u4e49\u5728WebConfig\u914d\u7f6e\u7c7b\uff08\u4f7f\u7528Java\u914d\u7f6e\uff09\u4e2d\u7684bean\u3002</p> <p>\u4f46\u662f\u5728Spring Web\u5e94\u7528\u4e2d\uff0c\u901a\u5e38\u8fd8\u4f1a\u6709\u53e6\u5916\u4e00\u4e2a\u5e94\u7528\u4e0a\u4e0b\u6587\u3002\u53e6\u5916\u7684\u8fd9\u4e2a\u5e94\u7528\u4e0a\u4e0b\u6587\u662f\u7531ContextLoaderListener\u521b\u5efa\u7684\u3002</p> <p>\u6211\u4eec\u5e0c\u671bDispatcherServlet\u52a0\u8f7d\u5305\u542bWeb\u7ec4\u4ef6\u7684bean\uff0c\u5982\u63a7\u5236\u5668\u3001\u89c6\u56fe\u89e3\u6790\u5668\u4ee5\u53ca\u5904\u7406\u5668\u6620\u5c04\uff0c\u800cContextLoaderListener\u8981\u52a0\u8f7d\u5e94\u7528\u4e2d\u7684\u5176\u4ed6bean\u3002\u8fd9\u4e9bbean\u901a\u5e38\u662f\u9a71\u52a8\u5e94\u7528\u540e\u7aef\u7684\u4e2d\u95f4\u5c42\u548c\u6570\u636e\u5c42\u7ec4\u4ef6\u3002</p> <p>\u5b9e\u9645\u4e0a\uff0cAbstractAnnotationConfigDispatcherServletInitializer\u4f1a\u540c\u65f6\u521b\u5efaDispatcherServlet\u548cContextLoaderListener\u3002GetServlet-ConfigClasses()\u65b9\u6cd5\u8fd4\u56de\u7684\u5e26\u6709@Configuration\u6ce8\u89e3\u7684\u7c7b\u5c06\u4f1a\u7528\u6765\u5b9a\u4e49DispatcherServlet\u5e94\u7528\u4e0a\u4e0b\u6587\u4e2d\u7684bean\u3002getRootConfigClasses()\u65b9\u6cd5\u8fd4\u56de\u7684\u5e26\u6709@Configuration\u6ce8\u89e3\u7684\u7c7b\u5c06\u4f1a\u7528\u6765\u914d\u7f6eContextLoaderListener\u521b\u5efa\u7684\u5e94\u7528\u4e0a\u4e0b\u6587\u4e2d\u7684bean\u3002</p> <p>\u5728\u672c\u4f8b\u4e2d\uff0c\u6839\u914d\u7f6e\u5b9a\u4e49\u5728RootConfig\u4e2d\uff0cDispatcherServlet\u7684\u914d\u7f6e\u58f0\u660e\u5728WebConfig\u4e2d\u3002\u7a0d\u540e\u6211\u4eec\u5c06\u4f1a\u770b\u5230\u8fd9\u4e24\u4e2a\u7c7b\u7684\u5185\u5bb9\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u901a\u8fc7AbstractAnnotationConfigDispatcherServlet-Initializer\u6765\u914d\u7f6eDispatcherServlet\u662f\u4f20\u7edfweb.xml\u65b9\u5f0f\u7684\u66ff\u4ee3\u65b9\u6848\u3002\u5982\u679c\u4f60\u613f\u610f\u7684\u8bdd\uff0c\u53ef\u4ee5\u540c\u65f6\u5305\u542bweb.xml\u548cAbstractAnnotationConfigDispatcher-ServletInitializer\uff0c\u4f46\u8fd9\u5176\u5b9e\u5e76\u6ca1\u6709\u5fc5\u8981\u3002</p> <p>\u5982\u679c\u6309\u7167\u8fd9\u79cd\u65b9\u5f0f\u914d\u7f6eDispatcherServlet\uff0c\u800c\u4e0d\u662f\u4f7f\u7528web.xml\u7684\u8bdd\uff0c\u90a3\u552f\u4e00\u95ee\u9898\u5728\u4e8e\u5b83\u53ea\u80fd\u90e8\u7f72\u5230\u652f\u6301Servlet 3.0\u7684\u670d\u52a1\u5668\u4e2d\u624d\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u5982Tomcat 7\u6216\u66f4\u9ad8\u7248\u672c\u3002Servlet 3.0\u89c4\u8303\u57282009\u5e7412\u6708\u4efd\u5c31\u53d1\u5e03\u4e86\uff0c\u56e0\u6b64\u5f88\u6709\u53ef\u80fd\u4f60\u4f1a\u5c06\u5e94\u7528\u90e8\u7f72\u5230\u652f\u6301Servlet 3.0\u7684Servlet\u5bb9\u5668\u4e4b\u4e2d\u3002</p> <p>\u5982\u679c\u4f60\u8fd8\u6ca1\u6709\u4f7f\u7528\u652f\u6301Servlet 3.0\u7684\u670d\u52a1\u5668\uff0c\u90a3\u4e48\u5728AbstractAnnotation-ConfigDispatcherServletInitializer\u5b50\u7c7b\u4e2d\u914d\u7f6eDispatcherServlet\u7684\u65b9\u6cd5\u5c31\u4e0d\u9002\u5408\u4f60\u4e86\u3002\u4f60\u522b\u65e0\u9009\u62e9\uff0c\u53ea\u80fd\u4f7f\u7528web.xml\u4e86\u3002\u6211\u4eec\u5c06\u4f1a\u5728\u7b2c7\u7ae0\u5b66\u4e60web.xml\u548c\u5176\u4ed6\u914d\u7f6e\u9009\u9879\u3002\u4f46\u73b0\u5728\uff0c\u6211\u4eec\u5148\u770b\u4e00\u4e0b\u7a0b\u5e8f\u6e05\u53555.1\u4e2d\u6240\u5f15\u7528\u7684WebConfig\u548cRootConfig\uff0c\u4e86\u89e3\u4e00\u4e0b\u5982\u4f55\u542f\u7528Spring MVC\u3002</p>"},{"location":"2017-11-18-Spring%E6%A1%86%E6%9E%B6%EF%BC%9ASpring%20MVC%E8%B5%B7%E6%AD%A5/#spring-mvc_2","title":"\u542f\u7528Spring MVC","text":"<p>\u6211\u4eec\u6709\u591a\u79cd\u65b9\u5f0f\u6765\u914d\u7f6eDispatcherServlet\uff0c\u4e0e\u4e4b\u7c7b\u4f3c\uff0c\u542f\u7528Spring MVC\u7ec4\u4ef6\u7684\u65b9\u6cd5\u4e5f\u4e0d\u4ec5\u4e00\u79cd\u3002\u4ee5\u524d\uff0cSpring\u662f\u4f7f\u7528XML\u8fdb\u884c\u914d\u7f6e\u7684\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528<code>&lt;mvc:annotation-driven&gt;</code>\u542f\u7528\u6ce8\u89e3\u9a71\u52a8\u7684Spring MVC\u3002</p> <p>\u6211\u4eec\u4f1a\u5728\u7b2c7\u7ae0\u8ba8\u8bbaSpring MVC\u914d\u7f6e\u53ef\u9009\u9879\u7684\u65f6\u5019\uff0c\u518d\u8ba8\u8bba<code>&lt;mvc:annotation-driven&gt;</code>\u3002\u4e0d\u8fc7\uff0c\u73b0\u5728\u6211\u4eec\u4f1a\u8ba9Spring MVC\u7684\u642d\u5efa\u8fc7\u7a0b\u5c3d\u53ef\u80fd\u7b80\u5355\u5e76\u57fa\u4e8eJava\u8fdb\u884c\u914d\u7f6e\u3002</p> <p>\u6211\u4eec\u6240\u80fd\u521b\u5efa\u7684\u6700\u7b80\u5355\u7684Spring MVC\u914d\u7f6e\u5c31\u662f\u4e00\u4e2a\u5e26\u6709@EnableWebMvc\u6ce8\u89e3\u7684\u7c7b\uff1a</p> <pre><code>package spittr.config;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.web.servlet.config.annotation.EnableWebMvc;\n\n@Configuration\n@EnableWebMvc\npublic class WebConfig {\n}\n</code></pre> <p>\u8fd9\u53ef\u4ee5\u8fd0\u884c\u8d77\u6765\uff0c\u5b83\u7684\u786e\u80fd\u591f\u542f\u7528Spring MVC\uff0c\u4f46\u8fd8\u6709\u4e0d\u5c11\u95ee\u9898\u8981\u89e3\u51b3\uff1a</p> <ul> <li>\u6ca1\u6709\u914d\u7f6e\u89c6\u56fe\u89e3\u6790\u5668\u3002\u5982\u679c\u8fd9\u6837\u7684\u8bdd\uff0cSpring\u9ed8\u8ba4\u4f1a\u4f7f\u7528BeanNameView-Resolver\uff0c\u8fd9\u4e2a\u89c6\u56fe\u89e3\u6790\u5668\u4f1a\u67e5\u627eID\u4e0e\u89c6\u56fe\u540d\u79f0\u5339\u914d\u7684bean\uff0c\u5e76\u4e14\u67e5\u627e\u7684bean\u8981\u5b9e\u73b0View\u63a5\u53e3\uff0c\u5b83\u4ee5\u8fd9\u6837\u7684\u65b9\u5f0f\u6765\u89e3\u6790\u89c6\u56fe\u3002</li> <li>\u6ca1\u6709\u542f\u7528\u7ec4\u4ef6\u626b\u63cf\u3002\u8fd9\u6837\u7684\u7ed3\u679c\u5c31\u662f\uff0cSpring\u53ea\u80fd\u627e\u5230\u663e\u5f0f\u58f0\u660e\u5728\u914d\u7f6e\u7c7b\u4e2d\u7684\u63a7\u5236\u5668\u3002</li> <li>\u8fd9\u6837\u914d\u7f6e\u7684\u8bdd\uff0cDispatcherServlet\u4f1a\u6620\u5c04\u4e3a\u5e94\u7528\u7684\u9ed8\u8ba4Servlet\uff0c\u6240\u4ee5\u5b83\u4f1a\u5904\u7406\u6240\u6709\u7684\u8bf7\u6c42\uff0c\u5305\u62ec\u5bf9\u9759\u6001\u8d44\u6e90\u7684\u8bf7\u6c42\uff0c\u5982\u56fe\u7247\u548c\u6837\u5f0f\u8868\uff08\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8fd9\u53ef\u80fd\u5e76\u4e0d\u662f\u4f60\u60f3\u8981\u7684\u6548\u679c\uff09\u3002 \u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u5728WebConfig\u8fd9\u4e2a\u6700\u5c0f\u7684Spring MVC\u914d\u7f6e\u4e0a\u518d\u52a0\u4e00\u4e9b\u5185\u5bb9\uff0c\u4ece\u800c\u8ba9\u5b83\u53d8\u5f97\u771f\u6b63\u6709\u7528\u3002\u5982\u4e0b\u7a0b\u5e8f\u6e05\u5355\u4e2d\u7684WebConfig\u89e3\u51b3\u4e86\u4e0a\u9762\u6240\u8ff0\u7684\u95ee\u9898\u3002</li> </ul> <p>\u7a0b\u5e8f\u6e05\u53555.2\u3000\u6700\u5c0f\u4f46\u53ef\u7528\u7684Spring MVC\u914d\u7f6e</p> <p></p> <p>\u5728\u7a0b\u5e8f\u6e05\u53555.2\u4e2d\u7b2c\u4e00\u4ef6\u9700\u8981\u6ce8\u610f\u7684\u4e8b\u60c5\u662fWebConfig\u73b0\u5728\u6dfb\u52a0\u4e86@Component-Scan\u6ce8\u89e3\uff0c\u56e0\u6b64\u5c06\u4f1a\u626b\u63cfspitter.web\u5305\u6765\u67e5\u627e\u7ec4\u4ef6\u3002\u7a0d\u540e\u4f60\u5c31\u4f1a\u770b\u5230\uff0c\u6211\u4eec\u6240\u7f16\u5199\u7684\u63a7\u5236\u5668\u5c06\u4f1a\u5e26\u6709@Controller\u6ce8\u89e3\uff0c\u8fd9\u4f1a\u4f7f\u5176\u6210\u4e3a\u7ec4\u4ef6\u626b\u63cf\u65f6\u7684\u5019\u9009bean\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u5728\u914d\u7f6e\u7c7b\u4e2d\u663e\u5f0f\u58f0\u660e\u4efb\u4f55\u7684\u63a7\u5236\u5668\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u6dfb\u52a0\u4e86\u4e00\u4e2aViewResolver bean\u3002\u66f4\u5177\u4f53\u6765\u8bb2\uff0c\u662fInternal-ResourceViewResolver\u3002\u6211\u4eec\u5c06\u4f1a\u5728\u7b2c6\u7ae0\u66f4\u4e3a\u8be6\u7ec6\u5730\u8ba8\u8bba\u89c6\u56fe\u89e3\u6790\u5668\u3002\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053\u5b83\u4f1a\u67e5\u627eJSP\u6587\u4ef6\uff0c\u5728\u67e5\u627e\u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u5728\u89c6\u56fe\u540d\u79f0\u4e0a\u52a0\u4e00\u4e2a\u7279\u5b9a\u7684\u524d\u7f00\u548c\u540e\u7f00\uff08\u4f8b\u5982\uff0c\u540d\u4e3ahome\u7684\u89c6\u56fe\u5c06\u4f1a\u89e3\u6790\u4e3a/WEB-INF/views/home.jsp\uff09\u3002</p> <p>\u6700\u540e\uff0c\u65b0\u7684WebConfig\u7c7b\u8fd8\u6269\u5c55\u4e86WebMvcConfigurerAdapter\u5e76\u91cd\u5199\u4e86\u5176configureDefaultServletHandling()\u65b9\u6cd5\u3002\u901a\u8fc7\u8c03\u7528DefaultServlet-HandlerConfigurer\u7684enable()\u65b9\u6cd5\uff0c\u6211\u4eec\u8981\u6c42DispatcherServlet\u5c06\u5bf9\u9759\u6001\u8d44\u6e90\u7684\u8bf7\u6c42\u8f6c\u53d1\u5230Servlet\u5bb9\u5668\u4e2d\u9ed8\u8ba4\u7684Servlet\u4e0a\uff0c\u800c\u4e0d\u662f\u4f7f\u7528DispatcherServlet\u672c\u8eab\u6765\u5904\u7406\u6b64\u7c7b\u8bf7\u6c42\u3002</p> <p>WebConfig\u5df2\u7ecf\u5c31\u7eea\uff0c\u90a3RootConfig\u5462\uff1f\u56e0\u4e3a\u672c\u7ae0\u805a\u7126\u4e8eWeb\u5f00\u53d1\uff0c\u800cWeb\u76f8\u5173\u7684\u914d\u7f6e\u901a\u8fc7DispatcherServlet\u521b\u5efa\u7684\u5e94\u7528\u4e0a\u4e0b\u6587\u90fd\u5df2\u7ecf\u914d\u7f6e\u597d\u4e86\uff0c\u56e0\u6b64\u73b0\u5728\u7684RootConfig\u76f8\u5bf9\u5f88\u7b80\u5355\uff1a</p> <pre><code>package spittr.config;\n\nimport org.springframework.context.annotation.ComponentScan;\nimport org.springframework.context.annotation.ComponentScan.Filter;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.context.annotation.FilterType;\nimport org.springframework.web.servlet.config.annotation.EnableWebMvc;\n\n@Configuration\n@ComponentScan(basePackages={\"spitter\"},\nexcludeFilters={\n@Filter(type=FilterType.ANNOTATION, value=EnableWebMvc.class)\n})\npublic class RootConfig {\n}\n</code></pre> <p>\u552f\u4e00\u9700\u8981\u6ce8\u610f\u7684\u662fRootConfig\u4f7f\u7528\u4e86@ComponentScan\u6ce8\u89e3\u3002\u8fd9\u6837\u7684\u8bdd\uff0c\u5728\u672c\u4e66\u4e2d\uff0c\u6211\u4eec\u5c31\u6709\u5f88\u591a\u673a\u4f1a\u7528\u975eWeb\u7684\u7ec4\u4ef6\u6765\u5145\u5b9e\u5b8c\u5584RootConfig\u3002</p> <p>\u73b0\u5728\uff0c\u6211\u4eec\u57fa\u672c\u4e0a\u5df2\u7ecf\u53ef\u4ee5\u5f00\u59cb\u4f7f\u7528Spring MVC\u6784\u5efaWeb\u5e94\u7528\u4e86\u3002\u6b64\u65f6\uff0c\u6700\u5927\u7684\u95ee\u9898\u5728\u4e8e\uff0c\u6211\u4eec\u8981\u6784\u5efa\u7684\u5e94\u7528\u5230\u5e95\u662f\u4ec0\u4e48\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9AEcho%E5%AE%A2%E6%88%B7%E7%AB%AF/","title":"2018 01 22 Netty\u6846\u67b6\uff1aEcho\u5ba2\u6237\u7aef","text":"<p>Echo\u5ba2\u6237\u7aef\u5c06\u4f1a\uff1a</p> <ol> <li>\u8fde\u63a5\u5230\u670d\u52a1\u5668</li> <li>\u53d1\u9001\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u6d88\u606f</li> <li>\u5bf9\u4e8e\u6bcf\u4e2a\u6d88\u606f\uff0c\u7b49\u5f85\u5e76\u63a5\u6536\u4ece\u670d\u52a1\u5668\u53d1\u56de\u7684\u76f8\u540c\u7684\u6d88\u606f</li> <li>\u5173\u95ed\u8fde\u63a5</li> </ol> <p>\u7f16\u5199\u5ba2\u6237\u7aef\u6240\u6d89\u53ca\u7684\u4e24\u4e2a\u4e3b\u8981\u4ee3\u7801\u90e8\u5206\u4e5f\u662f\u4e1a\u52a1\u903b\u8f91\u548c\u5f15\u5bfc\uff0c\u548c\u4f60\u5728\u670d\u52a1\u5668\u4e2d\u770b\u5230\u7684\u4e00\u6837\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9AEcho%E5%AE%A2%E6%88%B7%E7%AB%AF/#channelhandlerimplementing-the-client-logic-with-channelhandlers","title":"\u901a\u8fc7ChannelHandler\u5b9e\u73b0\u5ba2\u6237\u7aef\u903b\u8f91\uff08Implementing the client logic with ChannelHandlers\uff09","text":"<p>\u5982\u540c\u670d\u52a1\u5668\uff0c\u5ba2\u6237\u7aef\u5c06\u62e5\u6709\u4e00\u4e2a\u7528\u6765\u5904\u7406\u6570\u636e\u7684ChannelInboundHandler\u3002\u5728\u8fd9\u4e2a\u573a\u666f\u4e0b\uff0c\u4f60\u5c06\u6269\u5c55SimpleChannelInboundHandler\u7c7b\u4ee5\u5904\u7406\u6240\u6709\u5fc5\u987b\u7684\u4efb\u52a1\uff0c\u5982\u4ee3\u7801\u6e05\u53552-3\u6240\u793a\u3002\u8fd9\u8981\u6c42\u91cd\u5199\u4e0b\u9762\u7684\u65b9\u6cd5\uff1a</p> <ul> <li><code>channelActive()</code>\u2014\u2014\u5728\u5230\u670d\u52a1\u5668\u7684\u8fde\u63a5\u5df2\u7ecf\u5efa\u7acb\u4e4b\u540e\u5c06\u88ab\u8c03\u7528\uff1b</li> <li><code>channelRead0()</code>\u2014\u2014\u5f53\u4ece\u670d\u52a1\u5668\u63a5\u6536\u5230\u4e00\u6761\u6d88\u606f\u65f6\u88ab\u8c03\u7528\uff1b</li> <li><code>exceptionCaught()</code>\u2014\u2014\u5728\u5904\u7406\u8fc7\u7a0b\u4e2d\u5f15\u53d1\u5f02\u5e38\u65f6\u88ab\u8c03\u7528\u3002</li> </ul> <pre><code>// \u4ee3\u7801\u6e05\u53552-3\u3000\u5ba2\u6237\u7aef\u7684ChannelHandler\n@Sharable   // \u6807\u8bb0\u8be5\u7c7b\u7684\u5b9e\u4f8b\u53ef\u4ee5\u88ab\u591a\u4e2aChannel\u5171\u4eab\npublic class EchoClientHandler extends\nSimpleChannelInboundHandler&lt;ByteBuf&gt; {\n@Override\npublic void channelActive(ChannelHandlerContext ctx) {\nctx.writeAndFlush(Unpooled.copiedBuffer(\"Netty rocks!\",   // \u5f53\u88ab\u901a\u77e5Channel\u662f\u6d3b\u8dc3\u7684\u65f6\u5019\uff0c\u53d1\u9001\u4e00\u6761\u6d88\u606f\nCharsetUtil.UTF_8));\n}\n\n@Override\npublic void channelRead0(ChannelHandlerContext ctx, ByteBuf in) {\nSystem.out.println(  // \u8bb0\u5f55\u5df2\u63a5\u6536\u6d88\u606f\u7684\u8f6c\u50a8\n\"Client received: \" + in.toString(CharsetUtil.UTF_8));\n}\n\n@Override\npublic void exceptionCaught(ChannelHandlerContext ctx,   // \u5728\u53d1\u751f\u5f02\u5e38\u65f6\uff0c\u8bb0\u5f55\u9519\u8bef\u5e76\u5173\u95edChannel\nThrowable cause) {\ncause.printStackTrace();\nctx.close();\n}\n}\n</code></pre> <p>\u9996\u5148\uff0c\u4f60\u91cd\u5199\u4e86<code>channelActive()</code>\u65b9\u6cd5\uff0c\u5176\u5c06\u5728\u4e00\u4e2a\u8fde\u63a5\u5efa\u7acb\u65f6\u88ab\u8c03\u7528\u3002\u8fd9\u786e\u4fdd\u4e86\u6570\u636e\u5c06\u4f1a\u88ab\u5c3d\u53ef\u80fd\u5feb\u5730\u5199\u5165\u670d\u52a1\u5668\uff0c\u5176\u5728\u8fd9\u4e2a\u573a\u666f\u4e0b\u662f\u4e00\u4e2a\u7f16\u7801\u4e86\u5b57\u7b26\u4e32<code>Netty rocks!</code>\u7684\u5b57\u8282\u7f13\u51b2\u533a\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u4f60\u91cd\u5199\u4e86<code>channelRead0()</code>\u65b9\u6cd5\u3002\u6bcf\u5f53\u63a5\u6536\u6570\u636e\u65f6\uff0c\u90fd\u4f1a\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7531\u670d\u52a1\u5668\u53d1\u9001\u7684\u6d88\u606f\u53ef\u80fd\u4f1a\u88ab\u5206\u5757\u63a5\u6536\uff08received in chunks\uff09\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u670d\u52a1\u5668\u53d1\u9001\u4e865\u5b57\u8282\uff0c\u90a3\u4e48\u4e0d\u80fd\u4fdd\u8bc1\u8fd95\u5b57\u8282\u4f1a\u88ab\u4e00\u6b21\u6027\u63a5\u6536\u3002\u5373\u4f7f\u662f\u5bf9\u4e8e\u8fd9\u4e48\u5c11\u91cf\u7684\u6570\u636e\uff0cchannelRead0()\u65b9\u6cd5\u4e5f\u53ef\u80fd\u4f1a\u88ab\u8c03\u7528\u4e24\u6b21\uff0c\u7b2c\u4e00\u6b21\u4f7f\u7528\u4e00\u4e2a\u6301\u67093\u5b57\u8282\u7684ByteBuf\uff08Netty\u7684\u5b57\u8282\u5bb9\u5668\uff09\uff0c\u7b2c\u4e8c\u6b21\u4f7f\u7528\u4e00\u4e2a\u6301\u67092\u5b57\u8282\u7684ByteBuf\u3002\u4f5c\u4e3a\u4e00\u4e2a\u9762\u5411\u6d41\u7684\u534f\u8bae\uff0cTCP\u4fdd\u8bc1\u4e86\u5b57\u8282\u6570\u7ec4\u5c06\u4f1a\u6309\u7167\u670d\u52a1\u5668\u53d1\u9001\u5b83\u4eec\u7684\u987a\u5e8f\u88ab\u63a5\u6536\u3002</p> <p>\u91cd\u5199\u7684\u7b2c\u4e09\u4e2a\u65b9\u6cd5\u662f<code>exceptionCaught()</code>\u3002\u5982\u540c\u5728<code>EchoServerHandler</code>\uff08\u89c1\u4ee3\u7801\u6e05\u53552-2\uff09\u4e2d\u6240\u793a\uff0c\u8bb0\u5f55Throwable\uff0c\u5173\u95edChannel\uff0c\u5728\u8fd9\u4e2a\u573a\u666f\u4e0b\uff0c\u7ec8\u6b62\u5230\u670d\u52a1\u5668\u7684\u8fde\u63a5\u3002</p> <p><code>SimpleChannelInboundHandler</code>\u4e0e<code>ChannelInboundHandler</code></p> <p>\u4f60\u53ef\u80fd\u4f1a\u60f3\uff1a\u4e3a\u4ec0\u4e48\u6211\u4eec\u5728\u5ba2\u6237\u7aef\u4f7f\u7528\u7684\u662fSimpleChannelInboundHandler\uff0c\u800c\u4e0d\u662f\u5728EchoServerHandler\u4e2d\u6240\u4f7f\u7528\u7684ChannelInboundHandlerAdapter\u5462\uff1f\u8fd9\u548c\u4e24\u4e2a\u56e0\u7d20\u7684\u76f8\u4e92\u4f5c\u7528\u6709\u5173\uff1a\u4e1a\u52a1\u903b\u8f91\u5982\u4f55\u5904\u7406\u6d88\u606f\u4ee5\u53caNetty\u5982\u4f55\u7ba1\u7406\u8d44\u6e90\u3002\u5728\u5ba2\u6237\u7aef\uff0c\u5f53channelRead0()\u65b9\u6cd5\u5b8c\u6210\u65f6\uff0c\u4f60\u5df2\u7ecf\u6709\u4e86\u4f20\u5165\u6d88\u606f\uff0c\u5e76\u4e14\u5df2\u7ecf\u5904\u7406\u5b8c\u5b83\u4e86\u3002\u5f53\u8be5\u65b9\u6cd5\u8fd4\u56de\u65f6\uff0cSimpleChannelInboundHandler\u8d1f\u8d23\u91ca\u653e\u6307\u5411\u4fdd\u5b58\u8be5\u6d88\u606f\u7684ByteBuf\u7684\u5185\u5b58\u5f15\u7528\u3002\u5728EchoServerHandler\u4e2d\uff0c\u4f60\u4ecd\u7136\u9700\u8981\u5c06\u4f20\u5165\u6d88\u606f\u56de\u9001\u7ed9\u53d1\u9001\u8005\uff0c\u800cwrite()\u64cd\u4f5c\u662f\u5f02\u6b65\u7684\uff0c\u76f4\u5230channelRead()\u65b9\u6cd5\u8fd4\u56de\u540e\u53ef\u80fd\u4ecd\u7136\u6ca1\u6709\u5b8c\u6210\uff08\u5982\u4ee3\u7801\u6e05\u53552-1\u6240\u793a\uff09\u3002\u4e3a\u6b64\uff0cEchoServerHandler\u6269\u5c55\u4e86ChannelInboundHandlerAdapter\uff0c\u5176\u5728\u8fd9\u4e2a\u65f6\u95f4\u70b9\u4e0a\u4e0d\u4f1a\u91ca\u653e\u6d88\u606f\u3002\u6d88\u606f\u5728EchoServerHandler\u7684channelReadComplete()\u65b9\u6cd5\u4e2d\uff0c\u5f53writeAndFlush()\u65b9\u6cd5\u88ab\u8c03\u7528\u65f6\u88ab\u91ca\u653e\uff08\u89c1\u4ee3\u7801\u6e05\u53552-1\uff09\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9AEcho%E5%AE%A2%E6%88%B7%E7%AB%AF/#_1","title":"\u5f15\u5bfc\u5ba2\u6237\u7aef","text":"<p>\u5982\u540c\u5c06\u5728\u4ee3\u7801\u6e05\u53552-4\u4e2d\u6240\u770b\u5230\u7684\uff0c\u5f15\u5bfc\u5ba2\u6237\u7aef\u7c7b\u4f3c\u4e8e\u5f15\u5bfc\u670d\u52a1\u5668\uff0c\u4e0d\u540c\u7684\u662f\uff0c\u5ba2\u6237\u7aef\u662f\u4f7f\u7528\u4e3b\u673a\u548c\u7aef\u53e3\u53c2\u6570\u6765\u8fde\u63a5\u8fdc\u7a0b\u5730\u5740\uff0c\u4e5f\u5c31\u662f\u8fd9\u91cc\u7684Echo\u670d\u52a1\u5668\u7684\u5730\u5740\uff0c\u800c\u4e0d\u662f\u7ed1\u5b9a\u5230\u4e00\u4e2a\u4e00\u76f4\u88ab\u76d1\u542c\u7684\u7aef\u53e3\u3002</p> <pre><code>// \u4ee3\u7801\u6e05\u53552-4\u3000\u5ba2\u6237\u7aef\u7684\u4e3b\u7c7b\npublic class EchoClient {\nprivate final String host;\nprivate final int port;\n\npublic EchoClient(String host, int port) {\nthis.host = host;\nthis.port = port;\n}\n\npublic void start() throws Exception {\nEventLoopGroup group = new NioEventLoopGroup();\ntry {  // \u521b\u5efaBootstrap\nBootstrap b = new Bootstrap();   // \u6307\u5b9aEventLoopGroup\u4ee5\u5904\u7406\u5ba2\u6237\u7aef\u4e8b\u4ef6\uff1b\u9700\u8981\u9002\u7528\u4e8eNIO\u7684\u5b9e\u73b0\nb.group(group)\n.channel(NioSocketChannel.class)   // \u9002\u7528\u4e8eNIO\u4f20\u8f93\u7684Channel\u7c7b\u578b\n.remoteAddress(new InetSocketAddress(host, port))   // \u8bbe\u7f6e\u670d\u52a1\u5668\u7684InetSocketAddr-ess\n.handler(new ChannelInitializer&lt;SocketChannel&gt;() {  // \u5728\u521b\u5efaChannel\u65f6\uff0c\u5411ChannelPipeline\u4e2d\u6dfb\u52a0\u4e00\u4e2aEcho-ClientHandler\u5b9e\u4f8b\n@Override\npublic void initChannel(SocketChannel ch)\nthrows Exception {\nch.pipeline().addLast(\nnew EchoClientHandler());\n}\n});\nChannelFuture f = b.connect().sync();   // \u8fde\u63a5\u5230\u8fdc\u7a0b\u8282\u70b9\uff0c\u963b\u585e\u7b49\u5f85\u76f4\u5230\u8fde\u63a5\u5b8c\u6210\nf.channel().closeFuture().sync();    // \u963b\u585e\uff0c\u76f4\u5230Channel\u5173\u95ed\n} finally {\ngroup.shutdownGracefully().sync();     // \u5173\u95ed\u7ebf\u7a0b\u6c60\u5e76\u4e14\u91ca\u653e\u6240\u6709\u7684\u8d44\u6e90\n}\n}\n\npublic static void main(String[] args) throws Exception {\nif (args.length != 2) {\nSystem.err.println(\n\"Usage: \" + EchoClient.class.getSimpleName() +\n\" &lt;host&gt; &lt;port&gt;\");\nreturn;\n}\n\nString host = args[0];\nint port = Integer.parseInt(args[1]);\nnew EchoClient(host, port).start();\n}\n}\n</code></pre> <p>\u548c\u4e4b\u524d\u4e00\u6837\uff0c\u4f7f\u7528\u4e86NIO\u4f20\u8f93\u3002\u6ce8\u610f\uff0c\u4f60\u53ef\u4ee5\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e0a\u5206\u522b\u4f7f\u7528\u4e0d\u540c\u7684\u4f20\u8f93\u3002\u4f8b\u5982\uff0c\u5728\u670d\u52a1\u5668\u7aef\u4f7f\u7528NIO\u4f20\u8f93\uff0c\u800c\u5728\u5ba2\u6237\u7aef\u4f7f\u7528OIO\u4f20\u8f93\u3002</p> <p>\u8ba9\u6211\u4eec\u56de\u987e\u4e00\u4e0b\u8fd9\u4e00\u8282\u4e2d\u6240\u4ecb\u7ecd\u7684\u8981\u70b9\uff1a</p> <ul> <li>\u4e3a\u521d\u59cb\u5316\u5ba2\u6237\u7aef\uff0c\u521b\u5efa\u4e86\u4e00\u4e2a<code>Bootstrap</code>\u5b9e\u4f8b</li> <li>\u4e3a\u8fdb\u884c\u4e8b\u4ef6\u5904\u7406\u5206\u914d\u4e86\u4e00\u4e2aNioEventLoopGroup\u5b9e\u4f8b\uff0c\u5176\u4e2d\u4e8b\u4ef6\u5904\u7406\u5305\u62ec\u521b\u5efa\u65b0\u7684\u8fde\u63a5\u4ee5\u53ca\u5904\u7406\u5165\u7ad9\u548c\u51fa\u7ad9\u6570\u636e</li> <li>\u4e3a\u670d\u52a1\u5668\u8fde\u63a5\u521b\u5efa\u4e86\u4e00\u4e2aInetSocketAddress\u5b9e\u4f8b</li> <li>\u5f53\u8fde\u63a5\u88ab\u5efa\u7acb\u65f6\uff0c\u4e00\u4e2aEchoClientHandler\u5b9e\u4f8b\u4f1a\u88ab\u5b89\u88c5\u5230\uff08\u8be5Channel\u7684\uff09ChannelPipeline\u4e2d</li> <li>\u5728\u4e00\u5207\u90fd\u8bbe\u7f6e\u5b8c\u6210\u540e\uff0c\u8c03\u7528Bootstrap.connect()\u65b9\u6cd5\u8fde\u63a5\u5230\u8fdc\u7a0b\u8282\u70b9</li> </ul> <p>\u5b8c\u6210\u4e86\u5ba2\u6237\u7aef\uff0c\u4f60\u4fbf\u53ef\u4ee5\u7740\u624b\u6784\u5efa\u5e76\u6d4b\u8bd5\u8be5\u7cfb\u7edf\u4e86\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9AEcho%E6%9C%8D%E5%8A%A1%E5%99%A8/","title":"2018 01 22 Netty\u6846\u67b6\uff1aEcho\u670d\u52a1\u5668","text":""},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9AEcho%E6%9C%8D%E5%8A%A1%E5%99%A8/#netty","title":"Netty\u5ba2\u6237\u7aef/\u670d\u52a1\u5668\u6982\u89c8","text":"<p>\u56fe2-1\u4ece\u9ad8\u5c42\u6b21\u4e0a\u5c55\u793a\u4e86\u4e00\u4e2a\u5c06\u8981\u7f16\u5199\u7684Echo\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f\u3002\u867d\u7136\u4f60\u7684\u4e3b\u8981\u5173\u6ce8\u70b9\u53ef\u80fd\u662f\u7f16\u5199\u57fa\u4e8eWeb\u7684\u7528\u4e8e\u88ab\u6d4f\u89c8\u5668\u8bbf\u95ee\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f46\u662f\u901a\u8fc7\u540c\u65f6\u5b9e\u73b0\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\uff0c\u4f60\u4e00\u5b9a\u80fd\u66f4\u52a0\u5168\u9762\u5730\u7406\u89e3Netty\u7684API\u3002</p> <p></p> <p>\u56fe2-1\u3000Echo\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668</p> <p>\u867d\u7136\u6211\u4eec\u5df2\u7ecf\u8c08\u53ca\u5230\u4e86\u5ba2\u6237\u7aef\uff0c\u4f46\u662f\u8be5\u56fe\u5c55\u793a\u7684\u662f\u591a\u4e2a\u5ba2\u6237\u7aef\u540c\u65f6\u8fde\u63a5\u5230\u4e00\u53f0\u670d\u52a1\u5668\u3002\u6240\u80fd\u591f\u652f\u6301\u7684\u5ba2\u6237\u7aef\u6570\u91cf\uff0c\u5728\u7406\u8bba\u4e0a\uff0c\u4ec5\u53d7\u9650\u4e8e\u7cfb\u7edf\u7684\u53ef\u7528\u8d44\u6e90\uff08\u4ee5\u53ca\u6240\u4f7f\u7528\u7684JDK\u7248\u672c\u53ef\u80fd\u4f1a\u65bd\u52a0\u7684\u9650\u5236\uff09\u3002</p> <p>Echo\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u4ea4\u4e92\u662f\u975e\u5e38\u7b80\u5355\u7684\uff1b\u5728\u5ba2\u6237\u7aef\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\u4e4b\u540e\uff0c\u5b83\u4f1a\u5411\u670d\u52a1\u5668\u53d1\u9001\u4e00\u4e2a\u6216\u591a\u4e2a\u6d88\u606f\uff0c\u53cd\u8fc7\u6765\uff0c\u670d\u52a1\u5668\u53c8\u4f1a\u5c06\u6bcf\u4e2a\u6d88\u606f\u56de\u9001\u7ed9\u5ba2\u6237\u7aef\u3002\u867d\u7136\u5b83\u672c\u8eab\u770b\u8d77\u6765\u597d\u50cf\u7528\u5904\u4e0d\u5927\uff0c\u4f46\u5b83\u5145\u5206\u5730\u4f53\u73b0\u4e86\u5ba2\u6237\u7aef/\u670d\u52a1\u5668\u7cfb\u7edf\u4e2d\u5178\u578b\u7684\u8bf7\u6c42-\u54cd\u5e94\u4ea4\u4e92\u6a21\u5f0f\u3002</p> <p>\u6211\u4eec\u5c06\u4ece\u8003\u5bdf\u670d\u52a1\u5668\u7aef\u4ee3\u7801\u5f00\u59cb\u8fd9\u4e2a\u9879\u76ee\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9AEcho%E6%9C%8D%E5%8A%A1%E5%99%A8/#echo","title":"\u7f16\u5199Echo\u670d\u52a1\u5668","text":"<p>\u6240\u6709\u7684Netty\u670d\u52a1\u5668\u90fd\u9700\u8981\u4ee5\u4e0b\u4e24\u90e8\u5206\u3002</p> <ol> <li>\u81f3\u5c11\u4e00\u4e2aChannelHandler\u2014\u2014\u8be5\u7ec4\u4ef6\u5b9e\u73b0\u4e86\u670d\u52a1\u5668\u5bf9\u4ece\u5ba2\u6237\u7aef\u63a5\u6536\u7684\u6570\u636e\u7684\u5904\u7406\uff0c\u5373\u5b83\u7684\u4e1a\u52a1\u903b\u8f91\u3002</li> <li>\u5f15\u5bfc\u2014\u2014\u8fd9\u662f\u914d\u7f6e\u670d\u52a1\u5668\u7684\u542f\u52a8\u4ee3\u7801\u3002\u81f3\u5c11\uff0c\u5b83\u4f1a\u5c06\u670d\u52a1\u5668\u7ed1\u5b9a\u5230\u5b83\u8981\u76d1\u542c\u8fde\u63a5\u8bf7\u6c42\u7684\u7aef\u53e3\u4e0a\u3002</li> </ol> <p>\u5728\u672c\u5c0f\u8282\u7684\u5269\u4e0b\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u63cf\u8ff0Echo\u670d\u52a1\u5668\u7684\u4e1a\u52a1\u903b\u8f91\u4ee5\u53ca\u5f15\u5bfc\u4ee3\u7801\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9AEcho%E6%9C%8D%E5%8A%A1%E5%99%A8/#channelhandlerchannelhandlers-and-business-logic","title":"ChannelHandler\u548c\u4e1a\u52a1\u903b\u8f91\uff08ChannelHandlers and business logic\uff09","text":"<p>\u6211\u4eec\u5df2\u7ecf\u8ba8\u8bba\u4e86Future\u548c\u56de\u8c03\uff0c\u5e76\u4e14\u9610\u8ff0\u4e86\u5b83\u4eec\u5728\u4e8b\u4ef6\u9a71\u52a8\u8bbe\u8ba1\u4e2d\u7684\u5e94\u7528\u3002\u6211\u4eec\u8fd8\u8ba8\u8bba\u4e86<code>ChannelHandler</code>\uff0c\u5b83\u662f\u4e00\u4e2a\u63a5\u53e3\u65cf\u7684\u7236\u63a5\u53e3\uff0c\u5b83\u7684\u5b9e\u73b0\u8d1f\u8d23\u63a5\u6536\u5e76\u54cd\u5e94\u4e8b\u4ef6\u901a\u77e5\u3002\u5728Netty\u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u6240\u6709\u7684\u6570\u636e\u5904\u7406\u903b\u8f91\u90fd\u5305\u542b\u5728\u8fd9\u4e9b\u6838\u5fc3\u62bd\u8c61\u7684\u5b9e\u73b0\u4e2d\u3002</p> <p>\u56e0\u4e3a\u4f60\u7684Echo\u670d\u52a1\u5668\u4f1a\u54cd\u5e94\u4f20\u5165\u7684\u6d88\u606f\uff0c\u6240\u4ee5\u5b83\u9700\u8981\u5b9e\u73b0<code>ChannelInboundHandler</code>\u63a5\u53e3\uff0c\u7528\u6765\u5b9a\u4e49\u54cd\u5e94\u5165\u7ad9\u4e8b\u4ef6\u7684\u65b9\u6cd5\u3002\u8fd9\u4e2a\u7b80\u5355\u7684\u5e94\u7528\u7a0b\u5e8f\u53ea\u9700\u8981\u7528\u5230\u5c11\u91cf\u7684\u8fd9\u4e9b\u65b9\u6cd5\uff0c\u6240\u4ee5\u7ee7\u627f<code>ChannelInboundHandlerAdapter</code>\u7c7b\u4e5f\u5c31\u8db3\u591f\u4e86\uff0c\u5b83\u63d0\u4f9b\u4e86<code>ChannelInboundHandler</code>\u7684\u9ed8\u8ba4\u5b9e\u73b0\u3002</p> <p>\u6211\u4eec\u611f\u5174\u8da3\u7684\u65b9\u6cd5\u662f\uff1a</p> <ul> <li><code>channelRead()</code>\u2014\u2014\u5bf9\u4e8e\u6bcf\u4e2a\u4f20\u5165\u7684\u6d88\u606f\u90fd\u8981\u8c03\u7528\uff1b</li> <li><code>channelReadComplete()</code>\u2014\u2014\u901a\u77e5ChannelInboundHandler\u6700\u540e\u4e00\u6b21\u5bf9channel-Read()\u7684\u8c03\u7528\u662f\u5f53\u524d\u6279\u91cf\u8bfb\u53d6\u4e2d\u7684\u6700\u540e\u4e00\u6761\u6d88\u606f\uff1b</li> <li><code>exceptionCaught()</code>\u2014\u2014\u5728\u8bfb\u53d6\u64cd\u4f5c\u671f\u95f4\uff0c\u6709\u5f02\u5e38\u629b\u51fa\u65f6\u4f1a\u8c03\u7528\u3002</li> </ul> <p>\u8be5Echo\u670d\u52a1\u5668\u7684ChannelHandler\u5b9e\u73b0\u662fEchoServerHandler\uff0c\u5982\u4ee3\u7801\u6e05\u53552-1\u6240\u793a\u3002</p> <pre><code>// \u4ee3\u7801\u6e05\u53552-1\u3000EchoServerHandler\n@Sharable  // \u6807\u793a\u4e00\u4e2aChannel- Handler\u53ef\u4ee5\u88ab\u591a\u4e2aChannel\u5b89\u5168\u5730\u5171\u4eab\npublic class EchoServerHandler extends ChannelInboundHandlerAdapter {\n\n@Override\npublic void channelRead(ChannelHandlerContext ctx, Object msg) {\nByteBuf in = (ByteBuf) msg;\nSystem.out.println(\n\"Server received: \" + in.toString(CharsetUtil.UTF_8));     // \u5c06\u6d88\u606f\u8bb0\u5f55\u5230\u63a7\u5236\u53f0\nctx.write(in);  // \u5c06\u63a5\u6536\u5230\u7684\u6d88\u606f\u5199\u7ed9\u53d1\u9001\u8005\uff0c\u800c\u4e0d\u51b2\u5237\u51fa\u7ad9\u6d88\u606f\n}\n\n@Override\npublic void channelReadComplete(ChannelHandlerContext ctx) {\nctx.writeAndFlush(Unpooled.EMPTY_BUFFER)\n.addListener(ChannelFutureListener.CLOSE);   // \u5c06\u672a\u51b3\u6d88\u606f[4]\u51b2\u5237\u5230\u8fdc\u7a0b\u8282\u70b9\uff0c\u5e76\u4e14\u5173\u95ed\u8be5Channel\n}\n\n@Override\npublic void exceptionCaught(ChannelHandlerContext ctx,\nThrowable cause) {\ncause.printStackTrace();     // \u6253\u5370\u5f02\u5e38\u6808\u8ddf\u8e2a\nctx.close();   // \u5173\u95ed\u8be5Channel\n}\n}\n</code></pre> <p>\u672a\u51b3\u6d88\u606f\uff08pending message\uff09\u6307\u76ee\u524d\u6682\u5b58\u4e8e<code>ChannelOutboundBuffer</code>\u4e2d\u7684\u6d88\u606f\uff0c\u5728\u4e0b\u4e00\u6b21\u8c03\u7528<code>flush()</code>\u6216\u8005<code>writeAndFlush()</code>\u65b9\u6cd5\u65f6\u5c06\u4f1a\u5c1d\u8bd5\u5199\u51fa\u5230\u5957\u63a5\u5b57\u3002</p> <p><code>ChannelInboundHandlerAdapter</code>\u6709\u4e00\u4e2a\u76f4\u89c2\u7684API\uff0c\u5e76\u4e14\u5b83\u7684\u6bcf\u4e2a\u65b9\u6cd5\u90fd\u53ef\u4ee5\u88ab\u91cd\u5199\u4ee5\u6302\u94a9\u5230<code>\u4e8b\u4ef6\u751f\u547d\u5468\u671f</code>\u7684\u6070\u5f53\u70b9\u4e0a\u3002\u56e0\u4e3a\u9700\u8981\u5904\u7406\u6240\u6709\u63a5\u6536\u5230\u7684\u6570\u636e\uff0c\u6240\u4ee5\u4f60\u91cd\u5199\u4e86<code>channelRead()</code>\u65b9\u6cd5\u3002\u5728\u8fd9\u4e2a\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u4f60\u5c06\u6570\u636e\u7b80\u5355\u5730\u56de\u9001\u7ed9\u4e86\u8fdc\u7a0b\u8282\u70b9\u3002</p> <p>\u91cd\u5199<code>exceptionCaught()</code>\u65b9\u6cd5\u5141\u8bb8\u4f60\u5bf9<code>Throwable</code>\u7684\u4efb\u4f55\u5b50\u7c7b\u578b\u505a\u51fa\u53cd\u5e94\uff0c\u5728\u8fd9\u91cc\u4f60\u8bb0\u5f55\u4e86\u5f02\u5e38\u5e76\u5173\u95ed\u4e86\u8fde\u63a5\u3002\u867d\u7136\u4e00\u4e2a\u66f4\u52a0\u5b8c\u5584\u7684\u5e94\u7528\u7a0b\u5e8f\u4e5f\u8bb8\u4f1a\u5c1d\u8bd5\u4ece\u5f02\u5e38\u4e2d\u6062\u590d\uff0c\u4f46\u5728\u8fd9\u4e2a\u573a\u666f\u4e0b\uff0c\u53ea\u662f\u901a\u8fc7\u7b80\u5355\u5730\u5173\u95ed\u8fde\u63a5\u6765\u901a\u77e5\u8fdc\u7a0b\u8282\u70b9\u53d1\u751f\u4e86\u9519\u8bef\u3002</p> <p>\u5982\u679c\u4e0d\u6355\u83b7\u5f02\u5e38\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\u5462\uff1f</p> <p>\u6bcf\u4e2aChannel\u90fd\u62e5\u6709\u4e00\u4e2a\u4e0e\u4e4b\u76f8\u5173\u8054\u7684<code>ChannelPipeline</code>\uff0c\u5176\u6301\u6709\u4e00\u4e2aChannelHandler\u7684\u5b9e\u4f8b\u94fe\u3002\u5728\u9ed8\u8ba4\u7684\u60c5\u51b5\u4e0b\uff0cChannelHandler\u4f1a\u628a\u5bf9\u5b83\u7684\u65b9\u6cd5\u7684\u8c03\u7528\u8f6c\u53d1\u7ed9\u94fe\u4e2d\u7684\u4e0b\u4e00\u4e2aChannelHandler\u3002\u56e0\u6b64\uff0c\u5982\u679cexceptionCaught()\u65b9\u6cd5\u6ca1\u6709\u88ab\u8be5\u94fe\u4e2d\u7684\u67d0\u5904\u5b9e\u73b0\uff0c\u90a3\u4e48\u6240\u63a5\u6536\u7684\u5f02\u5e38\u5c06\u4f1a\u88ab\u4f20\u9012\u5230ChannelPipeline\u7684\u5c3e\u7aef\u5e76\u88ab\u8bb0\u5f55\u3002\u4e3a\u6b64\uff0c\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u5e94\u8be5\u63d0\u4f9b\u81f3\u5c11\u6709\u4e00\u4e2a\u5b9e\u73b0\u4e86exceptionCaught()\u65b9\u6cd5\u7684ChannelHandler\u3002</p> <p>\u9664\u4e86ChannelInboundHandlerAdapter\u4e4b\u5916\uff0c\u8fd8\u6709\u5f88\u591a\u9700\u8981\u5b66\u4e60\u7684ChannelHandler\u7684\u5b50\u7c7b\u578b\u548c\u5b9e\u73b0\u3002\u76ee\u524d\uff0c\u8bf7\u8bb0\u4f4f\u4e0b\u9762\u8fd9\u4e9b\u5173\u952e\u70b9\uff1a</p> <ul> <li>\u9488\u5bf9\u4e0d\u540c\u7c7b\u578b\u7684\u4e8b\u4ef6\u6765\u8c03\u7528ChannelHandler\uff1b</li> <li>\u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7\u5b9e\u73b0\u6216\u8005\u6269\u5c55ChannelHandler\u6765\u6302\u94a9\u5230\u4e8b\u4ef6\u7684\u751f\u547d\u5468\u671f\uff0c\u5e76\u4e14\u63d0\u4f9b\u81ea\u5b9a\u4e49\u7684\u5e94\u7528\u7a0b\u5e8f\u903b\u8f91\uff1b</li> <li>\u5728\u67b6\u6784\u4e0a\uff0cChannelHandler\u6709\u52a9\u4e8e\u4fdd\u6301\u4e1a\u52a1\u903b\u8f91\u4e0e\u7f51\u7edc\u5904\u7406\u4ee3\u7801\u7684\u5206\u79bb\u3002\u8fd9\u7b80\u5316\u4e86\u5f00\u53d1\u8fc7\u7a0b\uff0c\u56e0\u4e3a\u4ee3\u7801\u5fc5\u987b\u4e0d\u65ad\u5730\u6f14\u5316\u4ee5\u54cd\u5e94\u4e0d\u65ad\u53d8\u5316\u7684\u9700\u6c42\u3002</li> </ul>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9AEcho%E6%9C%8D%E5%8A%A1%E5%99%A8/#bootstrapping-the-server","title":"\u5f15\u5bfc\u670d\u52a1\u5668\uff08Bootstrapping the server\uff09","text":"<p>\u5728\u8ba8\u8bba\u8fc7\u7531EchoServerHandler\u5b9e\u73b0\u7684\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\u4e4b\u540e\uff0c\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u63a2\u8ba8\u5f15\u5bfc\u670d\u52a1\u5668\u672c\u8eab\u7684\u8fc7\u7a0b\u4e86\uff0c\u5177\u4f53\u6d89\u53ca\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <ul> <li>\u7ed1\u5b9a\u5230\u670d\u52a1\u5668\u5c06\u5728\u5176\u4e0a\u76d1\u542c\u5e76\u63a5\u53d7\u4f20\u5165\u8fde\u63a5\u8bf7\u6c42\u7684\u7aef\u53e3\uff1b</li> <li>\u914d\u7f6eChannel\uff0c\u4ee5\u5c06\u6709\u5173\u7684\u5165\u7ad9\u6d88\u606f\u901a\u77e5\u7ed9EchoServerHandler\u5b9e\u4f8b\u3002</li> </ul> <p>\u4f20\u8f93\u5c42\uff08Transports\uff09</p> <p>\u5728\u7f51\u7edc\u534f\u8bae\u7684\u6807\u51c6\u591a\u5c42\u89c6\u56fe\u4e2d\uff0c\u4f20\u8f93\u5c42\u63d0\u4f9b\u4e86\u7aef\u5230\u7aef\u7684\u6216\u8005\u4e3b\u673a\u5230\u4e3b\u673a\u7684\u901a\u4fe1\u670d\u52a1\u3002\u56e0\u7279\u7f51\u901a\u4fe1\u662f\u5efa\u7acb\u5728TCP\u4f20\u8f93\u4e4b\u4e0a\u7684\u3002\u9664\u4e86\u4e00\u4e9b\u7531Java NIO\u5b9e\u73b0\u63d0\u4f9b\u7684\u670d\u52a1\u5668\u7aef\u6027\u80fd\u589e\u5f3a\u4e4b\u5916\uff0cNIO\u4f20\u8f93\u5927\u591a\u6570\u65f6\u5019\u6307\u7684\u5c31\u662fTCP\u4f20\u8f93\u3002</p> <p>\u4ee3\u7801\u6e05\u53552-2\u5c55\u793a\u4e86EchoServer\u7c7b\u7684\u5b8c\u6574\u4ee3\u7801\u3002</p> <pre><code>// \u4ee3\u7801\u6e05\u53552-2\u3000EchoServer\u7c7b\npublic class EchoServer {\nprivate final int port;\n\npublic EchoServer(int port) {\nthis.port = port;\n}\n\npublic static void main(String[] args) throws Exception {\nif (args.length != 1) {\nSystem.err.println(\n\"Usage: \" + EchoServer.class.getSimpleName() +\n\" \");\n}\nint port = Integer.parseInt(args[0]);   // \u8bbe\u7f6e\u7aef\u53e3\u503c\uff08\u5982\u679c\u7aef\u53e3\u53c2\u6570\u7684\u683c\u5f0f\u4e0d\u6b63\u786e\uff0c\u5219\u629b\u51fa\u4e00\u4e2aNumberFormatException\uff09\nnew EchoServer(port).start();   // \u8c03\u7528\u670d\u52a1\u5668\u7684start()\u65b9\u6cd5\n}\npublic void start() throws Exception {\nfinal EchoServerHandler serverHandler = new EchoServerHandler();\nEventLoopGroup group = new NioEventLoopGroup();   // \u2776 \u521b\u5efaEvent-LoopGroup\ntry {\nServerBootstrap b = new ServerBootstrap();   //  \u2777 \u521b\u5efaServer-Bootstrap\nb.group(group)\n.channel(NioServerSocketChannel.class)   // \u2778 \u6307\u5b9a\u6240\u4f7f\u7528\u7684NIO\u4f20\u8f93Channel\n.localAddress(new InetSocketAddress(port))   // \u2779 \u4f7f\u7528\u6307\u5b9a\u7684\u7aef\u53e3\u8bbe\u7f6e\u5957\u63a5\u5b57\u5730\u5740\n.childHandler(new ChannelInitializer(){   // \u277a\u6dfb\u52a0\u4e00\u4e2aEchoServer-\nHandler\u5230\u5b50Channel\u7684ChannelPipeline\n@Override\npublic void initChannel(SocketChannel ch)\nthrows Exception {\nch.pipeline().addLast(serverHandler);[5]   // EchoServerHandler\u88ab\u6807\u6ce8\u4e3a@Shareable\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u603b\u662f\u4f7f\u7528\u540c\u6837\u7684\u5b9e\u4f8b\n}\n});\nChannelFuture f = b.bind().sync();   // \u277b \u5f02\u6b65\u5730\u7ed1\u5b9a\u670d\u52a1\u5668\uff1b\u8c03\u7528sync()\u65b9\u6cd5\u963b\u585e\u7b49\u5f85\u76f4\u5230\u7ed1\u5b9a\u5b8c\u6210\nf.channel().closeFuture().sync();   // \u277c \u83b7\u53d6Channel\u7684CloseFuture\uff0c\u5e76\u4e14\u963b\u585e\u5f53\u524d\u7ebf\u7a0b\u76f4\u5230\u5b83\u5b8c\u6210\n} finally {\ngroup.shutdownGracefully().sync();   //  \u277d \u5173\u95edEventLoopGroup\uff0c\u91ca\u653e\u6240\u6709\u7684\u8d44\u6e90\n}\n}\n}\n</code></pre> <p>\u5728\u278b\u5904\uff0c\u4f60\u521b\u5efa\u4e86\u4e00\u4e2a<code>ServerBootstrap</code>\u5b9e\u4f8b\u3002\u56e0\u4e3a\u4f60\u6b63\u5728\u4f7f\u7528\u7684\u662f<code>NIO</code>\u4f20\u8f93\uff0c\u6240\u4ee5\u4f60\u6307\u5b9a\u4e86<code>NioEventLoopGroup</code>\u278a\u6765\u63a5\u53d7\u548c\u5904\u7406\u65b0\u7684\u8fde\u63a5\uff0c\u5e76\u4e14\u5c06Channel\u7684\u7c7b\u578b\u6307\u5b9a\u4e3a<code>NioServerSocketChannel</code>\u278c\u3002\u5728\u6b64\u4e4b\u540e\uff0c\u4f60\u5c06\u672c\u5730\u5730\u5740\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u5177\u6709\u9009\u5b9a\u7aef\u53e3\u7684<code>InetSocketAddress</code>\u278d\u3002\u670d\u52a1\u5668\u5c06\u7ed1\u5b9a\u5230\u8fd9\u4e2a\u5730\u5740\u4ee5\u76d1\u542c\u65b0\u7684\u8fde\u63a5\u8bf7\u6c42\u3002</p> <p>\u5728\u278e\u5904\uff0c\u4f60\u4f7f\u7528\u4e86\u4e00\u4e2a\u7279\u6b8a\u7684\u7c7b\u2014\u2014<code>ChannelInitializer</code>\u3002\u8fd9\u662f\u5173\u952e\u3002\u5f53\u4e00\u4e2a\u65b0\u7684\u8fde\u63a5\u88ab\u63a5\u53d7\u65f6\uff0c\u4e00\u4e2a\u65b0\u7684\u5b50Channel\u5c06\u4f1a\u88ab\u521b\u5efa\uff0c\u800cChannelInitializer\u5c06\u4f1a\u628a\u4e00\u4e2a\u4f60\u7684<code>EchoServerHandler</code>\u7684\u5b9e\u4f8b\u6dfb\u52a0\u5230\u8be5Channel\u7684<code>ChannelPipeline</code>\u4e2d\u3002\u6b63\u5982\u6211\u4eec\u4e4b\u524d\u6240\u89e3\u91ca\u7684\uff0c\u8fd9\u4e2aChannelHandler\u5c06\u4f1a\u6536\u5230\u6709\u5173\u5165\u7ad9\u6d88\u606f\u7684\u901a\u77e5\u3002</p> <p>\u867d\u7136NIO\u662f\u53ef\u4f38\u7f29\u7684\uff0c\u4f46\u662f\u5176\u9002\u5f53\u7684\u5c24\u5176\u662f\u5173\u4e8e\u591a\u7ebf\u7a0b\u5904\u7406\u7684\u914d\u7f6e\u5e76\u4e0d\u7b80\u5355\u3002Netty\u7684\u8bbe\u8ba1\u5c01\u88c5\u4e86\u5927\u90e8\u5206\u7684\u590d\u6742\u6027\u3002</p> <p>\u63a5\u4e0b\u6765\u4f60\u7ed1\u5b9a\u4e86\u670d\u52a1\u5668\u278f\uff0c\u5e76\u7b49\u5f85\u7ed1\u5b9a\u5b8c\u6210\u3002\uff08\u5bf9<code>sync()</code>\u65b9\u6cd5\u7684\u8c03\u7528\u5c06\u5bfc\u81f4\u5f53\u524dThread<code>\u963b\u585e</code>\uff0c\u4e00\u76f4\u5230\u7ed1\u5b9a\u64cd\u4f5c\u5b8c\u6210\u4e3a\u6b62\uff09\u3002\u5728\u2790\u5904\uff0c\u8be5\u5e94\u7528\u7a0b\u5e8f\u5c06\u4f1a\u963b\u585e\u7b49\u5f85\u76f4\u5230\u670d\u52a1\u5668\u7684Channel\u5173\u95ed\uff08\u56e0\u4e3a\u4f60\u5728Channel\u7684<code>Close Future</code>\u4e0a\u8c03\u7528\u4e86sync()\u65b9\u6cd5\uff09\u3002\u7136\u540e\uff0c\u4f60\u5c06\u53ef\u4ee5\u5173\u95ed<code>EventLoopGroup</code>\uff0c\u5e76\u91ca\u653e\u6240\u6709\u7684\u8d44\u6e90\uff0c\u5305\u62ec\u6240\u6709\u88ab\u521b\u5efa\u7684\u7ebf\u7a0b\u2791\u3002</p> <p>\u8fd9\u4e2a\u793a\u4f8b\u4f7f\u7528\u4e86NIO\uff0c\u56e0\u4e3a\u5f97\u76ca\u4e8e\u5b83\u7684\u53ef\u6269\u5c55\u6027\u548c\u5f7b\u5e95\u7684\u5f02\u6b65\u6027\uff0c\u5b83\u662f\u76ee\u524d\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u4f20\u8f93\u3002\u4f46\u662f\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u4e0d\u540c\u7684\u4f20\u8f93\u5b9e\u73b0\u3002\u5982\u679c\u4f60\u60f3\u8981\u5728\u81ea\u5df1\u7684\u670d\u52a1\u5668\u4e2d\u4f7f\u7528OIO\u4f20\u8f93\uff0c\u5c06\u9700\u8981\u6307\u5b9a<code>OioServerSocketChannel</code>\u548c<code>OioEventLoopGroup</code>\u3002</p> <p>\u4e0e\u6b64\u540c\u65f6\uff0c\u8ba9\u6211\u4eec\u56de\u987e\u4e00\u4e0b\u4f60\u521a\u5b8c\u6210\u7684\u670d\u52a1\u5668\u5b9e\u73b0\u4e2d\u7684\u91cd\u8981\u6b65\u9aa4\u3002\u4e0b\u9762\u8fd9\u4e9b\u662f\u670d\u52a1\u5668\u7684\u4e3b\u8981\u4ee3\u7801\u7ec4\u4ef6\uff1a</p> <ul> <li><code>EchoServerHandler</code>\u5b9e\u73b0\u4e86\u4e1a\u52a1\u903b\u8f91</li> <li><code>main()</code>\u65b9\u6cd5<code>\u5f15\u5bfc</code>\u4e86\u670d\u52a1\u5668</li> </ul> <p>\u5f15\u5bfc\u8fc7\u7a0b\u4e2d\u6240\u9700\u8981\u7684\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <ul> <li>\u521b\u5efa\u4e00\u4e2a<code>ServerBootstrap</code>\u7684\u5b9e\u4f8b\u4ee5\u5f15\u5bfc\u548c\u7ed1\u5b9a\u670d\u52a1\u5668</li> <li>\u521b\u5efa\u5e76\u5206\u914d\u4e00\u4e2a<code>NioEventLoopGroup</code>\u5b9e\u4f8b\u4ee5\u8fdb\u884c\u4e8b\u4ef6\u7684\u5904\u7406\uff0c\u5982\u63a5\u53d7\u65b0\u8fde\u63a5\u4ee5\u53ca<code>\u8bfb/\u5199</code>\u6570\u636e</li> <li>\u6307\u5b9a\u670d\u52a1\u5668\u7ed1\u5b9a\u7684\u672c\u5730\u7684<code>InetSocketAddress</code></li> <li>\u4f7f\u7528\u4e00\u4e2a<code>EchoServerHandler</code>\u7684\u5b9e\u4f8b\u521d\u59cb\u5316\u6bcf\u4e00\u4e2a\u65b0\u7684<code>Channel</code></li> <li>\u8c03\u7528<code>ServerBootstrap.bind()</code>\u65b9\u6cd5\u4ee5\u7ed1\u5b9a\u670d\u52a1\u5668</li> </ul> <p>\u5728\u8fd9\u4e2a\u65f6\u5019\uff0c\u670d\u52a1\u5668\u5df2\u7ecf\u521d\u59cb\u5316\uff0c\u5e76\u4e14\u5df2\u7ecf\u5c31\u7eea\u80fd\u88ab\u4f7f\u7528\u4e86\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6/","title":"2018 01 22 Netty\u6846\u67b6\uff1a\u6838\u5fc3\u7ec4\u4ef6","text":"<p>\u6211\u4eec\u5c06\u9996\u5148\u770b\u4e00\u770bNetty\u7684\u6838\u5fc3\u7ec4\u4ef6\u3002\u76ee\u524d\u53ea\u9700\u8981\u5c06\u5b83\u4eec\u770b\u4f5c\u662f\u57df\u5bf9\u8c61\uff0c\u800c\u4e0d\u662f\u5177\u4f53\u7684Java\u7c7b\u3002\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\uff0c\u6211\u4eec\u5c06\u770b\u5230\u5b83\u4eec\u662f\u5982\u4f55\u534f\u4f5c\uff0c\u6765\u4e3a\u5728\u7f51\u7edc\u4e0a\u53d1\u751f\u7684\u4e8b\u4ef6\u63d0\u4f9b\u901a\u77e5\uff0c\u5e76\u4f7f\u5f97\u5b83\u4eec\u53ef\u4ee5\u88ab\u5904\u7406\u7684\u3002</p> <p>Netty\u7684\u4e3b\u8981\u6784\u4ef6\u5757\uff1a</p> <ul> <li>Channel</li> <li>\u56de\u8c03</li> <li>Future</li> <li>\u4e8b\u4ef6\u548cChannelHandler</li> </ul> <p>\u8fd9\u4e9b\u6784\u5efa\u5757\u4ee3\u8868\u4e86\u4e0d\u540c\u7c7b\u578b\u7684\u6784\u9020\uff1a\u8d44\u6e90\u3001\u903b\u8f91\u4ee5\u53ca\u901a\u77e5\u3002\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u5c06\u4f7f\u7528\u5b83\u4eec\u6765\u8bbf\u95ee\u7f51\u7edc\u4ee5\u53ca\u6d41\u7ecf\u7f51\u7edc\u7684\u6570\u636e\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6/#1-channel","title":"1 Channel","text":"<p><code>Channel</code>\u662fJava NIO\u7684\u4e00\u4e2a\u57fa\u672c\u6784\u9020\u3002\u5b83\u4ee3\u8868\u4e00\u4e2a\u5230\u5b9e\u4f53\uff08\u5982\u4e00\u4e2a\u786c\u4ef6\u8bbe\u5907\u3001\u4e00\u4e2a\u6587\u4ef6\u3001\u4e00\u4e2a\u7f51\u7edc\u5957\u63a5\u5b57\u6216\u8005\u4e00\u4e2a\u80fd\u591f\u6267\u884c\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u4e0d\u540c\u7684I/O\u64cd\u4f5c\u7684\u7a0b\u5e8f\u7ec4\u4ef6\uff09\u7684\u5f00\u653e\u8fde\u63a5\uff0c\u5982\u8bfb\u64cd\u4f5c\u548c\u5199\u64cd\u4f5c\u3002</p> <p>\u76ee\u524d\uff0c\u53ef\u4ee5\u628aChannel\u770b\u4f5c\u662f\u4f20\u5165\uff08\u5165\u7ad9\uff09\u6216\u8005\u4f20\u51fa\uff08\u51fa\u7ad9\uff09\u6570\u636e\u7684\u8f7d\u4f53\u3002\u56e0\u6b64\uff0c\u5b83\u53ef\u4ee5\u88ab\u6253\u5f00\u6216\u8005\u88ab\u5173\u95ed\uff0c\u8fde\u63a5\u6216\u8005\u65ad\u5f00\u8fde\u63a5\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6/#2","title":"2 \u56de\u8c03","text":"<p>\u4e00\u4e2a\u56de\u8c03\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u65b9\u6cd5\uff0c\u4e00\u4e2a\u6307\u5411\u5df2\u7ecf\u88ab\u63d0\u4f9b\u7ed9\u53e6\u5916\u4e00\u4e2a\u65b9\u6cd5\u7684\u65b9\u6cd5\u7684\u5f15\u7528\u3002\u8fd9\u4f7f\u5f97\u540e\u8005\u53ef\u4ee5\u5728\u9002\u5f53\u7684\u65f6\u5019\u8c03\u7528\u524d\u8005\u3002\u56de\u8c03\u5728\u5e7f\u6cdb\u7684\u7f16\u7a0b\u573a\u666f\u4e2d\u90fd\u6709\u5e94\u7528\uff0c\u800c\u4e14\u4e5f\u662f\u5728\u64cd\u4f5c\u5b8c\u6210\u540e\u901a\u77e5\u76f8\u5173\u65b9\u6700\u5e38\u89c1\u7684\u65b9\u5f0f\u4e4b\u4e00\u3002</p> <p>Netty\u5728\u5185\u90e8\u4f7f\u7528\u4e86\u56de\u8c03\u6765\u5904\u7406\u4e8b\u4ef6\uff1b\u5f53\u4e00\u4e2a\u56de\u8c03\u88ab\u89e6\u53d1\u65f6\uff0c\u76f8\u5173\u7684\u4e8b\u4ef6\u53ef\u4ee5\u88ab\u4e00\u4e2ainterface-<code>ChannelHandler</code>\u7684\u5b9e\u73b0\u5904\u7406\u3002\u4ee3\u7801\u6e05\u53551-2\u5c55\u793a\u4e86\u4e00\u4e2a\u4f8b\u5b50\uff1a\u5f53\u4e00\u4e2a\u65b0\u7684\u8fde\u63a5\u5df2\u7ecf\u88ab\u5efa\u7acb\u65f6\uff0cChannelHandler\u7684<code>channelActive()</code>\u56de\u8c03\u65b9\u6cd5\u5c06\u4f1a\u88ab\u8c03\u7528\uff0c\u5e76\u5c06\u6253\u5370\u51fa\u4e00\u6761\u4fe1\u606f\u3002</p> <pre><code>// \u4ee3\u7801\u6e05\u53551-2\u3000\u88ab\u56de\u8c03\u89e6\u53d1\u7684ChannelHandler\npublic class ConnectHandler extends ChannelInboundHandlerAdapter {\n@Override\npublic void channelActive(ChannelHandlerContext ctx)\nthrows Exception {    // \u5f53\u4e00\u4e2a\u65b0\u7684\u8fde\u63a5\u5df2\u7ecf\u88ab\u5efa\u7acb\u65f6\uff0cchannelActive(ChannelHandlerContext)\u5c06\u4f1a\u88ab\u8c03\u7528\nSystem.out.println(\n\"Client \" + ctx.channel().remoteAddress() + \" connected\");\n}\n}\n</code></pre>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6/#3-future","title":"3 Future","text":"<p><code>Future</code>\u63d0\u4f9b\u4e86\u53e6\u4e00\u79cd\u5728\u64cd\u4f5c\u5b8c\u6210\u65f6\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\u7684\u65b9\u5f0f\u3002\u8fd9\u4e2a\u5bf9\u8c61\u53ef\u4ee5\u770b\u4f5c\u662f\u4e00\u4e2a\u5f02\u6b65\u64cd\u4f5c\u7684\u7ed3\u679c\u7684\u5360\u4f4d\u7b26\uff1b\u5b83\u5c06\u5728\u672a\u6765\u7684\u67d0\u4e2a\u65f6\u523b\u5b8c\u6210\uff0c\u5e76\u63d0\u4f9b\u5bf9\u5176\u7ed3\u679c\u7684\u8bbf\u95ee\u3002</p> <p>JDK\u9884\u7f6e\u4e86interface <code>java.util.concurrent.Future</code>\uff0c\u4f46\u662f\u5176\u6240\u63d0\u4f9b\u7684\u5b9e\u73b0\uff0c\u53ea\u5141\u8bb8\u624b\u52a8\u68c0\u67e5\u5bf9\u5e94\u7684\u64cd\u4f5c\u662f\u5426\u5df2\u7ecf\u5b8c\u6210\uff0c\u6216\u8005\u4e00\u76f4\u963b\u585e\u76f4\u5230\u5b83\u5b8c\u6210\u3002\u8fd9\u662f\u975e\u5e38\u7e41\u7410\u7684\uff0c\u6240\u4ee5Netty\u63d0\u4f9b\u4e86\u5b83\u81ea\u5df1\u7684\u5b9e\u73b0\u2014\u2014<code>ChannelFuture</code>\uff0c\u7528\u4e8e\u5728\u6267\u884c\u5f02\u6b65\u64cd\u4f5c\u7684\u65f6\u5019\u4f7f\u7528\u3002</p> <p>ChannelFuture\u63d0\u4f9b\u4e86\u51e0\u79cd\u989d\u5916\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u4f7f\u5f97\u6211\u4eec\u80fd\u591f\u6ce8\u518c\u4e00\u4e2a\u6216\u8005\u591a\u4e2a<code>ChannelFutureListener</code>\u5b9e\u4f8b\u3002\u76d1\u542c\u5668\u7684\u56de\u8c03\u65b9\u6cd5<code>operationComplete()</code>\uff0c\u5c06\u4f1a\u5728\u5bf9\u5e94\u7684\u64cd\u4f5c\u5b8c\u6210\u65f6\u88ab\u8c03\u7528\uff08\u5982\u679c\u5728ChannelFutureListener\u6dfb\u52a0\u5230ChannelFuture\u7684\u65f6\u5019\uff0cChannelFuture\u5df2\u7ecf\u5b8c\u6210\uff0c\u90a3\u4e48\u8be5ChannelFutureListener\u5c06\u4f1a\u88ab\u76f4\u63a5\u5730\u901a\u77e5\u3002\uff09\u3002\u7136\u540e\u76d1\u542c\u5668\u53ef\u4ee5\u5224\u65ad\u8be5\u64cd\u4f5c\u662f\u6210\u529f\u5730\u5b8c\u6210\u4e86\u8fd8\u662f\u51fa\u9519\u4e86\u3002\u5982\u679c\u662f\u540e\u8005\uff0c\u6211\u4eec\u53ef\u4ee5\u68c0\u7d22\u4ea7\u751f\u7684<code>Throwable</code>\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u7531ChannelFutureListener\u63d0\u4f9b\u7684\u901a\u77e5\u673a\u5236\u6d88\u9664\u4e86\u624b\u52a8\u68c0\u67e5\u5bf9\u5e94\u7684\u64cd\u4f5c\u662f\u5426\u5b8c\u6210\u7684\u5fc5\u8981\u3002</p> <p>\u6bcf\u4e2aNetty\u7684\u51fa\u7ad9I/O\u64cd\u4f5c\u90fd\u5c06\u8fd4\u56de\u4e00\u4e2aChannelFuture\uff1b\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u4eec\u90fd\u4e0d\u4f1a\u963b\u585e\u3002\u6b63\u5982\u6211\u4eec\u524d\u9762\u6240\u63d0\u5230\u8fc7\u7684\u4e00\u6837\uff0cNetty\u5b8c\u5168\u662f\u5f02\u6b65\u548c\u4e8b\u4ef6\u9a71\u52a8\u7684\u3002</p> <p>\u4ee3\u7801\u6e05\u53551-3\u5c55\u793a\u4e86\u4e00\u4e2aChannelFuture\u4f5c\u4e3a\u4e00\u4e2aI/O\u64cd\u4f5c\u7684\u4e00\u90e8\u5206\u8fd4\u56de\u7684\u4f8b\u5b50\u3002\u8fd9\u91cc\uff0c<code>connect()</code>\u65b9\u6cd5\u5c06\u4f1a\u76f4\u63a5\u8fd4\u56de\uff0c\u800c\u4e0d\u4f1a\u963b\u585e\uff0c\u8be5\u8c03\u7528\u5c06\u4f1a\u5728\u540e\u53f0\u5b8c\u6210\u3002\u8fd9\u7a76\u7adf\u4ec0\u4e48\u65f6\u5019\u4f1a\u53d1\u751f\u5219\u53d6\u51b3\u4e8e\u82e5\u5e72\u7684\u56e0\u7d20\uff0c\u4f46\u8fd9\u4e2a\u5173\u6ce8\u70b9\u5df2\u7ecf\u4ece\u4ee3\u7801\u4e2d\u62bd\u8c61\u51fa\u6765\u4e86\u3002\u56e0\u4e3a\u7ebf\u7a0b\u4e0d\u7528\u963b\u585e\u4ee5\u7b49\u5f85\u5bf9\u5e94\u7684\u64cd\u4f5c\u5b8c\u6210\uff0c\u6240\u4ee5\u5b83\u53ef\u4ee5\u540c\u65f6\u505a\u5176\u4ed6\u7684\u5de5\u4f5c\uff0c\u4ece\u800c\u66f4\u52a0\u6709\u6548\u5730\u5229\u7528\u8d44\u6e90\u3002</p> <pre><code>// \u4ee3\u7801\u6e05\u53551-3\u3000\u5f02\u6b65\u5730\u5efa\u7acb\u8fde\u63a5\nChannel channel = ...;\n// Does not block\nChannelFuture future = channel.connect(     // \u5f02\u6b65\u5730\u8fde\u63a5\u5230\u8fdc\u7a0b\u8282\u70b9\nnew InetSocketAddress(\"192.168.0.1\", 25));\n</code></pre> <p>\u4ee3\u7801\u6e05\u53551-4\u663e\u793a\u4e86\u5982\u4f55\u5229\u7528ChannelFutureListener\u3002\u9996\u5148\uff0c\u8981\u8fde\u63a5\u5230\u8fdc\u7a0b\u8282\u70b9\u4e0a\u3002\u7136\u540e\uff0c\u8981\u6ce8\u518c\u4e00\u4e2a\u65b0\u7684<code>ChannelFutureListener</code>\u5230\u5bf9<code>connect()</code>\u65b9\u6cd5\u7684\u8c03\u7528\u6240\u8fd4\u56de\u7684ChannelFuture\u4e0a\u3002\u5f53\u8be5\u76d1\u542c\u5668\u88ab\u901a\u77e5\u8fde\u63a5\u5df2\u7ecf\u5efa\u7acb\u7684\u65f6\u5019\uff0c\u8981\u68c0\u67e5\u5bf9\u5e94\u7684\u72b6\u6001\u2776\u3002\u5982\u679c\u8be5\u64cd\u4f5c\u662f\u6210\u529f\u7684\uff0c\u90a3\u4e48\u5c06\u6570\u636e\u5199\u5230\u8be5Channel\u3002\u5426\u5219\uff0c\u8981\u4eceChannelFuture\u4e2d\u68c0\u7d22\u5bf9\u5e94\u7684Throwable\u3002</p> <pre><code>// \u4ee3\u7801\u6e05\u53551-4\u3000\u56de\u8c03\u5b9e\u6218\nChannel channel = ...;\n// Does not block\nChannelFuture future = channel.connect(  // \u5f02\u6b65\u5730\u8fde\u63a5\u5230\u8fdc\u7a0b\u8282\u70b9\nnew InetSocketAddress(\"192.168.0.1\", 25));\nfuture.addListener(new ChannelFutureListener() {   //  \u6ce8\u518c\u4e00\u4e2aChannelFutureListener\uff0c\u4ee5\u4fbf\u5728\u64cd\u4f5c\u5b8c\u6210\u65f6\u83b7\u5f97\u901a\u77e5\n@Override\npublic void operationComplete(ChannelFuture future) { //  \u2776 \u68c0\u67e5\u64cd\u4f5c\n\u7684\u72b6\u6001\nif (future.isSuccess()){\nByteBuf buffer = Unpooled.copiedBuffer(  // \u5982\u679c\u64cd\u4f5c\u662f\u6210\u529f\u7684\uff0c\u5219\u521b\u5efa\u4e00\u4e2aByteBuf\u4ee5\u6301\u6709\u6570\u636e\n\"Hello\",Charset.defaultCharset());\nChannelFuture wf = future.channel()\n.writeAndFlush(buffer);   // \u5c06\u6570\u636e\u5f02\u6b65\u5730\u53d1\u9001\u5230\u8fdc\u7a0b\u8282\u70b9\u3002\n\u8fd4\u56de\u4e00\u4e2aChannelFuture\n....\n} else {\nThrowable cause = future.cause();\u3000\u3000//\u3000\u5982\u679c\u53d1\u751f\u9519\u8bef\uff0c\u5219\u8bbf\u95ee\u63cf\u8ff0\u539f\u56e0\u7684Throwable\ncause.printStackTrace();\n}\n}\n});\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5bf9\u9519\u8bef\u7684\u5904\u7406\u5b8c\u5168\u53d6\u51b3\u4e8e\u4f60\u3001\u76ee\u6807\uff0c\u5f53\u7136\u4e5f\u5305\u62ec\u76ee\u524d\u4efb\u4f55\u5bf9\u4e8e\u7279\u5b9a\u7c7b\u578b\u7684\u9519\u8bef\u52a0\u4ee5\u7684\u9650\u5236\u3002\u4f8b\u5982\uff0c\u5982\u679c\u8fde\u63a5\u5931\u8d25\uff0c\u4f60\u53ef\u4ee5\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u6216\u8005\u5efa\u7acb\u4e00\u4e2a\u5230\u53e6\u4e00\u4e2a\u8fdc\u7a0b\u8282\u70b9\u7684\u8fde\u63a5\u3002</p> <p>\u5982\u679c\u4f60\u628a<code>ChannelFutureListener</code>\u770b\u4f5c\u662f\u56de\u8c03\u7684\u4e00\u4e2a\u66f4\u52a0\u7cbe\u7ec6\u7684\u7248\u672c\uff0c\u90a3\u4e48\u4f60\u662f\u5bf9\u7684\u3002\u4e8b\u5b9e\u4e0a\uff0c\u56de\u8c03\u548cFuture\u662f\u76f8\u4e92\u8865\u5145\u7684\u673a\u5236\uff1b\u5b83\u4eec\u76f8\u4e92\u7ed3\u5408\uff0c\u6784\u6210\u4e86Netty\u672c\u8eab\u7684\u5173\u952e\u6784\u4ef6\u5757\u4e4b\u4e00\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6/#4-channelhandler","title":"4 \u4e8b\u4ef6\u548cChannelHandler","text":"<p>Netty\u4f7f\u7528\u4e0d\u540c\u7684\u4e8b\u4ef6\u6765\u901a\u77e5\u6211\u4eec\u72b6\u6001\u7684\u6539\u53d8\u6216\u8005\u662f\u64cd\u4f5c\u7684\u72b6\u6001\u3002\u8fd9\u4f7f\u5f97\u6211\u4eec\u80fd\u591f\u57fa\u4e8e\u5df2\u7ecf\u53d1\u751f\u7684\u4e8b\u4ef6\u6765\u89e6\u53d1\u9002\u5f53\u7684\u52a8\u4f5c\u3002\u8fd9\u4e9b\u52a8\u4f5c\u53ef\u80fd\u662f\uff1a</p> <ul> <li>\u8bb0\u5f55\u65e5\u5fd7</li> <li>\u6570\u636e\u8f6c\u6362</li> <li>\u6d41\u63a7\u5236</li> <li>\u5e94\u7528\u7a0b\u5e8f\u903b\u8f91</li> </ul> <p>Netty\u662f\u4e00\u4e2a\u7f51\u7edc\u7f16\u7a0b\u6846\u67b6\uff0c\u6240\u4ee5\u4e8b\u4ef6\u662f\u6309\u7167\u5b83\u4eec\u4e0e\u5165\u7ad9\u6216\u51fa\u7ad9\u6570\u636e\u6d41\u7684\u76f8\u5173\u6027\u8fdb\u884c\u5206\u7c7b\u7684\u3002\u53ef\u80fd\u7531\u5165\u7ad9\u6570\u636e\u6216\u8005\u76f8\u5173\u7684\u72b6\u6001\u66f4\u6539\u800c\u89e6\u53d1\u7684\u4e8b\u4ef6\u5305\u62ec\uff1a</p> <ul> <li>\u8fde\u63a5\u5df2\u88ab\u6fc0\u6d3b\u6216\u8005\u8fde\u63a5\u5931\u6d3b</li> <li>\u6570\u636e\u8bfb\u53d6</li> <li>\u7528\u6237\u4e8b\u4ef6</li> <li>\u9519\u8bef\u4e8b\u4ef6</li> </ul> <p>\u51fa\u7ad9\u4e8b\u4ef6\u662f\u672a\u6765\u5c06\u4f1a\u89e6\u53d1\u7684\u67d0\u4e2a\u52a8\u4f5c\u7684\u64cd\u4f5c\u7ed3\u679c\uff0c\u8fd9\u4e9b\u52a8\u4f5c\u5305\u62ec\uff1a</p> <ul> <li>\u6253\u5f00\u6216\u8005\u5173\u95ed\u5230\u8fdc\u7a0b\u8282\u70b9\u7684\u8fde\u63a5</li> <li>\u5c06\u6570\u636e\u5199\u5230\u6216\u8005\u51b2\u5237\u5230\u5957\u63a5\u5b57</li> </ul> <p>\u6bcf\u4e2a\u4e8b\u4ef6\u90fd\u53ef\u4ee5\u88ab\u5206\u53d1\u7ed9<code>ChannelHandler</code>\u7c7b\u4e2d\u7684\u67d0\u4e2a\u7528\u6237\u5b9e\u73b0\u7684\u65b9\u6cd5\u3002\u8fd9\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u5c06\u4e8b\u4ef6\u9a71\u52a8\u8303\u5f0f\u76f4\u63a5\u8f6c\u6362\u4e3a\u5e94\u7528\u7a0b\u5e8f\u6784\u4ef6\u5757\u7684\u4f8b\u5b50\u3002\u56fe1-3\u5c55\u793a\u4e86\u4e00\u4e2a\u4e8b\u4ef6\u662f\u5982\u4f55\u88ab\u4e00\u4e2a\u8fd9\u6837\u7684ChannelHandler\u94fe\u5904\u7406\u7684\u3002</p> <p></p> <p>\u56fe1-3\u3000\u6d41\u7ecfChannelHandler\u94fe\u7684\u5165\u7ad9\u4e8b\u4ef6\u548c\u51fa\u7ad9\u4e8b\u4ef6</p> <p>Netty\u7684ChannelHandler\u4e3a\u5904\u7406\u5668\u63d0\u4f9b\u4e86\u57fa\u672c\u7684\u62bd\u8c61\uff0c\u5982\u56fe1-3\u6240\u793a\u7684\u90a3\u4e9b\u3002\u6211\u4eec\u4f1a\u5728\u9002\u5f53\u7684\u65f6\u5019\u5bf9ChannelHandler\u8fdb\u884c\u66f4\u591a\u7684\u8bf4\u660e\uff0c\u4f46\u662f\u76ee\u524d\u4f60\u53ef\u4ee5\u8ba4\u4e3a\u6bcf\u4e2aChannelHandler\u7684\u5b9e\u4f8b\u90fd\u7c7b\u4f3c\u4e8e\u4e00\u79cd\u4e3a\u4e86\u54cd\u5e94\u7279\u5b9a\u4e8b\u4ef6\u800c\u88ab\u6267\u884c\u7684\u56de\u8c03\u3002</p> <p>Netty\u63d0\u4f9b\u4e86\u5927\u91cf\u9884\u5b9a\u4e49\u7684\u53ef\u4ee5\u5f00\u7bb1\u5373\u7528\u7684ChannelHandler\u5b9e\u73b0\uff0c\u5305\u62ec\u7528\u4e8e\u5404\u79cd\u534f\u8bae\uff08\u5982HTTP\u548cSSL/TLS\uff09\u7684ChannelHandler\u3002\u5728\u5185\u90e8\uff0cChannelHandler\u81ea\u5df1\u4e5f\u4f7f\u7528\u4e86\u4e8b\u4ef6\u548cFuture\uff0c\u4f7f\u5f97\u5b83\u4eec\u4e5f\u6210\u4e3a\u4e86\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u5c06\u4f7f\u7528\u7684\u76f8\u540c\u62bd\u8c61\u7684\u6d88\u8d39\u8005\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6/#5","title":"5 \u628a\u5b83\u4eec\u653e\u5728\u4e00\u8d77","text":""},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6/#1-futurechannelhandler","title":"1 Future\u3001\u56de\u8c03\u548cChannelHandler","text":"<p>Netty\u7684\u5f02\u6b65\u7f16\u7a0b\u6a21\u578b\u662f\u5efa\u7acb\u5728Future\u548c\u56de\u8c03\u7684\u6982\u5ff5\u4e4b\u4e0a\u7684\uff0c \u800c\u5c06\u4e8b\u4ef6\u6d3e\u53d1\u5230ChannelHandler\u7684\u65b9\u6cd5\u5219\u53d1\u751f\u5728\u66f4\u6df1\u7684\u5c42\u6b21\u4e0a\u3002\u7ed3\u5408\u5728\u4e00\u8d77\uff0c\u8fd9\u4e9b\u5143\u7d20\u5c31\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5904\u7406\u73af\u5883\uff0c\u4f7f\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u903b\u8f91\u53ef\u4ee5\u72ec\u7acb\u4e8e\u4efb\u4f55\u7f51\u7edc\u64cd\u4f5c\u76f8\u5173\u7684\u987e\u8651\u800c\u72ec\u7acb\u5730\u6f14\u53d8\u3002\u8fd9\u4e5f\u662fNetty\u7684\u8bbe\u8ba1\u65b9\u5f0f\u7684\u4e00\u4e2a\u5173\u952e\u76ee\u6807\u3002</p> <p>\u62e6\u622a\u64cd\u4f5c\u4ee5\u53ca\u9ad8\u901f\u5730\u8f6c\u6362\u5165\u7ad9\u6570\u636e\u548c\u51fa\u7ad9\u6570\u636e\uff0c\u90fd\u53ea\u9700\u8981\u4f60\u63d0\u4f9b\u56de\u8c03\u6216\u8005\u5229\u7528\u64cd\u4f5c\u6240\u8fd4\u56de\u7684Future\u3002\u8fd9\u4f7f\u5f97\u94fe\u63a5\u64cd\u4f5c\u53d8\u5f97\u65e2\u7b80\u5355\u53c8\u9ad8\u6548\uff0c\u5e76\u4e14\u4fc3\u8fdb\u4e86\u53ef\u91cd\u7528\u7684\u901a\u7528\u4ee3\u7801\u7684\u7f16\u5199\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6/#2-eventloop","title":"2 \u9009\u62e9\u5668\u3001\u4e8b\u4ef6\u548cEventLoop","text":"<p>Netty\u901a\u8fc7\u89e6\u53d1\u4e8b\u4ef6\u5c06Selector\u4ece\u5e94\u7528\u7a0b\u5e8f\u4e2d\u62bd\u8c61\u51fa\u6765\uff0c\u6d88\u9664\u4e86\u6240\u6709\u672c\u6765\u5c06\u9700\u8981\u624b\u52a8\u7f16\u5199\u7684\u6d3e\u53d1\uff08dispatch\uff09\u4ee3\u7801\u3002\u5728\u5185\u90e8\uff0c\u5c06\u4f1a\u4e3a\u6bcf\u4e2aChannel\u5206\u914d\u4e00\u4e2aEventLoop\uff0c\u7528\u4ee5\u5904\u7406\u6240\u6709\u4e8b\u4ef6\uff0c\u5305\u62ec\uff1a</p> <ul> <li>\u6ce8\u518c\u611f\u5174\u8da3\u7684\u4e8b\u4ef6</li> <li>\u5c06\u4e8b\u4ef6\u6d3e\u53d1\u7ed9ChannelHandler</li> <li>\u5b89\u6392\u8fdb\u4e00\u6b65\u7684\u52a8\u4f5c</li> </ul> <p><code>EventLoop</code>\u672c\u8eab\u53ea\u7531\u4e00\u4e2a\u7ebf\u7a0b\u9a71\u52a8\uff0c\u5176\u5904\u7406\u4e86\u4e00\u4e2aChannel\u7684\u6240\u6709I/O\u4e8b\u4ef6\uff0c\u5e76\u4e14\u5728\u8be5EventLoop\u7684\u6574\u4e2a\u751f\u547d\u5468\u671f\u5185\u90fd\u4e0d\u4f1a\u6539\u53d8\u3002\u8fd9\u4e2a\u7b80\u5355\u800c\u5f3a\u5927\u7684\u8bbe\u8ba1\u6d88\u9664\u4e86\u4f60\u53ef\u80fd\u6709\u7684\u5728ChannelHandler\u5b9e\u73b0\u4e2d\u9700\u8981\u8fdb\u884c\u540c\u6b65\u7684\u4efb\u4f55\u987e\u8651\uff0c\u56e0\u6b64\uff0c\u4f60\u53ef\u4ee5\u4e13\u6ce8\u4e8e\u63d0\u4f9b\u6b63\u786e\u7684\u903b\u8f91\uff0c\u7528\u6765\u5728\u6709\u611f\u5174\u8da3\u7684\u6570\u636e\u8981\u5904\u7406\u7684\u65f6\u5019\u6267\u884c\u3002\u5982\u540c\u6211\u4eec\u5728\u8be6\u7ec6\u63a2\u8ba8Netty\u7684\u7ebf\u7a0b\u6a21\u578b\u65f6\u5c06\u4f1a\u770b\u5230\u7684\uff0c\u8be5API\u662f\u7b80\u5355\u800c\u7d27\u51d1\u7684\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E7%BB%84%E4%BB%B6%E5%92%8C%E8%AE%BE%E8%AE%A1/","title":"2018 01 22 Netty\u6846\u67b6\uff1a\u7ec4\u4ef6\u548c\u8bbe\u8ba1","text":"<p>\u8ba9\u6211\u4eec\u4ece\u6846\u67b6\u7684\u89c6\u89d2\u6765\u63a2\u8ba8Netty\u3002\u4ece\u9ad8\u5c42\u6b21\u7684\u89d2\u5ea6\u6765\u770b\uff0cNetty\u89e3\u51b3\u4e86\u4e24\u4e2a\u76f8\u5e94\u7684\u5173\u6ce8\u9886\u57df\uff0c\u6211\u4eec\u53ef\u5c06\u5176\u5927\u81f4\u6807\u8bb0\u4e3a\u6280\u672f\u7684\u548c\u4f53\u7cfb\u7ed3\u6784\u7684\u3002\u9996\u5148\uff0c\u5b83\u7684\u57fa\u4e8eJava NIO\u7684\u5f02\u6b65\u7684\u548c\u4e8b\u4ef6\u9a71\u52a8\u7684\u5b9e\u73b0\uff0c\u4fdd\u8bc1\u4e86\u9ad8\u8d1f\u8f7d\u4e0b\u5e94\u7528\u7a0b\u5e8f\u6027\u80fd\u7684\u6700\u5927\u5316\u548c\u53ef\u4f38\u7f29\u6027\u3002\u5176\u6b21\uff0cNetty\u4e5f\u5305\u542b\u4e86\u4e00\u7ec4\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u5c06\u5e94\u7528\u7a0b\u5e8f\u903b\u8f91\u4ece\u7f51\u7edc\u5c42\u89e3\u8026\uff0c\u7b80\u5316\u4e86\u5f00\u53d1\u8fc7\u7a0b\uff0c\u540c\u65f6\u4e5f\u6700\u5927\u9650\u5ea6\u5730\u63d0\u9ad8\u4e86\u53ef\u6d4b\u8bd5\u6027\u3001\u6a21\u5757\u5316\u4ee5\u53ca\u4ee3\u7801\u7684\u53ef\u91cd\u7528\u6027\u3002</p> <p>\u5728\u6211\u4eec\u66f4\u52a0\u8be6\u7ec6\u5730\u7814\u7a76Netty\u7684\u5404\u4e2a\u7ec4\u4ef6\u65f6\uff0c\u6211\u4eec\u5c06\u5bc6\u5207\u5173\u6ce8\u5b83\u4eec\u662f\u5982\u4f55\u901a\u8fc7\u534f\u4f5c\u6765\u652f\u6491\u8fd9\u4e9b\u4f53\u7cfb\u7ed3\u6784\u4e0a\u7684\u6700\u4f73\u5b9e\u8df5\u7684\u3002\u901a\u8fc7\u9075\u5faa\u540c\u6837\u7684\u539f\u5219\uff0c\u6211\u4eec\u4fbf\u53ef\u83b7\u5f97Netty\u6240\u63d0\u4f9b\u7684\u6240\u6709\u76ca\u5904\u3002\u7262\u8bb0\u8fd9\u4e2a\u76ee\u6807\uff0c\u6211\u4eec\u5c06\u56de\u987e\u5230\u76ee\u524d\u4e3a\u6b62\u6211\u4eec\u4ecb\u7ecd\u8fc7\u7684\u4e3b\u8981\u6982\u5ff5\u548c\u7ec4\u4ef6\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E7%BB%84%E4%BB%B6%E5%92%8C%E8%AE%BE%E8%AE%A1/#channeleventloopchannelfuture","title":"Channel\u3001EventLoop\u548cChannelFuture","text":"<p>\u63a5\u4e0b\u6765\u7684\u5404\u8282\u5c06\u4f1a\u4e3a\u6211\u4eec\u5bf9\u4e8eChannel\u3001EventLoop\u548cChannelFuture\u7c7b\u8fdb\u884c\u7684\u8ba8\u8bba\u589e\u6dfb\u66f4\u591a\u7684\u7ec6\u8282\uff0c\u8fd9\u4e9b\u7c7b\u5408\u5728\u4e00\u8d77\uff0c\u53ef\u4ee5\u88ab\u8ba4\u4e3a\u662fNetty\u7f51\u7edc\u62bd\u8c61\u7684\u4ee3\u8868\uff1a</p> <ul> <li>Channel\u2014\u2014Socket</li> <li>EventLoop\u2014\u2014\u63a7\u5236\u6d41\u3001\u591a\u7ebf\u7a0b\u5904\u7406\u3001\u5e76\u53d1</li> <li>ChannelFuture\u2014\u2014\u5f02\u6b65\u901a\u77e5</li> </ul>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E7%BB%84%E4%BB%B6%E5%92%8C%E8%AE%BE%E8%AE%A1/#channel","title":"Channel\u63a5\u53e3","text":"<p>\u57fa\u672c\u7684I/O\u64cd\u4f5c\uff08bind()\u3001connect()\u3001read()\u548cwrite()\uff09\u4f9d\u8d56\u4e8e\u5e95\u5c42\u7f51\u7edc\u4f20\u8f93\u6240\u63d0\u4f9b\u7684\u539f\u8bed\u3002\u5728\u57fa\u4e8eJava\u7684\u7f51\u7edc\u7f16\u7a0b\u4e2d\uff0c\u5176\u57fa\u672c\u7684\u6784\u9020\u662fclass Socket\u3002Netty\u7684Channel\u63a5\u53e3\u6240\u63d0\u4f9b\u7684API\uff0c\u5927\u5927\u5730\u964d\u4f4e\u4e86\u76f4\u63a5\u4f7f\u7528Socket\u7c7b\u7684\u590d\u6742\u6027\u3002\u6b64\u5916\uff0cChannel\u4e5f\u662f\u62e5\u6709\u8bb8\u591a\u9884\u5b9a\u4e49\u7684\u3001\u4e13\u95e8\u5316\u5b9e\u73b0\u7684\u5e7f\u6cdb\u7c7b\u5c42\u6b21\u7ed3\u6784\u7684\u6839\uff0c\u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u77ed\u7684\u90e8\u5206\u6e05\u5355\uff1a</p> <ul> <li>EmbeddedChannel</li> <li>LocalServerChannel</li> <li>NioDatagramChannel</li> <li>NioSctpChannel</li> <li>NioSocketChannel</li> </ul>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E7%BB%84%E4%BB%B6%E5%92%8C%E8%AE%BE%E8%AE%A1/#eventloop","title":"EventLoop\u63a5\u53e3","text":"<p>EventLoop\u5b9a\u4e49\u4e86Netty\u7684\u6838\u5fc3\u62bd\u8c61\uff0c\u7528\u4e8e\u5904\u7406\u8fde\u63a5\u7684\u751f\u547d\u5468\u671f\u4e2d\u6240\u53d1\u751f\u7684\u4e8b\u4ef6\u3002\u76ee\u524d\uff0c\u56fe3-1\u5728\u9ad8\u5c42\u6b21\u4e0a\u8bf4\u660e\u4e86Channel\u3001EventLoop\u3001Thread\u4ee5\u53caEventLoopGroup\u4e4b\u95f4\u7684\u5173\u7cfb\u3002</p> <p></p> <p>\u56fe3-1\u3000Channel\u3001EventLoop\u548cEventLoopGroup</p> <p>\u8fd9\u4e9b\u5173\u7cfb\u662f\uff1a</p> <ul> <li>\u4e00\u4e2aEventLoopGroup\u5305\u542b\u4e00\u4e2a\u6216\u8005\u591a\u4e2aEventLoop</li> <li>\u4e00\u4e2aEventLoop\u5728\u5b83\u7684\u751f\u547d\u5468\u671f\u5185\u53ea\u548c\u4e00\u4e2aThread\u7ed1\u5b9a</li> <li>\u6240\u6709\u7531EventLoop\u5904\u7406\u7684I/O\u4e8b\u4ef6\u90fd\u5c06\u5728\u5b83\u4e13\u6709\u7684Thread\u4e0a\u88ab\u5904\u7406</li> <li>\u4e00\u4e2aChannel\u5728\u5b83\u7684\u751f\u547d\u5468\u671f\u5185\u53ea\u6ce8\u518c\u4e8e\u4e00\u4e2aEventLoop</li> <li>\u4e00\u4e2aEventLoop\u53ef\u80fd\u4f1a\u88ab\u5206\u914d\u7ed9\u4e00\u4e2a\u6216\u591a\u4e2aChannel</li> </ul>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E7%BB%84%E4%BB%B6%E5%92%8C%E8%AE%BE%E8%AE%A1/#channelfuture","title":"ChannelFuture\u63a5\u53e3","text":"<p>\u6b63\u5982\u6211\u4eec\u5df2\u7ecf\u89e3\u91ca\u8fc7\u7684\u90a3\u6837\uff0cNetty\u4e2d\u6240\u6709\u7684I/O\u64cd\u4f5c\u90fd\u662f\u5f02\u6b65\u7684\u3002\u56e0\u4e3a\u4e00\u4e2a\u64cd\u4f5c\u53ef\u80fd\u4e0d\u4f1a\u7acb\u5373\u8fd4\u56de\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4e00\u79cd\u7528\u4e8e\u5728\u4e4b\u540e\u7684\u67d0\u4e2a\u65f6\u95f4\u70b9\u786e\u5b9a\u5176\u7ed3\u679c\u7684\u65b9\u6cd5\u3002\u4e3a\u6b64\uff0cNetty\u63d0\u4f9b\u4e86<code>ChannelFuture</code>\u63a5\u53e3\uff0c\u5176<code>addListener()</code>\u65b9\u6cd5\u6ce8\u518c\u4e86\u4e00\u4e2a<code>ChannelFutureListener</code>\uff0c\u4ee5\u4fbf\u5728\u67d0\u4e2a\u64cd\u4f5c\u5b8c\u6210\u65f6\uff08\u65e0\u8bba\u662f\u5426\u6210\u529f\uff09\u5f97\u5230\u901a\u77e5\u3002</p> <p>\u5173\u4e8eChannelFuture\u7684\u66f4\u591a\u8ba8\u8bba</p> <p>\u53ef\u4ee5\u5c06ChannelFuture\u770b\u4f5c\u662f\u5c06\u6765\u8981\u6267\u884c\u7684\u64cd\u4f5c\u7684\u7ed3\u679c\u7684\u5360\u4f4d\u7b26\u3002\u5b83\u7a76\u7adf\u4ec0\u4e48\u65f6\u5019\u88ab\u6267\u884c\u5219\u53ef\u80fd\u53d6\u51b3\u4e8e\u82e5\u5e72\u7684\u56e0\u7d20\uff0c\u56e0\u6b64\u4e0d\u53ef\u80fd\u51c6\u786e\u5730\u9884\u6d4b\uff0c\u4f46\u662f\u53ef\u4ee5\u80af\u5b9a\u7684\u662f\u5b83\u5c06\u4f1a\u88ab\u6267\u884c\u3002\u6b64\u5916\uff0c\u6240\u6709\u5c5e\u4e8e\u540c\u4e00\u4e2aChannel\u7684\u64cd\u4f5c\u90fd\u88ab\u4fdd\u8bc1\u5176\u5c06\u4ee5\u5b83\u4eec\u88ab\u8c03\u7528\u7684\u987a\u5e8f\u88ab\u6267\u884c\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E7%BB%84%E4%BB%B6%E5%92%8C%E8%AE%BE%E8%AE%A1/#channelhandlerchannelpipeline","title":"ChannelHandler\u548cChannelPipeline","text":"<p>\u73b0\u5728\uff0c\u6211\u4eec\u5c06\u66f4\u52a0\u7ec6\u81f4\u5730\u770b\u4e00\u770b\u90a3\u4e9b\u7ba1\u7406\u6570\u636e\u6d41\u4ee5\u53ca\u6267\u884c\u5e94\u7528\u7a0b\u5e8f\u5904\u7406\u903b\u8f91\u7684\u7ec4\u4ef6\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E7%BB%84%E4%BB%B6%E5%92%8C%E8%AE%BE%E8%AE%A1/#channelhandler","title":"ChannelHandler\u63a5\u53e3","text":"<p>\u4ece\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u7684\u89d2\u5ea6\u6765\u770b\uff0cNetty\u7684\u4e3b\u8981\u7ec4\u4ef6\u662f<code>ChannelHandler</code>\uff0c\u5b83\u5145\u5f53\u4e86\u6240\u6709\u5904\u7406\u5165\u7ad9\u548c\u51fa\u7ad9\u6570\u636e\u7684\u5e94\u7528\u7a0b\u5e8f\u903b\u8f91\u7684\u5bb9\u5668\u3002\u8fd9\u662f\u53ef\u884c\u7684\uff0c\u56e0\u4e3a<code>ChannelHandler</code>\u7684\u65b9\u6cd5\u662f\u7531\u7f51\u7edc\u4e8b\u4ef6\uff08\u5176\u4e2d\u672f\u8bed\u201c\u4e8b\u4ef6\u201d\u7684\u4f7f\u7528\u975e\u5e38\u5e7f\u6cdb\uff09\u89e6\u53d1\u7684\u3002\u4e8b\u5b9e\u4e0a\uff0c<code>ChannelHandler</code>\u53ef\u4e13\u95e8\u7528\u4e8e\u51e0\u4e4e\u4efb\u4f55\u7c7b\u578b\u7684\u52a8\u4f5c\uff0c\u4f8b\u5982\u5c06\u6570\u636e\u4ece\u4e00\u79cd\u683c\u5f0f\u8f6c\u6362\u4e3a\u53e6\u5916\u4e00\u79cd\u683c\u5f0f\uff0c\u6216\u8005\u5904\u7406\u8f6c\u6362\u8fc7\u7a0b\u4e2d\u6240\u629b\u51fa\u7684\u5f02\u5e38\u3002</p> <p>\u4e3e\u4f8b\u6765\u8bf4\uff0c<code>ChannelInboundHandler</code>\u662f\u4e00\u4e2a\u4f60\u5c06\u4f1a\u7ecf\u5e38\u5b9e\u73b0\u7684\u5b50\u63a5\u53e3\u3002\u8fd9\u79cd\u7c7b\u578b\u7684<code>ChannelHandler</code>\u63a5\u6536\u5165\u7ad9\u4e8b\u4ef6\u548c\u6570\u636e\uff0c\u8fd9\u4e9b\u6570\u636e\u968f\u540e\u5c06\u4f1a\u88ab\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u4e1a\u52a1\u903b\u8f91\u6240\u5904\u7406\u3002\u5f53\u4f60\u8981\u7ed9\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\u53d1\u9001\u54cd\u5e94\u65f6\uff0c\u4e5f\u53ef\u4ee5\u4ece<code>ChannelInboundHandler</code>\u51b2\u5237\u6570\u636e\u3002\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u4e1a\u52a1\u903b\u8f91\u901a\u5e38\u9a7b\u7559\u5728\u4e00\u4e2a\u6216\u8005\u591a\u4e2a<code>ChannelInboundHandler</code>\u4e2d\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E7%BB%84%E4%BB%B6%E5%92%8C%E8%AE%BE%E8%AE%A1/#channelpipeline","title":"ChannelPipeline\u63a5\u53e3","text":"<p>ChannelPipeline\u4e3aChannelHandler\u94fe\u63d0\u4f9b\u4e86\u5bb9\u5668\uff0c\u5e76\u5b9a\u4e49\u4e86\u7528\u4e8e\u5728\u8be5\u94fe\u4e0a\u4f20\u64ad\u5165\u7ad9\u548c\u51fa\u7ad9\u4e8b\u4ef6\u6d41\u7684API\u3002\u5f53Channel\u88ab\u521b\u5efa\u65f6\uff0c\u5b83\u4f1a\u88ab\u81ea\u52a8\u5730\u5206\u914d\u5230\u5b83\u4e13\u5c5e\u7684ChannelPipeline\u3002</p> <p>ChannelHandler\u5b89\u88c5\u5230ChannelPipeline\u4e2d\u7684\u8fc7\u7a0b\u5982\u4e0b\u6240\u793a\uff1a</p> <ul> <li>\u4e00\u4e2aChannelInitializer\u7684\u5b9e\u73b0\u88ab\u6ce8\u518c\u5230\u4e86ServerBootstrap\uff08\u6216Bootstrap\uff09\u4e2d</li> <li>\u5f53<code>ChannelInitializer.initChannel()</code>\u65b9\u6cd5\u88ab\u8c03\u7528\u65f6\uff0c<code>ChannelInitializer</code>\u5c06\u5728<code>ChannelPipeline</code>\u4e2d\u5b89\u88c5\u4e00\u7ec4\u81ea\u5b9a\u4e49\u7684<code>ChannelHandler</code></li> <li><code>ChannelInitializer</code>\u5c06\u5b83\u81ea\u5df1\u4ece<code>ChannelPipeline</code>\u4e2d\u79fb\u9664</li> </ul> <p>\u4e3a\u4e86\u5ba1\u67e5\u53d1\u9001\u6216\u8005\u63a5\u6536\u6570\u636e\u65f6\u5c06\u4f1a\u53d1\u751f\u4ec0\u4e48\uff0c\u8ba9\u6211\u4eec\u6765\u66f4\u52a0\u6df1\u5165\u5730\u7814\u7a76ChannelPipeline\u548cChannelHandler\u4e4b\u95f4\u7684\u5171\u751f\u5173\u7cfb\u5427\u3002</p> <p>ChannelHandler\u662f\u4e13\u4e3a\u652f\u6301\u5e7f\u6cdb\u7684\u7528\u9014\u800c\u8bbe\u8ba1\u7684\uff0c\u53ef\u4ee5\u5c06\u5b83\u770b\u4f5c\u662f\u5904\u7406\u5f80\u6765Channel- Pipeline\u4e8b\u4ef6\uff08\u5305\u62ec\u6570\u636e\uff09\u7684\u4efb\u4f55\u4ee3\u7801\u7684\u901a\u7528\u5bb9\u5668\u3002\u56fe3-2\u8bf4\u660e\u4e86\u8fd9\u4e00\u70b9\uff0c\u5176\u5c55\u793a\u4e86\u4eceChannel- Handler\u6d3e\u751f\u7684ChannelInboundHandler\u548cChannelOutboundHandler\u63a5\u53e3\u3002</p> <p></p> <p>\u56fe3-2\u3000ChannelHandler\u7c7b\u7684\u5c42\u6b21\u7ed3\u6784</p> <p>\u4f7f\u5f97\u4e8b\u4ef6\u6d41\u7ecfChannelPipeline\u662fChannelHandler\u7684\u5de5\u4f5c\uff0c\u5b83\u4eec\u662f\u5728\u5e94\u7528\u7a0b\u5e8f\u7684\u521d\u59cb\u5316\u6216\u8005\u5f15\u5bfc\u9636\u6bb5\u88ab\u5b89\u88c5\u7684\u3002\u8fd9\u4e9b\u5bf9\u8c61\u63a5\u6536\u4e8b\u4ef6\u3001\u6267\u884c\u5b83\u4eec\u6240\u5b9e\u73b0\u7684\u5904\u7406\u903b\u8f91\uff0c\u5e76\u5c06\u6570\u636e\u4f20\u9012\u7ed9\u94fe\u4e2d\u7684\u4e0b\u4e00\u4e2aChannelHandler\u3002\u5b83\u4eec\u7684\u6267\u884c\u987a\u5e8f\u662f\u7531\u5b83\u4eec\u88ab\u6dfb\u52a0\u7684\u987a\u5e8f\u6240\u51b3\u5b9a\u7684\u3002\u5b9e\u9645\u4e0a\uff0c\u88ab\u6211\u4eec\u79f0\u4e3aChannelPipeline\u7684\u662f\u8fd9\u4e9bChannelHandler\u7684\u7f16\u6392\u987a\u5e8f\uff08ordered arrangement\uff09\u3002</p> <p></p> <p>\u56fe3-3\u3000\u5305\u542b\u5165\u7ad9\u548c\u51fa\u7ad9ChannelHandler\u7684ChannelPipeline</p> <p>\u56fe3-3\u8bf4\u660e\u4e86\u4e00\u4e2aNetty\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5165\u7ad9\uff08inbound\uff09\u548c\u51fa\u7ad9\uff08outbound\uff09\u6570\u636e\u6d41\u4e4b\u95f4\u7684\u533a\u522b\u3002\u4ece\u4e00\u4e2a\u5ba2\u6237\u7aef\u5e94\u7528\u7a0b\u5e8f\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u5982\u679c\u4e8b\u4ef6\u7684\u8fd0\u52a8\u65b9\u5411\u662f\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u5668\u7aef\uff0c\u90a3\u4e48\u6211\u4eec\u79f0\u8fd9\u4e9b\u4e8b\u4ef6\u4e3a\u51fa\u7ad9\u7684\uff0c\u53cd\u4e4b\u5219\u79f0\u4e3a\u5165\u7ad9\u7684\u3002</p> <p>\u56fe3-3\u4e5f\u663e\u793a\u4e86\u5165\u7ad9\u548c\u51fa\u7ad9ChannelHandler\u53ef\u4ee5\u88ab\u5b89\u88c5\u5230\u540c\u4e00\u4e2aChannelPipeline\u4e2d\u3002\u5982\u679c\u4e00\u4e2a\u6d88\u606f\u6216\u8005\u4efb\u4f55\u5176\u4ed6\u7684\u5165\u7ad9\u4e8b\u4ef6\u88ab\u8bfb\u53d6\uff0c\u90a3\u4e48\u5b83\u4f1a\u4eceChannelPipeline\u7684\u5934\u90e8\u5f00\u59cb\u6d41\u52a8\uff0c\u5e76\u88ab\u4f20\u9012\u7ed9\u7b2c\u4e00\u4e2aChannelInboundHandler\u3002\u8fd9\u4e2aChannelHandler\u4e0d\u4e00\u5b9a\u4f1a\u5b9e\u9645\u5730\u4fee\u6539\u6570\u636e\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u5b83\u7684\u5177\u4f53\u529f\u80fd\uff0c\u5728\u8fd9\u4e4b\u540e\uff0c\u6570\u636e\u5c06\u4f1a\u88ab\u4f20\u9012\u7ed9\u94fe\u4e2d\u7684\u4e0b\u4e00\u4e2aChannelInboundHandler\u3002\u6700\u7ec8\uff0c\u6570\u636e\u5c06\u4f1a\u5230\u8fbeChannelPipeline\u7684\u5c3e\u7aef\uff0c\u5c4a\u65f6\uff0c\u6240\u6709\u5904\u7406\u5c31\u90fd\u7ed3\u675f\u4e86\u3002</p> <p>\u6570\u636e\u7684\u51fa\u7ad9\u8fd0\u52a8\uff08\u5373\u6b63\u5728\u88ab\u5199\u7684\u6570\u636e\uff09\u5728\u6982\u5ff5\u4e0a\u4e5f\u662f\u4e00\u6837\u7684\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6570\u636e\u5c06\u4eceChannelOutboundHandler\u94fe\u7684\u5c3e\u7aef\u5f00\u59cb\u6d41\u52a8\uff0c\u76f4\u5230\u5b83\u5230\u8fbe\u94fe\u7684\u5934\u90e8\u4e3a\u6b62\u3002\u5728\u8fd9\u4e4b\u540e\uff0c\u51fa\u7ad9\u6570\u636e\u5c06\u4f1a\u5230\u8fbe\u7f51\u7edc\u4f20\u8f93\u5c42\uff0c\u8fd9\u91cc\u663e\u793a\u4e3aSocket\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u8fd9\u5c06\u89e6\u53d1\u4e00\u4e2a\u5199\u64cd\u4f5c\u3002</p> <p>\u5173\u4e8e\u5165\u7ad9\u548c\u51fa\u7ad9ChannelHandler\u7684\u66f4\u591a\u8ba8\u8bba</p> <p>\u901a\u8fc7\u4f7f\u7528\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u5230\u6bcf\u4e2a\u65b9\u6cd5\u7684<code>ChannelHandlerContext</code>\uff0c\u4e8b\u4ef6\u53ef\u4ee5\u88ab\u4f20\u9012\u7ed9\u5f53\u524dChannelHandler\u94fe\u4e2d\u7684\u4e0b\u4e00\u4e2aChannelHandler\u3002\u56e0\u4e3a\u4f60\u6709\u65f6\u4f1a\u5ffd\u7565\u90a3\u4e9b\u4e0d\u611f\u5174\u8da3\u7684\u4e8b\u4ef6\uff0c\u6240\u4ee5Netty\u63d0\u4f9b\u4e86\u62bd\u8c61\u57fa\u7c7b<code>ChannelInboundHandlerAdapter</code>\u548c<code>ChannelOutboundHandlerAdapter</code>\u3002\u901a\u8fc7\u8c03\u7528ChannelHandlerContext\u4e0a\u7684\u5bf9\u5e94\u65b9\u6cd5\uff0c\u6bcf\u4e2a\u90fd\u63d0\u4f9b\u4e86\u7b80\u5355\u5730\u5c06\u4e8b\u4ef6\u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a<code>ChannelHandler</code>\u7684\u65b9\u6cd5\u7684\u5b9e\u73b0\u3002\u968f\u540e\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u91cd\u5199\u4f60\u6240\u611f\u5174\u8da3\u7684\u90a3\u4e9b\u65b9\u6cd5\u6765\u6269\u5c55\u8fd9\u4e9b\u7c7b\u3002</p> <p>\u9274\u4e8e\u51fa\u7ad9\u64cd\u4f5c\u548c\u5165\u7ad9\u64cd\u4f5c\u662f\u4e0d\u540c\u7684\uff0c\u4f60\u53ef\u80fd\u4f1a\u60f3\u77e5\u9053\u5982\u679c\u5c06\u4e24\u4e2a\u7c7b\u522b\u7684ChannelHandler\u90fd\u6df7\u5408\u6dfb\u52a0\u5230\u540c\u4e00\u4e2aChannelPipeline\u4e2d\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002\u867d\u7136ChannelInboundHandle\u548cChannelOutboundHandle\u90fd\u6269\u5c55\u81eaChannelHandler\uff0c\u4f46\u662fNetty\u80fd\u533a\u5206ChannelInboundHandler\u5b9e\u73b0\u548cChannelOutboundHandler\u5b9e\u73b0\uff0c\u5e76\u786e\u4fdd\u6570\u636e\u53ea\u4f1a\u5728\u5177\u6709\u76f8\u540c\u5b9a\u5411\u7c7b\u578b\u7684\u4e24\u4e2aChannelHandler\u4e4b\u95f4\u4f20\u9012\u3002</p> <p>\u5f53ChannelHandler\u88ab\u6dfb\u52a0\u5230ChannelPipeline\u65f6\uff0c\u5b83\u5c06\u4f1a\u88ab\u5206\u914d\u4e00\u4e2aChannelHandlerContext\uff0c\u5176\u4ee3\u8868\u4e86ChannelHandler\u548cChannelPipeline\u4e4b\u95f4\u7684\u7ed1\u5b9a\u3002\u867d\u7136\u8fd9\u4e2a\u5bf9\u8c61\u53ef\u4ee5\u88ab\u7528\u4e8e\u83b7\u53d6\u5e95\u5c42\u7684Channel\uff0c\u4f46\u662f\u5b83\u4e3b\u8981\u8fd8\u662f\u88ab\u7528\u4e8e\u5199\u51fa\u7ad9\u6570\u636e\u3002</p> <p>\u5728Netty\u4e2d\uff0c\u6709\u4e24\u79cd\u53d1\u9001\u6d88\u606f\u7684\u65b9\u5f0f\u3002\u4f60\u53ef\u4ee5\u76f4\u63a5\u5199\u5230Channel\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u5199\u5230\u548cChannelHandler\u76f8\u5173\u8054\u7684ChannelHandlerContext\u5bf9\u8c61\u4e2d\u3002\u524d\u4e00\u79cd\u65b9\u5f0f\u5c06\u4f1a\u5bfc\u81f4\u6d88\u606f\u4eceChannelPipeline\u7684\u5c3e\u7aef\u5f00\u59cb\u6d41\u52a8\uff0c\u800c\u540e\u8005\u5c06\u5bfc\u81f4\u6d88\u606f\u4eceChannelPipeline\u4e2d\u7684\u4e0b\u4e00\u4e2aChannelHandler\u5f00\u59cb\u6d41\u52a8\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E7%BB%84%E4%BB%B6%E5%92%8C%E8%AE%BE%E8%AE%A1/#channelhandler_1","title":"\u66f4\u52a0\u6df1\u5165\u5730\u4e86\u89e3ChannelHandler","text":"<p>\u6b63\u5982\u6211\u4eec\u4e4b\u524d\u6240\u8bf4\u7684\uff0c\u6709\u8bb8\u591a\u4e0d\u540c\u7c7b\u578b\u7684ChannelHandler\uff0c\u5b83\u4eec\u5404\u81ea\u7684\u529f\u80fd\u4e3b\u8981\u53d6\u51b3\u4e8e\u5b83\u4eec\u7684\u8d85\u7c7b\u3002Netty\u4ee5\u9002\u914d\u5668\u7c7b\u7684\u5f62\u5f0f\u63d0\u4f9b\u4e86\u5927\u91cf\u9ed8\u8ba4\u7684ChannelHandler\u5b9e\u73b0\uff0c\u5176\u65e8\u5728\u7b80\u5316\u5e94\u7528\u7a0b\u5e8f\u5904\u7406\u903b\u8f91\u7684\u5f00\u53d1\u8fc7\u7a0b\u3002\u4f60\u5df2\u7ecf\u770b\u5230\u4e86\uff0cChannelPipeline\u4e2d\u7684\u6bcf\u4e2aChannelHandler\u5c06\u8d1f\u8d23\u628a\u4e8b\u4ef6\u8f6c\u53d1\u5230\u94fe\u4e2d\u7684\u4e0b\u4e00\u4e2aChannelHandler\u3002\u8fd9\u4e9b\u9002\u914d\u5668\u7c7b\uff08\u53ca\u5b83\u4eec\u7684\u5b50\u7c7b\uff09\u5c06\u81ea\u52a8\u6267\u884c\u8fd9\u4e2a\u64cd\u4f5c\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u53ea\u91cd\u5199\u90a3\u4e9b\u4f60\u60f3\u8981\u7279\u6b8a\u5904\u7406\u7684\u65b9\u6cd5\u548c\u4e8b\u4ef6\u3002</p> <p>\u4e3a\u4ec0\u4e48\u9700\u8981\u9002\u914d\u5668\u7c7b\uff08adapters\uff09\uff1f</p> <p>\u6709\u4e00\u4e9b\u9002\u914d\u5668\u7c7b\u53ef\u4ee5\u5c06\u7f16\u5199\u81ea\u5b9a\u4e49\u7684ChannelHandler\u6240\u9700\u8981\u7684\u52aa\u529b\u964d\u5230\u6700\u4f4e\u9650\u5ea6\uff0c\u56e0\u4e3a\u5b83\u4eec\u63d0\u4f9b\u4e86\u5b9a\u4e49\u5728\u5bf9\u5e94\u63a5\u53e3\u4e2d\u7684\u6240\u6709\u65b9\u6cd5\u7684\u9ed8\u8ba4\u5b9e\u73b0\u3002\u4e0b\u9762\u8fd9\u4e9b\u662f\u7f16\u5199\u81ea\u5b9a\u4e49ChannelHandler\u65f6\u7ecf\u5e38\u4f1a\u7528\u5230\u7684\u9002\u914d\u5668\u7c7b\uff1a</p> <ul> <li>ChannelHandlerAdapter</li> <li>ChannelInboundHandlerAdapter</li> <li>ChannelOutboundHandlerAdapter</li> <li>ChannelDuplexHandler</li> </ul> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u7814\u7a763\u4e2aChannelHandler\u7684\u5b50\u7c7b\u578b\uff1a<code>\u7f16\u7801\u5668</code>\u3001<code>\u89e3\u7801\u5668</code>\u548c<code>SimpleChannelInboundHandler&lt;T&gt;</code> \u2014\u2014 <code>ChannelInboundHandlerAdapter</code>\u7684\u4e00\u4e2a\u5b50\u7c7b\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E7%BB%84%E4%BB%B6%E5%92%8C%E8%AE%BE%E8%AE%A1/#_1","title":"\u7f16\u7801\u5668\u548c\u89e3\u7801\u5668","text":"<p>\u5f53\u4f60\u901a\u8fc7Netty\u53d1\u9001\u6216\u8005\u63a5\u6536\u4e00\u4e2a\u6d88\u606f\u7684\u65f6\u5019\uff0c\u5c31\u5c06\u4f1a\u53d1\u751f\u4e00\u6b21\u6570\u636e\u8f6c\u6362\u3002\u5165\u7ad9\u6d88\u606f\u4f1a\u88ab\u89e3\u7801\uff1b\u4e5f\u5c31\u662f\u8bf4\uff0c\u4ece\u5b57\u8282\u8f6c\u6362\u4e3a\u53e6\u4e00\u79cd\u683c\u5f0f\uff0c\u901a\u5e38\u662f\u4e00\u4e2aJava\u5bf9\u8c61\u3002\u5982\u679c\u662f\u51fa\u7ad9\u6d88\u606f\uff0c\u5219\u4f1a\u53d1\u751f\u76f8\u53cd\u65b9\u5411\u7684\u8f6c\u6362\uff1a\u5b83\u5c06\u4ece\u5b83\u7684\u5f53\u524d\u683c\u5f0f\u88ab\u7f16\u7801\u4e3a\u5b57\u8282\u3002\u8fd9\u4e24\u79cd\u65b9\u5411\u7684\u8f6c\u6362\u7684\u539f\u56e0\u5f88\u7b80\u5355\uff1a\u7f51\u7edc\u6570\u636e\u603b\u662f\u4e00\u7cfb\u5217\u7684\u5b57\u8282\u3002</p> <p>\u5bf9\u5e94\u4e8e\u7279\u5b9a\u7684\u9700\u8981\uff0cNetty\u4e3a\u7f16\u7801\u5668\u548c\u89e3\u7801\u5668\u63d0\u4f9b\u4e86\u4e0d\u540c\u7c7b\u578b\u7684\u62bd\u8c61\u7c7b\u3002\u4f8b\u5982\uff0c\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u4f7f\u7528\u4e86\u4e00\u79cd\u4e2d\u95f4\u683c\u5f0f\uff0c\u800c\u4e0d\u9700\u8981\u7acb\u5373\u5c06\u6d88\u606f\u8f6c\u6362\u6210\u5b57\u8282\u3002\u4f60\u5c06\u4ecd\u7136\u9700\u8981\u4e00\u4e2a\u7f16\u7801\u5668\uff0c\u4f46\u662f\u5b83\u5c06\u6d3e\u751f\u81ea\u4e00\u4e2a\u4e0d\u540c\u7684\u8d85\u7c7b\u3002\u4e3a\u4e86\u786e\u5b9a\u5408\u9002\u7684\u7f16\u7801\u5668\u7c7b\u578b\uff0c\u4f60\u53ef\u4ee5\u5e94\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u547d\u540d\u7ea6\u5b9a\u3002</p> <p>\u901a\u5e38\u6765\u8bf4\uff0c\u8fd9\u4e9b\u57fa\u7c7b\u7684\u540d\u79f0\u5c06\u7c7b\u4f3c\u4e8eByteToMessageDecoder\u6216MessageToByteEncoder\u3002\u5bf9\u4e8e\u7279\u6b8a\u7684\u7c7b\u578b\uff0c\u4f60\u53ef\u80fd\u4f1a\u53d1\u73b0\u7c7b\u4f3c\u4e8eProtobufEncoder\u548cProtobufDecoder\u8fd9\u6837\u7684\u540d\u79f0\u2014\u2014\u9884\u7f6e\u7684\u7528\u6765\u652f\u6301Google\u7684<code>Protocol Buffers</code>\u3002</p> <p>\u4e25\u683c\u5730\u8bf4\uff0c\u5176\u4ed6\u7684\u5904\u7406\u5668\u4e5f\u53ef\u4ee5\u5b8c\u6210\u7f16\u7801\u5668\u548c\u89e3\u7801\u5668\u7684\u529f\u80fd\u3002\u4f46\u662f\uff0c\u6b63\u5982\u6709\u7528\u6765\u7b80\u5316ChannelHandler\u7684\u521b\u5efa\u7684\u9002\u914d\u5668\u7c7b\u4e00\u6837\uff0c\u6240\u6709\u7531Netty\u63d0\u4f9b\u7684\u7f16\u7801\u5668/\u89e3\u7801\u5668\u9002\u914d\u5668\u7c7b\u90fd\u5b9e\u73b0\u4e86ChannelOutboundHandler\u6216\u8005ChannelInboundHandler\u63a5\u53e3\u3002</p> <p>\u4f60\u5c06\u4f1a\u53d1\u73b0\u5bf9\u4e8e\u5165\u7ad9\u6570\u636e\u6765\u8bf4\uff0cchannelRead\u65b9\u6cd5/\u4e8b\u4ef6\u5df2\u7ecf\u88ab\u91cd\u5199\u4e86\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u4ece\u5165\u7ad9Channel\u8bfb\u53d6\u7684\u6d88\u606f\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u90fd\u5c06\u4f1a\u88ab\u8c03\u7528\u3002\u968f\u540e\uff0c\u5b83\u5c06\u8c03\u7528\u7531\u9884\u7f6e\u89e3\u7801\u5668\u6240\u63d0\u4f9b\u7684decode()\u65b9\u6cd5\uff0c\u5e76\u5c06\u5df2\u89e3\u7801\u7684\u5b57\u8282\u8f6c\u53d1\u7ed9ChannelPipeline\u4e2d\u7684\u4e0b\u4e00\u4e2aChannelInboundHandler\u3002</p> <p>\u51fa\u7ad9\u6d88\u606f\u7684\u6a21\u5f0f\u662f\u76f8\u53cd\u65b9\u5411\u7684\uff1a\u7f16\u7801\u5668\u5c06\u6d88\u606f\u8f6c\u6362\u4e3a\u5b57\u8282\uff0c\u5e76\u5c06\u5b83\u4eec\u8f6c\u53d1\u7ed9\u4e0b\u4e00\u4e2aChannelOutboundHandler\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E7%BB%84%E4%BB%B6%E5%92%8C%E8%AE%BE%E8%AE%A1/#simplechannelinboundhandler","title":"\u62bd\u8c61\u7c7bSimpleChannelInboundHandler","text":"<p>\u6700\u5e38\u89c1\u7684\u60c5\u51b5\u662f\uff0c\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u4f1a\u5229\u7528\u4e00\u4e2aChannelHandler\u6765\u63a5\u6536\u89e3\u7801\u6d88\u606f\uff0c\u5e76\u5bf9\u8be5\u6570\u636e\u5e94\u7528\u4e1a\u52a1\u903b\u8f91\u3002\u8981\u521b\u5efa\u4e00\u4e2a\u8fd9\u6837\u7684ChannelHandler\uff0c\u4f60\u53ea\u9700\u8981\u6269\u5c55\u57fa\u7c7b<code>SimpleChannelInboundHandler&lt;T&gt;</code>\uff0c\u5176\u4e2dT\u662f\u4f60\u8981\u5904\u7406\u7684\u6d88\u606f\u7684Java\u7c7b\u578b\u3002\u5728\u8fd9\u4e2aChannelHandler\u4e2d\uff0c\u4f60\u5c06\u9700\u8981\u91cd\u5199\u57fa\u7c7b\u7684\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u65b9\u6cd5\uff0c\u5e76\u4e14\u83b7\u53d6\u4e00\u4e2a\u5230ChannelHandlerContext\u7684\u5f15\u7528\uff0c\u8fd9\u4e2a\u5f15\u7528\u5c06\u4f5c\u4e3a\u8f93\u5165\u53c2\u6570\u4f20\u9012\u7ed9ChannelHandler\u7684\u6240\u6709\u65b9\u6cd5\u3002</p> <p>\u5728\u8fd9\u79cd\u7c7b\u578b\u7684ChannelHandler\u4e2d\uff0c\u6700\u91cd\u8981\u7684\u65b9\u6cd5\u662fchannelRead0(ChannelHandlerContext,T)\u3002\u9664\u4e86\u8981\u6c42\u4e0d\u8981\u963b\u585e\u5f53\u524d\u7684I/O\u7ebf\u7a0b\u4e4b\u5916\uff0c\u5176\u5177\u4f53\u5b9e\u73b0\u5b8c\u5168\u53d6\u51b3\u4e8e\u4f60\u3002</p>"},{"location":"2018-01-22-Netty%E6%A1%86%E6%9E%B6%EF%BC%9A%E7%BB%84%E4%BB%B6%E5%92%8C%E8%AE%BE%E8%AE%A1/#bootstrap","title":"\u5f15\u5bfc\uff08Bootstrap\uff09","text":"<p>Netty\u7684\u5f15\u5bfc\u7c7b\u4e3a\u5e94\u7528\u7a0b\u5e8f\u7684\u7f51\u7edc\u5c42\u914d\u7f6e\u63d0\u4f9b\u4e86\u5bb9\u5668\uff0c\u8fd9\u6d89\u53ca\u5c06\u4e00\u4e2a\u8fdb\u7a0b\u7ed1\u5b9a\u5230\u67d0\u4e2a\u6307\u5b9a\u7684\u7aef\u53e3\uff0c\u6216\u8005\u5c06\u4e00\u4e2a\u8fdb\u7a0b\u8fde\u63a5\u5230\u53e6\u4e00\u4e2a\u8fd0\u884c\u5728\u67d0\u4e2a\u6307\u5b9a\u4e3b\u673a\u7684\u6307\u5b9a\u7aef\u53e3\u4e0a\u7684\u8fdb\u7a0b\u3002</p> <p>\u901a\u5e38\u6765\u8bf4\uff0c\u6211\u4eec\u628a\u524d\u9762\u7684\u7528\u4f8b\u79f0\u4f5c\u5f15\u5bfc\u4e00\u4e2a\u670d\u52a1\u5668\uff0c\u540e\u9762\u7684\u7528\u4f8b\u79f0\u4f5c\u5f15\u5bfc\u4e00\u4e2a\u5ba2\u6237\u7aef\u3002\u867d\u7136\u8fd9\u4e2a\u672f\u8bed\u7b80\u5355\u65b9\u4fbf\uff0c\u4f46\u662f\u5b83\u7565\u5fae\u63a9\u76d6\u4e86\u4e00\u4e2a\u91cd\u8981\u7684\u4e8b\u5b9e\uff0c\u5373\u201c\u670d\u52a1\u5668\u201d\u548c\u201c\u5ba2\u6237\u7aef\u201d\u5b9e\u9645\u4e0a\u8868\u793a\u4e86\u4e0d\u540c\u7684\u7f51\u7edc\u884c\u4e3a\uff1b\u6362\u53e5\u8bdd\u8bf4\uff0c\u662f\u76d1\u542c\u4f20\u5165\u7684\u8fde\u63a5\u8fd8\u662f\u5efa\u7acb\u5230\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u8fdb\u7a0b\u7684\u8fde\u63a5\u3002</p> <p>\u9762\u5411\u8fde\u63a5\u7684\u534f\u8bae\uff0c\u4e25\u683c\u6765\u8bf4\uff0c\u201c\u8fde\u63a5\u201d\u8fd9\u4e2a\u672f\u8bed\u4ec5\u9002\u7528\u4e8e\u9762\u5411\u8fde\u63a5\u7684\u534f\u8bae\uff0c\u5982TCP\uff0c\u5176\u4fdd\u8bc1\u4e86\u4e24\u4e2a\u8fde\u63a5\u7aef\u70b9\u4e4b\u95f4\u6d88\u606f\u7684\u6709\u5e8f\u4f20\u9012\u3002</p> <p>\u56e0\u6b64\uff0c\u6709\u4e24\u79cd\u7c7b\u578b\u7684\u5f15\u5bfc\uff1a\u4e00\u79cd\u7528\u4e8e\u5ba2\u6237\u7aef\uff08\u7b80\u5355\u5730\u79f0\u4e3aBootstrap\uff09\uff0c\u800c\u53e6\u4e00\u79cd\uff08ServerBootstrap\uff09\u7528\u4e8e\u670d\u52a1\u5668\u3002\u65e0\u8bba\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u54ea\u79cd\u534f\u8bae\u6216\u8005\u5904\u7406\u54ea\u79cd\u7c7b\u578b\u7684\u6570\u636e\uff0c\u552f\u4e00\u51b3\u5b9a\u5b83\u4f7f\u7528\u54ea\u79cd\u5f15\u5bfc\u7c7b\u7684\u662f\u5b83\u662f\u4f5c\u4e3a\u4e00\u4e2a\u5ba2\u6237\u7aef\u8fd8\u662f\u4f5c\u4e3a\u4e00\u4e2a\u670d\u52a1\u5668\u3002\u88683-1\u6bd4\u8f83\u4e86\u8fd9\u4e24\u79cd\u7c7b\u578b\u7684\u5f15\u5bfc\u7c7b\u3002</p> \u7c7b\u522b <code>BootStrap</code> <code>ServerBootstrap</code> \u7f51\u7edc\u7f16\u7a0b\u4e2d\u7684\u4f5c\u7528 \u8fde\u63a5\u5230\u8fdc\u7a0b\u4e3b\u673a\u548c\u7aef\u53e3 \u7ed1\u5b9a\u5230\u4e00\u4e2a\u672c\u5730\u7aef\u53e3 EventLoopGroup\u7684\u6570\u76ee 1 1\u62162 <p>\u8fd9\u4e24\u79cd\u7c7b\u578b\u7684\u5f15\u5bfc\u7c7b\u4e4b\u95f4\u7684\u7b2c\u4e00\u4e2a\u533a\u522b\u5df2\u7ecf\u8ba8\u8bba\u8fc7\u4e86\uff1a</p> <ul> <li>ServerBootstrap\u5c06\u7ed1\u5b9a\u5230\u4e00\u4e2a\u7aef\u53e3\uff0c\u56e0\u4e3a\u670d\u52a1\u5668\u5fc5\u987b\u8981\u76d1\u542c\u8fde\u63a5</li> <li>Bootstrap\u5219\u662f\u7531\u60f3\u8981\u8fde\u63a5\u5230\u8fdc\u7a0b\u8282\u70b9\u7684\u5ba2\u6237\u7aef\u5e94\u7528\u7a0b\u5e8f\u6240\u4f7f\u7528\u7684</li> </ul> <p>\u7b2c\u4e8c\u4e2a\u533a\u522b\u53ef\u80fd\u66f4\u52a0\u660e\u663e\u3002\u5f15\u5bfc\u4e00\u4e2a\u5ba2\u6237\u7aef\u53ea\u9700\u8981\u4e00\u4e2aEventLoopGroup\uff0c\u4f46\u662f\u4e00\u4e2aServerBootstrap\u5219\u9700\u8981\u4e24\u4e2a\uff08\u4e5f\u53ef\u4ee5\u662f\u540c\u4e00\u4e2a\u5b9e\u4f8b\uff09\u3002\u4e3a\u4ec0\u4e48\u5462\uff1f</p> <p>\u56e0\u4e3a\u670d\u52a1\u5668\u9700\u8981\u4e24\u7ec4\u4e0d\u540c\u7684Channel\u3002\u7b2c\u4e00\u7ec4\u5c06\u53ea\u5305\u542b\u4e00\u4e2aServerChannel\uff0c\u4ee3\u8868\u670d\u52a1\u5668\u81ea\u8eab\u7684\u5df2\u7ed1\u5b9a\u5230\u67d0\u4e2a\u672c\u5730\u7aef\u53e3\u7684\u6b63\u5728\u76d1\u542c\u7684\u5957\u63a5\u5b57\u3002\u800c\u7b2c\u4e8c\u7ec4\u5c06\u5305\u542b\u6240\u6709\u5df2\u521b\u5efa\u7684\u7528\u6765\u5904\u7406\u4f20\u5165\u5ba2\u6237\u7aef\u8fde\u63a5\uff08\u5bf9\u4e8e\u6bcf\u4e2a\u670d\u52a1\u5668\u5df2\u7ecf\u63a5\u53d7\u7684\u8fde\u63a5\u90fd\u6709\u4e00\u4e2a\uff09\u7684Channel\u3002\u56fe3-4\u8bf4\u660e\u4e86\u8fd9\u4e2a\u6a21\u578b\uff0c\u5e76\u4e14\u5c55\u793a\u4e86\u4e3a\u4f55\u9700\u8981\u4e24\u4e2a\u4e0d\u540c\u7684EventLoopGroup\u3002</p> <p></p> <p>\u4e0e<code>ServerChannel</code>\u76f8\u5173\u8054\u7684EventLoopGroup\u5c06\u5206\u914d\u4e00\u4e2a\u8d1f\u8d23\u4e3a\u4f20\u5165\u8fde\u63a5\u8bf7\u6c42\u521b\u5efaChannel\u7684EventLoop\u3002\u4e00\u65e6\u8fde\u63a5\u88ab\u63a5\u53d7\uff0c\u7b2c\u4e8c\u4e2a<code>EventLoopGroup</code>\u5c31\u4f1a\u7ed9\u5b83\u7684<code>Channel</code>\u5206\u914d\u4e00\u4e2a<code>EventLoop</code>\u3002</p>"},{"location":"2018-01-22-Nginx%E7%9A%84WebDAV%E6%94%AF%E6%8C%81/","title":"2018 01 22 Nginx\u7684WebDAV\u652f\u6301","text":"<p>\u5728<code>ArchLinux ARM</code>\u4e0a\u7f16\u8bd1<code>Nginx</code>\u53ca\u5176\u62d3\u5c55\u6a21\u5757nginx-dav-ext-module</p> <p>\u4e0b\u8f7dnginx\uff1a</p> <p>\u5728\u5bb6\u76ee\u5f55\u4e0b\u64cd\u4f5c\u3002</p> <pre><code>$ curl -O -L https://nginx.org/download/nginx-1.16.0.tar.gz\n$ tar zxf nginx-1.16.0.tar.gz\n$ cd ~/nginx-1.16.0\n</code></pre> <p>\u4e0b\u8f7d\u6a21\u5757<code>nginx-dav-ext-module</code>\uff1a</p> <pre><code>$ mkdir module &amp;&amp; cd module\n$ git clone https://github.com/arut/nginx-dav-ext-module\n</code></pre> <p>\u914d\u7f6enginx-dav-ext-module\uff1a</p> <pre><code>$ vim module/nginx-dav-ext-module/config\n</code></pre> <p>\u4fee\u6539\uff1a</p> <pre><code>diff --git a/config b/config\nindex 91ae1b3..777f5e9 100644\n--- a/config\n+++ b/config\n@@ -8,9 +8,9 @@ ngx_module_name=ngx_http_dav_ext_module\n# building nginx with the xslt module, in which case libxslt will\n # be linked anyway.  In other cases libxslt is just redundant.\n # If that's a big deal, libxml2 can be linked directly:\n-# ngx_module_libs=-lxml2\n+ngx_module_libs=-lxml2\n\n-ngx_module_libs=LIBXSLT\n+# ngx_module_libs=LIBXSLT\n\nngx_module_srcs=\"$ngx_addon_dir/ngx_http_dav_ext_module.c\"\n</code></pre> <p>\u5b89\u88c5<code>libxml2</code>\u548c<code>icu</code>\uff1a</p> <pre><code>sudo pacman -S libxml2 icu\n</code></pre> <p>\u914d\u7f6e\u4e0e\u6784\u5efa\uff1a</p> <pre><code>$ cd ~/nginx-1.16.0\n$ ./configure \\\n--with-cc-opt=\"-I /usr/include/libxml2\" \\\n--with-http_dav_module \\\n--add-module=module/nginx-dav-ext-module\n$ make\n</code></pre> <p>\u914d\u7f6e\u6587\u4ef6<code>conf/nginx.conf</code>\uff1a</p> <pre><code>server {\n    listen       80;\n    server_name  localhost;\n\n    location / {\n        root   /mnt/disk01;\n\n        autoindex on;\n        autoindex_format html;\n        autoindex_exact_size off;\n        autoindex_localtime on;\n\n        dav_methods PUT DELETE MKCOL COPY MOVE;\n        dav_ext_methods PROPFIND OPTIONS;\n        dav_access            group:rw  all:r;\n        create_full_put_path  on;\n\n        allow 192.168.1.0/24;\n        deny all;\n\n        charset utf-8;\n        index  index.html index.htm;\n    }\n}\n</code></pre> <p>\u8fd0\u884cnginx\uff1a</p> <pre><code>$ sudo ./objs/nginx -p .\n</code></pre>"},{"location":"2018-01-22-Nginx%E7%9A%84WebDAV%E6%94%AF%E6%8C%81/#_1","title":"\u53c2\u8003","text":"<ul> <li>configure_gcc</li> <li>libxml2 2.9.9-2</li> <li>arut/nginx-dav-ext-module</li> </ul>"},{"location":"2018-03-25-how-to-set-the-font-of-console/","title":"2018 03 25 how to set the font of console","text":""},{"location":"2018-03-25-how-to-set-the-font-of-console/#1","title":"1 \u67e5\u770b\u53ef\u7528\u7684\u5b57\u4f53","text":"<pre><code>$ cd /usr/share/kbd/consolefonts\n$ ls -l\n</code></pre> <p>\u5728\u6211\u7535\u8111\u4e0a\u7684\u8f93\u51fa\u5982\u4e0b\uff1a <pre><code>total 1864\n-rw-r--r-- 1 root root  3019 Jan 21  2017 161.cp.gz\n-rw-r--r-- 1 root root  3086 Jan 21  2017 162.cp.gz\n-rw-r--r-- 1 root root  3069 Jan 21  2017 163.cp.gz\n-rw-r--r-- 1 root root  3136 Jan 21  2017 164.cp.gz\n-rw-r--r-- 1 root root  3247 Jan 21  2017 165.cp.gz\n-rw-r--r-- 1 root root  2948 Jan 21  2017 737.cp.gz\n-rw-r--r-- 1 root root  2914 Jan 21  2017 880.cp.gz\n-rw-r--r-- 1 root root  2759 Jan 21  2017 928.cp.gz\n-rw-r--r-- 1 root root  2159 Jan 21  2017 972.cp.gz\n...\n</code></pre></p>"},{"location":"2018-03-25-how-to-set-the-font-of-console/#2","title":"2 \u8bbe\u7f6e","text":"<p>\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff0c\u8bbe\u7f6e<code>ter-v18n</code>\u4e3a\u7ec8\u7aef\u5b57\u4f53\uff0c\u82e5\u8bbe\u7f6e\u6210\u529f\uff0c\u5219\u7acb\u5373\u663e\u793a\u4e3a\u65b0\u7684\u5b57\u4f53\uff1b <pre><code>$ sudo setfont ter-v18n.psf\n</code></pre></p>"},{"location":"2018-05-27-MySQL%E6%9F%A5%E8%AF%A2%E6%9F%90%E5%BC%A0%E8%A1%A8%E7%9A%84%E5%88%97%E5%90%8D/","title":"MySQL\u67e5\u8be2\u67d0\u5f20\u8868\u7684\u5217\u540d","text":"<p>\u67e5\u8be2\u5217\u540d\uff0c\u8fd4\u56de\u591a\u5217\uff1a</p> <pre><code>SELECT COLUMN_NAME FROM `information_schema`.`COLUMNS` WHERE `TABLE_SCHEMA` = 'schema_name' AND TABLE_NAME = 'table_name';\n</code></pre> <p>\u67e5\u8be2\u5217\u540d\uff0c\u8fd4\u56de\u5355\u5217\uff1a</p> <pre><code>SELECT GROUP_CONCAT(COLUMN_NAME SEPARATOR ',') FROM `information_schema`.`COLUMNS` WHERE `TABLE_SCHEMA` = 'schema_name' AND TABLE_NAME = 'table_name';\n</code></pre>"},{"location":"2018-05-27-MySQL%E6%9F%A5%E8%AF%A2%E6%9F%90%E5%BC%A0%E8%A1%A8%E7%9A%84%E5%88%97%E5%90%8D/#_1","title":"\u53c2\u8003","text":"<ul> <li>function_group-concat</li> </ul>"},{"location":"2018-05-27-MySQL%E7%9A%84mysqldump%E4%BE%8B%E5%AD%90/","title":"2018 05 27 MySQL\u7684mysqldump\u4f8b\u5b50","text":"<pre><code>$ mysqldump \\\n--result-file=SQL_FILE_PATH \\\n--complete-insert SCHEMA_NAME [TABLE_NAME] \\\n-uYOUR_USERNAME \\\n-pYOUR_PASSWORD \\\n--host=HOST \\\n--port=PORT\n</code></pre>"},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8Nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2/","title":"2018 06 14 \u4f7f\u7528Nginx\u53cd\u5411\u4ee3\u7406\u8c37\u6b4c\u641c\u7d22","text":""},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8Nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2/#1","title":"1 \u4ec0\u4e48\u662f\u4ee3\u7406","text":"<p>\u5728\u8ba1\u7b97\u673a\u7f51\u7edc\u57fa\u7840\u8bbe\u65bd\u67b6\u6784\u4e2d\uff0c\u4ee3\u7406(Proxy)\u662f\u5728\u5ba2\u6237\u7aef(Client)\u4e0e\u670d\u52a1\u5668(Server)\u4e4b\u95f4\u7684\u670d\u52a1\u4e0e\u8bbe\u65bd\u3002\u4ee3\u7406\u76d1\u542c\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u5e76\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u670d\u52a1\u5668\uff0c\u5f85\u670d\u52a1\u5668\u8fd4\u56de\u7ed3\u679c\u540e\uff0c\u4ee3\u7406\u5c06\u7ed3\u679c\u8f6c\u53d1\u7ed9\u5ba2\u6237\u7aef\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e2d\u95f4\u4eba\u3002</p>"},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8Nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2/#2","title":"2 \u4f9d\u8d56","text":"<ul> <li>\u4e00\u53f0\u53ef\u4ee5\u8bbf\u95ee\u8c37\u6b4c\u641c\u7d22\u7684\u4e3b\u673a\uff0c\u53ef\u4ee5\u5728\u5404\u5927\u4e3b\u673a\u63d0\u4f9b\u5546\u8d2d\u4e70</li> <li>Nginx\u7a0b\u5e8f</li> </ul>"},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8Nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2/#3-nginx","title":"3 \u5b89\u88c5Nginx","text":""},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8Nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2/#4-nginx","title":"4 \u5b89\u88c5Nginx","text":""},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8Nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2/#41","title":"4.1 \u5b89\u88c5\u5f00\u53d1\u5957\u4ef6","text":"<p>\u6267\u884c\u547d\u4ee4\uff1a</p> <pre><code>$ sudo apt-get install build-essential libtool\n</code></pre>"},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8Nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2/#42-pcre","title":"4.2 \u5b89\u88c5PCRE","text":"<pre><code>$ sudo wget -O /usr/local/src/pcre-8.41.zip https://ftp.pcre.org/pub/pcre/pcre-8.41.zip\n$ cd /usr/local/src\n$ sudo unzip pcre-8.41.zip\n$ cd pcre-8.41\n$ sudo ./configure\n$ sudo make\n$ sudo make install\n</code></pre>"},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8Nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2/#43-zlib","title":"4.3 \u5b89\u88c5zlib","text":"<pre><code>$ sudo wget -O /usr/local/src/zlib-1.2.11.tar.gz https://zlib.net/zlib-1.2.11.tar.gz\n$ cd /usr/local/src\n$ sudo tar zxf zlib-1.2.11.tar.gz\n$ cd zlib-1.2.11\n$ sudo ./configure\n$ sudo make\n$ sudo make install\n</code></pre>"},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8Nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2/#44-openssl","title":"4.4 \u5b89\u88c5OpenSSL","text":"<pre><code>$ sudo wget -O /usr/local/src/openssl-1.1.0f.tar.gz https://www.openssl.org/source/openssl-1.1.0f.tar.gz\n$ cd /usr/local/src\n$ sudo tar zxf openssl-1.1.0f.tar.gz\n$ cd openssl-1.1.0f\n$ sudo ./config\n$ sudo make\n$ sudo make install\n</code></pre>"},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8Nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2/#45-ngx_http_substitutions_filter","title":"4.5 \u4e0b\u8f7dngx_http_substitutions_filter\u63d2\u4ef6\u6e90\u4ee3\u7801","text":"<pre><code>$ sudo wget -O /usr/local/src/master.zip https://github.com/yaoweibin/ngx_http_substitutions_filter_module/archive/master.zip\n$ cd /usr/local/src\n$ sudo unzip master.zip\n</code></pre>"},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8Nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2/#46-nginx","title":"4.6 \u5b89\u88c5Nginx","text":"<pre><code>$ sudo wget -O /usr/local/nginx-1.13.5.tar.gz http://nginx.org/download/nginx-1.13.5.tar.gz\n$ cd /usr/local/src\n$ sudo tar zxf nginx-1.13.5.tar.gz\n$ cd nginx-1.13.5\n$ sudo ./configure --sbin-path=/usr/local/nginx/nginx \\\n--conf-path=/usr/local/nginx/nginx.conf \\\n--pid-path=/usr/local/nginx/nginx.pid \\\n--with-http_ssl_module \\\n--with-pcre=/usr/local/src/pcre-8.41 \\\n--with-http_stub_status_module \\\n--with-http_gzip_static_module \\\n--with-zlib=/usr/local/src/zlib-1.2.11 \\\n--with-openssl=/usr/local/src/openssl-1.1.0f \\\n--add-module=/usr/local/src/ngx_http_substitutions_filter_module-master\n$ sudo sudo make\n$ sudo sudo make install\n</code></pre> <p>\u82e5\u4ee5\u4e0a\u8fc7\u7a0b\u6210\u529f\u5b8c\u6210\uff0c\u8bf7\u8bd5\u8fd0\u884cnginx\uff1a</p> <pre><code>$ sudo /usr/local/nginx/nginx\n</code></pre>"},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8Nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2/#47-80","title":"4.7 \u5f00\u653e80\u7aef\u53e3","text":"<p>\u6b64\u5904\u6f14\u793a\u5982\u4f55\u8bbe\u7f6e\u9632\u706b\u5899\u5141\u8bb8\u5916\u754c\u8bbf\u95ee80\u7aef\u53e3</p> <p>\u6267\u884c\u547d\u4ee4\uff1a</p> <pre><code>$ sudo ufw allow 80\n</code></pre> <p>\u82e5\u4f7f\u7528\u963f\u91cc\u4e91ECS\uff0c\u56e0\u4e3a\u5176\u201d\u5b89\u5168\u7ec4\u201d\u8bbe\u7f6e\u4f5c\u7528\u548c\u9632\u706b\u5899\u7c7b\u4f3c\uff0c\u8bf7\u53c2\u8003\u5176\u6587\u6863\uff1b</p> <p>\u8bbf\u95ee\u4e3b\u673a\u768480\u7aef\u53e3\uff0c\u82e5\u51fa\u73b0\u6b22\u8fce\u754c\u9762\uff0c\u5219\u5b89\u88c5\u6210\u529f\uff0c\u82e5\u5931\u8d25\uff0c\u8bf7\u5c1d\u8bd5\u6392\u9664\u9519\u8bef\u3002</p>"},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8Nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2/#5-nginx","title":"5 \u7f16\u8f91Nginx\u865a\u62df\u4e3b\u673a","text":"<p>\u7f16\u8f91Nginx\u914d\u7f6e\u6587\u4ef6\uff0c\u82e5\u6309\u7167\u4e0a\u9762\u7684\u5b89\u88c5\u8fc7\u7a0b\uff0c\u914d\u7f6e\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\u4e3a<code>/usr/local/nginx/nginx.conf</code>\uff0c\u4f7f\u7528\u6587\u672c\u7f16\u8f91\u5668\u4fee\u6539\u8be5\u6587\u4ef6\uff0c\u8bbe\u7f6e\u76d1\u542c80\u7aef\u53e3\u7684\u865a\u62df\u4e3b\u673a\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>server {\n\n    listen 80;\n    server_name $\u4e3b\u673aIP\u6216\u8005\u57df\u540d;\n    #\u53d8\u91cf\uff0c\u4ee3\u7406\u57df\u540d\n    set $proxy_hostname www.google.com;\n\n    location / {\n        #\u4ee3\u7406\u8bbe\u7f6e\n        proxy_cookie_domain $proxy_hostname $server_name;\n        proxy_pass https://$proxy_hostname;\n        proxy_ssl_name $proxy_hostname;\n        #\u8bbe\u5b9a\u8f6c\u53d1\u540e\u7aef\u670d\u52a1\u5668\u7684header\n        proxy_set_header Host $proxy_hostname;\n        proxy_set_header User-Agent $http_user_agent;\n        proxy_set_header Referer http://$proxy_hostname;\n        proxy_set_header X-Real_IP $remote_addr;\n        #\u8c37\u6b4c\u641c\u7d22\u54cd\u5e94\u9875\u9762\u4e0d\u88ab\u538b\u7f29\uff0c\u4f7f\u5f97\u66ff\u6362\u63d2\u4ef6\u80fd\u591f\u5de5\u4f5c\n        proxy_set_header Accept-Encoding \"\";\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto https;\n        proxy_set_header Cookie \"\";\n        proxy_set_header referer https://$proxy_hostname$request_uri;\n        #\u66ff\u6362\u8c37\u6b4c\u641c\u7d22\u57df\u540d\u4e3a\u5f53\u524d\u4e3b\u673a\u540d\u79f0\n        subs_filter https://$proxy_hostname http://$server_name g;\n        #\u6d88\u9664\u684c\u9762\u7248\u9875\u9762\u7684\u8ddf\u8e2a\n        subs_filter ping=\\\"(.+?)\\\" '' ir;\n        subs_filter oncontextmenu=\\\"google.ctpacw.cm(this)\\\" '' ir;\n        #\u66ff\u6362\u6587\u4ef6\u7c7b\u578b\n        subs_filter_types text/css text/xml text/javascript;\n    }\n}\n</code></pre> <p>\u91cd\u542fnginx\uff0c\u6267\u884c\u547d\u4ee4\uff1a</p> <pre><code>$ sudo /usr/local/nginx/nginx -s reload\n</code></pre> <p>\u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u4f60\u7684\u57df\u540d\uff0c\u82e5\u6210\u529f\u54cd\u5e94\u8c37\u6b4c\u641c\u7d22\u9875\u9762\uff0c\u5219\u8bbe\u7f6e\u6210\u529f\u3002</p> <p>\u5982\u6709\u95ee\u9898\uff0c\u6b22\u8fce\u6765\u4fe1\u54e6\ud83d\udce8\ufe0f\uff5e</p>"},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E6%B3%A8%E5%85%A5%E4%BE%9D%E8%B5%96/","title":"2018 06 14 \u4f7f\u7528\u6784\u9020\u65b9\u6cd5\u6ce8\u5165\u4f9d\u8d56","text":""},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E6%B3%A8%E5%85%A5%E4%BE%9D%E8%B5%96/#1","title":"1 \u4ec0\u4e48\u662f\u4f9d\u8d56\u6ce8\u5165","text":"<p>\u5728\u8f6f\u4ef6\u5de5\u7a0b\u4e2d\uff0c\u4f9d\u8d56\u6ce8\u5165\u662f\u4e00\u79cd\u5bf9\u8c61\u63d0\u4f9b\u53e6\u4e00\u5bf9\u8c61\u7684\u4f9d\u8d56\u6027\u7684\u6280\u672f\u3002\u4f9d\u8d56\u5173\u7cfb\u662f\u53ef\u4ee5\u4f7f\u7528\u7684\u5bf9\u8c61\uff08\u670d\u52a1\uff09\u3002\u6ce8\u5165\u662f\u5c06\u4f9d\u8d56\u5173\u7cfb\u4f20\u9012\u7ed9\u5c06\u4f7f\u7528\u5b83\u7684\u4f9d\u8d56\u5bf9\u8c61\uff08\u5ba2\u6237\u7aef\uff09\u3002</p>"},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E6%B3%A8%E5%85%A5%E4%BE%9D%E8%B5%96/#2","title":"2 \u4e3a\u4ec0\u4e48\u4f7f\u7528\u6784\u9020\u65b9\u6cd5\u6ce8\u5165","text":"<p>\u4f7f\u7528Spring\u63d0\u4f9b\u7684@Autowired\u6ce8\u89e3\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6807\u8bb0\u6784\u9020\u65b9\u6cd5(constructor)\u3001\u57df(field)\u3001setter\u65b9\u6cd5\u548c\u914d\u7f6e\u65b9\u6cd5(config methods)\u6765\u5b9e\u73b0\u4f9d\u8d56\u6ce8\u5165\u3002\u6211\u4eec\u4f7f\u7528\u8f83\u591a\u7684\u662f\u6807\u8bb0\u57df\u7684\u65b9\u5f0f\uff0c\u8fd9\u4f7f\u5f97\u5ba2\u6237\u7aef\u53ef\u4ee5\u521b\u5efa\u8be5\u7c7b\u7684\u4e0d\u5408\u6cd5\u7684\u5b9e\u4f8b\uff0c\u4e0d\u5229\u4e8e\u95ee\u9898\u6392\u67e5\u548c\u6d4b\u8bd5\uff0c\u8fd9\u4e00\u70b9\u5728Oliver Gierke\u7684Why field injection is evil\u7684\u6587\u7ae0\u4e2d\u5df2\u6709\u8bf4\u660e\u3002</p>"},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E6%B3%A8%E5%85%A5%E4%BE%9D%E8%B5%96/#3","title":"3 \u5982\u4f55\u4f7f\u7528\u6784\u9020\u65b9\u6cd5\u6ce8\u5165","text":"<p>\u7ed3\u5408Lombok\u6ce8\u89e3\u4f7f\u7528\u6784\u9020\u65b9\u6cd5\u6ce8\u5165\u53ef\u7b80\u5316\u4ee3\u7801\uff1a</p> <pre><code>@Service\n@Slf4j\n@RequiredArgsConstructor(onConstructor = @__(@Autowired))   //\u6ce8\u610f\u70b91\npublic class OssSyncService {\nprivate final @NonNull  //\u6ce8\u610f\u70b92\nOssSyncObjectRepository ossSyncObjectRepository;\n\nprivate final @NonNull\nOssSyncInfoRepository ossSyncInfoRepository;\n\nprivate final @NonNull\nS3Config s3Config;\n//\u5176\u4f59\u7701\u7565\n}\n</code></pre> <ul> <li>\u6ce8\u610f\u70b91-\u7c7b\u524d\u6807\u6ce8@RequiredArgsConstructor(onConstructor = @__(@Autowired))</li> <li>\u6ce8\u610f\u70b92-\u4f9d\u8d56\u7684Bean\u4f7f\u7528private final\u4fee\u9970\u7b26\u548c@NonNull\u6ce8\u89e3</li> </ul>"},{"location":"2018-06-14-%E4%BD%BF%E7%94%A8%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E6%B3%A8%E5%85%A5%E4%BE%9D%E8%B5%96/#4","title":"4 \u53c2\u8003","text":"<ul> <li>http://olivergierke.de/2013/11/why-field-injection-is-evil/</li> <li>https://wiki.yziyz.xin:82/wiki/%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC</li> <li>https://en.wikipedia.org/wiki/Dependency_injection</li> <li>https://docs.spring.io/spring-boot/docs/current/reference/html/using-boot-spring-beans-and-dependency-injection.html</li> <li>https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/factory/annotation/Autowired.html</li> </ul>"},{"location":"2018-06-15-%E4%BD%BF%E7%94%A8Jconsole%E7%9B%91%E6%8E%A7%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E8%BF%90%E8%A1%8C%E7%9A%84Java%E7%A8%8B%E5%BA%8F/","title":"2018 06 15 \u4f7f\u7528Jconsole\u76d1\u63a7\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u7684Java\u7a0b\u5e8f","text":""},{"location":"2018-06-15-%E4%BD%BF%E7%94%A8Jconsole%E7%9B%91%E6%8E%A7%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E8%BF%90%E8%A1%8C%E7%9A%84Java%E7%A8%8B%E5%BA%8F/#1","title":"1 \u8fdc\u7a0b\u670d\u52a1\u5668\u914d\u7f6e","text":""},{"location":"2018-06-15-%E4%BD%BF%E7%94%A8Jconsole%E7%9B%91%E6%8E%A7%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E8%BF%90%E8%A1%8C%E7%9A%84Java%E7%A8%8B%E5%BA%8F/#11","title":"1.1 \u65b0\u5efa\u7ba1\u7406\u5c5e\u6027\u6587\u4ef6","text":"<p>\u6a21\u677f\u6587\u4ef6\u4e3a$JAVA_HOME/jre/lib/management/management.properties</p> <p>\u7f16\u8f91management.properties\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>com.sun.management.jmxremote.port=8888\ncom.sun.management.jmxremote.rmi.port=8888\ncom.sun.management.jmxremote.ssl=false\ncom.sun.management.jmxremote.authenticate=false\ncom.sun.management.jmxremote.local.only=false\n</code></pre> <p>\u6ce8\uff1a</p> <ul> <li>8888\u53ef\u4ee5\u4fee\u6539\u4e3a\u5176\u5b83\u53ef\u7528\u7aef\u53e3\u53f7\uff1b</li> <li>\u6b64\u5904\u7981\u7528\u4e86SSL\u548c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5b58\u5728\u5b89\u5168\u9690\u60a3\uff0c\u82e5\u5b89\u5168\u6027\u8981\u6c42\u8f83\u9ad8\uff0c\u8bf7\u5c06\u5176\u914d\u7f6e\u5e76\u542f\u7528\uff1b</li> </ul>"},{"location":"2018-06-15-%E4%BD%BF%E7%94%A8Jconsole%E7%9B%91%E6%8E%A7%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E8%BF%90%E8%A1%8C%E7%9A%84Java%E7%A8%8B%E5%BA%8F/#2-java","title":"2 \u8fd0\u884cJava\u7a0b\u5e8f","text":"<p>\u5982<code>$JAVA_HOME/jre/lib/management/management.properties</code>\u6307\u51fa\uff0c\u6211\u4eec\u9700\u8981\u5728\u542f\u52a8Java\u7a0b\u5e8f\u65f6\u4f7f\u7528\u5c5e\u6027<code>com.sun.management.config.file</code>\u6765\u6307\u5b9a\u914d\u7f6e\u6587\u4ef6\uff0c\u5b9e\u4f8b\u542f\u52a8\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>$ java -Dcom.sun.management.config.file=~/management.properties -jar hello.jar\n</code></pre> <p>\u6ce8\uff1a\u5176\u4e2d<code>hello.jar</code>\u4e3aJAR\u6587\u4ef6\u540d\u79f0\u793a\u4f8b</p>"},{"location":"2018-06-15-%E4%BD%BF%E7%94%A8Jconsole%E7%9B%91%E6%8E%A7%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E8%BF%90%E8%A1%8C%E7%9A%84Java%E7%A8%8B%E5%BA%8F/#3-ssh","title":"3 SSH\u8f6c\u53d1","text":"<p>\u6458\u81ea\uff1aman ssh(1) -L port:host:hostport  \u5c06\u672c\u5730\u673a(\u5ba2\u6237\u673a)\u7684\u67d0\u4e2a\u7aef\u53e3\u8f6c\u53d1\u5230\u8fdc\u7aef\u6307\u5b9a\u673a\u5668\u7684\u6307\u5b9a\u7aef\u53e3. \u5de5\u4f5c\u539f\u7406\u662f\u8fd9\u6837\u7684, \u672c\u5730\u673a\u5668\u4e0a\u5206\u914d\u4e86\u4e00\u4e2a socket \u4fa6\u542c port \u7aef\u53e3\uff0c\u4e00\u65e6\u8fd9\u4e2a\u7aef\u53e3\u4e0a\u6709\u4e86\u8fde\u63a5, \u8be5\u8fde\u63a5\u5c31\u7ecf\u8fc7\u5b89\u5168\u901a\u9053\u8f6c\u53d1\u51fa\u53bb, \u540c\u65f6\u8fdc\u7a0b\u4e3b\u673a\u548c host \u7684 hostport \u7aef\u53e3\u5efa\u7acb\u8fde\u63a5. \u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u7aef\u53e3\u7684\u8f6c\u53d1\u3002\u53ea\u6709 root \u624d\u80fd\u8f6c\u53d1\u7279\u6743\u7aef\u53e3. IPv6 \u5730\u5740\u7528\u53e6\u4e00\u79cd\u683c\u5f0f\u8bf4\u660e: port/host/hostport</p> <p>\u5047\u5b9aJava\u7a0b\u5e8f\u8fd0\u884c\u4e8e\u4e3b\u673a<code>192.168.0.83</code>\u4e0a\uff0c\u5e76\u4e14\u8be5\u4e3b\u673a\u7684<code>TCP\u7aef\u53e38888</code>\u53ef\u8bbf\u95ee\uff0c\u6267\u884c\u547d\u4ee4\uff1a</p> <pre><code>$ ssh user@192.168.0.83 -L 8888:192.168.0.83:8888\n</code></pre> <p>\u8f93\u5165\u7528\u6237user\u7684\u5bc6\u7801\uff0c\u6210\u529f\u767b\u5f55\u5373\u53ef\u3002</p> <p>\u6ce8\uff1a\u82e5 Windows \u7528\u6237\u4f7f\u7528PuTTY\u4f5c\u4e3a\u7ec8\u7aef\uff0c\u8bf7\u53c2\u8003has-anyone-ever-got-a-remote-jmx-jconsole-to-work</p>"},{"location":"2018-06-15-%E4%BD%BF%E7%94%A8Jconsole%E7%9B%91%E6%8E%A7%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E8%BF%90%E8%A1%8C%E7%9A%84Java%E7%A8%8B%E5%BA%8F/#4-jconsole","title":"4 \u8fd0\u884cJconsole","text":"<p>\u6267\u884c\u547d\u4ee4\uff1a</p> <pre><code>$ jconsole -interval=1 localhost:8888\n</code></pre> <p>\u63d0\u793a<code>Secure connection failed. Retry insecurely?</code>\uff0c\u5982\u56fe\uff1a</p> <p></p> <p>\u9009\u62e9<code>Insecure connection</code>\uff0c\u5982\u56fe\uff1a</p> <p></p>"},{"location":"2018-06-15-%E4%BD%BF%E7%94%A8Jconsole%E7%9B%91%E6%8E%A7%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E8%BF%90%E8%A1%8C%E7%9A%84Java%E7%A8%8B%E5%BA%8F/#5","title":"5 \u53c2\u8003","text":"<ul> <li>https://stackoverflow.com/questions/151238/has-anyone-ever-got-a-remote-jmx-jconsole-to-work </li> <li>https://docs.oracle.com/javase/9/management/monitoring-and-management-using-jmx-technology.htm#JSMGM-GUID-7B962724-69BC-46AF-A46E-4A47A4E0B57A</li> </ul>"},{"location":"2018-06-22-CSAPP%E7%BB%83%E4%B9%A0%E9%A2%982-13/","title":"2018 06 22 CSAPP\u7ec3\u4e60\u98982 13","text":"<p>\u8bb0\u5f55CSAPP\u4e0a\u4e00\u9053\u6709\u8da3\u7684\u9898\u76ee\ud83e\udd2f\uff0c\u7b2c56\u9875</p>"},{"location":"2018-06-22-CSAPP%E7%BB%83%E4%B9%A0%E9%A2%982-13/#_1","title":"\u9898\u5e72","text":"<p>\u4ece20\u4e16\u7eaa70\u5e74\u4ee3\u672b\u523080\u5e74\u4ee3\u672b\uff0cDigital Equipment\u7684VAX\u8ba1\u7b97\u673a\u662f\u4e00\u79cd\u975e\u5e38\u6d41\u884c\u7684\u673a\u578b\u3002\u5b83\u6ca1\u6709\u5e03\u5c14\u8fd0\u7b97AND\u548cOR\u6307\u4ee4\uff0c\u53ea\u6709<code>bis\uff08\u4f4d\u8bbe\u7f6e\uff09\u548cbic\uff08\u4f4d\u6e05\u9664\uff09</code>\u8fd9\u4e24\u79cd\u6307\u4ee4\u3002\u4e24\u79cd\u6307\u4ee4\u7684\u8f93\u5165\u90fd\u662f\u4e00\u4e2a\u6570\u636e\u5b57x\u548c\u4e00\u4e2a\u63a9\u7801\u5b57m\u3002\u4ed6\u4eec\u751f\u6210\u4e00\u4e2a\u7ed3\u679cz\uff0cz\u662f\u7531\u6839\u636e\u63a9\u7801m\u7684\u4f4d\u6765\u4fee\u6539x\u7684\u4f4d\u5f97\u5230\u7684\u3002</p> <ul> <li>\u4f7f\u7528bis\u6307\u4ee4\uff0c\u8fd9\u79cd\u4fee\u6539\u5c31\u662f\u5728m\u4e3a1\u7684\u6bcf\u4e2a\u4f4d\u7f6e\uff0c\u5c06z\u5bf9\u5e94\u7684\u4f4d\u8bbe\u7f6e\u4e3a1\uff1b</li> <li>\u4f7f\u7528bic\u6307\u4ee4\uff0c\u8fd9\u79cd\u4fee\u6539\u5c31\u662f\u5728m\u4e3a1\u7684\u6bcf\u4e2a\u4f4d\u7f6e\uff0c\u5c06z\u5bf9\u5e94\u7684\u4f4d\u8bbe\u7f6e\u4e3a0\u3002</li> </ul> <p>\u4e3a\u4e86\u770b\u6e05\u695a\u8fd9\u4e9b\u8fd0\u7b97\u4e0eC\u8bed\u8a00\u4f4d\u7ea7\u8fd0\u7b97\u7684\u5173\u7cfb\uff0c\u5047\u8bbe\u6211\u4eec\u6709\u4e24\u4e2a\u51fd\u6570bis\u548cbic\u6765\u5b9e\u73b0\u4f4d\u8bbe\u7f6e\u548c\u4f4d\u6e05\u9664\u64cd\u4f5c\u3002\u53ea\u60f3\u7528\u8fd9\u4e24\u4e2a\u51fd\u6570\uff0c\u800c\u4e0d\u4f7f\u7528\u4efb\u4f55\u5176\u4ed6C\u8bed\u8a00\u8fd0\u7b97\uff0c\u6765\u5b9e\u73b0<code>\u6309\u4f4d|\u548c^</code>\u8fd0\u7b97\u3002\u586b\u5199\u4e0b\u5217\u4ee3\u7801\u4e2d\u7f3a\u5931\u7684\u4ee3\u7801\u3002</p> <p>\u63d0\u793a\uff1a\u5199\u51fabis\u548cbic\u8fd0\u7b97\u7684C\u8bed\u8a00\u8868\u8fbe\u5f0f\u3002</p> <pre><code>/* \u5b9e\u73b0bis\u548cbic\u51fd\u6570\u7684\u58f0\u660e */\nint bis(int x, int m);\nint bic(int x, int m);\n\n/* \u53ea\u8c03\u7528bis\u548cbic\u51fd\u6570\uff0c\u8ba1\u7b97x|y */\nint bool_or(int x, int y) {\nint result = ____; //\u7a7a\u767d1\nreturn result;\n}\n\n/* \u53ea\u8c03\u7528bis\u548cbic\u51fd\u6570\uff0c\u8ba1\u7b97x^y */\nint bool_xor(int x, int y) {\nint result = ____; //\u7a7a\u767d2\nreturn result;\n}\n</code></pre>"},{"location":"2018-06-22-CSAPP%E7%BB%83%E4%B9%A0%E9%A2%982-13/#_2","title":"\u89e3\u9898\u601d\u8def","text":"<ul> <li>\u5bf9\u4e8e<code>bis</code>\u51fd\u6570\uff0c<code>z = x | m</code>\uff1b\u5bf9\u4e8e<code>bic</code>\u51fd\u6570\uff0c<code>z = x &amp; ~m</code>\uff1b</li> <li><code>x ^ y = (x &amp; ~y) | (~x &amp; y)</code></li> </ul>"},{"location":"2018-06-22-CSAPP%E7%BB%83%E4%B9%A0%E9%A2%982-13/#_3","title":"\u7b54\u6848","text":"<ul> <li>\u7a7a\u767d1\uff1abis(x, y)</li> <li>\u7a7a\u767d2\uff1abis(bic(x. y), bic(y, x))</li> </ul>"},{"location":"2018-06-22-CSAPP%E7%BB%83%E4%B9%A0%E9%A2%982-13/#_4","title":"\u4ee3\u7801","text":"<pre><code>#include &lt;stdio.h&gt;\n\n/* \u5b9e\u73b0bis\u548cbic\u7684\u51fd\u6570 */\nint bis(int x, int m) {\nreturn x | m;\n}\n\nint bic(int x, int m) {\nreturn x &amp; ~m;\n}\n\n/* \u53ea\u8c03\u7528bis\u548cbic\u51fd\u6570\uff0c\u8ba1\u7b97x|y */\nint bool_or(int x, int y) {\nint result = bis(x, y); //\u7a7a\u767d1\nreturn result;\n}\n\n/* \u53ea\u8c03\u7528bis\u548cbic\u51fd\u6570\uff0c\u8ba1\u7b97x^y */\nint bool_xor(int x, int y) {\nint result = bis(bic(x, y), bic(y, x)); //\u7a7a\u767d2\nreturn result;\n}\n\nint main() {\nprintf(\"1 or  0 is %d\\n\", bool_or(1, 0));\nprintf(\"1 or  1 is %d\\n\", bool_or(1, 1));\nprintf(\"0 or  0 is %d\\n\", bool_or(0, 0));\nprintf(\"1 xor 0 is %d\\n\", bool_xor(1, 0));\nprintf(\"1 xor 1 is %d\\n\", bool_xor(1, 1));\nprintf(\"0 xor 0 is %d\\n\", bool_xor(0, 0));\nreturn 0;\n}\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>1 or  0 is 1\n1 or  1 is 1\n0 or  0 is 0\n1 xor 0 is 1\n1 xor 1 is 0\n0 xor 0 is 0\n</code></pre>"},{"location":"2018-06-22-Manjaro%20Linux%E8%AE%BF%E9%97%AEiPhone%E9%9C%80%E5%AE%89%E8%A3%85%E7%9A%84%E5%B7%A5%E5%85%B7/","title":"2018 06 22 Manjaro Linux\u8bbf\u95eeiPhone\u9700\u5b89\u88c5\u7684\u5de5\u5177","text":""},{"location":"2018-06-22-Manjaro%20Linux%E8%AE%BF%E9%97%AEiPhone%E9%9C%80%E5%AE%89%E8%A3%85%E7%9A%84%E5%B7%A5%E5%85%B7/#libimobiledevice","title":"libimobiledevice\u7b80\u4ecb","text":"<p>libimobiledevice\u662f\u4e00\u4e2a\u8de8\u5e73\u53f0\u7684\u8f6f\u4ef6\u5e93\uff0c\u53ef\u534f\u8bae\u652f\u6301iPhone\u00ae\uff0ciPodTouch\u00ae\uff0ciPad\u00ae\u548cAppleTV\u00ae\u8bbe\u5907\u3002 \u4e0e\u5176\u4ed6\u9879\u76ee\u4e0d\u540c\uff0c\u5b83\u4e0d\u4f9d\u8d56\u4e8e\u4f7f\u7528\u4efb\u4f55\u73b0\u6709\u7684\u4e13\u6709\u5e93\u5e76\u4e14\u4e0d\u9700\u8981\u8d8a\u72f1\u3002 \u5b83\u5141\u8bb8\u5176\u4ed6\u8f6f\u4ef6\u8f7b\u677e\u8bbf\u95ee\u8bbe\u5907\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u68c0\u7d22\u6709\u5173\u8bbe\u5907\u53ca\u5176\u5185\u90e8\u7684\u4fe1\u606f\uff0c\u5907\u4efd/\u6062\u590d\u8bbe\u5907\uff0c\u7ba1\u7406SpringBoard\u00ae\u56fe\u6807\uff0c\u7ba1\u7406\u5df2\u5b89\u88c5\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u68c0\u7d22\u5730\u5740\u7c3f/\u65e5\u5386/\u7b14\u8bb0\u548c\u4e66\u7b7e\u4ee5\u53ca\uff08\u4f7f\u7528libgpod\uff09\u540c\u6b65\u97f3\u4e50 \u548c\u89c6\u9891\u5230\u8bbe\u5907\u3002 \u8be5\u5e93\u81ea2007\u5e748\u6708\u5f00\u59cb\u5f00\u53d1\uff0c\u4f7fLinux\u684c\u9762\u652f\u6301\u8fd9\u4e9b\u8bbe\u5907\u3002</p> <p>\u4ee5\u4e0a\u6458\u81ealibimobiledevice\u9879\u76ee\u5b98\u7f51</p>"},{"location":"2018-06-22-Manjaro%20Linux%E8%AE%BF%E9%97%AEiPhone%E9%9C%80%E5%AE%89%E8%A3%85%E7%9A%84%E5%B7%A5%E5%85%B7/#pacman","title":"\u4f7f\u7528pacman\u5b89\u88c5","text":"<p>\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ sudo pacman -Syy\n$ sudo pacman -S ifuse usbmuxd libplist libimobiledevice\n</code></pre>"},{"location":"2018-06-22-Manjaro%20Linux%E8%AE%BF%E9%97%AEiPhone%E9%9C%80%E5%AE%89%E8%A3%85%E7%9A%84%E5%B7%A5%E5%85%B7/#_1","title":"\u53c2\u8003","text":"<ul> <li>https://forum.manjaro.org/t/how-to-access-an-iphone-with-manjaro/3768/4</li> <li>http://www.libimobiledevice.org/</li> </ul>"},{"location":"2018-06-24-%E4%BB%80%E4%B9%88%E6%98%AF%E6%95%B0%E5%AD%A6-Richard-Courant/","title":"2018 06 24 \u4ec0\u4e48\u662f\u6570\u5b66 Richard Courant","text":"<p>\u6458\u81ea\u4ec0\u4e48\u662f\u6570\u5b66\uff1a\u5bf9\u601d\u60f3\u548c\u65b9\u6cd5\u7684\u57fa\u672c\u7814\u7a76</p> <p>\u6570\u5b66\uff0c\u4f5c\u4e3a\u4eba\u7c7b\u601d\u7ef4\u7684\u8868\u8fbe\u5f62\u5f0f\uff0c\u53cd\u6620\u4e86\u4eba\u4eec\u79ef\u6781\u8fdb\u53d6\u7684\u610f\u5fd7\u3001\u7f1c\u5bc6\u5468\u8be6\u7684\u63a8\u7406\u4ee5\u53ca\u5bf9\u5b8c\u7f8e\u5883\u754c\u7684\u8ffd\u6c42\u3002\u5b83\u7684\u57fa\u672c\u8981\u7d20\u662f\uff1a\u903b\u8f91\u548c\u76f4\u89c2\u3001\u5206\u6790\u548c\u6784\u4f5c\u3001\u4e00\u822c\u6027\u548c\u4e2a\u522b\u6027\u3002\u867d\u7136\u4e0d\u540c\u7684\u4f20\u7edf\u53ef\u4ee5\u5f3a\u8c03\u4e0d\u540c\u7684\u4fa7\u9762\uff0c\u7136\u800c\u6b63\u662f\u8fd9\u4e9b\u4e92\u76f8\u5bf9\u7acb\u7684\u529b\u91cf\u7684\u76f8\u4e92\u4f5c\u7528\u4ee5\u53ca\u5b83\u4eec\u7efc\u5408\u8d77\u6765\u7684\u52aa\u529b\u624d\u6784\u6210\u4e86\u6570\u5b66\u79d1\u5b66\u7684\u751f\u547d\u3001\u7528\u9014\u548c\u5b83\u7684\u5d07\u9ad8\u4ef7\u503c\u3002</p> <p>\u6beb\u65e0\u7591\u95ee\uff0c\u4e00\u5207\u6570\u5b66\u7684\u53d1\u5c55\u5728\u5fc3\u7406\u4e0a\u90fd\u6216\u591a\u6216\u5c11\u5730\u662f\u57fa\u4e8e\u5b9e\u9645\u7684\u3002\u4f46\u662f\u7406\u8bba\u4e00\u65e6\u5728\u5b9e\u9645\u7684\u9700\u8981\u4e2d\u51fa\u73b0\uff0c\u5c31\u4e0d\u53ef\u907f\u514d\u5730\u4f1a\u4f7f\u5b83\u81ea\u8eab\u83b7\u5f97\u53d1\u5c55\u7684\u52a8\u529b\uff0c\u5e76\u8d85\u8d8a\u51fa\u76f4\u63a5\u5b9e\u7528\u7684\u5c40\u9650\u3002\u8fd9\u79cd\u4ece\u5e94\u7528\u79d1\u5b66\u5230\u7406\u8bba\u79d1\u5b66\u7684\u53d1\u5c55\u8d8b\u52bf\uff0c\u4e0d\u4ec5\u5e38\u89c1\u4e8e\u53e4\u4ee3\u5386\u53f2\u4e2d\uff0c\u800c\u4e14\u5728\u5de5\u7a0b\u5e08\u548c\u7269\u7406\u5b66\u5bb6\u4e3a\u8fd1\u4ee3\u6570\u5b66\u4e0d\u65ad\u4f5c\u51fa\u7684\u8bb8\u591a\u8d21\u732e\u4e2d\u66f4\u662f\u5c61\u89c1\u4e0d\u9c9c\u3002</p> <p>\u6709\u8bb0\u8f7d\u7684\u6570\u5b66\u8d77\u6e90\u4e8e\u4e1c\u65b9\u3002\u5927\u7ea6\u5728\u516c\u5143\u524d\u4e24\u5343\u5e74\uff0c\u5df4\u6bd4\u4f26\u4eba\u5c31\u641c\u96c6\u4e86\u6781\u5176\u4e30\u5bcc\u7684\u8d44\u6599\uff0c\u8fd9\u4e9b\u8d44\u6599\u4eca\u5929\u770b\u6765\u5e94\u5c5e\u4e8e\u521d\u7b49\u4ee3\u6570\u7684\u8303\u56f4\u3002\u81f3\u4e8e\u6570\u5b66\u4f5c\u4e3a\u73b0\u4ee3\u610f\u4e49\u7684\u4e00\u95e8\u79d1\u5b66\uff0c\u5219\u662f\u8fdf\u81f3\u516c\u5143\u524d5\u81f3\u516c\u5143\u524d4\u4e16\u7eaa\u624d\u5728\u5e0c\u814a\u51fa\u73b0\u7684\u3002\u4e1c\u65b9\u548c\u5e0c\u814a\u4e4b\u95f4\u7684\u63a5\u89e6\u4e0d\u65ad\u589e\u591a\uff08\u59cb\u4e8e\u6ce2\u65af\u5e1d\u56fd\u65f6\u671f\uff0c\u81f3\u4e9a\u5386\u5c71\u5927\u8fdc\u5f81\u65f6\u671f\u5219\u8fbe\u5230\u9ad8\u5cf0\uff09\uff0c\u4f7f\u5e0c\u814a\u4eba\u5f97\u4ee5\u719f\u6089\u5df4\u6bd4\u4f26\u4eba\u5728\u6570\u5b66\u548c\u5929\u6587\u5b66\u65b9\u9762\u7684\u6210\u5c31\uff0c\u6570\u5b66\u5f88\u5feb\u5c31\u88ab\u52a0\u5165\u5230\u98ce\u884c\u4e8e\u5e0c\u814a\u57ce\u90a6\u7684\u54f2\u5b66\u8ba8\u8bba\u4e4b\u4e2d\u3002\u56e0\u800c\u5e0c\u814a\u7684\u601d\u60f3\u5bb6\u9010\u6e10\u610f\u8bc6\u5230\uff0c\u5728\u8fde\u7eed\u3001\u8fd0\u52a8\u3001\u65e0\u9650\u5927\u8fd9\u4e9b\u6982\u5ff5\u4e2d\uff0c\u4ee5\u53ca\u5728\u7528\u5df2\u77e5\u5355\u4f4d\u53bb\u5ea6\u91cf\u4efb\u610f\u4e00\u4e2a\u91cf\u7684\u95ee\u9898\u4e2d\uff0c\u6570\u5b66\u90fd\u5b58\u5728\u7740\u56fa\u6709\u7684\u6781\u5927\u56f0\u96be\u3002\u9762\u5bf9\u8fd9\u4e2a\u6311\u6218\uff0c\u7ecf\u8fc7\u4e86\u4e00\u756a\u4e0d\u5c48\u4e0d\u6320\u7684\u52aa\u529b\uff0c\u4ea7\u751f\u4e86\u6b27\u591a\u514b\u65af\uff08Eudoxus\uff09\u7684\u51e0\u4f55\u8fde\u7eed\u7edf\u7406\u8bba\uff0c\u8fd9\u4e2a\u6210\u679c\u662f\u552f\u4e00\u80fd\u548c\u4e24\u5343\u591a\u5e74\u540e\u7684\u73b0\u4ee3\u65e0\u7406\u6570\u7406\u8bba\u76f8\u5ab2\u7f8e\u7684\u3002\u6570\u5b66\u4e2d\u8fd9\u79cd\u516c\u7406\u6f14\u7ece\u7684\u8d8b\u5411\u8d77\u6e90\u4e8e\u6b27\u591a\u514b\u65af\u65f6\u4ee3\uff0c\u53c8\u5728\u6b27\u51e0\u91cc\u5f97\uff08Euclid\uff09\u7684\u201c\u539f\u672c\u201d\u4e2d\u5f97\u4ee5\u6210\u719f\u3002</p> <p>\u867d\u7136\u5e0c\u814a\u6570\u5b66\u7684\u7406\u8bba\u5316\u548c\u516c\u7406\u5316\u7684\u503e\u5411\u4e00\u76f4\u662f\u5b83\u7684\u4e00\u4e2a\u91cd\u8981\u7279\u70b9\uff0c\u5e76\u4e14\u66fe\u7ecf\u4ea7\u751f\u8fc7\u5de8\u5927\u7684\u5f71\u54cd\u3002\u4f46\u662f\uff0c\u5bf9\u8fd9\u4e00\u70b9\u6211\u4eec\u4e0d\u80fd\u8fc7\u5206\u5f3a\u8c03\uff0c\u56e0\u4e3a\u5728\u53e4\u4ee3\u6570\u5b66\u4e2d\uff0c\u5e94\u7528\u4ee5\u53ca\u540c\u7269\u7406\u73b0\u5b9e\u7684\u8054\u7cfb\u6070\u6070\u8d77\u4e86\u540c\u6837\u91cd\u8981\u7684\u4f5c\u7528\uff0c\u800c\u4e14\u90a3\u65f6\u5019\u4eba\u4eec\u5b81\u613f\u91c7\u7528\u4e0d\u50cf\u6b27\u51e0\u91cc\u5f97\u90a3\u6837\u4e25\u5bc6\u7684\u8868\u8fbe\u65b9\u5f0f\u3002</p> <p>\u7531\u4e8e\u8f83\u65e9\u5730\u53d1\u73b0\u4e86\u4e0e\u201c\u4e0d\u53ef\u516c\u5ea6\u201d\u7684\u91cf\u6709\u5173\u7684\u8fd9\u4e9b\u56f0\u96be\uff0c\u4f7f\u5e0c\u814a\u4eba\u6ca1\u80fd\u53d1\u5c55\u65e9\u5df2\u4e3a\u4e1c\u65b9\u6240\u638c\u63e1\u7684\u6570\u5b57\u8ba1\u7b97\u7684\u6280\u672f\u3002\u76f8\u53cd\uff0c\u4ed6\u4eec\u5374\u8feb\u4f7f\u81ea\u5df1\u94bb\u8fdb\u4e86\u7eaf\u7cb9\u516c\u7406\u51e0\u4f55\u7684\u4e1b\u6797\u4e4b\u4e2d\u3002\u4e8e\u662f\u79d1\u5b66\u53f2\u4e0a\u51fa\u73b0\u4e86\u4e00\u4e2a\u5947\u602a\u7684\u66f2\u6298\u3002\u8fd9\u6216\u8bb8\u610f\u5473\u7740\u4eba\u7c7b\u4e27\u5931\u4e86\u4e00\u4e2a\u5f88\u597d\u7684\u65f6\u673a\u3002\u51e0\u4e4e\u4e24\u5343\u5e74\u6765\uff0c\u5e0c\u814a\u51e0\u4f55\u7684\u4f20\u7edf\u529b\u91cf\u63a8\u8fdf\u4e86\u5fc5\u7136\u4f1a\u53d1\u751f\u7684\u6570\u7684\u6982\u5ff5\u548c\u4ee3\u6570\u8fd0\u7b97\u7684\u8fdb\u6b65\uff0c\u800c\u5b83\u4eec\u540e\u6765\u6784\u6210\u4e86\u8fd1\u4ee3\u79d1\u5b66\u7684\u57fa\u7840\u3002</p> <p>\u7ecf\u8fc7\u4e86\u4e00\u6bb5\u7f13\u6162\u7684\u51c6\u5907\uff0c\u523017\u4e16\u7eaa\uff0c\u968f\u7740\u89e3\u6790\u51e0\u4f55\u4e0e\u5fae\u79ef\u5206\u7684\u53d1\u5c55\uff0c\u6570\u5b66\u548c\u79d1\u5b66\u7684\u9769\u547d\u4e5f\u5f00\u59cb\u84ec\u52c3\u53d1\u5c55\u8d77\u6765\u3002\u867d\u7136\u5e0c\u814a\u7684\u51e0\u4f55\u5b66\u4ecd\u7136\u5360\u6709\u91cd\u8981\u7684\u5730\u4f4d\uff0c\u4f46\u662f\uff0c\u5e0c\u814a\u4eba\u5173\u4e8e\u516c\u7406\u4f53\u7cfb\u548c\u7cfb\u7edf\u63a8\u6f14\u7684\u601d\u60f3\u572817\u4e16\u7eaa\u548c18\u4e16\u7eaa\u4e0d\u590d\u51fa\u73b0\u3002\u4ece\u4e00\u4e9b\u6e05\u6e05\u695a\u695a\u7684\u5b9a\u4e49\u548c\u6ca1\u6709\u77db\u76fe\u7684\u201c\u660e\u663e\u201d\u516c\u7406\u51fa\u53d1\uff0c\u8fdb\u884c\u51c6\u786e\u7684\u903b\u8f91\u63a8\u7406\uff0c\u8fd9\u5bf9\u4e8e\u6570\u5b66\u79d1\u5b66\u7684\u65b0\u7684\u5f00\u62d3\u8005\u6765\u8bf4\u4f3c\u4e4e\u662f\u65e0\u5173\u7d27\u8981\u7684\u3002\u901a\u8fc7\u6beb\u65e0\u62d8\u675f\u7684\u76f4\u89c2\u731c\u60f3\u548c\u4ee4\u4eba\u4fe1\u670d\u7684\u63a8\u7406\uff0c\u518d\u52a0\u4e0a\u8352\u8c2c\u7684\u795e\u79d8\u8bba\u4ee5\u53ca\u5bf9\u5f62\u5f0f\u63a8\u7406\u7684\u8d85\u4eba\u529b\u91cf\u7684\u76f2\u76ee\u76f8\u4fe1\uff0c\u4ed6\u4eec\u5f81\u670d\u4e86\u4e00\u4e2a\u8574\u85cf\u7740\u65e0\u9650\u8d22\u5bcc\u7684\u6570\u5b66\u4e16\u754c\u3002\u4f46\u662f\u540e\u6765\uff0c\u5927\u53d1\u5c55\u5f15\u8d77\u7684\u72c2\u70ed\u9010\u6e10\u8ba9\u4f4d\u4e8e\u4e00\u79cd\u81ea\u6211\u63a7\u5236\u7684\u6279\u5224\u7cbe\u795e\u3002\u5230\u4e8619\u4e16\u7eaa\uff0c\u7531\u4e8e\u6570\u5b66\u672c\u8eab\u9700\u8981\u5de9\u56fa\u5df2\u6709\u6210\u679c\uff0c\u800c\u4e14\u4eba\u4eec\u4e5f\u5e0c\u671b\u628a\u5b83\u63a8\u5411\u66f4\u9ad8\u9636\u6bb5\u65f6\u4e0d\u81f4\u53d1\u751f\u95ee\u9898\uff08\u8fd9\u662f\u53d7\u5230\u6cd5\u56fd\u5927\u9769\u547d\u7684\u5f71\u54cd\uff09\uff0c\u5c31\u4e0d\u5f97\u4e0d\u56de\u8fc7\u5934\u6765\u91cd\u65b0\u5ba1\u67e5\u8fd9\u65b0\u7684\u6570\u5b66\u57fa\u7840\uff0c\u7279\u522b\u662f\u5fae\u79ef\u5206\u53ca\u5176\u8d56\u4ee5\u5efa\u7acb\u7684\u6781\u9650\u6982\u5ff5\u3002\u56e0\u6b6419\u4e16\u7eaa\u4e0d\u4ec5\u6210\u4e3a\u4e00\u4e2a\u65b0\u7684\u53d1\u5c55\u65f6\u671f\uff0c\u800c\u4e14\u4e5f\u4ee5\u6210\u529f\u5730\u8fd4\u56de\u5230\u90a3\u79cd\u51c6\u786e\u800c\u4e25\u8c28\u7684\u8bc1\u660e\u4e3a\u5176\u7279\u5f81\u3002\u5728\u8fd9\u65b9\u9762\u5b83\u751a\u81f3\u80dc\u8fc7\u4e86\u5e0c\u814a\u79d1\u5b66\u7684\u5178\u8303\u3002\u4e8e\u662f\uff0c\u949f\u6446\u53c8\u4e00\u6b21\u5411\u7eaf\u7cb9\u6027\u548c\u62bd\u8c61\u6027\u7684\u4e00\u4fa7\u6446\u53bb\u3002\u76ee\u524d\u6211\u4eec\u4f3c\u4e4e\u4ecd\u7136\u5904\u4e8e\u8fd9\u4e2a\u65f6\u671f\u3002\u4f46\u662f\u4eba\u4eec\u53ef\u4ee5\u671f\u671b\uff0c\u5728\u7eaf\u7cb9\u6570\u5b66\u548c\u5177\u6709\u6d3b\u529b\u7684\u5e94\u7528\u4e4b\u95f4\u4ea7\u751f\u4e86\u8fd9\u79cd\u4e0d\u5e78\u5206\u79bb\uff08\u53ef\u80fd\u5728\u6279\u5224\u6027\u7684\u5ba1\u67e5\u65f6\u671f\uff0c\u8fd9\u662f\u4e0d\u53ef\u907f\u514d\u7684\uff09\u4e4b\u540e\uff0c\u968f\u4e4b\u800c\u6765\u7684\u5e94\u662f\u4e00\u4e2a\u7d27\u5bc6\u7ed3\u5408\u7684\u65f6\u4ee3\u3002\u8fd9\u79cd\u91cd\u65b0\u83b7\u5f97\u7684\u5185\u5728\u529b\u91cf\uff0c\u66f4\u4e3b\u8981\u7684\u662f\u7531\u4e8e\u7406\u89e3\u66f4\u52a0\u660e\u6670\u800c\u8fbe\u5230\u8ba4\u8bc6\u4e0a\u7684\u6781\u5927\u7b80\u5316\uff0c\u5c06\u4f7f\u5f97\u4eca\u5929\u6709\u53ef\u80fd\u5728\u4e0d\u5ffd\u7565\u5e94\u7528\u7684\u60c5\u51b5\u4e0b\u6765\u638c\u63e1\u6570\u5b66\u7406\u8bba\u3002\u518d\u4e00\u6b21\u5728\u7eaf\u6570\u5b66\u548c\u5e94\u7528\u79d1\u5b66\u4e4b\u95f4\u5efa\u7acb\u8d77\u6709\u673a\u7684\u7ed3\u5408\uff0c\u5728\u62bd\u8c61\u7684\u5171\u6027\u548c\u8272\u5f69\u7f24\u7eb7\u7684\u4e2a\u6027\u4e4b\u95f4\u5efa\u7acb\u8d77\u7262\u56fa\u7684\u5e73\u8861\uff0c\u8fd9\u6216\u8bb8\u5c31\u662f\u4e0d\u4e45\u7684\u5c06\u6765\u6570\u5b66\u4e0a\u7684\u9996\u8981\u4efb\u52a1\u3002</p> <p>\u8fd9\u91cc\u4e0d\u662f\u5bf9\u6570\u5b66\u8fdb\u884c\u8be6\u7ec6\u7684\u54f2\u5b66\u6216\u5fc3\u7406\u5b66\u7684\u5206\u6790\u7684\u5730\u65b9\u3002\u4f46\u6709\u51e0\u70b9\u5e94\u5f53\u5f3a\u8c03\u4e00\u4e0b\u3002\u76ee\u524d\u8fc7\u5206\u5f3a\u8c03\u6570\u5b66\u7684\u516c\u7406\u6f14\u7ece\u7279\u70b9\u7684\u98ce\u6c14\uff0c\u4f3c\u4e4e\u6709\u76db\u884c\u8d77\u6765\u7684\u5371\u9669\u3002\u4e8b\u5b9e\u4e0a\uff0c\u90a3\u79cd\u521b\u9020\u53d1\u660e\u7684\u8981\u7d20\uff0c\u90a3\u79cd\u8d77\u6307\u5bfc\u548c\u63a8\u52a8\u4f5c\u7528\u7684\u76f4\u89c2\u8981\u7d20\uff0c\u867d\u7136\u5e38\u5e38\u4e0d\u80fd\u7528\u7b80\u5355\u7684\u54f2\u5b66\u516c\u5f0f\u6765\u8868\u8ff0\uff0c\u4f46\u662f\u5b83\u4eec\u5374\u662f\u4efb\u4f55\u6570\u5b66\u6210\u5c31\u7684\u6838\u5fc3\uff0c\u5373\u4f7f\u5728\u6700\u62bd\u8c61\u7684\u9886\u57df\u91cc\u4e5f\u662f\u5982\u6b64\u3002\u5982\u679c\u8bf4\u5b8c\u5584\u7684\u6f14\u7ece\u5f62\u5f0f\u662f\u76ee\u6807\uff0c\u90a3\u4e48\u76f4\u89c2\u548c\u6784\u4f5c\u81f3\u5c11\u4e5f\u662f\u4e00\u79cd\u52a8\u529b\u3002\u6709\u4e00\u79cd\u89c2\u70b9\u5bf9\u79d1\u5b66\u672c\u8eab\u662f\u4e25\u91cd\u7684\u5a01\u80c1\uff0c\u5b83\u65ad\u8a00\u6570\u5b66\u4e0d\u662f\u522b\u7684\u4e1c\u897f\uff0c\u800c\u53ea\u662f\u4ece\u5b9a\u4e49\u548c\u516c\u7406\u63a8\u5bfc\u51fa\u6765\u7684\u4e00\u7ec4\u7ed3\u8bba\uff0c\u800c\u8fd9\u4e9b\u5b9a\u4e49\u548c\u547d\u9898\u9664\u4e86\u5fc5\u987b\u4e0d\u77db\u76fe\u4e4b\u5916\uff0c\u53ef\u4ee5\u7531\u6570\u5b66\u5bb6\u6839\u636e\u4ed6\u4eec\u7684\u610f\u5fd7\u968f\u610f\u521b\u9020\u3002\u5982\u679c\u8fd9\u4e2a\u8bf4\u6cd5\u662f\u6b63\u786e\u7684\u8bdd\uff0c\u6570\u5b66\u5c06\u4e0d\u4f1a\u5438\u5f15\u4efb\u4f55\u6709\u7406\u667a\u7684\u4eba\u3002\u5b83\u5c06\u6210\u4e3a\u5b9a\u4e49\u3001\u89c4\u5219\u548c\u6f14\u7ece\u6cd5\u7684\u6e38\u620f\uff0c\u65e2\u6ca1\u6709\u52a8\u529b\u4e5f\u6ca1\u6709\u76ee\u6807\u3002\u8ba4\u4e3a\u7075\u611f\u80fd\u521b\u9020\u51fa\u6709\u610f\u4e49\u7684\u516c\u7406\u4f53\u7cfb\u7684\u770b\u6cd5\uff0c\u662f\u9a97\u4eba\u7684\u4f3c\u662f\u800c\u975e\u7684\u771f\u7406\u3002\u53ea\u6709\u5728\u4ee5\u8fbe\u5230\u6709\u673a\u6574\u4f53\u4e3a\u76ee\u6807\u7684\u524d\u63d0\u4e0b\uff0c\u4ee5\u53ca\u5728\u5185\u5728\u9700\u8981\u7684\u5f15\u5bfc\u4e0b\uff0c\u81ea\u7531\u7684\u601d\u7ef4\u624d\u80fd\u4f5c\u51fa\u6709\u79d1\u5b66\u4ef7\u503c\u7684\u6210\u679c\u6765\u3002</p> <p>\u5c3d\u7ba1\u903b\u8f91\u5206\u6790\u7684\u601d\u8fa8\u8d8b\u52bf\u5e76\u4e0d\u4ee3\u8868\u5168\u90e8\u6570\u5b66\uff0c\u4f46\u5b83\u5374\u4f7f\u6211\u4eec\u5bf9\u6570\u5b66\u4e8b\u5b9e\u548c\u5b83\u4eec\u76f8\u4e92\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u6709\u66f4\u6df1\u523b\u7684\u7406\u89e3\uff0c\u4ee5\u53ca\u5bf9\u6570\u5b66\u4e2d\u7684\u4e3b\u8981\u6982\u5ff5\u6709\u66f4\u6df1\u523b\u7684\u7406\u89e3\uff0c\u5e76\u7531\u6b64\u53d1\u5c55\u4e86\u53ef\u4f5c\u4e3a\u4e00\u822c\u79d1\u5b66\u6001\u5ea6\u7684\u5178\u8303\u7684\u8fd1\u4ee3\u6570\u5b66\u89c2\u70b9\u3002</p> <p>\u4e0d\u8bba\u6211\u4eec\u6301\u4ec0\u4e48\u6837\u7684\u54f2\u5b66\u89c2\u70b9\uff0c\u5c31\u79d1\u5b66\u89c2\u5bdf\u7684\u76ee\u7684\u6765\u8bf4\uff0c\u5bf9\u4e00\u4e2a\u5bf9\u8c61\u7684\u8ba4\u8bc6\uff0c\u5b8c\u5168\u8868\u73b0\u5728\u5b83\u4e0e\u8ba4\u8bc6\u8005\uff08\u6216\u4eea\u5668\uff09\u7684\u6240\u6709\u53ef\u80fd\u5173\u7cfb\u4e4b\u4e2d\u3002\u5f53\u7136\u4ec5\u4ec5\u662f\u611f\u89c9\u5e76\u4e0d\u80fd\u6784\u6210\u77e5\u8bc6\u548c\u89c1\u89e3\uff0c\u5fc5\u987b\u8981\u4e0e\u67d0\u4e9b\u57fa\u672c\u7684\u5b9e\u4f53\u5373\u201c\u81ea\u5728\u4e4b\u7269\u201d\u76f8\u9002\u5e94\u3001\u76f8\u5370\u8bc1\uff0c\u6240\u8c13\u201c\u81ea\u5728\u4e4b\u7269\u201d\u5e76\u4e0d\u662f\u7269\u4f53\u89c2\u5bdf\u7684\u76f4\u63a5\u5bf9\u8c61\uff0c\u800c\u662f\u5c5e\u4e8e\u5f62\u800c\u4e0a\u5b66\u7684\u3002\u7136\u800c\uff0c\u5bf9\u4e8e\u79d1\u5b66\u65b9\u6cd5\u6765\u8bf4\uff0c\u91cd\u8981\u7684\u662f\u5e94\u653e\u5f03\u5e26\u6709\u5f62\u800c\u4e0a\u5b66\u6027\u8d28\u7684\u56e0\u7d20\uff0c\u800c\u53bb\u8003\u8651\u90a3\u4e9b\u53ef\u89c2\u6d4b\u7684\u4e8b\u5b9e\uff0c\u628a\u5b83\u4eec\u4f5c\u4e3a\u6982\u5ff5\u548c\u6784\u4f5c\u7684\u6700\u7ec8\u6839\u6e90\u3002\u653e\u5f03\u5bf9\u201c\u81ea\u5728\u4e4b\u7269\u201d\u7684\u9886\u609f\uff0c\u5bf9\u201c\u7ec8\u6781\u771f\u7406\u201d\u7684\u8ba4\u8bc6\u4ee5\u53ca\u5173\u4e8e\u4e16\u754c\u7684\u6700\u7ec8\u672c\u8d28\u7684\u9610\u660e\uff0c\u8fd9\u5bf9\u4e8e\u8d28\u6734\u7684\u70ed\u8bda\u8005\u6765\u8bf4\uff0c\u53ef\u80fd\u4f1a\u5e26\u6765\u4e00\u79cd\u5fc3\u7406\u4e0a\u7684\u75db\u82e6\uff0c\u4f46\u4e8b\u5b9e\u4e0a\u5b83\u5374\u662f\u8fd1\u4ee3\u601d\u60f3\u4e0a\u6700\u6709\u6210\u6548\u7684\u4e00\u79cd\u8f6c\u53d8\u3002</p> <p>\u7269\u7406\u5b66\u4e0a\u6240\u53d6\u5f97\u7684\u4e00\u4e9b\u6700\u4f1f\u5927\u7684\u6210\u5c31\uff0c\u6b63\u662f\u7531\u4e8e\u6562\u4e8e\u575a\u6301\u201c\u6d88\u9664\u5f62\u800c\u4e0a\u5b66\u201d\u8fd9\u4e2a\u539f\u5219\u7684\u7ed3\u679c\u3002\u5f53\u7231\u56e0\u65af\u5766\uff08A. Einstein\uff09\u8bd5\u56fe\u628a\u201c\u5728\u4e0d\u540c\u5730\u65b9\u540c\u65f6\u53d1\u751f\u7684\u4e8b\u4ef6\u201d\u8fd9\u4e00\u6982\u5ff5\u5f52\u7ed3\u4e3a\u53ef\u89c2\u6d4b\u7684\u73b0\u8c61\u65f6\uff0c\u5f53\u4ed6\u63ed\u9732\u51fa\uff0c\u8ba4\u4e3a\u4e0a\u8ff0\u6982\u5ff5\u5fc5\u987b\u6709\u5b83\u81ea\u8eab\u7684\u79d1\u5b66\u610f\u4e49\u7684\u4fe1\u5ff5\u53ea\u662f\u5f62\u800c\u4e0a\u5b66\u7684\u504f\u89c1\u65f6\uff0c\u4ed6\u5df2\u53d1\u73b0\u4e86\u4ed6\u7684\u76f8\u5bf9\u8bba\u7684\u5173\u952e\u6240\u5728\u3002\u5f53\u73bb\u5c14\uff08N. Bohr\uff09\u548c\u4ed6\u7684\u5b66\u751f\u4eec\u6307\u51fa\uff0c\u4efb\u4f55\u7269\u7406\u89c2\u6d4b\u5fc5\u7136\u4f34\u968f\u7740\u89c2\u6d4b\u5de5\u5177\u5bf9\u88ab\u89c2\u6d4b\u5bf9\u8c61\u7684\u5f71\u54cd\u8fd9\u4e2a\u4e8b\u5b9e\u65f6\uff0c\u95ee\u9898\u53d8\u5f97\u5f88\u6e05\u695a\uff0c\u5728\u7269\u7406\u4e0a\uff0c\u540c\u65f6\u51c6\u786e\u5730\u786e\u5b9a\u4e00\u4e2a\u7c92\u5b50\u7684\u4f4d\u7f6e\u548c\u901f\u5ea6\u662f\u4e0d\u53ef\u80fd\u7684\u3002\u8fd9\u4e2a\u53d1\u73b0\u7684\u6df1\u8fdc\u610f\u4e49\u4f53\u73b0\u5728\u4e3a\u6bcf\u4e2a\u7269\u7406\u5b66\u5bb6\u6240\u719f\u6089\u7684\u8fd1\u4ee3\u91cf\u5b50\u529b\u5b66\u7684\u7406\u8bba\u4e2d\u3002\u5728\u5341\u4e5d\u4e16\u7eaa\u6d41\u884c\u7740\u4e00\u79cd\u6982\u5ff5\uff0c\u8ba4\u4e3a\u673a\u68b0\u529b\u548c\u7c92\u5b50\u5728\u7a7a\u95f4\u4e2d\u7684\u8fd0\u52a8\u662f\u81ea\u5728\u4e4b\u7269\uff0c\u800c\u7535\u3001\u5149\u548c\u78c1\u90fd\u5e94\u5f53\u5f52\u7ed3\u4e3a\u529b\u5b66\u73b0\u8c61\u6216\u8005\u4f5c\u4e3a\u529b\u5b66\u73b0\u8c61\u6765\u201c\u89e3\u91ca\u201d\uff0c\u6b63\u5982\u4ee5\u524d\u5904\u7406\u201c\u70ed\u201d\u7684\u65b9\u6cd5\u90a3\u6837\u3002\u4eba\u4eec\u66fe\u7ecf\u5047\u8bbe\u8fc7\u201c\u4ee5\u592a\u201d\uff0c\u4f5c\u4e3a\u4e00\u79cd\u5047\u8bbe\u6027\u7684\u5a92\u4ecb\u7269\uff0c\u628a\u5b83\u7528\u4e8e\u90a3\u4e9b\u5bf9\u6211\u4eec\u6765\u8bf4\u4e0d\u80fd\u5b8c\u5168\u52a0\u4ee5\u89e3\u91ca\u7684\u8fd0\u52a8\u4e2d\uff0c\u4f8b\u5982\u5149\u6216\u7535\u3002\u540e\u6765\u4eba\u4eec\u624d\u6162\u6162\u5730\u8ba4\u8bc6\u5230\u4ee5\u592a\u662f\u80af\u5b9a\u65e0\u6cd5\u89c2\u6d4b\u5230\u7684\uff0c\u5b83\u5c5e\u4e8e\u5f62\u800c\u4e0a\u5b66\uff0c\u800c\u4e0d\u5c5e\u4e8e\u7269\u7406\u5b66\u3002\u4e8e\u662f\u4e4e\uff0c\u5728\u67d0\u4e9b\u65b9\u9762\u611f\u5230\u5fe7\u8651\uff0c\u800c\u5728\u53e6\u4e00\u4e9b\u65b9\u9762\u53c8\u611f\u5230\u5b89\u6170\u7684\u5fc3\u60c5\u4e0b\uff0c\u5173\u4e8e\u5149\u548c\u7535\u7684\u529b\u5b66\u89e3\u91ca\u8fde\u540c\u4ee5\u592a\u6700\u540e\u4e00\u9f50\u90fd\u88ab\u653e\u5f03\u4e86\u3002</p> <p>\u5728\u6570\u5b66\u4e2d\u6709\u4e9b\u60c5\u51b5\u4e0e\u6b64\u76f8\u7c7b\u4f3c\uff0c\u751a\u81f3\u66f4\u4e3a\u7a81\u51fa\u3002\u4e16\u4e16\u4ee3\u4ee3\u4ee5\u6765\uff0c\u6570\u5b66\u5bb6\u4e00\u76f4\u628a\u4ed6\u4eec\u7814\u7a76\u7684\u5bf9\u8c61\uff0c\u4f8b\u5982\u6570\u3001\u70b9\u7b49\u7b49\uff0c\u770b\u6210\u5b9e\u5b9e\u5728\u5728\u7684\u81ea\u5728\u4e4b\u7269\u3002\u4f46\u662f\uff0c\u51c6\u786e\u5730\u63cf\u8ff0\u8fd9\u4e9b\u5b9e\u4f53\u7684\u79cd\u79cd\u52aa\u529b\u603b\u662f\u88ab\u8fd9\u4e9b\u5b9e\u4f53\u81ea\u8eab\u7ed0\u5426\u5b9a\u4e86\u3002\u4ece\u800c\u5341\u4e5d\u4e16\u7eaa\u7684\u6570\u5b66\u5bb6\u9010\u6e10\u5f00\u59cb\u61c2\u5f97\uff0c\u8981\u95ee\u5f53\u4f5c\u5b9e\u4f53\u7684\u8fd9\u4e9b\u5bf9\u8c61\u7a76\u7adf\u662f\u4ec0\u4e48\uff0c\u8fd9\u662f\u6ca1\u6709\u610f\u4e49\u7684\uff0c\u5373\u4f7f\u6709\u7684\u8bdd\u4e5f\u4e0d\u53ef\u80fd\u5728\u6570\u5b66\u8303\u56f4\u5185\u5f97\u5230\u89e3\u51b3\u3002\u6240\u6709\u9002\u5408\u5b83\u4eec\u7684\u8bba\u65ad\u90fd\u4e0d\u6d89\u53ca\u8fd9\u4e9b\u5b9e\u4f53\u7684\u73b0\u5b9e\uff0c\u800c\u53ea\u8bf4\u660e\u6570\u5b66\u4e0a\u201c\u4e0d\u52a0\u5b9a\u4e49\u7684\u5bf9\u8c61\u201d\u4e4b\u95f4\u7684\u76f8\u4e92\u5173\u7cfb\u4ee5\u53ca\u5b83\u4eec\u6240\u9075\u5faa\u7684\u8fd0\u7b97\u6cd5\u5219\u3002\u81f3\u4e8e\u70b9\u3001\u7ebf\u3001\u6570\uff0c\u201c\u5b9e\u9645\u4e0a\u201d\u662f\u4ec0\u4e48\uff0c\u8fd9\u4e0d\u53ef\u80fd\u4e5f\u4e0d\u9700\u8981\u5728\u6570\u5b66\u79d1\u5b66\u4e2d\u52a0\u4ee5\u8ba8\u8bba\u3002\u201c\u53ef\u9a8c\u8bc1\u201d\u7684\u4e8b\u5b9e\u53ea\u662f\u7ed3\u6784\u548c\u5173\u7cfb\uff1a\u4e24\u70b9\u51b3\u5b9a\u4e00\u76f4\u7ebf\uff0c\u4e00\u4e9b\u6570\u6309\u7167\u67d0\u4e9b\u89c4\u5219\u7ec4\u6210\u5176\u4ed6\u4e00\u4e9b\u6570\uff0c\u7b49\u7b49\u3002\u57fa\u672c\u7684\u6570\u5b66\u6982\u5ff5\u5fc5\u987b\u62bd\u8c61\u5316\uff0c\u8fd9\u4e00\u89c1\u89e3\u662f\u8fd1\u4ee3\u516c\u7406\u5316\u53d1\u5c55\u4e2d\u6700\u91cd\u8981\u548c\u6700\u4e30\u5bcc\u7684\u6210\u679c\u4e4b\u4e00\u3002</p> <p>\u5e78\u8fd0\u7684\u662f\uff0c\u521b\u9020\u6027\u7684\u601d\u7ef4\u4e0d\u987e\u67d0\u4e9b\u6559\u6761\u7684\u54f2\u5b66\u4fe1\u4ef0\u800c\u7ee7\u7eed\u53d1\u5c55\u7740\uff0c\u800c\u5982\u679c\u601d\u7ef4\u5c48\u4ece\u4e8e\u8fd9\u79cd\u4fe1\u4ef0\u5c31\u4f1a\u963b\u788d\u51fa\u73b0\u5efa\u8bbe\u6027\u7684\u6210\u5c31\u3002\u4e0d\u8bba\u5bf9\u4e13\u5bb6\u6765\u8bf4\uff0c\u8fd8\u662f\u5bf9\u666e\u901a\u4eba\u6765\u8bf4\uff0c\u552f\u4e00\u80fd\u56de\u7b54\u201c\u4ec0\u4e48\u662f\u6570\u5b66\u201d\u8fd9\u4e2a\u95ee\u9898\u7684\uff0c\u4e0d\u662f\u54f2\u5b66\u800c\u662f\u6570\u5b66\u672c\u8eab\u4e2d\u7684\u6d3b\u751f\u751f\u7684\u7ecf\u9a8c\u3002</p>"},{"location":"2018-08-08-%E5%9C%A8%E6%A0%91%E8%8E%93%E6%B4%BE%E4%B8%8A%E5%AE%89%E8%A3%85Arch%20Linux%20ARM/","title":"2018 08 08 \u5728\u6811\u8393\u6d3e\u4e0a\u5b89\u88c5Arch Linux ARM","text":"<p>\u6765\u81eahttps://archlinuxarm.org/platforms/armv6/raspberry-pi</p> <p>\u8bf7\u5c06\u4e0b\u9762\u6307\u4ee4\u4e2d\u7684<code>sdX</code>\u66ff\u6362\u4e3aSD\u5361\u5728\u60a8\u7535\u8111\u4e2d\u7684\u8bbe\u5907\u540d\u79f0\u3002</p> <ol> <li>\u4f7f\u7528fdisk\u4e3aSD\u5361\u5206\u533a: <pre><code># fdisk /dev/sdX\n</code></pre></li> <li>\u5728fdisk\u7684\u63d0\u793a\u7b26\u4e2d\uff0c\u5220\u9664\u539f\u6709\u7684\u5206\u533a\uff0c\u7136\u540e\u65b0\u5efa\u5206\u533a\uff1a<ol> <li>\u6309<code>o</code>\uff0c\u6e05\u9664\u6b64\u8bbe\u5907\u4e0a\u6240\u6709\u7684\u5206\u533a\uff1b</li> <li>\u6309<code>p</code>\u6765\u5217\u51fa\u6240\u6709\u5206\u533a\uff0c\u5f53\u524d\u8bbe\u5907\u5e94\u8be5\u6ca1\u6709\u4efb\u4f55\u5206\u533a\u5b58\u5728\uff1b</li> <li>\u6309<code>n</code>\uff0c\u7136\u540e\u6309<code>p</code>\uff08\u4e3b\u5206\u533a\uff09\uff0c\u7136\u540e\u6309<code>1</code>\uff08\u8bbe\u5907\u4e0a\u7b2c\u4e00\u4e2a\u5206\u533a\uff09\uff0c\u7136\u540e\u6309<code>\u56de\u8f66</code>\u952e\u63a5\u53d7\u9ed8\u8ba4\u7684\u7b2c\u4e00\u4e2a\u6247\u533a\uff0c\u7136\u540e\u4e3a\u6700\u540e\u4e00\u4e2a\u6247\u533a\u8f93\u5165<code>+100M</code>\uff1b</li> <li>\u6309<code>t</code>\uff0c\u7136\u540e\u6309<code>c</code>\u8bbe\u7f6e\u7b2c\u4e00\u4e2a\u5206\u533a\u7c7b\u578b\u4e3a<code>W95 FAT32(LBA)</code>\uff1b</li> <li>\u6309<code>n</code>\uff0c\u7136\u540e\u6309<code>p</code>\uff08\u4e3b\u5206\u533a\uff09\uff0c\u6309<code>2</code>\uff08\u8bbe\u5907\u4e0a\u7b2c\u4e8c\u4e2a\u5206\u533a\uff09\uff0c\u7136\u540e\u6309\u4e24\u6b21<code>\u56de\u8f66</code>\u6765\u63a5\u53d7\u9ed8\u8ba4\u7684\u7b2c\u4e00\u4e2a\u548c\u6700\u540e\u4e00\u4e2a\u6247\u533a\uff1b</li> <li>\u6309<code>w</code>\uff0c\u5199\u5165\u5206\u533a\u8868\u540e\u9000\u51fa\uff1b</li> </ol> </li> <li>\u521b\u5efaFAT\u6587\u4ef6\u7cfb\u7edf\u5e76\u88c5\u8f7d <pre><code># mkfs.vfat /dev/sdX1\n# mkdir boot\n# mount /dev/sdX1 boot\n</code></pre></li> <li>\u521b\u5efaext4\u6587\u4ef6\u7cfb\u7edf\u5e76\u88c5\u8f7d: <pre><code># mkfs.ext4 /dev/sdX2\n# mkdir root\n# mount /dev/sdX2 root\n</code></pre></li> <li>\u4e0b\u8f7d\u7cfb\u7edf\u955c\u50cf\u6587\u4ef6\uff0c\u5e76\u4e14\u63d0\u53d6\u5230<code>root</code>\u6587\u4ef6\u7cfb\u7edf\uff08\u6ce8\uff0c\u4f5c\u4e3a<code>root\u7528\u6237</code>\uff0c\u800c\u4e0d\u662f\u901a\u8fc7<code>sudo</code>\uff09:  <pre><code># wget http://os.archlinuxarm.org/os/ArchLinuxARM-rpi-latest.tar.gz\n# bsdtar -xpf ArchLinuxARM-rpi-latest.tar.gz -C root\n# sync # \u6b64\u547d\u4ee4\u6bd4\u8f83\u8017\u65f6\n</code></pre></li> <li>\u79fb\u52a8boot\u6587\u4ef6\u5230\u7b2c\u4e00\u4e2a\u5206\u533a\uff1a <pre><code># mv root/boot/* boot\n</code></pre></li> <li>\u5378\u8f7d\u4e24\u4e2a\u5206\u533a <pre><code># umount boot root\n</code></pre></li> <li>\u5c06SD\u5361\u63d2\u5165\u5230\u6811\u8393\u6d3e\uff0c\u8fde\u63a5\u4ee5\u592a\u7f51\uff0c\u5e76\u4e14\u8fde\u63a5\u7535\u6e90</li> <li>\u4f7f\u7528<code>\u4e32\u884c\u63a7\u5236\u53f0(serial console)</code>\u6216\u8005<code>SSH</code>\u8fde\u63a5</li> <li>\u4f7f\u7528\u9ed8\u8ba4\u7528\u6237<code>alarm</code>\uff0c\u5bc6\u7801<code>alarm</code></li> <li><code>root</code>\u7528\u6237\u7684\u5bc6\u7801\u9ed8\u8ba4\u662f<code>root</code> <p>\u6ce8\uff1a\u4e3a\u4e86\u5b89\u5168\uff0c\u8bf7\u5f3a\u5316\u7528\u6237\u5bc6\u7801</p> </li> <li>\u521d\u59cb\u5316pacman\u5bc6\u94a5\u73af\u5e76\u586b\u5145Arch Linux ARM\u5305\u7b7e\u540d\u5bc6\u94a5: <pre><code># pacman-key --init\n# pacman-key --populate archlinuxarm\n</code></pre></li> </ol> <p>\u81f3\u6b64\uff0c\u6811\u8393\u6d3e\u5b89\u88c5\u5b8c\u6210\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u5305\u7ba1\u7406\u5668<code>pacman</code>\u5b89\u88c5sudo/ufw\u7b49\u5de5\u5177\uff0c\u5f3a\u5316\u5b89\u5168\uff0c\u4e5f\u53ef\u4ee5\u5f53\u4f5c\u4e00\u4e2a\u5bb6\u7528\u7684\u670d\u52a1\u5668\uff0c\u795d\u73a9\u5f97\u5f00\u5fc3\ud83e\udd73~</p>"},{"location":"2018-08-16-Timsort%20%E4%BD%A0%E4%BB%8E%E6%9C%AA%E5%90%AC%E8%AF%B4%E8%BF%87%E7%9A%84%E6%9C%80%E5%BF%AB%E7%9A%84%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/","title":"2018 08 16 Timsort \u4f60\u4ece\u672a\u542c\u8bf4\u8fc7\u7684\u6700\u5feb\u7684\u6392\u5e8f\u7b97\u6cd5","text":"<p>\u672c\u6587\u7ffb\u8bd1\u81eaTimsort\u200a\u2014\u200athe fastest sorting algorithm you\u2019ve never heard of\uff0c\u5982\u4fb5\u5fc5\u5220\u3002</p> <p>Timsort: \u4e00\u4e2a\u975e\u5e38\u5feb\u901f\u7684\uff0c\u65f6\u95f4\u590d\u6742\u5ea6O(n log n)\uff0c\u4e3a\u771f\u5b9e\u4e16\u754c\u6784\u5efa\u7684\u7a33\u5b9a\u6392\u5e8f\u7b97\u6cd5\u2014\u2014\u800c\u4e0d\u662f\u5b66\u672f\u754c\u3002</p> <p>Timsort\u662f\u4e00\u4e2a\u5bf9\u4e8e\u771f\u5b9e\u4e16\u754c\u6570\u636e\u5177\u6709\u9ad8\u6548\u7387\u7684\u3001\u4e0d\u662f\u5728\u5b66\u672f\u5b9e\u9a8c\u5ba4\u4e2d\u53d1\u8868\u7684\u6392\u5e8f\u7b97\u6cd5\uff0c\u7531Tim Peters\u57282001\u5e74\u4e3aPython\u7f16\u7a0b\u8bed\u8a00\u521b\u9020\u3002\u5b83\u8bd5\u56fe\u9996\u5148\u5206\u6790\u9700\u8981\u6392\u5e8f\u7684\u5217\u8868\uff0c\u7136\u540e\u57fa\u4e8e\u5206\u6790\u9009\u62e9\u4e00\u79cd\u65b9\u6cd5\u3002</p> <p></p> <p>\u4ece\u53d1\u8868\u81f3\u4eca\uff0c\u8be5\u7b97\u6cd5\u5df2\u7ecf\u88ab\u7528\u4f5cPython, Java, Android(TM)\u548cGNU Octave\u7528\u4f5c\u9ed8\u8ba4\u6392\u5e8f\u7b97\u6cd5\u3002</p> <p>Timsort\u7684\u5927O\u6807\u8bb0\u6cd5(big O notation)\u662fO(n log n).\u5b66\u4e60\u5927O\u6807\u8bb0\u6cd5\uff0c\u8bf7\u79fb\u6b65\u81f3\u6b64\u3002</p> <p></p> <p>Timsort\u7684\u6392\u5e8f\u65f6\u95f4\u4e0e\u5f52\u5e76\u6392\u5e8f\u76f8\u540c\uff0c\u540e\u8005\u6bd4\u60a8\u53ef\u80fd\u77e5\u9053\u7684\u5176\u4ed6\u5927\u591a\u6570\u6392\u5e8f\u7b97\u6cd5\u8981\u5feb\u3002\u6b63\u5982\u4f60\u5f88\u5feb\u5c06\u8981\u770b\u5230\u7684\uff0cTimsort\u5b9e\u9645\u4e0a\u4f7f\u7528\u4e86\u63d2\u5165\u6392\u5e8f\u548c\u5f52\u5e76\u6392\u5e8f\u3002</p> <p>Peters\u5c06Timsort\u8bbe\u8ba1\u4e3a\u4f7f\u7528\u771f\u5b9e\u4e16\u754c\u7684\u6570\u636e\u4e2d\u5df2\u7ecf\u6709\u5e8f\u7684\u5143\u7d20\u3002\u5b83\u5c06\u8fd9\u4e9b\u5df2\u7ecf\u6709\u5e8f\u7684\u5143\u7d20\u79f0\u4f5c\u201c\u81ea\u7136\u7684\u8fd0\u884c(natural runs)\u201d\u3002\u5b83\u8fed\u4ee3\u6574\u4e2a\u6570\u636e\uff0c\u5c06\u5143\u7d20\u6536\u96c6\u5230\u591a\u4e2arun\u4e2d\uff0c\u540c\u65f6\u5c06\u591a\u4e2arun\u5408\u5e76\u5230\u4e00\u4e2a\u3002</p>"},{"location":"2018-08-16-Timsort%20%E4%BD%A0%E4%BB%8E%E6%9C%AA%E5%90%AC%E8%AF%B4%E8%BF%87%E7%9A%84%E6%9C%80%E5%BF%AB%E7%9A%84%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/#64","title":"\u5217\u8868\u957f\u5ea6\u5c0f\u4e8e64","text":"<p>\u82e5\u5217\u8868\u5c1d\u8bd5\u6392\u5e8f\u5176\u5185\u90e8\u5c11\u4e8e64\u4e2a\u5143\u7d20\u65f6\uff0cTimsort\u5c06\u4f1a\u6267\u884c\u4e00\u4e2a\u63d2\u5165\u6392\u5e8f\u3002</p> <p>\u63d2\u5165\u6392\u5e8f\u662f\u4e00\u79cd\u7b80\u5355\u7684\u6392\u5e8f\uff0c\u5bf9\u4e8e\u5c0f\u578b\u5217\u8868\u6548\u7387\u6700\u9ad8\u3002\u5728\u8f83\u5927\u7684\u5217\u8868\u4e2d\u786e\u5b9e\u6bd4\u8f83\u6162\uff0c\u4f46\u5728\u5c0f\u578b\u5217\u8868\u4e2d\u5374\u975e\u5e38\u5feb\u3002\u63d2\u5165\u6392\u5e8f\u7684\u6982\u5ff5\u5982\u4e0b\uff1a</p> <ul> <li>\u9010\u4e2a\u67e5\u770b\u5143\u7d20</li> <li>\u901a\u8fc7\u5c06\u5143\u7d20\u63d2\u5165\u6b63\u786e\u7684\u4f4d\u7f6e\u6765\u6784\u5efa\u6392\u5e8f\u5217\u8868</li> </ul> <p>\u8fd9\u662f\u4e00\u4e2a\u8ddf\u8e2a\u5217\u8868\uff0c\u663e\u793a\u4e86[34, 10, 64, 51, 32, 21]\u5982\u4f55\u8fdb\u884c\u63d2\u5165\u6392\u5e8f\uff1a</p> <p></p> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5c06\u4e00\u4e2a\u65b0\u6392\u5e8f\u7684\u5143\u7d20\u63d2\u5165\u4e00\u4e2a\u65b0\u7684\u5b50\u6570\u7ec4\uff0c\u8be5\u5b50\u6570\u7ec4\u4ece\u6570\u7ec4\u7684\u5f00\u5934\u5f00\u59cb\u3002</p> <p>\u8fd9\u662f\u4e00\u4e2a\u663e\u793a\u63d2\u5165\u6392\u5e8f\u7684GIF\uff1a</p> <p></p>"},{"location":"2018-08-16-Timsort%20%E4%BD%A0%E4%BB%8E%E6%9C%AA%E5%90%AC%E8%AF%B4%E8%BF%87%E7%9A%84%E6%9C%80%E5%BF%AB%E7%9A%84%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/#run","title":"\u5173\u4e8erun\u7684\u7ec6\u8282","text":"<p>\u5982\u679c\u5217\u8868\u5927\u4e8e64\u4e2a\u5143\u7d20\uff0c\u5219\u7b97\u6cd5\u5c06\u9996\u5148\u901a\u8fc7\u5217\u8868\u67e5\u627e\u4e25\u683c\u589e\u52a0\u6216\u51cf\u5c11\u7684\u90e8\u5206\u3002\u5982\u679c\u67d0\u4e2a\u90e8\u5206\u6b63\u5728\u51cf\u5c11\uff0c\u5b83\u5c06\u8be5\u90e8\u5206\u53cd\u8f6c\u3002\u56e0\u6b64\uff0c\u5982\u679c\u8fd0\u884c\u6b63\u5728\u51cf\u5c11\uff0c\u5b83\u5c06\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff08\u8fd0\u884c\u4ee5\u7c97\u4f53\u663e\u793a\uff09\uff1a</p> <p></p> <p>\u82e5\u4e0d\u51cf\u5c11\uff0c\u5219\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a</p> <p></p> <p>minrun\u662f\u57fa\u4e8e\u6570\u7ec4\u5927\u5c0f\u786e\u5b9a\u7684\u3002\u8be5\u7b97\u6cd5\u9009\u62e9\u5b83\uff0c\u4ee5\u4fbf\u5927\u591a\u6570\u5728\u968f\u673a\u6570\u7ec4\u4e2d\u8fd0\u884c\u7684\u957f\u5ea6\u4e3aminrun\u3002\u5f53\u8fd0\u884c\u6b21\u6570\u7b49\u4e8e\u6216\u7565\u5c0f\u4e8e2\u7684\u5e42\u65f6\uff0c\u5408\u5e762\u4e2a\u6570\u7ec4\u4f1a\u66f4\u9ad8\u6548\u3002Timsort\u9009\u62e9minrun\u6765\u4fdd\u6301\u4f7fminrun\u7684\u957f\u5ea6\u4e0d\u5927\u4e8e2\u7684\u5e42\u3002\u8be5\u7b97\u6cd5\u9009\u62e9\u8303\u56f4\u4e3a32\u523064\uff08\u5305\u62ec32\u548c64\uff09\u7684minrun\uff0c\u4f7f\u5f97\u539f\u59cb\u6570\u7ec4\u7684\u957f\u5ea6\u9664\u4ee5minrun\u65f6\u7b49\u4e8e\u6216\u7565\u5c0f\u4e8e2\u7684\u5e42\u3002</p> <p>\u5982\u679c\u67d0\u4e2arun\u7684\u957f\u5ea6\u5c0f\u4e8eminrun\uff0c\u5219\u8ba1\u7b97\u4e24\u8005\u5dee\u503c\uff0c\u4f7f\u7528\u6b64\u65b0\u6570\u5b57\uff0c\u60a8\u53ef\u4ee5\u5728run\u7684\u5934\u90e8\u83b7\u53d6\u8bb8\u591a\u5143\u7d20\u5e76\u6267\u884c\u63d2\u5165\u6392\u5e8f\u4ee5\u521b\u5efa\u4e00\u4e2a\u65b0\u7684run\u3002</p> <p>\u56e0\u6b64\uff0c\u5982\u679cminrun\u4e3a63\u5e76\u4e14run\u7684\u957f\u5ea6\u4e3a33\uff0c\u5219\u6267\u884c63-33 = 30\uff0c\u7136\u540e\u4ecerun\u7684\u672b\u5c3e\u524d\u6293\u53d630\u4e2a\u5143\u7d20\uff0c\u8fd9\u662f\u6765\u81earun[33]\u768430\u4e2a\u5143\u7d20\u7136\u540e\u6267\u884c\u7528\u4e8e\u521b\u5efa\u65b0run\u7684\u63d2\u5165\u6392\u5e8f\u3002</p> <p>\u5f53\u672c\u90e8\u5206\u5b8c\u6210\u4e4b\u540e\uff0c\u6211\u4eec\u5e94\u8be5\u5728\u6570\u7ec4\u4e2d\u6709\u4e00\u5806\u5df2\u7ecf\u6392\u5e8f\u7684run\u3002</p>"},{"location":"2018-08-16-Timsort%20%E4%BD%A0%E4%BB%8E%E6%9C%AA%E5%90%AC%E8%AF%B4%E8%BF%87%E7%9A%84%E6%9C%80%E5%BF%AB%E7%9A%84%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/#_1","title":"\u5408\u5e76","text":"<p>Timsort\u73b0\u5728\u6267\u884cmergesort\u4ee5\u5c06\u8fd0\u884c\u5408\u5e76\u5728\u4e00\u8d77\u3002\u4f46\u662f\uff0cTimsort\u786e\u4fdd\u5728\u5408\u5e76\u6392\u5e8f\u65f6\u4fdd\u6301\u7a33\u5b9a\u6027\u548c\u5408\u5e76\u5e73\u8861\u3002\u4e3a\u4e86\u4fdd\u6301\u7a33\u5b9a\uff0c\u6211\u4eec\u4e0d\u5e94\u8be5\u4ea4\u63622\u4e2a\u76f8\u7b49\u6570\u503c\u7684\u6570\u5b57\u3002\u8fd9\u4e0d\u4ec5\u4f7f\u5176\u539f\u59cb\u4f4d\u7f6e\u4fdd\u6301\u5728\u5217\u8868\u4e2d\uff0c\u800c\u4e14\u4f7f\u7b97\u6cd5\u66f4\u5feb\u3002\u6211\u4eec\u5c06\u5728\u77ed\u671f\u5185\u8ba8\u8bba\u5408\u5e76\u5e73\u8861\u3002</p> <p>\u5f53Timsort\u67e5\u627erun\u65f6\uff0c\u4f1a\u5c06\u5b83\u4eec\u6dfb\u52a0\u5230\u5806\u6808\u4e2d\u3002\u4e00\u4e2a\u7b80\u5355\u7684\u5806\u6808\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a</p> <p></p> <p>\u60f3\u8c61\u4e00\u5806\u76d8\u5b50\u3002\u4f60\u4e0d\u80fd\u4ece\u5e95\u90e8\u53d6\u677f\uff0c\u6240\u4ee5\u4f60\u5fc5\u987b\u4ece\u9876\u90e8\u4e00\u4e2a\u4e00\u4e2a\u62ff\u8d70\u5b83\u4eec\uff0c\u5806\u6808\u4e5f\u662f\u5982\u6b64\u3002</p> <p>\u5f53\u5408\u5e76\u8fd0\u884c\u65f6\uff0cTimsort\u8bd5\u56fe\u5e73\u8861\u4e24\u4e2a\u7ade\u4e89\u9700\u6c42\u3002\u4e00\u65b9\u9762\uff0c\u6211\u4eec\u5e0c\u671b\u5c3d\u53ef\u80fd\u5730\u5ef6\u8fdf\u5408\u5e76\uff0c\u4ee5\u4fbf\u5229\u7528\u53ef\u80fd\u5728\u4ee5\u540e\u51fa\u73b0\u7684\u6a21\u5f0f\u3002\u4f46\u662f\u6211\u4eec\u5e0c\u671b\u5c3d\u5feb\u8fdb\u884c\u5408\u5e76\u4ee5\u5229\u7528\u521a\u521a\u53d1\u73b0\u7684\u8fd0\u884c\u5728\u5185\u5b58\u5c42\u6b21\u7ed3\u6784\u4e2d\u4ecd\u7136\u5f88\u9ad8\u7684run\u3002\u6211\u4eec\u4e5f\u4e0d\u80fd\u5ef6\u8fdf\u5408\u5e76\u201c\u592a\u957f\u201d\uff0c\u56e0\u4e3a\u5b83\u6d88\u8017\u5185\u5b58\u6765\u8bb0\u4f4f\u4ecd\u7136\u672a\u5408\u5e76\u7684\u8fd0\u884c\uff0c\u5e76\u4e14\u5806\u6808\u5177\u6709\u56fa\u5b9a\u7684\u5927\u5c0f\u3002</p> <p>\u4e3a\u4e86\u786e\u4fdd\u6211\u4eec\u6709\u8fd9\u79cd\u59a5\u534f\uff0cTimsort\u4f1a\u8ddf\u8e2a\u5806\u6808\u4e2d\u6700\u8fd1\u7684\u4e09\u4e2a\u9879\u76ee\u5e76\u521b\u5efa\u4e24\u4e2a\u5fc5\u987b\u7b26\u5408\u8fd9\u4e9b\u9879\u76ee\u7684\u6cd5\u5219\uff1a</p> <ol> <li> <p>A &gt; B + C</p> </li> <li> <p>B &gt; C</p> </li> </ol> <p>\u5176\u4e2dA\uff0cB\u548cC\u662f\u5806\u6808\u4e2d\u6700\u8fd1\u7684\u4e09\u4e2a\u9879\u76ee\u3002</p> <p>\u7528Tim Peters\u672c\u4eba\u7684\u8bdd\u6765\u8bf4\uff1a</p> <p>What turned out to be a good compromise maintains two invariants on the stack entries, where A, B and C are the lengths of the three righmost not-yet merged slices.</p> <p>\u901a\u5e38\uff0c\u5c06\u4e0d\u540c\u957f\u5ea6\u7684\u76f8\u90bb\u8fd0\u884c\u5408\u5e76\u5230\u4f4d\u662f\u5f88\u56f0\u96be\u7684\u3002\u66f4\u96be\u7684\u662f\u6211\u4eec\u5fc5\u987b\u4fdd\u6301\u7a33\u5b9a\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cTimsort\u7559\u51fa\u4e86\u4e34\u65f6\u5185\u5b58\u3002\u5b83\u5c06\u4e24\u6b21\u8fd0\u884c\u7684\u8f83\u5c0f\uff08\u8c03\u7528\u8fd0\u884cA\u548cB\uff09\u653e\u5165\u8be5\u4e34\u65f6\u5185\u5b58\u4e2d\u3002</p>"},{"location":"2018-08-16-Timsort%20%E4%BD%A0%E4%BB%8E%E6%9C%AA%E5%90%AC%E8%AF%B4%E8%BF%87%E7%9A%84%E6%9C%80%E5%BF%AB%E7%9A%84%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/#galloping","title":"\u75be\u9a70\uff08Galloping\uff09","text":"<p>\u867d\u7136Timsort\u6b63\u5728\u5408\u5e76A\u548cB\uff0c\u4f46\u5b83\u6ce8\u610f\u5230\u4e00\u6b21run\u5df2\u8fde\u7eed\u591a\u6b21\u201c\u5b8c\u6210\u201d\u3002\u5982\u679c\u7ed3\u679c\u8868\u660e\u8fd0\u884cA\u7684\u6570\u91cf\u6bd4\u8fd0\u884cB\u7684\u6570\u91cf\u5c11\uff0c\u90a3\u4e48\u8fd0\u884cA\u5c06\u6700\u7ec8\u8fd4\u56de\u5176\u539f\u59cb\u4f4d\u7f6e\u3002\u5408\u5e76\u4e24\u6b21\u8fd0\u884c\u5c06\u6d89\u53ca\u5927\u91cf\u5de5\u4f5c\u4ee5\u5b9e\u73b0\u4efb\u4f55\u76ee\u6807\u3002</p> <p>\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u6570\u636e\u5c06\u5177\u6709\u4e00\u4e9b\u9884\u5148\u5b58\u5728\u7684\u5185\u90e8\u7ed3\u6784\u3002 Timsort\u5047\u8bbe\u5982\u679c\u8bb8\u591a\u8fd0\u884cA\u7684\u503c\u4f4e\u4e8e\u8fd0\u884cB\u7684\u503c\uff0c\u5219A\u53ef\u80fd\u7ee7\u7eed\u5177\u6709\u6bd4B\u66f4\u5c0f\u7684\u503c\u3002</p> <p></p> <p>\u7136\u540eTimsort\u5c06\u8fdb\u5165\u75be\u9a70\u6a21\u5f0f\u3002 Timsort\u4e0d\u662f\u76f8\u4e92\u68c0\u67e5A[0]\u548cB[0]\uff0c\u800c\u662f\u5bf9[0]\u4e2db [0]\u7684\u9002\u5f53\u4f4d\u7f6e\u8fdb\u884c\u4e8c\u5206\u641c\u7d22\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0cTimsort\u53ef\u4ee5\u5c06\u6574\u4e2aA\u90e8\u5206\u79fb\u52a8\u5230\u4f4d\u3002\u7136\u540eTimsort\u5728B\u4e2d\u641c\u7d22A[0]\u7684\u9002\u5f53\u4f4d\u7f6e\u3002\u7136\u540e\uff0cTimsort\u5c06\u7acb\u5373\u79fb\u52a8\u6574\u4e2aB\u7f50\u7684\u90e8\u5206\uff0c\u5e76\u5c06\u5176\u79fb\u52a8\u5230\u4f4d\u3002</p> <p>\u8ba9\u6211\u4eec\u5173\u6ce8\u4e00\u4e0b\u5b83\u3002 Timsort\u68c0\u67e5B[0]\uff08\u53735\uff09\u5e76\u4f7f\u7528\u4e8c\u8fdb\u5236\u641c\u7d22\u5b83\u5728A\u4e2d\u67e5\u627e\u6b63\u786e\u7684\u4f4d\u7f6e\u3002\u597d\u5427\uff0cB[0]\u5c5e\u4e8eA\u5217\u8868\u7684\u540e\u9762\u3002\u73b0\u5728Timsort\u5728B\u7684\u6b63\u786e\u4f4d\u7f6e\u68c0\u67e5A[0]\uff08\u53731\uff09\u3002\u6240\u4ee5\u6211\u4eec\u8981\u67e5\u770b\u6570\u5b571\u7684\u4f4d\u7f6e\u3002\u8fd9\u4e2a\u6570\u5b57\u5728B\u7684\u5f00\u5934\u3002\u6211\u4eec\u73b0\u5728\u77e5\u9053B\u5c5e\u4e8eA\u7684\u672b\u5c3e\uff0cA\u5c5e\u4e8eB\u7684\u5f00\u5934\u3002\u4e8b\u5b9e\u8bc1\u660e\uff0c\u5982\u679cB[0]\u7684\u9002\u5f53\u4f4d\u7f6e\u975e\u5e38\u63a5\u8fd1A\u7684\u5f00\u5934\uff08\u6216\u53cd\u4e4b\u4ea6\u7136\uff09\uff0c\u5219\u6b64\u64cd\u4f5c\u4e0d\u503c\u5f97\u3002\u6240\u4ee5\u5982\u679c\u6ca1\u6709\u5f97\u5230\u56de\u62a5\uff0c\u9a70\u9a8b\u6a21\u5f0f\u4f1a\u5f88\u5feb\u9000\u51fa\u3002\u6b64\u5916\uff0cTimsort\u6ce8\u610f\u5230\u5e76\u4e14\u901a\u8fc7\u589e\u52a0\u8fdb\u5165\u6240\u9700\u7684\u8fde\u7eedA-only\u6216B-only\u80dc\u5229\u7684\u6b21\u6570\u4f7f\u5f97\u8fdb\u5165\u9a70\u9a8b\u6a21\u5f0f\u53d8\u5f97\u66f4\u52a0\u56f0\u96be\u3002\u5982\u679c\u9a70\u9a8b\u6a21\u5f0f\u5f97\u5230\u56de\u62a5\uff0cTimsort\u8ba9\u5b83\u66f4\u5bb9\u6613\u91cd\u5165\u3002</p> <p>\u7b80\u800c\u8a00\u4e4b\uff0cTimsort\u505a\u4e86\u4e24\u4ef6\u4ee4\u4eba\u96be\u4ee5\u7f6e\u4fe1\u7684\u4e8b\u60c5\uff1a </p> <ul> <li>\u5177\u6709\u9884\u5148\u5b58\u5728\u7684\u5185\u90e8\u7ed3\u6784\u7684\u9635\u5217\u5177\u6709\u51fa\u8272\u7684\u6027\u80fd</li> <li>\u80fd\u591f\u4fdd\u6301\u7a33\u5b9a\u7684\u6392\u5e8f</li> </ul> <p>\u4ee5\u524d\uff0c\u4e3a\u4e86\u5b9e\u73b0\u7a33\u5b9a\u7684\u6392\u5e8f\uff0c\u60a8\u5fc5\u987b\u4f7f\u7528\u6574\u6570\u5c06\u5217\u8868\u4e2d\u7684\u9879\u76ee\u538b\u7f29\uff0c\u5e76\u5c06\u5176\u6392\u5e8f\u4e3a\u5143\u7ec4\u6570\u7ec4\u3002</p>"},{"location":"2018-08-16-Timsort%20%E4%BD%A0%E4%BB%8E%E6%9C%AA%E5%90%AC%E8%AF%B4%E8%BF%87%E7%9A%84%E6%9C%80%E5%BF%AB%E7%9A%84%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/#_2","title":"\u4ee3\u7801","text":"<p>\u5982\u679c\u60a8\u5bf9\u4ee3\u7801\u4e0d\u611f\u5174\u8da3\uff0c\u8bf7\u8df3\u8fc7\u6b64\u90e8\u5206\u3002\u672c\u8282\u4e0b\u9762\u8fd8\u6709\u4e00\u4e9b\u4fe1\u606f\u3002</p> <p>\u4e0b\u9762\u7684\u6e90\u4ee3\u7801\u57fa\u4e8e\u6211\u548cNanda Javarma\u7684\u5de5\u4f5c\u3002\u6e90\u4ee3\u7801\u4e0d\u5b8c\u6574\uff0c\u4e5f\u4e0d\u7c7b\u4f3c\u4e8ePython\u7684\u5b98\u65b9sorted()\u6e90\u4ee3\u7801\u3002\u8fd9\u53ea\u662f\u6211\u5b9e\u73b0\u7684\u4e00\u4e2a\u611a\u8822\u7684Timsort\uff0c\u4ee5\u83b7\u5f97Timsort\u7684\u5927\u6982\u611f\u89c9\u3002\u5982\u679c\u4f60\u60f3\u770b\u5230Timsort\u7684\u539f\u521b\u6e90\u4ee3\u7801\uff0c\u8bf7\u5728\u8fd9\u91cc\u67e5\u770b\u3002 Timsort\u662f\u7528C\u8bed\u8a00\u5b9e\u73b0\u7684\uff0c\u800c\u4e0d\u662fPython\u3002</p> <pre><code># based off of this code https://gist.github.com/nandajavarma/a3a6b62f34e74ec4c31674934327bbd3\n# Brandon Skerritt\n# https://skerritt.tech\n\ndef binary_search(the_array, item, start, end):\n    if start == end:\n        if the_array[start] &gt; item:\n            return start\n        else:\n            return start + 1\n    if start &gt; end:\n        return start\n\n    mid = round((start + end)/ 2)\n\n    if the_array[mid] &lt; item:\n        return binary_search(the_array, item, mid + 1, end)\n\n    elif the_array[mid] &gt; item:\n        return binary_search(the_array, item, start, mid - 1)\n\n    else:\n        return mid\n\n\"\"\"\nInsertion sort that timsort uses if the array size is small or if\nthe size of the \"run\" is small\n\"\"\"\ndef insertion_sort(the_array):\n    l = len(the_array)\n    for index in range(1, l):\n        value = the_array[index]\n        pos = binary_search(the_array, value, 0, index - 1)\n        the_array = the_array[:pos] + [value] + the_array[pos:index] + the_array[index+1:]\n    return the_array\n\ndef merge(left, right):\n\"\"\"Takes two sorted lists and returns a single sorted list by comparing the\n    elements one at a time.\n    [1, 2, 3, 4, 5, 6]\n    \"\"\"\n    if not left:\n        return right\n    if not right:\n        return left\n    if left[0] &lt; right[0]:\n        return [left[0]] + merge(left[1:], right)\n    return [right[0]] + merge(left, right[1:])\n\ndef timsort(the_array):\n    runs, sorted_runs = [], []\n    length = len(the_array)\n    new_run = [the_array[0]]\n\n    # for every i in the range of 1 to length of array\n    for i in range(1, length):\n        # if i is at the end of the list\n        if i == length - 1:\n            new_run.append(the_array[i])\n            runs.append(new_run)\n            break\n        # if the i'th element of the array is less than the one before it\n        if the_array[i] &lt; the_array[i-1]:\n            # if new_run is set to None (NULL)\n            if not new_run:\n                runs.append([the_array[i]])\n                new_run.append(the_array[i])\n            else:\n                runs.append(new_run)\n                new_run = []\n        # else if its equal to or more than\n        else:\n            new_run.append(the_array[i])\n\n    # for every item in runs, append it using insertion sort\n    for item in runs:\n        sorted_runs.append(insertion_sort(item))\n\n    # for every run in sorted_runs, merge them\n    sorted_array = []\n    for run in sorted_runs:\n        sorted_array = merge(sorted_array, run)\n\n    print(sorted_array)\n\ntimsort([2, 3, 1, 5, 6, 7])\n</code></pre> <p>Timsort\u5b9e\u9645\u4e0a\u662f\u5185\u7f6e\u4e8ePython\u4e2d\u7684\uff0c\u6240\u4ee5\u8fd9\u6bb5\u4ee3\u7801\u53ea\u80fd\u4f5c\u4e3a\u89e3\u91ca\u3002\u8981\u4f7f\u7528Timsort\uff0c\u53ea\u9700\u5199\uff1a</p> <pre><code>list.sort()\n</code></pre> <p>\u6216\u8005\uff1a</p> <pre><code>sorted(list)\n</code></pre> <p>\u5982\u679c\u4f60\u60f3\u638c\u63e1Timsort\u5982\u4f55\u5de5\u4f5c\u5e76\u611f\u53d7\u5b83\uff0c\u6211\u5f3a\u70c8\u5efa\u8bae\u4f60\u81ea\u5df1\u5c1d\u8bd5\u5b9e\u73b0\u5b83\uff01</p> <p>\u672c\u6587\u57fa\u4e8eTim Peters\u5bf9Timsort\u7684\u539f\u59cb\u4ecb\u7ecd\uff0c\u53ef\u5728\u6b64\u5904\u627e\u5230\u3002</p>"},{"location":"2018-08-16-Timsort%20%E4%BD%A0%E4%BB%8E%E6%9C%AA%E5%90%AC%E8%AF%B4%E8%BF%87%E7%9A%84%E6%9C%80%E5%BF%AB%E7%9A%84%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/#_3","title":"\u53c2\u8003","text":"<ol> <li>#JDK-6804124 (coll) Replace \"modified mergesort\" in java.util.Arrays.sort with timsort\".</li> </ol>"},{"location":"2018-09-29-%E4%BD%BF%E7%94%A8Googletrans%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8A%E7%BF%BB%E8%AF%91/","title":"2018 09 29 \u4f7f\u7528Googletrans\u5728\u547d\u4ee4\u884c\u4e0a\u7ffb\u8bd1","text":""},{"location":"2018-09-29-%E4%BD%BF%E7%94%A8Googletrans%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8A%E7%BF%BB%E8%AF%91/#googletrans","title":"googletrans\u4ecb\u7ecd","text":"<p>googletrans\u662f\u4e00\u4e2a\u514d\u8d39\u3001\u65e0\u9650\u5236\u7684Python\u5e93\uff0c\u5b9e\u73b0\u4e86<code>Google Translate API</code>\uff0c\u4f7f\u7528<code>Google Translate Ajax API</code>\u8fdb\u884c\u8bed\u8a00\u68c0\u6d4b\u548c\u7ffb\u8bd1\u3002</p>"},{"location":"2018-09-29-%E4%BD%BF%E7%94%A8Googletrans%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8A%E7%BF%BB%E8%AF%91/#_1","title":"\u5b89\u88c5","text":"<pre><code>$ git clone https://github.com/BoseCorp/py-googletrans.git\n$ cd ./py-googletrans\n$ sudo python3 setup.py install\n</code></pre>"},{"location":"2018-09-29-%E4%BD%BF%E7%94%A8Googletrans%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8A%E7%BF%BB%E8%AF%91/#_2","title":"\u811a\u672c\u5185\u5bb9","text":"<pre><code>#!/usr/bin/env python3\n\nfrom sys import argv\nfrom googletrans import Translator\n\nt = Translator(service_urls=['translate.google.cn'])\nif argv[1] == '-r':\n    r = t.translate(' '.join(argv[2:]), dest='en')\nelse:\n    r = t.translate(' '.join(argv[1:]), dest='zh-CN')\nprint(r.text)\n</code></pre>"},{"location":"2018-09-29-%E4%BD%BF%E7%94%A8Googletrans%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8A%E7%BF%BB%E8%AF%91/#_3","title":"\u793a\u4f8b","text":"<p>\u60a8\u53ef\u4ee5\u5c06\u811a\u672c\u6240\u5728\u8def\u5f84\u6dfb\u52a0\u5230<code>PATH</code>\u73af\u5883\u53d8\u91cf\u4e2d</p> <pre><code>$ ./gt.py \"In view of these constraints, it is clear that there is a need for a file delivery service capable of transferring files to and from mass memory located in the space segment. Such a capability must not only operate under the constraints associated with space data communication, but it must also be applicable to the diverse range of mission configurations ranging from single low earth orbiting spacecraft to complex networks of relays, orbiters, and landers.\"\n\u9274\u4e8e\u8fd9\u4e9b\u7ea6\u675f\uff0c\u663e\u7136\u9700\u8981\u4e00\u79cd\u80fd\u591f\u5c06\u6587\u4ef6\u4f20\u9001\u5230\u4f4d\u4e8e\u7a7a\u95f4\u6bb5\u4e2d\u7684\u5927\u5bb9\u91cf\u5b58\u50a8\u5668\u548c\u4ece\u5927\u5bb9\u91cf\u5b58\u50a8\u5668\u4f20\u9001\u6587\u4ef6\u7684\u6587\u4ef6\u4f20\u9001\u670d\u52a1\u3002\u8fd9\u79cd\u80fd\u529b\u4e0d\u4ec5\u5fc5\u987b\u5728\u4e0e\u7a7a\u95f4\u6570\u636e\u901a\u4fe1\u76f8\u5173\u7684\u9650\u5236\u4e0b\u8fd0\u884c\uff0c\u800c\u4e14\u8fd8\u5fc5\u987b\u9002\u7528\u4e8e\u4ece\u5355\u4e2a\u4f4e\u5730\u7403\u8f68\u9053\u822a\u5929\u5668\u5230\u590d\u6742\u7684\u7ee7\u7535\u5668\u7f51\u7edc\uff0c\u8f68\u9053\u5668\u548c\u7740\u9646\u5668\u7684\u5404\u79cd\u4efb\u52a1\u914d\u7f6e\u3002\n</code></pre>"},{"location":"2018-09-29-%E4%BD%BF%E7%94%A8Googletrans%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8A%E7%BF%BB%E8%AF%91/#_4","title":"\u53c2\u8003","text":"<ul> <li>https://pypi.org/project/googletrans/</li> <li>https://github.com/BoseCorp/py-googletrans</li> </ul>"},{"location":"2018-10-10-%E5%9F%BA%E4%BA%8EShadowsocks%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/","title":"2018 10 10 \u57fa\u4e8eShadowsocks\u7684\u79d1\u5b66\u4e0a\u7f51","text":"<p>\u4ee5\u4e0b\u662f\u7ef4\u57fa\u767e\u79d1\u5bf9<code>Shadowsocks</code>\u7684\u63cf\u8ff0\uff1a</p> <p>Shadowsocks is a free and open-source encrypted proxy project, widely used inmainland China to circumvent Internet censorship. It was created in 2012 by a Chinese programmer named \"clowwindy\", and multiple implementations of the protocol have been made available since. Typically, the client software will open a socks5 proxy on the machine it is run, which internet traffic can then be directed towards, similarly to an SSH tunnel. Unlike an SSH tunnel, shadowsocks can also proxy UDP traffic.</p> <p>\u672c\u6587\u5185\u5bb9\u4e3a\u8f6f\u4ef6\u7684\u90e8\u7f72\u4e0e\u64cd\u4f5c\uff0c\u5206\u4e3a<code>\u670d\u52a1\u7aef</code>\u4e0e<code>\u5ba2\u6237\u7aef</code>\u4e24\u90e8\u5206\u3002</p>"},{"location":"2018-10-10-%E5%9F%BA%E4%BA%8EShadowsocks%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#1","title":"1 \u670d\u52a1\u7aef","text":"<p>\u672c\u90e8\u5206\u4ecb\u7ecd\u5728Ubuntu\u4e0a\u7684\u6b65\u9aa4\uff0c\u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u6b64\u4e3a\u53c2\u8003\u3002</p> <p>\u672c\u6b65\u9aa4\u4e2d\uff0c\u60a8\u9700\u8981\uff1a</p> <ul> <li> <p>\u4e00\u53f0\u4e0d\u53d7GFW\u5f71\u54cd\u7684\u4e3b\u673a\uff08\u53ef\u4ee5\u5230\u5404\u5927VPS\u5382\u5546\u8d2d\u4e70\uff09</p> </li> <li> <p>\u547d\u4ee4\u884c\u57fa\u7840</p> </li> </ul>"},{"location":"2018-10-10-%E5%9F%BA%E4%BA%8EShadowsocks%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#11-python3pip","title":"1.1 \u5b89\u88c5python3\u548cpip","text":"<p>\u6267\u884cBash\u547d\u4ee4\uff1a</p> <pre><code>sudo apt update\nsudo apt install python3 python3-pip\n</code></pre>"},{"location":"2018-10-10-%E5%9F%BA%E4%BA%8EShadowsocks%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#12-shadowsocks","title":"1.2 \u5b89\u88c5shadowsocks","text":"<p>shadowsocks\u670d\u52a1\u7aef\u7684Python\u5b9e\u73b0\u6258\u7ba1\u4e8eshadowsocks/shadowsocks</p> <p>\u4f7f\u7528pip\u5b89\u88c5shadowsocks\u670d\u52a1\u7aef\uff0c\u6267\u884cBash\u547d\u4ee4\uff1a</p> <pre><code>sudo pip3 install git+https://github.com/shadowsocks/shadowsocks.git@master\n</code></pre>"},{"location":"2018-10-10-%E5%9F%BA%E4%BA%8EShadowsocks%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#13","title":"1.3 \u914d\u7f6e\u6587\u4ef6","text":"<p>\u5728\u60a8\u7684home\u76ee\u5f55\u91cc\uff0c\u65b0\u5efa<code>ss</code>\u76ee\u5f55\uff0c\u5c06shadowsocks\u7684<code>\u914d\u7f6e\u6587\u4ef6</code>\u548c<code>\u65e5\u5fd7\u6587\u4ef6</code>\u653e\u7f6e\u5728\u5176\u4e2d\uff1b\u6267\u884cBash\u547d\u4ee4\uff1a</p> <pre><code>mkdir ~/ss\ncd ss\n</code></pre> <p>\u4f7f\u7528\u4f60\u559c\u6b22\u7684\u6587\u672c\u7f16\u8f91\u5668\uff0c\u521b\u5efa\u914d\u7f6e\u6587\u4ef6<code>config.json</code>\uff0c\u6b64\u5904\u5b9e\u4f8b\u4f7f\u7528nano\uff1b\u6267\u884cBash\u547d\u4ee4\uff1a</p> <pre><code>nano config.json\n</code></pre> <p>\u7c98\u8d34\u5982\u4e0b\u5185\u5bb9\uff0c\u5e76\u6839\u636e\u60a8\u7684\u559c\u597d\u8bbe\u7f6e\uff1a</p> <pre><code>{\n\"server_port\":8388,\n\"password\":\"your_password\",\n\"method\":\"aes-256-cfb\"\n}\n</code></pre> <p>\u5b57\u6bb5\u8bf4\u660e\uff1a</p> \u540d\u79f0 \u8bf4\u660e server_port \u670d\u52a1\u7aef\u76d1\u542c\u7684\u7aef\u53e3 password \u5bc6\u7801 method \u52a0\u5bc6\u65b9\u6cd5\uff0c\u8bf7\u67e5\u770bEncryption <p>\u66f4\u591a\u8bf4\u660e\u8bf7\u67e5\u770bwiki</p>"},{"location":"2018-10-10-%E5%9F%BA%E4%BA%8EShadowsocks%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#15","title":"1.5 \u8fd0\u884c","text":"<p>\u5728\u540e\u53f0\u8fd0\u884cshadowsocks\uff0c\u5e76\u5c06\u65e5\u5fd7\u5199\u5165\u6587\u4ef6<code>~/ss/log</code>\uff0c\u6267\u884cBash\u547d\u4ee4\uff1a</p> <pre><code>ssserver -c ~/ss/config.json --log-file ~/ss/log --pid-file ~/ss/pid -d start\n</code></pre> <p>Bash\u4f1a\u8bdd\u8bb0\u5f55\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"2018-10-10-%E5%9F%BA%E4%BA%8EShadowsocks%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#14-shadowsocks","title":"1.4 \u9632\u706b\u5899\u5f00\u653eshadowsocks\u7aef\u53e3","text":"<p>\u5728<code>1.3 \u914d\u7f6e\u6587\u4ef6</code>\u4e2d\u7684\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u8bbe\u7f6e\u4e86shadowsocks\u76d1\u542c<code>8388</code>\u7aef\u53e3\uff0c\u5982\u679c\u60a8\u7684\u4e3b\u673a\u5f00\u542f\u4e86\u9632\u706b\u5899\uff0c\u5219\u6211\u4eec\u9700\u8981\u5f00\u653e\u8fd9\u4e2a\u7aef\u53e3\uff1b\u6b64\u5904\u5047\u8bbe\u9632\u706b\u5899\u8f6f\u4ef6\u4e3a<code>ufw</code>\uff0c\u6267\u884cBash\uff1a</p> <pre><code>sudo ufw allow 8388\n</code></pre>"},{"location":"2018-10-10-%E5%9F%BA%E4%BA%8EShadowsocks%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#2","title":"2 \u5ba2\u6237\u7aef","text":"<p>\u672c\u90e8\u5206\u4f9d\u6b21\u4ecb\u7ecd\u5728Android / macOS / Manjaro Linux \u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684shadowsocks\u5ba2\u6237\u7aef\u4f7f\u7528\u3002</p>"},{"location":"2018-10-10-%E5%9F%BA%E4%BA%8EShadowsocks%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#21-android","title":"2.1 Android","text":"<p>shadowsocks\u7684Android\u5ba2\u6237\u7aef\u6258\u7ba1\u4e8eshadowsocks/shadowsocks-android</p> <p>\u9996\u5148\uff0c\u5728<code>Releases</code>\u9875\u9762\u4e0b\u8f7d\u60a8\u7684CPU\u67b6\u6784\u5bf9\u5e94\u7684\u5b89\u88c5\u5305\uff0c\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u5173\u4e8eAndroid\u7684CPU\u67b6\u6784\uff0c\u6458\u81eaWhat is armeabi and why they use it?\u7684\u4e00\u4e2a\u56de\u7b54\uff1a Android\u8bbe\u5907\u6709CPU\u3002 \u5176\u4e2d\u8bb8\u591aCPU\u57fa\u4e8eARM\u67b6\u6784\uff0c\u6709\u4e9b\u57fa\u4e8ex86\uff0c\u8fd8\u6709\u4e00\u4e9b\u57fa\u4e8eMIPS\u7b49\u5176\u4ed6\u4e1c\u897f\u3002 \u4e00\u4e9bAndroid\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528Native Development Kit\uff08NDK\uff09\u521b\u5efaC / C++\u4ee3\u7801\u4ee5\u94fe\u63a5\u5230\u4ed6\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u3002 \u9700\u8981\u9488\u5bf9\u7279\u5b9a\u7684CPU\u67b6\u6784\u7f16\u8bd1C / C++\u4ee3\u7801\u3002 NDK\u5c06\u4e3a\u6bcf\u4e2a\u4f53\u7cfb\u7ed3\u6784\u7f16\u8bd1\u7684C / C++\u4ee3\u7801\u7248\u672c\u653e\u5165\u7279\u5b9a\u4e8e\u4f53\u7cfb\u7ed3\u6784\u7684\u76ee\u5f55\u4e2d\u3002 \u5176\u4e2d\u4e00\u4e2a\u76ee\u5f55\u662farmeabi /\uff0c\u5b83\u7528\u4e8e\u901a\u7528ARM CPU\u3002 \u8fd8\u6709armeabi-v7 /\uff08\u5bf9\u4e8eARM v7\u517c\u5bb9\u7684CPU\uff09\uff0cx86 /\uff08\u5bf9\u4e8ex86 CPU\uff09\u7b49\u3002\uff08\u6765\u81ea\u8c37\u6b4c\u7ffb\u8bd1\uff09</p> <p>\u4e0b\u8f7d\u5e76\u5b89\u88c5\u540e\uff0c\u6253\u5f00\u7a0b\u5e8f\uff0c\u9ed8\u8ba4\u9875\u9762\u4e3a<code>\u914d\u7f6e\u6587\u4ef6</code>\uff0c\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u6211\u4eec\u5047\u5b9a\u60a8\u7684\u4e3b\u673aIP\u5730\u5740\u4e3a<code>6.6.6.6</code></p> <p>\u70b9\u51fb\u4e0b\u65b9\u622a\u56fe\u4e2d\u7ea2\u6846\u6240\u793a\u7684<code>\u94c5\u7b14</code>\u6309\u94ae\uff1a</p> <p></p> <p>\u6839\u636e<code>1.3 \u914d\u7f6e\u6587\u4ef6</code>\u4e2d\u7684\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\uff0c\u4fee\u6539<code>\u670d\u52a1\u5668\u914d\u7f6e</code>\u4e2d\u7684\u9879\uff0c\u622a\u56fe\u5982\u4e0b\uff0c\u7ea2\u6846\u6240\u793a\uff1a</p> <p></p> <p>\u7ee7\u7eed\u4fee\u6539<code>\u529f\u80fd\u8bbe\u7f6e</code>\uff0c<code>\u8def\u7531</code>\u8bbe\u7f6e\u4e3a<code>GFW\u5217\u8868</code>\uff08\u5728\u60a8\u7406\u89e3\u5176\u4ed6\u9009\u9879\u65f6\uff0c\u53ef\u4ee5\u9009\u62e9\u5176\u4ed6\u9009\u9879\uff09\uff0c\u5176\u4f59\u9009\u9879\u4fdd\u6301\u9ed8\u8ba4\uff0c\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u5176\u4f59\u9009\u9879\u4fdd\u6301\u9ed8\u8ba4\uff0c\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684<code>\u52fe</code>\u6309\u94ae\uff0c\u4fdd\u5b58\u4fee\u6539\uff0c\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u70b9\u51fb\u53f3\u4e0b\u89d2\u7684<code>\u5c0f\u98de\u673a</code>\uff0c\u4ee5\u8fde\u63a5\u670d\u52a1\u5668\uff0c\u9996\u6b21\u4f1a\u5f39\u51fa\u622a\u56fe\u6240\u793a\u5bf9\u8bdd\u6846\uff1b</p> <p></p> <p>\u8bf7\u6253\u5f00\u60a8\u7684\u6d4f\u89c8\u5668\uff0c\u8bbf\u95ee<code>https://google.com</code>\u4ee5\u6d4b\u8bd5\u662f\u5426\u80fd\u79d1\u5b66\u4e0a\u7f51\uff0c\u82e5\u60a8\u7684\u64cd\u4f5c\u6b63\u786e\uff0c\u5219\u53ef\u4ee5\u8bbf\u95ee\u3002</p>"},{"location":"2018-10-10-%E5%9F%BA%E4%BA%8EShadowsocks%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#22-macos","title":"2.2 macOS","text":"<p>shadowsocks\u7684macOS\u7aef\u6258\u7ba1\u4e8eshadowsocks/ShadowsocksX-NG</p> <p>\u9996\u5148\uff0c\u5230Releases\u9875\u9762\u4e0b\u8f7d\u7a0b\u5e8f\uff0c\u9875\u9762\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u4e0b\u8f7d\u5b8c\u6210\u540e\uff0c\u7531\u9875\u9762\u4e0a\u7684sha256\u548c\uff0c\u6821\u9a8c\u4e0b\u8f7d\u7684\u6587\u4ef6\u662f\u5426\u76f8\u540c\uff1b\u82e5\u4e0d\u662f\uff0c\u8bf7\u5c1d\u8bd5\u91cd\u65b0\u4e0b\u8f7d\uff1b\u82e5\u662f\uff0c\u62d6\u62fd\u81f3<code>\u5e94\u7528\u7a0b\u5e8f</code>\u4e2d\uff0c\u53cc\u51fb\u8fd0\u884c\uff0c\u4f1a\u5728<code>\u83dc\u5355\u680f</code>\u4e2d\u663e\u793a\u7070\u8272\u7684<code>\u5c0f\u98de\u673a</code>\uff0c\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u5355\u51fb\u5c0f\u98de\u673a\uff0c\u73b0\u5b9e\u83dc\u5355\uff0c\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u70b9\u51fb<code>\u670d\u52a1\u5668</code>&gt;<code>\u670d\u52a1\u5668\u8bbe\u7f6e</code>&gt;<code>+</code>\uff0c\u6309\u7167<code>\u60a8\u7684\u670d\u52a1\u5668\u914d\u7f6e\u60c5\u51b5</code>\u586b\u5199\u6570\u636e\u9879\uff0c\u70b9\u51fb<code>\u786e\u5b9a</code>\uff0c\u518d\u6b21\u8fdb\u5165<code>\u670d\u52a1\u5668\u8bbe\u7f6e</code>\uff0c\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u60a8\u53ef\u80fd\u5df2\u7ecf\u89c2\u5bdf\u5230\uff0cShadowsocks\u9ed8\u8ba4\u9009\u62e9\u4e86<code>PAC\u81ea\u52a8\u6a21\u5f0f</code>\uff0c\u82e5\u60a8\u521a\u63a5\u89e6\u6b64\u8f6f\u4ef6\uff0c\u8bf7\u4fdd\u7559\u6b64\u8bbe\u7f6e\uff0c\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u70b9\u51fb\u83dc\u5355\u680f\u7684\u5c0f\u98de\u673a&gt;<code>\u6253\u5f00 Shadowsocks</code>\uff0c\u5c0f\u98de\u673a\u7531<code>\u7070\u8272</code>\u53d8\u4e3a<code>\u9ed1\u8272</code>\uff0c\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u8bf7\u6253\u5f00\u60a8\u7684\u6d4f\u89c8\u5668\uff0c\u8bbf\u95ee<code>https://google.com</code>\u4ee5\u6d4b\u8bd5\u662f\u5426\u80fd\u79d1\u5b66\u4e0a\u7f51\uff0c\u82e5\u60a8\u7684\u64cd\u4f5c\u6b63\u786e\uff0c\u5219\u53ef\u4ee5\u8bbf\u95ee\u3002</p>"},{"location":"2018-10-10-%E5%9F%BA%E4%BA%8EShadowsocks%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#23-manjaro-linux","title":"2.3 Manjaro Linux","text":"<p>\u5206\u4e3a<code>Shadowsocks\u5ba2\u6237\u7aef</code>\u548c<code>\u6d4f\u89c8\u5668\u63d2\u4ef6</code>\u4e24\u90e8\u5206</p>"},{"location":"2018-10-10-%E5%9F%BA%E4%BA%8EShadowsocks%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#231-shadowsocks","title":"2.3.1 Shadowsocks\u5ba2\u6237\u7aef","text":"<p>shadowsocks/shadowsocks-qt5\u662f\u4e00\u4e2a\u8de8\u5e73\u53f0\u7684\u5ba2\u6237\u7aef\u3002</p> <p>\u5728Linux\u64cd\u4f5c\u7cfb\u7edf\u4e0a\uff0c\u6211\u4eec\u901a\u8fc7\u5305\u7ba1\u7406\u5668\u5b89\u88c5shadowsocks-qt5\uff0c\u6253\u5f00\u7ec8\u7aef\uff0c\u6267\u884cBash\u547d\u4ee4\uff1a</p> <pre><code>sudo pacman -Syy\nsudo pacman -S shadowsocks-qt5\n</code></pre> <p>\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u6253\u5f00shadowsocks-qt5\uff0c\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u70b9\u51fb\u83dc\u5355<code>Connection</code>&gt;<code>Add</code>&gt;<code>Manually</code>\uff0c\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u6309\u7167<code>\u60a8\u7684\u670d\u52a1\u5668\u914d\u7f6e\u60c5\u51b5</code>\u586b\u5199\u6570\u636e\u9879\uff0c\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u70b9\u51fb<code>OK</code>\uff0c\u9009\u4e2d\u521a\u521a\u521b\u5efa\u7684\u670d\u52a1\u5668\u9879\uff0c\u70b9\u51fb\u83dc\u5355<code>Connection</code>&gt;<code>Connect</code>\uff0c\u82e5\u60a8\u7684\u64cd\u4f5c\u6b63\u786e\uff0c\u5219\u670d\u52a1\u5668\u9879\u7684<code>Status</code>\u4e3a<code>Connected</code>\u3002</p>"},{"location":"2018-10-10-%E5%9F%BA%E4%BA%8EShadowsocks%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#232","title":"2.3.2 \u6d4f\u89c8\u5668\u63d2\u4ef6","text":"<p>FelisCatus/SwitchyOmega\u9879\u76ee\u63d0\u4f9b\u4e86<code>Chrome(\u6216\u8005Chromium)</code>\u548c<code>Firefox</code>\u7684\u4ee3\u7406\u63d2\u4ef6\uff0c\u672c\u90e8\u5206\u6f14\u793a\u5728Chrome\u6d4f\u89c8\u5668\u7684\u64cd\u4f5c\u3002</p> <p>\u9996\u5148\uff0c\u5230Releases\u4e0b\u8f7dSwitchyOmega_Chromium.crx\u5b89\u88c5\u5305\uff1b\u5728Chrome\u5730\u5740\u680f\u8f93\u5165<code>chrome://extensions/</code>\u5e76\u56de\u8f66\uff0c\u8fdb\u5165\u62d3\u5c55\u7a0b\u5e8f\u754c\u9762\uff0c\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684<code>\u5f00\u53d1\u8005\u6a21\u5f0f</code>\uff0c\u5c06\u4e0b\u8f7d\u597d\u7684SwitchyOmega_Chromium.crx\u6587\u4ef6\u62d6\u62fd\u5230\u6b64\u754c\u9762\uff0c\u5b89\u88c5\uff1b</p> <p>\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u81ea\u52a8\u6253\u5f00\u8bbe\u7f6e\u754c\u9762\uff0c\u60a8\u53ef\u4ee5\u8ddf\u968f\u6559\u7a0b\u5b66\u4e60\uff1b\u5b8c\u6210\u540e\uff0c\u70b9\u51fb<code>PROFILES</code>&gt;<code>proxy</code>\uff0c\u6839\u636e<code>2.3.1 Shadowsocks\u5ba2\u6237\u7aef</code>\u7684\u914d\u7f6e\u6765\u8bbe\u7f6e<code>Proxy servers</code>\uff0c<code>Protocol</code>\u9009\u62e9<code>SOCKS5</code>\uff0c<code>Server</code>\u8bbe\u7f6e<code>127.0.0.1</code>\uff0c<code>Port</code>\u8bbe\u7f6e<code>1080</code>\uff0c\u70b9\u51fb<code>ACTIONS</code>&gt;<code>Apply changes</code>\uff0c\u4ee5\u4fdd\u5b58\u8bbe\u7f6e\uff0c\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u70b9\u51fb<code>\u5730\u5740\u680f</code>\u53f3\u8fb9\u7684<code>\u5c0f\u9ed1\u5708</code>\uff0c\u9009\u62e9<code>proxy</code>\uff0c\u8bbf\u95ee<code>https://google.com</code>\uff0c\u82e5\u60a8\u7684\u64cd\u4f5c\u6b63\u786e\uff0c\u5219\u53ef\u4ee5\u8bbf\u95ee\uff1b</p> <p><code>proxy</code>\u6a21\u5f0f\u4e0b\uff0c\u6240\u6709\u6d41\u91cf\u90fd\u901a\u8fc7\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528<code>auto switch</code>\u6a21\u5f0f\uff0c\u81ea\u52a8\u6dfb\u52a0\u4ee3\u7406\u89c4\u5219\uff1b\u66f4\u591a\u4fe1\u606f\u8bf7\u67e5\u770bwiki</p>"},{"location":"2018-10-14-%E5%9F%BA%E4%BA%8EOpenCV%E7%9A%84%E5%9B%BE%E5%83%8F%E7%BC%A9%E6%94%BE%E8%84%9A%E6%9C%AC/","title":"1 OpenCV\u662f\u4ec0\u4e48","text":"<p>\u6458\u81ea\u7ef4\u57fa\u767e\u79d1\u7684OpenCV\u8bcd\u6761\uff1a</p> <p>OpenCV (Open Source Computer Vision) is a library of programming functions mainly aimed at real-time computer vision. Originally developed by Intel, it was later supported by Willow Garage then Itseez (which was later acquired by Intel). The library is cross-platform and free for use under the open-source BSD license.</p> <p>OpenCV\u5177\u6709C++\uff0cPython\u548cJava\u63a5\u53e3\uff0c\u5e76\u652f\u6301Windows\uff0cLinux\uff0cmacOS\uff0ciOS\u548cAndroid\u64cd\u4f5c\u7cfb\u7edf\u3002\u7531\u4e8e\u672c\u535a\u5ba2\u7684\u4e00\u4e9b\u6587\u7ae0\u9700\u8981\u653e\u7f6e\u56fe\u7247\uff0c\u4e3a\u4e86\u66f4\u597d\u7684\u6392\u7248\uff0c\u9700\u8981\u5bf9\u56fe\u7247\u8fdb\u884c\u7f29\u653e\u64cd\u4f5c\uff1bGIMP\u7b49\u56fe\u50cf\u5904\u7406\u7a0b\u5e8f\u53ef\u6ee1\u8db3\u9700\u6c42\uff0c\u4f46\u56fe\u7247\u6570\u91cf\u8f83\u591a\u65f6\uff0c\u624b\u52a8\u64cd\u4f5c\u6548\u7387\u4f4e\u4e0b\uff0c\u867d\u7136\u5927\u591a\u6570\u56fe\u50cf\u5904\u7406\u7a0b\u5e8f\u90fd\u652f\u6301\u6279\u5904\u7406\uff08\u6bd4\u5982GIMP Batch Mode\uff0c\u4f46Python+OpenCV\u7684\u89e3\u51b3\u65b9\u6848\u80fd\u4ea7\u51fa\u66f4\u591a\u7684\u5b66\u4e60\u6536\u76ca\uff1b</p>"},{"location":"2018-10-14-%E5%9F%BA%E4%BA%8EOpenCV%E7%9A%84%E5%9B%BE%E5%83%8F%E7%BC%A9%E6%94%BE%E8%84%9A%E6%9C%AC/#2","title":"2 \u811a\u672c","text":"<p>\u9996\u5148\uff0c\u4f7f\u7528<code>pip3</code>\u5b89\u88c5<code>opencv-python</code>\uff0c\u6267\u884cBash\u547d\u4ee4\uff1a</p> <pre><code>pip3 install opencv-python\n</code></pre> <p>\u5176\u6b21\uff0c\u521b\u5efa\u811a\u672c\u6587\u4ef6\uff0c\u6b64\u5904\u4ee5<code>nano</code>\u4f5c\u4e3a\u6587\u672c\u7f16\u8f91\u5668\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u60a8\u559c\u7231\u7684\u5de5\u5177\uff1b\u6267\u884cBash\u547d\u4ee4\uff1a</p> <pre><code>nano resize\n</code></pre> <p>\u7c98\u8d34\u5982\u4e0b\u5185\u5bb9\uff1a</p> <pre><code>#!/usr/bin/env python3\n\nimport cv2\nimport argparse\n\n\ndef main():\n    # \u53c2\u6570\u89e3\u6790\u5668\n    parser = argparse.ArgumentParser(description='Image resize tool')\n    parser.add_argument('sources', nargs='+', help='path of source image')\n    parser.add_argument('--width', type=int,\n                        default=400, help='width of target image')\n    args = parser.parse_args()\n    for source in args.sources:\n        # \u8bfb\u53d6\uff0c\u6309\u539f\u6837\u8fd4\u56de\u52a0\u8f7d\u7684\u56fe\u50cf\uff08\u4f7f\u7528Alpha\u901a\u9053\uff0c\u5426\u5219\u4f1a\u88ab\u88c1\u526a\uff09\u3002\n        image = cv2.imread(source, cv2.IMREAD_UNCHANGED)\n        # \u8ba1\u7b97\u7f29\u653e\u6bd4\u4f8b\n        scale = args.width / image.shape[1]\n        # \u7f29\u653e\n        output = cv2.resize(image, (0, 0), fx=scale, fy=scale)\n        # \u4fdd\u5b58\n        cv2.imwrite(source, output)\n\n\nif __name__ == '__main__':\n    main()\n</code></pre> <p>\u6309<code>Ctrl + O</code>\u5199\u51fa\uff0c\u6309<code>\u56de\u8f66</code>\u786e\u8ba4\u5199\u81f3\u6587\u4ef6<code>resize</code>\uff0c\u6309<code>Ctrl + X</code>\u9000\u51fa\uff1b</p>"},{"location":"2018-10-14-%E5%9F%BA%E4%BA%8EOpenCV%E7%9A%84%E5%9B%BE%E5%83%8F%E7%BC%A9%E6%94%BE%E8%84%9A%E6%9C%AC/#3","title":"3 \u4f7f\u7528","text":"<p>\u5047\u8bbe\u60a8\u9700\u8981\u7f29\u653e<code>./b22dc2b9a85cd92f99123c0b.png</code>\u81f3<code>\u5bbd\u4e3a600\u50cf\u7d20</code>\uff0c\u6267\u884c\u5982\u4e0bBash\u547d\u4ee4\uff1a <pre><code>\u279c  resize --width 800 b22dc2b9a85cd92f99123c0b.png\n</code></pre></p> <p>\u53ef\u5728\u6267\u884c\u524d\u540e\u4f7f\u7528<code>file</code>\u547d\u4ee4\u67e5\u770b\u533a\u522b\uff1a <pre><code>\u279c  file b22dc2b9a85cd92f99123c0b.png \nb22dc2b9a85cd92f99123c0b.png: PNG image data, 2144 x 1396, 8-bit/color RGBA, non-interlaced\n\u279c  resize --width 800 b22dc2b9a85cd92f99123c0b.png                                  \n\u279c  file b22dc2b9a85cd92f99123c0b.png              \nb22dc2b9a85cd92f99123c0b.png: PNG image data, 800 x 521, 8-bit/color RGBA, non-interlaced\n</code></pre></p>"},{"location":"2018-10-14-%E5%9F%BA%E4%BA%8EOpenCV%E7%9A%84%E5%9B%BE%E5%83%8F%E7%BC%A9%E6%94%BE%E8%84%9A%E6%9C%AC/#4","title":"4 \u7ed3\u8bed","text":"<p>\u65f6\u95f4\u6709\u9650\uff0c\u672c\u6587\u4ec5\u6d89\u53ca\u5230\u5f88\u57fa\u7840\u7684OpenCV\u77e5\u8bc6\uff0c\u5982\u679c\u60a8\u611f\u5174\u8da3\u7684\u8bdd\uff0c\u53ef\u4ee5\u62bd\u7a7a\u5b66\u4e60\u5b83\uff0c\u795d\u60a8\u5b66\u4e60\u6109\u5feb\uff5e</p>"},{"location":"2018-10-14-%E5%9F%BA%E4%BA%8EOpenCV%E7%9A%84%E5%9B%BE%E5%83%8F%E7%BC%A9%E6%94%BE%E8%84%9A%E6%9C%AC/#5","title":"5 \u66f4\u65b0","text":"<p><code>cv2.imread()</code>\u8c03\u7528\u65f6\uff0c\u82e5\u4e0d\u6dfb\u52a0<code>cv2.IMREAD_UNCHANGED</code>\uff0c\u5219\u8bfb\u53d6\u7684PNG\u56fe\u50cf\u4f1a\u7f3a\u5c11alpha\u901a\u9053\uff0c\u5bfc\u81f4\u5199\u51fa\u7684\u56fe\u50cf\u4e5f\u7f3a\u5c11\uff0c\u6dfb\u52a0\u540e\u5373\u53ef\u3002</p>"},{"location":"2018-10-14-%E5%9F%BA%E4%BA%8EOpenCV%E7%9A%84%E5%9B%BE%E5%83%8F%E7%BC%A9%E6%94%BE%E8%84%9A%E6%9C%AC/#6","title":"6 \u53c2\u8003","text":"<ul> <li>OpenCV: Image file reading and writing</li> </ul>"},{"location":"2018-11-09-%E6%B5%85%E8%B0%88Java%E5%AF%B9%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E7%9A%84%E6%94%AF%E6%8C%81/","title":"2018 11 09 \u6d45\u8c08Java\u5bf9\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u652f\u6301","text":"<p>\u6b64\u7bc7\u6587\u7ae0\u4e3b\u8981\u57fa\u4e8e\u5bf9<code>java.util.function</code>\u5305\u7684javadoc\u7ffb\u8bd1\uff0c\u8c08\u8c08Java\u5bf9\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u652f\u6301\uff0c\u4ea6\u6709\u52a9\u4e8e\u5b66\u4e60Stram API\u3002</p>"},{"location":"2018-11-09-%E6%B5%85%E8%B0%88Java%E5%AF%B9%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E7%9A%84%E6%94%AF%E6%8C%81/#1","title":"1 \u4ec0\u4e48\u662f\u51fd\u6570\u5f0f\u7f16\u7a0b\uff1f","text":"<p>\u5728\u8ba1\u7b97\u673a\u79d1\u5b66\u4e2d\uff0c\u51fd\u6570\u5f0f\u7f16\u7a0b\uff08Functional programing\uff09\u662f\u4e00\u79cd\u5c06\u8ba1\u7b97\uff08Computation\uff09\u89c6\u4e3a\u6570\u5b66\u51fd\u6570\u7684\u8bc4\u4f30\uff0c\u907f\u514d\u6539\u53d8\u72b6\u6001\uff08changing-state\uff09\u548c\u53ef\u53d8\u6570\u636e\uff08mutable data\uff09\u7684\u7f16\u7a0b\u8303\u5f0f\uff08\u4e00\u79cd\u6784\u5efa\u8ba1\u7b97\u673a\u7a0b\u5e8f\u7ed3\u6784\u548c\u5143\u7d20\u7684\u65b9\u5f0f\uff09\u3002</p> <p>In computer science, functional programming is a programming paradigm\u2014a style of building the structure and elements of computer programs\u2014that treats computation as the evaluation of mathematical functions and avoids changing-state and mutable data. \u6458\u81ea\u7ef4\u57fa\u767e\u79d1</p>"},{"location":"2018-11-09-%E6%B5%85%E8%B0%88Java%E5%AF%B9%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E7%9A%84%E6%94%AF%E6%8C%81/#2-javautilfunction","title":"2 java.util.function\u5305","text":"<p>Java\u81ea1.8\u6dfb\u52a0java.util.function\u5305\uff0c\u4ee5\u652f\u6301\u51fd\u6570\u5f0f\u7f16\u7a0b\uff1b\u5176\u5c06\u8ba1\u7b97\u62bd\u8c61\u4e3a\u51fd\u6570\u5f0f\u63a5\u53e3\uff08Functional interface\uff09\uff0c\u4e3alambda\u8868\u8fbe\u5f0f\uff08lambda expressions\uff09\u548c\u65b9\u6cd5\u5f15\u7528\uff08method references\uff09\u63d0\u4f9b\u4e86\u76ee\u6807\u7c7b\u578b\u3002\u6bcf\u4e00\u4e2a\u51fd\u6570\u5f0f\u63a5\u53e3\u542b\u6709\u5355\u4e2a\u62bd\u8c61\u65b9\u6cd5\uff0c\u79f0\u4e3a\u8be5\u51fd\u6570\u5f0f\u63a5\u53e3\u7684\u51fd\u6570\u5f0f\u65b9\u6cd5\uff08functional method\uff09\uff0clambda\u8868\u8fbe\u5f0f\u7684\u53c2\u6570\u548c\u8fd4\u56de\u7c7b\u578b\u4e0e\u4e4b\u5339\u914d\u6216\u9002\u5e94\u3002\u5728\u591a\u79cd\u4e0a\u4e0b\u6587\u4e2d\uff0c\u51fd\u6570\u5f0f\u63a5\u53e3\u53ef\u63d0\u4f9b\u4e00\u4e2a\u76ee\u6807\u7c7b\u578b\uff0c\u5982\u8d4b\u503c\u3001\u65b9\u6cd5\u8c03\u7528\u548c\u8f6c\u578b\u4e0a\u4e0b\u6587\uff1a</p> <pre><code>// \u8d4b\u503c\u4e0a\u4e0b\u6587\nPredicate&lt;String&gt; p = String::isEmpty;\n\n// \u65b9\u6cd5\u8c03\u7528\u4e0a\u4e0b\u6587\nstream.filter(e -&gt; e.getSize() &gt; 10)...\n\n// \u8f6c\u578b\u4e0a\u4e0b\u6587\nstream.map((ToIntFunction) e -&gt; e.getSize())\n</code></pre> <p>\u6b64\u5305\u4e2d\u7684\u63a5\u53e3\u662fJDK\u4f7f\u7528\u7684\u901a\u7528\u51fd\u6570\u5f0f\u63a5\u53e3\uff0c\u4e5f\u53ef\u4f9b\u7528\u6237\u4ee3\u7801\u4f7f\u7528\u3002\u867d\u7136\u5b83\u4eec\u6ca1\u6709\u786e\u5b9a\u53ef\u4ee5\u9002\u5e94lambda\u8868\u8fbe\u5f0f\u7684\u4e00\u6574\u5957\u51fd\u6570\u5f62\u72b6\uff0c\u4f46\u5b83\u4eec\u8db3\u4ee5\u6ee1\u8db3\u5e38\u89c1\u8981\u6c42\u3002\u4e3a\u7279\u5b9a\u76ee\u7684\u63d0\u4f9b\u7684\u5176\u4ed6\u529f\u80fd\u63a5\u53e3\uff08\u4f8b\u5982FileFilter\uff09\u5728\u4f7f\u7528\u5b83\u4eec\u7684\u5305\u4e2d\u5b9a\u4e49\u3002</p> <p>\u6b64\u5305\u4e2d\u7684\u63a5\u53e3\u90fd\u88ab\u6ce8\u89e3\u4e3aFunctionalInterface\u6ce8\u89e3\u3002\u6b64\u6ce8\u91ca\u4e0d\u662f\u7f16\u8bd1\u5668\u5c06\u63a5\u53e3\u8bc6\u522b\u4e3a\u529f\u80fd\u63a5\u53e3\u7684\u5fc5\u8981\u6761\u4ef6\uff0c\u800c\u4ec5\u662f\u5e2e\u52a9\u6355\u83b7\u8bbe\u8ba1\u610f\u56fe\uff08design intent\uff09\u5e76\u83b7\u5f97\u7f16\u8bd1\u5668\u5e2e\u52a9\u8bc6\u522b\u610f\u5916\u8fdd\u53cd\u8bbe\u8ba1\u610f\u56fe\u7684\u5e2e\u52a9\u3002</p> <p>\u51fd\u6570\u5f0f\u63a5\u53e3\u901a\u5e38\u8868\u793a\u7c7b\u4f3c\u51fd\u6570\uff08functions\uff09\u3001\u64cd\u4f5c\uff08actions\uff09\u6216\u8c13\u8bcd\uff08predicates\uff09\u7684\u62bd\u8c61\u6982\u5ff5\u3002\u5728\u8bb0\u5f55\u51fd\u6570\u5f0f\u63a5\u53e3\u6216\u5f15\u7528\u7c7b\u578b\u4e3a\u51fd\u6570\u5f0f\u63a5\u53e3\u7684\u53d8\u91cf\u65f6\uff0c\u901a\u5e38\u76f4\u63a5\u5f15\u7528\u90a3\u4e9b\u62bd\u8c61\u6982\u5ff5\uff0c\u4f8b\u5982\u7528\u201c\u8fd9\u4e2a\u51fd\u6570\u201d\u800c\u4e0d\u662f\u201c\u8fd9\u4e2a\u5bf9\u8c61\u8868\u793a\u7684\u51fd\u6570\u201d\u3002\u5f53\u4e00\u4e2aAPI\u65b9\u6cd5\u4ee5\u4f8b\u5982\u201c\u5c06\u63d0\u4f9b\u7684\u51fd\u6570\u5e94\u7528\u4e8e...\u201d\u8fd9\u79cd\u65b9\u5f0f\u63a5\u53d7\u6216\u8fd4\u56de\u51fd\u6570\u5f0f\u63a5\u53e3\u65f6\uff0c\u8fd9\u88ab\u7406\u89e3\u4e00\u4e2a\u5bf9\u5b9e\u73b0\u9002\u5f53\u51fd\u6570\u5f0f\u63a5\u53e3\u7684\u5bf9\u8c61\u7684\u975enull\u5f15\u7528\uff0c\u9664\u975e\u660e\u786e\u5236\u5b9a\u4e86\u6f5c\u5728\u7684\u65e0\u6548\u6027\u3002</p> <p>\u6b64\u5305\u4e2d\u7684\u51fd\u6570\u5f0f\u63a5\u53e3\u9075\u5faa\u53ef\u62d3\u5c55\u7684\u547d\u540d\u7ea6\u5b9a\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <ul> <li> <p>\u57fa\u672c\u51fd\u6570\u5f62\u5f0f\uff08function shapes\uff09\uff0c\u5305\u62ecFunction\uff08\u4eceT\u5230R\u7684\u4e00\u5143\u51fd\u6570\uff09\uff0cConsumer\uff08\u4eceT\u5230void\u7684\u4e00\u5143\u51fd\u6570\uff09\uff0cPredicate\uff08\u4eceT\u5230boolean\u7684\u4e00\u5143\u51fd\u6570\uff09\u548cSupplier\uff08\u5230R\u76840\u5143\u51fd\u6570\uff09\u3002</p> </li> <li> <p>\u542b\u6709\u57fa\u4e8e\u6700\u5e38\u7528\u7684\u65b9\u5f0f\u7684\u81ea\u7136\u5143\u6570\u7684\u51fd\u6570\u5f62\u5f0f\u3002\u53ef\u901a\u8fc7\u5143\u6570\uff08Arity\uff09\u524d\u7f00\u4fee\u6539\u57fa\u672c\u5f62\u5f0f\u4ee5\u8868\u793a\u4e0d\u540c\u7684\u5143\u6570\uff0c\u5982BiFunction\uff08\u4eceT\u548cU\u5230R\u7684\u4e8c\u5143\u51fd\u6570\uff09\u4e2d\u6240\u793a\u3002</p> </li> <li> <p>\u6d3e\u751f\u51fd\u6570\u5f62\u5f0f\uff0c\u5b83\u4eec\u62d3\u5c55\u4e86\u57fa\u672c\u51fd\u6570\u5f62\u5f0f\uff0c\u5305\u62ecUnaryOperator\uff08\u62d3\u5c55\u4e86Function\uff09\u548cBinaryOperator\uff08\u62d3\u5c55\u4e86BiFunction\uff09\u3002</p> </li> <li> <p>\u51fd\u6570\u5f0f\u63a5\u53e3\u7684\u7c7b\u578b\u53c2\u6570\u53ef\u4ee5\u4e13\u7528\u4e0e\u5177\u6709\u7c7b\u578b\u524d\u7f00\u7684\u57fa\u672c\u7c7b\u578b\uff08primitives\uff09\u3002\u4e3a\u5177\u6709\u6cdb\u578b\u8fd4\u56de\u7c7b\u578b\u548c\u6cdb\u578b\u53c2\u6570\u7684\u7c7b\u578b\u4e13\u95e8\u5316\uff08specialize\uff09\u8fd4\u56de\u7c7b\u578b\uff0c\u6211\u4eec\u52a0\u4e0a\u524d\u7f00ToXxx\uff0c\u5982ToIntFunction\u4e2d\u6240\u793a\u3002\u53e6\u5916\uff0c\u7c7b\u578b\u53c2\u6570\u4ece\u5de6\u5230\u53f3\u662f\u4e13\u95e8\u5316\u7684\uff0c\u4f8b\u5982DoubleConsumer\u548cObjIntConsumer\uff08\u7c7b\u578b\u524d\u7f00<code>Obj</code>\u88ab\u7528\u4e8e\u8868\u793a\u6211\u4eec\u4e0d\u60f3\u4e13\u95e8\u5316\u6b64\u53c2\u6570\uff0c\u4f46\u5e0c\u671b\u4e13\u95e8\u5316\u4e0b\u4e00\u4e2a\u53c2\u6570\uff09\u3002\u53ef\u4ee5\u7ed3\u5408\u8fd9\u4e9b\u6a21\u5f0f\uff0c\u5982IntToDoubleFunction\u4e2d\u6240\u793a\u3002</p> </li> <li> <p>\u82e5\u6240\u6709\u53c2\u6570\u90fd\u6709\u4e13\u95e8\u5316\u524d\u7f00\uff0c\u5219\u53ef\u4ee5\u7701\u7565\u5143\u6570\u524d\u7f00\uff0c\u5982ObjIntConsumer\u4e2d\u6240\u793a\u3002</p> </li> </ul>"},{"location":"2018-11-09-%E6%B5%85%E8%B0%88Java%E5%AF%B9%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E7%9A%84%E6%94%AF%E6%8C%81/#3-lambda","title":"3 Lambda\u8868\u8fbe\u5f0f","text":"<p>Java 8 \u5f15\u5165\u7684\u529f\u80fd\u4e2d\uff0c\u6700\u8ba9\u4eba\u671f\u76fc\u7684\u662flambda\u8868\u8fbe\u5f0f\u3002Lambda\u8868\u8fbe\u5f0f\u4ee5\u5b57\u9762\u91cf\u7684\u5f62\u5f0f\u628a\u5c11\u91cf\u4ee3\u7801\u76f4\u63a5\u5199\u5728\u7a0b\u5e8f\u4e2d\uff0c\u800c\u4e14\u8ba9Java\u7f16\u7a0b\u66f4\u7b26\u5408\u51fd\u6570\u5f0f\u98ce\u683c\u3002\u5176\u5b9e\uff0clambda\u8868\u8fbe\u5f0f\u7684\u5f88\u591a\u529f\u80fd\u90fd\u80fd\u4f7f\u7528\u56de\u8c03\u548c\u5904\u7406\u7a0b\u5e8f\u7b49\u6a21\u5f0f\u6765\u5b9e\u73b0\uff0c\u4f46\u4f7f\u7528\u7684\u53e5\u6cd5\u603b\u662f\u975e\u5e38\u5197\u957f\uff0c\u5c24\u5176\u662f\uff0c\u5c31\u7b97\u53ea\u9700\u8981\u5728\u56de\u8c03\u4e2d\u7f16\u5199\u4e00\u884c\u4ee3\u7801\uff0c\u4e5f\u8981\u5b8c\u6574\u5b9a\u4e49\u4e00\u4e2a\u65b0\u7c7b\u578b\u3002Lambda\u8868\u8fbe\u5f0f\u7684\u53e5\u6cd5\u662f\u4e00\u4e2a\u53c2\u6570\u5217\u8868\u548c\u65b9\u6cd5\u4e3b\u4f53\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>(p, q) -&gt; { /* \u65b9\u6cd5\u4e3b\u4f53 */}\n</code></pre> <p>\u8fd9\u79cd\u53e5\u6cd5\u80fd\u901a\u8fc7\u4e00\u79cd\u5341\u5206\u7d27\u51d1\u7684\u65b9\u5f0f\u8868\u793a\u7b80\u5355\u7684\u65b9\u6cd5\uff0c\u800c\u4e14\u80fd\u5f88\u5927\u7a0b\u5ea6\u4e0a\u907f\u514d\u4f7f\u7528\u533f\u540d\u7c7b\u3002\u7ec4\u6210\u65b9\u6cd5\u7684\u5404\u4e2a\u90e8\u5206\uff0clambda\u8868\u8fbe\u5f0f\u51e0\u4e4e\u90fd\u6709\uff0c\u4e0d\u8fc7\u663e\u7136\uff0clambda\u8868\u8fbe\u5f0f\u6ca1\u6709\u540d\u79f0\uff0c\u6709\u4e9b\u53d1\u5f00\u7740\u559c\u6b22\u5427lambda\u8868\u8fbe\u5f0f\u5f53\u6210\u201c\u533f\u540d\u65b9\u6cd5\u201d\u3002</p> <p>\u4e0a\u90e8\u5206\u6211\u4eec\u77e5\u9053\u51fd\u6570\u5f0f\u63a5\u53e3\u53ea\u5305\u542b\u4e00\u4e2a\u62bd\u8c61\u65b9\u6cd5\uff0c\u6709\u4e9b\u5f00\u53d1\u8005\u559c\u6b22\u4f7f\u7528\u201c\u5355\u4e00\u62bd\u8c61\u65b9\u6cd5\u201d\uff08Single Abstract Method, SAM\uff09\u7c7b\u578b\u8fd9\u4e2a\u5c5e\u4e8e\u8868\u793alambda\u8868\u8fbe\u5f0f\u8f6c\u6362\u5f97\u5230\u7684\u63a5\u53e3\u7c7b\u578b\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u533f\u540d\u7c7b\u6216\u5177\u540d\u7c7b\u6765\u5b9e\u73b0\u5b83\uff0c\u4f46Java\u4ece1.8\u5f00\u59cb\u652f\u6301lambda\u8868\u793a\u5f0f\uff0c\u4f7f\u60a8\u53ef\u4ee5\u66f4\u7d27\u51d1\u5730\u8868\u8fbe\u5355\u65b9\u6cd5\u7c7b\u7684\u5b9e\u4f8b\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u57fa\u4e8e<code>java.util.function.BiFunction</code>\u5b9e\u73b0\u4e00\u4e2a\u6574\u6570\u52a0\u6cd5\u51fd\u6570\uff0c\u82e5\u4f7f\u7528\u5177\u540d\u7c7b\uff0c\u60a8\u53ef\u80fd\u4f1a\u8fd9\u6837\u5199\uff1a </p> <pre><code>import java.util.function.BiFunction;\n\npublic final class AddFunction implements BiFunction&lt;Integer, Integer, Integer&gt; {\n@Override\npublic Integer apply(Integer first, Integer second) {\nreturn first + second;\n}\n}\n</code></pre> <p>\u662f\u4e0d\u662f\u4ee3\u7801\u91cf\u8f83\u5927\uff1f\u4f7f\u7528lambda\uff0c\u6211\u4eec\u53ef\u4ee5\u4ee5\u533f\u540d\u7c7b\u7684\u65b9\u5f0f\u5b9e\u73b0<code>AddFunction</code>\u540c\u6837\u7684\u51fd\u6570\u5316\u5b9e\u4f8b\uff0c\u5982\u4e0b\uff1a</p> <pre><code>BiFunction&lt;Integer, Integer, Integer&gt; addFunction\n= (first, second) -&gt; (first + second);\n</code></pre> <p>\u662f\u4e0d\u662f\u6e05\u723d\ud83c\udf43\u4e86\u5f88\u591a\uff1f</p> <p><code>javac</code>\u9047\u5230lambda \u8868\u8fbe\u5f0f\u65f6\u4f1a\u628a\u5b83\u89e3\u91ca\u4e3a\u4e00\u4e2a\u65b9\u6cd5\u7684\u4e3b\u4f53\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5177\u6709\u7279\u5b9a\u7684\u7b7e\u540d\u3002\u4e0d\u8fc7\uff0c\u662f\u90a3\u4e2a\u65b9\u6cd5\u5462\uff1f</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cjavac\u4f1a\u67e5\u770b\u5468\u56f4\u7684\u4ee3\u7801\uff0clambda \u8868\u8fbe\u5f0f\u5fc5\u987b\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u624d\u7b97\u662f\u5408\u6cd5\u7684Java\u4ee3\u7801\uff1a</p> <ul> <li>lambda \u8868\u8fbe\u5f0f\u5fc5\u987b\u51fa\u73b0\u5728\u671f\u671b\u4f7f\u7528\u63a5\u53e3\u7c7b\u578b\u5b9e\u4f8b\u7684\u5730\u65b9\uff1b</li> <li>\u671f\u671b\u4f7f\u7528\u7684\u63a5\u53e3\u7c7b\u578b\u5fc5\u987b\u53ea\u6709\u4e00\u4e2a\u5f3a\u5236\u65b9\u6cd5\uff1b</li> <li>\u8fd9\u4e2a\u5f3a\u5236\u65b9\u6cd5\u7684\u7b7e\u540d\u8981\u5b8c\u5168\u5339\u914dlambda\u8868\u8fbe\u5f0f\u3002</li> </ul> <p>\u5982\u679c\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\uff0c\u7f16\u8bd1\u5668\u4f1a\u521b\u5efa\u4e00\u4e2a\u7c7b\u578b\uff0c\u5b9e\u73b0\u671f\u671b\u4f7f\u7528\u7684\u63a5\u53e3\uff0c\u7136\u540e\u628alambda\u8868\u8fbe\u5f0f\u7684\u4e3b\u4f53\u5f53\u4f5c\u5f3a\u5236\u65b9\u6cd5\u7684\u5b9e\u73b0\u3002\u8bf4\u7684\u7a0d\u5fae\u590d\u6742\u70b9\uff0c\u8fd9\u4e2a\u4f5c\u662f\u4e3a\u4e86\u4fdd\u6301Java\u7c7b\u578b\u7cfb\u7edf\u7684\u540d\u4e49\uff08\u57fa\u4e8e\u540d\u79f0\uff09\u7eaf\u7cb9\u6027\u3002\u4e5f\u5c31\u662f\u8bf4\uff0clambda\u8868\u8fbe\u5f0f\u4f1a\u88ab\u8f6c\u6362\u6210\u6b63\u786e\u63a5\u53e3\u7c7b\u578b\u7684\u5b9e\u4f8b\u3002</p>"},{"location":"2018-11-09-%E6%B5%85%E8%B0%88Java%E5%AF%B9%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E7%9A%84%E6%94%AF%E6%8C%81/#4","title":"4 \u53c2\u8003","text":"<ul> <li>Functional programming</li> <li>Imperative programming</li> <li>Lambda expressions</li> <li>Scala school</li> <li>\u5143\u6570-\u7ef4\u57fa\u767e\u79d1</li> </ul>"},{"location":"2018-11-18-Linux%E7%9A%84TCP%20backlog%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C/","title":"2018 11 18 Linux\u7684TCP backlog\u5982\u4f55\u5de5\u4f5c","text":"<p>\u672c\u6587\u7ffb\u8bd1\u81eaHow TCP backlog works in Linux\u3002</p> <p>\u5f53\u67d0\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528listen\u7cfb\u7edf\u8c03\u7528\u5c06\u4e00\u4e2asocket\u7f6e\u4e3a<code>LISTEN</code>\u72b6\u6001\u65f6\uff0c\u9700\u8981\u4e3a\u8fd9\u4e2asocket\u8bbe\u7f6e\u53c2\u6570<code>backlog</code>\uff0c\u8be5\u53c2\u6570\u901a\u5e38\u88ab\u63cf\u8ff0\u4e3a\u4f20\u5165\uff08incoming\uff09\u8fde\u63a5\u961f\u5217\u7684\u6570\u91cf\u9650\u5236\u3002</p> <p></p> <p>\u56e0\u4e3aTCP\u4f7f\u7528\u4e09\u6b65\u63e1\u624b\uff083-way handshake\uff09\uff0c\u5728\u4e00\u4e2a\u4f20\u5165\u7684\u8fde\u63a5\u5728\u5230\u8fbe<code>ESTABLISHED</code>\u72b6\u6001\u4e4b\u524d\u5fc5\u987b\u7ecf\u8fc7\u4e2d\u95f4\uff08intermediate\uff09\u72b6\u6001<code>SYN RECEIVED</code>\uff0c\u5e76\u4e14\u53ef\u7531accept\u7cfb\u7edf\u8c03\u7528\u8fd4\u56de\u5230\u5e94\u7528\u7a0b\u5e8f\uff08\u8bf7\u53c2\u9605\u4e0a\u9762\u590d\u5236\u7684TCP\u72b6\u6001\u56fe\uff09\u3002\u8fd9\u610f\u5473\u7740TCP/IP\u5806\u6808\u6709\u4e24\u4e2a\u9009\u9879\u6765\u5b9e\u73b0<code>LISTEN</code>\u72b6\u6001\u7684socket\u7684\u79ef\u538b\u961f\u5217\uff08backlog queue\uff09\uff1a</p> <p>1) \u4f7f\u7528\u5927\u5c0f\u7531<code>listen\u7cfb\u7edf\u8c03\u7528</code>\u7684<code>backlog</code>\u53c2\u6570\u51b3\u5b9a\u7684\u5355\u961f\u5217\u5b9e\u73b0\u3002\u5f53\u67d0\u4e2aconnection\u63a5\u6536<code>SYN</code>\u5206\u7ec4\u65f6\uff0c\u5b83\u4f1a\u53d1\u56de<code>SYN/ACK</code>\u5206\u7ec4\u5e76\u5c06\u8fde\u63a5\u5165\u5217\uff1b\u5f53\u63a5\u6536\u5230\u76f8\u5e94\u7684<code>ACK</code>\u5206\u7ec4\u65f6\uff0c\u8fde\u63a5\u5c06\u5176\u72b6\u6001\u6539\u53d8\u4e3a<code>ESTABLISHED</code>\u5e76\u4e14\u6709\u8d44\u683c\u5207\u6362\u5230\u5e94\u7528\u7a0b\u5e8f\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u961f\u5217\u4e2d\u5305\u542b\u4e24\u79cd\u4e0d\u540c\u72b6\u6001\u2014\u2014<code>SYN RECEIVED</code>\u548c<code>ESTABLISHED</code>\uff0c\u53ea\u6709\u540e\u4e00\u79cd\u72b6\u6001\u7684connection\u624d\u80fd\u901a\u8fc7<code>accept\u7cfb\u7edf\u8c03\u7528</code>\u8fd4\u56de\u7ed9\u5e94\u7528\u7a0b\u5e8f\u3002</p> <p>2) \u4f7f\u7528\u4e00\u4e2a<code>SYN</code>\u961f\u5217\uff08\u672a\u5b8c\u6210\u7684\u8fde\u63a5\u961f\u5217\uff09\u548c\u4e00\u4e2a<code>accept</code>\u961f\u5217\uff08\u5df2\u5b8c\u6210\u7684\u8fde\u63a5\u961f\u5217\uff09\u3002\u72b6\u6001<code>SYN RECEIVED</code>\u4e2d\u7684connection\u88ab\u6dfb\u52a0\u5230<code>SYN</code>\u961f\u5217\u4e2d\uff0c\u5e76\u4e14\u5f53\u5b83\u4eec\u7684\u72b6\u6001\u53d8\u4e3a<code>ESTABLISHED</code>\u65f6\uff0c\u5373\u5f53\u63a5\u6536\u52303\u6b21\u63e1\u624b\u4e2d\u7684<code>ACK</code>\u5206\u7ec4\u65f6\uff0c\u79fb\u52a8\u5230accept\u961f\u5217\u3002\u987e\u540d\u601d\u4e49\uff0c<code>accept\u7cfb\u7edf\u8c03\u7528</code>\u7136\u540e\u53ea\u662f\u4e3a\u4e86\u6d88\u8d39\uff08consume\uff09\u6765\u81eaaccept\u961f\u5217\u7684\u8fde\u63a5\u800c\u5b9e\u73b0\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c<code>listen\u7cfb\u7edf\u8c03\u7528</code>\u7684<code>backlog</code>\u53c2\u6570\u786e\u5b9aaccept\u961f\u5217\u7684\u5927\u5c0f\u3002</p> <p>\u4ece\u5386\u53f2\u4e0a\u770b\uff0cBSD\u6d3e\u751f\u7684TCP\u5b9e\u73b0\u4f7f\u7528\u7b2c\u4e00\u79cd\u9009\u9879\uff0c\u610f\u5473\u7740\u5f53\u8fbe\u5230\u6700\u5927backlog\u65f6\uff0c\u7cfb\u7edf\u5c06\u4e0d\u518d\u53d1\u56de<code>SYN/ACK</code>\u5206\u7ec4\u4ee5\u54cd\u5e94<code>SYN</code>\u5206\u7ec4\u3002\u901a\u5e38\uff0cTCP\u5b9e\u73b0\u53ea\u4f1a\u4e22\u5f03<code>SYN</code>\u5206\u7ec4\uff08\u800c\u4e0d\u662f\u54cd\u5e94<code>RST</code>\u5206\u7ec4\uff09\uff0c\u4ee5\u4fbf\u5ba2\u6237\u7aef\u91cd\u8bd5\u3002\u8fd9\u662fW. Richard Stevens\u7684\u7ecf\u5178\u6559\u6750TCP/IP\u8be6\u89e3 \u53773\u7684\u7b2c14.5\u8282<code>listen Backlog Queue</code>\u63cf\u8ff0\u7684\u5185\u5bb9\u3002</p> <p>\u8bf7\u6ce8\u610f\uff0cStevens\u5b9e\u9645\u4e0a\u89e3\u91ca\u4e86BSD\u5b9e\u73b0\u786e\u5b9e\u4f7f\u7528\u4e86\u4e24\u4e2a\u5355\u72ec\u7684\u961f\u5217\uff0c\u4f46\u5b83\u4eec\u8868\u73b0\u4e3a\u5355\u4e2a\u961f\u5217\uff0c\u5176\u56fa\u5b9a\u7684\u6700\u5927\u5927\u5c0f\u7531<code>backlog\u53c2\u6570</code>\u786e\u5b9a\uff08\u4f46\u4e0d\u4e00\u5b9a\u5b8c\u5168\u7b49\u4e8e\uff09\uff0c\u5373BSD\u5728\u903b\u8f91\u4e0a\u8868\u73b0\u5982\u7b2c\u4e00\u4e2a\u9009\u9879\u6240\u8ff0\uff1a</p> <p>\u961f\u5217\u9650\u5236\u9002\u7528\u4e8e[...]\u4e0d\u5b8c\u6574\u8fde\u63a5\u961f\u5217\u4e0a\u7684\u6761\u76ee\u6570\u548c[...]\u5df2\u5b8c\u6210\u8fde\u63a5\u961f\u5217[...]\u4e0a\u7684\u6761\u76ee\u6570\u4e4b\u548c\u3002</p> <p>\u5728Linux\u4e0a\uff0c\u4e8b\u60c5\u662f\u4e0d\u540c\u7684\uff0c\u5982<code>listen\u7cfb\u7edf\u8c03\u7528</code>\u7684\u624b\u518c\u9875\u4e2d\u6240\u8ff0\uff1a</p> <p>Linux 2.2\u4fee\u6539\u4e86TCP socket\u7684<code>backlog</code>\u53c2\u6570\u7684\u884c\u4e3a\u3002\u73b0\u5728\u5b83\u6307\u5b9a\u4e86\u7b49\u5f85\u88abaccept\u7684<code>\u5b8c\u5168</code>\u5efa\u7acb\u7684\u5957\u63a5\u5b57\u7684\u961f\u5217\u957f\u5ea6\uff0c\u800c\u4e0d\u662f<code>\u672a\u5b8c\u6210</code>\u7684\u8fde\u63a5\u8bf7\u6c42\u7684\u6570\u91cf\u3002\u53ef\u4ee5\u5728\u6587\u4ef6<code>/proc/sys/net/ipv4/tcp_max_syn_backlog</code>\u4e2d\u8bbe\u7f6e<code>\u672a\u5b8c\u6210</code>\u7684socket\u961f\u5217\u7684\u957f\u5ea6\u3002</p> <p>\u8fd9\u610f\u5473\u7740\u5f53\u524d\u7684Linux\u7248\u672c\u4f7f\u7528\u5177\u6709\u4e24\u4e2a\u4e0d\u540c\u961f\u5217\u7684\u7b2c\u4e8c\u4e2a\u9009\u9879\uff1a\u5177\u6709\u7531\u7cfb\u7edf\u8303\u56f4\u8bbe\u7f6e\u6307\u5b9a\u7684\u5927\u5c0f\u7684<code>SYN</code>\u961f\u5217\u548c\u5177\u6709\u7531\u5e94\u7528\u7a0b\u5e8f\u6307\u5b9a\u7684\u5927\u5c0f\u7684accept\u961f\u5217\u3002</p> <p>\u73b0\u5728\u6709\u8da3\u7684\u95ee\u9898\u662f\uff0c\u5982\u679c\u63a5\u53d7\u961f\u5217\u5df2\u6ee1\u5e76\u4e14\u9700\u8981\u5c06\u8fde\u63a5\u4eceSYN\u961f\u5217\u79fb\u52a8\u5230\u63a5\u53d7\u961f\u5217\uff0c\u5373\u5f53\u63a5\u6536\u52303\u6b21\u63e1\u624b\u7684ACK\u5206\u7ec4\u65f6\uff0c\u8fd9\u79cd\u5b9e\u73b0\u5982\u4f55\u8868\u73b0\u3002\u8fd9\u79cd\u60c5\u51b5\u7531<code>net/ipv4/tcp_minisocks.c</code>\u4e2d\u7684<code>tcp_check_req</code>\u51fd\u6570\u5904\u7406\uff0c\u76f8\u5173\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>child = inet_csk(sk)-&gt;icsk_af_ops-&gt;syn_recv_sock(sk, skb, req, NULL);\nif (child == NULL)\ngoto listen_overflow;\n</code></pre> <p>\u5bf9\u4e8eIPv4\uff0c\u7b2c\u4e00\u884c\u4ee3\u7801\u5b9e\u9645\u8c03\u7528<code>net/ipv4/tcp_ipv4.c</code>\u4e2d\u7684<code>tcp_v4_syn_recv_sock</code>\u51fd\u6570\uff0c\u5305\u542b\u4ee5\u4e0b\u4ee3\u7801\uff1a</p> <p><pre><code>if (sk_acceptq_is_full(sk))\ngoto exit_overflow;\n</code></pre> \u6b64\u5904\u7684\u4ee3\u7801\u5bf9accept\u961f\u5217\u8fdb\u884c\u4e86check\u3002<code>exit_overflow</code>\u6807\u7b7e\u4e4b\u540e\u7684\u4ee3\u7801\u5c06\u6267\u884c\u4e00\u4e9b\u6e05\u7406\uff0c\u66f4\u65b0<code>/proc/net/netstat</code>\u4e2d\u7684<code>ListenOverflows</code>\u548c<code>ListenDrops</code>\u7edf\u8ba1\u4fe1\u606f\uff0c\u7136\u540e\u8fd4\u56de<code>NULL</code>\u3002\u8fd9\u5c06\u5f15\u53d1<code>tcp_check_req</code>\u51fd\u6570\u4e2d\u7684<code>listen_overflow</code>\u4ee3\u7801\u7684\u6267\u884c\uff1a</p> <pre><code>listen_overflow:\nif (!sysctl_tcp_abort_on_overflow) {\ninet_rsk(req)-&gt;acked = 1;\nreturn NULL;\n}\n</code></pre> <p>\u8fd9\u610f\u5473\u7740\u9664\u975e<code>/proc/sys/net/ipv4/tcp_abort_on_overflow</code>\u88ab\u7f6e\u4e3a<code>1</code>\uff08\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e0a\u9762\u663e\u793a\u7684\u4ee3\u7801\u4e4b\u540e\u7684\u4ee3\u7801\u5c06\u53d1\u9001\u4e00\u4e2a<code>RST</code>\u5206\u7ec4\uff09\uff0c\u8fd9\u79cd\u5b9e\u73b0\u57fa\u672c\u4e0a\u4e0d\u505a\u5904\u7406\u3002</p> <p>\u603b\u800c\u8a00\u4e4b\uff0c\u5982\u679cLinux\u4e2d\u7684TCP\u5b9e\u73b0\u63a5\u6536\u52303\u6b21\u63e1\u624b\u7684<code>ACK</code>\u5206\u7ec4\u5e76\u4e14accept\u961f\u5217\u5df2\u6ee1\uff0c\u5b83\u5c06\u57fa\u672c\u4e0a\u5ffd\u7565\u8be5\u5206\u7ec4\u3002\u4e4d\u770b\u8d77\u6765\u5f88\u5947\u602a\uff0c\u4f46\u662f\u522b\u5fd8\u8bb0\u6709\u4e00\u4e2a\u4e0e<code>SYN RECEIVED</code>\u72b6\u6001\u76f8\u5173\u8054\u7684\u5b9a\u65f6\u5668\uff1a\u82e5\u6ca1\u6709\u6536\u5230<code>ACK</code>\u5206\u7ec4\uff08\u6216\u8005\u5982\u679c\u5b83\u88ab\u5ffd\u7565\uff0c\u5982\u6b64\u5904\u6240\u8003\u8651\u7684\u60c5\u51b5\uff09\uff0c\u90a3\u4e48TCP\u5b9e\u73b0\u5c06\u91cd\u65b0\u53d1\u9001<code>SYN / ACK</code>\u5206\u7ec4\uff08\u5177\u6709\u7531<code>/proc/sys/net/ipv4/tcp_synack_retries</code>\u6307\u5b9a\u7684\u91cd\u8bd5\u6b21\u6570\uff0c\u5e76\u4f7f\u7528\u6307\u6570\u9000\u907f\u7b97\u6cd5\uff09\u3002</p> <p>\u5bf9\u4e8e\u5c1d\u8bd5\u8fde\u63a5\uff08\u5e76\u53d1\u9001\u6570\u636e\uff09\u5230\u8fbe\u5df2\u8fbe\u5230\u5176\u6700\u5927backlog\u7684socket\u7684\u5ba2\u6237\u7aef\uff0c\u53ef\u4ee5\u5728\u4ee5\u4e0b\u6570\u636e\u5305\u8ddf\u8e2a\u4e2d\u770b\u5230\uff1a</p> <pre><code>0.000  127.0.0.1 -&gt; 127.0.0.1  TCP 74 53302 &gt; 9999 [SYN] Seq=0 Len=0\n  0.000  127.0.0.1 -&gt; 127.0.0.1  TCP 74 9999 &gt; 53302 [SYN, ACK] Seq=0 Ack=1 Len=0\n  0.000  127.0.0.1 -&gt; 127.0.0.1  TCP 66 53302 &gt; 9999 [ACK] Seq=1 Ack=1 Len=0\n  0.000  127.0.0.1 -&gt; 127.0.0.1  TCP 71 53302 &gt; 9999 [PSH, ACK] Seq=1 Ack=1 Len=5\n  0.207  127.0.0.1 -&gt; 127.0.0.1  TCP 71 [TCP Retransmission] 53302 &gt; 9999 [PSH, ACK] Seq=1 Ack=1 Len=5\n  0.623  127.0.0.1 -&gt; 127.0.0.1  TCP 71 [TCP Retransmission] 53302 &gt; 9999 [PSH, ACK] Seq=1 Ack=1 Len=5\n  1.199  127.0.0.1 -&gt; 127.0.0.1  TCP 74 9999 &gt; 53302 [SYN, ACK] Seq=0 Ack=1 Len=0\n  1.199  127.0.0.1 -&gt; 127.0.0.1  TCP 66 [TCP Dup ACK 6#1] 53302 &gt; 9999 [ACK] Seq=6 Ack=1 Len=0\n  1.455  127.0.0.1 -&gt; 127.0.0.1  TCP 71 [TCP Retransmission] 53302 &gt; 9999 [PSH, ACK] Seq=1 Ack=1 Len=5\n  3.123  127.0.0.1 -&gt; 127.0.0.1  TCP 71 [TCP Retransmission] 53302 &gt; 9999 [PSH, ACK] Seq=1 Ack=1 Len=5\n  3.399  127.0.0.1 -&gt; 127.0.0.1  TCP 74 9999 &gt; 53302 [SYN, ACK] Seq=0 Ack=1 Len=0\n  3.399  127.0.0.1 -&gt; 127.0.0.1  TCP 66 [TCP Dup ACK 10#1] 53302 &gt; 9999 [ACK] Seq=6 Ack=1 Len=0\n  6.459  127.0.0.1 -&gt; 127.0.0.1  TCP 71 [TCP Retransmission] 53302 &gt; 9999 [PSH, ACK] Seq=1 Ack=1 Len=5\n  7.599  127.0.0.1 -&gt; 127.0.0.1  TCP 74 9999 &gt; 53302 [SYN, ACK] Seq=0 Ack=1 Len=0\n  7.599  127.0.0.1 -&gt; 127.0.0.1  TCP 66 [TCP Dup ACK 13#1] 53302 &gt; 9999 [ACK] Seq=6 Ack=1 Len=0\n 13.131  127.0.0.1 -&gt; 127.0.0.1  TCP 71 [TCP Retransmission] 53302 &gt; 9999 [PSH, ACK] Seq=1 Ack=1 Len=5\n 15.599  127.0.0.1 -&gt; 127.0.0.1  TCP 74 9999 &gt; 53302 [SYN, ACK] Seq=0 Ack=1 Len=0\n 15.599  127.0.0.1 -&gt; 127.0.0.1  TCP 66 [TCP Dup ACK 16#1] 53302 &gt; 9999 [ACK] Seq=6 Ack=1 Len=0\n 26.491  127.0.0.1 -&gt; 127.0.0.1  TCP 71 [TCP Retransmission] 53302 &gt; 9999 [PSH, ACK] Seq=1 Ack=1 Len=5\n 31.599  127.0.0.1 -&gt; 127.0.0.1  TCP 74 9999 &gt; 53302 [SYN, ACK] Seq=0 Ack=1 Len=0\n 31.599  127.0.0.1 -&gt; 127.0.0.1  TCP 66 [TCP Dup ACK 19#1] 53302 &gt; 9999 [ACK] Seq=6 Ack=1 Len=0\n 53.179  127.0.0.1 -&gt; 127.0.0.1  TCP 71 [TCP Retransmission] 53302 &gt; 9999 [PSH, ACK] Seq=1 Ack=1 Len=5\n106.491  127.0.0.1 -&gt; 127.0.0.1  TCP 71 [TCP Retransmission] 53302 &gt; 9999 [PSH, ACK] Seq=1 Ack=1 Len=5\n106.491  127.0.0.1 -&gt; 127.0.0.1  TCP 54 9999 &gt; 53302 [RST] Seq=1 Len=0\n</code></pre> <p>\u7531\u4e8e\u5ba2\u6237\u7aef\u4e0a\u7684TCP\u5b9e\u73b0\u83b7\u5f97\u591a\u4e2a<code>SYN/ACK</code>\u5206\u7ec4\uff0c\u56e0\u6b64\u5b83\u5c06\u5047\u8bbe<code>ACK</code>\u5206\u7ec4\u4e22\u5931\u5e76\u91cd\u65b0\u53d1\u9001\uff08\u8bf7\u53c2\u9605\u4e0a\u9762\u8ddf\u8e2a\u4e2d\u5e26\u6709<code>TCP Dup ACK</code>\u7684\u884c\uff09\u3002\u82e5\u670d\u52a1\u5668\u7aef\u7684\u5e94\u7528\u7a0b\u5e8f\u5728\u8fbe\u5230\u6700\u5927<code>SYN/ACK</code>\u91cd\u8bd5\u6b21\u6570\u4e4b\u524d\u51cf\u5c11\u4e86backlog\uff08\u5373\u4eceaccept\u961f\u5217\u4e2d\u6d88\u8d39\u4e86\u4e00\u4e2aentry\uff09\uff0c\u90a3\u4e48TCP\u5b9e\u73b0\u6700\u7ec8\u5c06\u5904\u7406\u5176\u4e2d\u4e00\u4e2a\u91cd\u590d\u7684<code>ACK</code>\uff0c\u8f6c\u6362\u72b6\u6001\u4ece<code>SYN RECEIVED</code>\u5230<code>ESTABLISHED</code>\u7684connection\uff0c\u5e76\u5c06\u5176\u6dfb\u52a0\u5230accept\u961f\u5217\u3002\u5426\u5219\uff0c\u5ba2\u6237\u7aef\u6700\u7ec8\u5c06\u83b7\u5f97<code>RST</code>\u5206\u7ec4\uff08\u5982\u4e0a\u9762\u663e\u793a\u7684\u793a\u4f8b\uff09\u3002</p> <p>\u4e0a\u8ff0\u6570\u636e\u5305\u8ddf\u8e2a\u8fd8\u663e\u793a\u4e86\u6b64\u884c\u4e3a\u7684\u53e6\u4e00\u4e2a\u6709\u8da3\u65b9\u9762\u3002\u4ece\u5ba2\u6237\u7aef\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u5728\u63a5\u6536\u5230\u7b2c\u4e00\u4e2a<code>SYN/ACK</code>\u5206\u7ec4\u540e\uff0cconnection\u5c06\u5904\u4e8e<code>ESTABLISHED</code>\u72b6\u6001\u3002\u5982\u679c\u5b83\u53d1\u9001\u6570\u636e\uff08\u4e0d\u5148\u4ece\u670d\u52a1\u5668\u7b49\u5f85\u6570\u636e\uff09\uff0c\u90a3\u4e48\u4e5f\u5c06\u91cd\u4f20\u8be5\u6570\u636e\u3002\u5e78\u8fd0\u7684\u662f\uff0cTCP\u6162\u542f\u52a8\u5e94\u8be5\u9650\u5236\u5728\u6b64\u9636\u6bb5\u53d1\u9001\u7684\u6bb5\u6570\uff08the number of segments sent\uff09\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u9996\u5148\u7b49\u5f85\u6765\u81ea\u670d\u52a1\u5668\u7684\u6570\u636e\u5e76\u4e14\u670d\u52a1\u5668\u6c38\u8fdc\u4e0d\u4f1a\u51cf\u5c11backlog\uff0c\u90a3\u4e48\u6700\u7ec8\u7ed3\u679c\u662f\u5728\u5ba2\u6237\u7aef\uff0c\u8fde\u63a5\u5904\u4e8e<code>ESTABLISHED</code>\u72b6\u6001\uff0c\u800c\u5728\u670d\u52a1\u5668\u7aef\uff0cconnection\u88ab\u89c6\u4e3a<code>CLOSED</code>\u3002\u8fd9\u610f\u5473\u7740\u6211\u4eec\u6700\u7ec8\u4f1a\u5efa\u7acb\u534a\u5f00\u8fde\u63a5\uff01</p> <p>\u8fd8\u6709\u4e00\u4e2a\u65b9\u9762\u6211\u4eec\u5c1a\u672a\u8ba8\u8bba\u3002\u6765\u81ea<code>listen\u7cfb\u7edf\u8c03\u7528</code>\u7684\u624b\u518c\u9875\u7684\u5f15\u7528\u8868\u660e\u6bcf\u4e2a<code>SYN</code>\u5206\u7ec4\u90fd\u4f1a\u5bfc\u81f4\u4e00\u4e2aconnection\u88ab\u6dfb\u52a0\u5230<code>SYN</code>\u961f\u5217\uff08\u9664\u975e\u8be5\u961f\u5217\u5df2\u6ee1\uff09\u3002\u4e8b\u5b9e\u5e76\u975e\u5982\u6b64\u3002\u539f\u56e0\u5728<code>net/ipv4/tcp_ipv4.c</code>\u7684<code>tcp_v4_conn_request</code>\u65b9\u6cd5\uff08\u5904\u7406<code>SYN</code>\u5206\u7ec4\uff09\u7684\u5982\u4e0b\u4ee3\u7801\u4e2d\uff1a</p> <pre><code>/* Accept backlog \u5df2\u6ee1\u3002\u5982\u679c\u6211\u4eec\u5df2\u7ecf\u5728`SYN`\u961f\u5217\u4e2d\u6392\u961f\u4e86\u8db3\u591f\u7684\u70ed\u6761\u76ee\uff0c\u5219\u5220\u9664\u8bf7\u6c42\u3002\u5b83\u6bd4\u4f7f\u7528\u6307\u6570\u589e\u52a0\u8d85\u65f6\u7684openreqs\u5835\u585e`SYN`\u961f\u5217\u66f4\u597d\u3002\n*/\nif (sk_acceptq_is_full(sk) &amp;&amp; inet_csk_reqsk_queue_young(sk) &gt; 1) {\nNET_INC_STATS_BH(sock_net(sk), LINUX_MIB_LISTENOVERFLOWS);\ngoto drop;\n}\n</code></pre> <p>\u8fd9\u610f\u5473\u7740\u82e5accept\u961f\u5217\u5df2\u6ee1\uff0c\u5219\u5185\u6838\u5c06\u5bf9\u63a5\u53d7<code>SYN</code>\u5206\u7ec4\u7684\u901f\u7387\u65bd\u52a0\u9650\u5236\u3002\u82e5\u6536\u5230\u592a\u591a\u7684<code>SYN</code>\u5206\u7ec4\uff0c\u5176\u4e2d\u4e00\u4e9b\u5c06\u88ab\u4e22\u5f03\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7531\u5ba2\u6237\u7aef\u91cd\u8bd5\u53d1\u9001<code>SYN</code>\u5206\u7ec4\uff0c\u6211\u4eec\u6700\u7ec8\u5f97\u5230\u7684\u884c\u4e3a\u4e0eBSD\u6d3e\u751f\u7684\u5b9e\u73b0\u76f8\u540c\u3002</p> <p>\u6700\u540e\uff0c\u8ba9\u6211\u4eec\u8bd5\u7740\u4e86\u89e3\u4e3a\u4ec0\u4e48Linux\u7684\u8bbe\u8ba1\u9009\u62e9\u4f18\u4e8e\u4f20\u7edf\u7684BSD\u5b9e\u73b0\u3002Stevens\u63d0\u51fa\u4ee5\u4e0b\u6709\u8da3\u7684\u89c2\u70b9\uff1a</p> <p>The backlog can be reached if the completed connection queue fills (i.e., the server process or the server host is so busy that the process cannot call accept fast enough to take the completed entries off the queue) or if the incomplete connection queue fills. The latter is the problem that HTTP servers face, when the round-trip time between the client and server is long, compared to the arrival rate of new connection requests, because a new SYN occupies an entry on this queue for one round-trip time. [\u2026]</p> <p>The completed connection queue is almost always empty because when an entry is placed on this queue, the server\u2019s call to accept returns, and the server takes the completed connection off the queue.</p> <p>Stevens\u5efa\u8bae\u7684\u89e3\u51b3\u65b9\u6848\u53ea\u662f\u589e\u52a0backlog\u3002\u8fd9\u6837\u505a\u7684\u95ee\u9898\u5728\u4e8e\uff0c\u5b83\u5047\u5b9a\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u8c03\u6574backlog\uff0c\u4e0d\u4ec5\u8981\u8003\u8651\u5b83\u5982\u4f55\u5904\u7406\u65b0\u5efa\u7acb\u7684\u4f20\u5165\u8fde\u63a5\uff08incoming connection\uff09\uff0c\u8fd8\u8981\u8003\u8651\u5230\u8bf8\u5982\u5f80\u8fd4\u65f6\u95f4\uff08round-trip time\uff09\u7b49\u6d41\u91cf\u7279\u6027\uff08traffic characteristics\uff09\u7684\u529f\u80fd\u3002Linux\u4e2d\u7684\u5b9e\u73b0\u6709\u6548\u5730\u533a\u5206\u4e86\u8fd9\u4e24\u4e2a\u95ee\u9898\uff1a\u5e94\u7528\u7a0b\u5e8f\u53ea\u8d1f\u8d23\u8c03\u6574backlog\uff0c\u4ee5\u4fbf\u5b83\u53ef\u4ee5\u8db3\u591f\u5feb\u5730\u8c03\u7528<code>accept\u7cfb\u7edf\u8c03\u7528</code>\u4ee5\u907f\u514d\u586b\u5145accept\u961f\u5217\uff09\uff0c\u7136\u540e\uff0c\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u4ee5\u6839\u636e\u6d41\u91cf\u7279\u5f81\u8c03\u6574<code>/proc/sys/net/ipv4/tcp_max_syn_backlog</code>\u3002</p>"},{"location":"2019-01-27-%E5%BB%BA%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BA%94%E5%A4%A7%E5%8E%9F%E5%88%99/","title":"2019 01 27 \u5efa\u7d22\u5f15\u7684\u4e94\u5927\u539f\u5219","text":"<ol> <li>\u6700\u5de6\u524d\u7f00\u5339\u914d\u539f\u5219\uff0c\u975e\u5e38\u91cd\u8981\u7684\u539f\u5219\uff0cMySQL\u4f1a\u4e00\u76f4\u5411\u53f3\u5339\u914d\u76f4\u5230\u9047\u5230\u8303\u56f4\u67e5\u8be2(&gt;\u3001&lt;\u3001between\u3001like)\u5c31\u505c\u6b62\u5339\u914d\uff0c\u6bd4\u5982<code>a = 1 and b = 2 and c &gt; 3 and d = 4</code>\u5982\u679c\u5efa\u7acb<code>(a,b,c,d)</code>\u987a\u5e8f\u7684\u7d22\u5f15\uff0cd\u662f\u7528\u4e0d\u5230\u7d22\u5f15\u7684\uff0c\u5982\u679c\u5efa\u7acb<code>(a,b,d,c)</code>\u7684\u7d22\u5f15\u5219\u90fd\u53ef\u4ee5\u7528\u5230\uff0ca,b,d\u7684\u987a\u5e8f\u53ef\u4ee5\u4efb\u610f\u8c03\u6574\u3002</li> <li><code>=</code>\u548c<code>in</code>\u53ef\u4ee5\u4e71\u5e8f\uff0c\u6bd4\u5982<code>a = 1 and b = 2 and c = 3</code> \u5efa\u7acb<code>(a,b,c)</code>\u7d22\u5f15\u53ef\u4ee5\u4efb\u610f\u987a\u5e8f\uff0cMySQL\u7684\u67e5\u8be2\u4f18\u5316\u5668\u4f1a\u5e2e\u4f60\u4f18\u5316\u6210\u7d22\u5f15\u53ef\u4ee5\u8bc6\u522b\u7684\u5f62\u5f0f\u3002</li> <li>\u5c3d\u91cf\u9009\u62e9\u533a\u5206\u5ea6\u9ad8\u7684\u5217\u4f5c\u4e3a\u7d22\u5f15,\u533a\u5206\u5ea6\u7684\u516c\u5f0f\u662f<code>count(distinct col)/count(*)</code>\uff0c\u8868\u793a\u5b57\u6bb5\u4e0d\u91cd\u590d\u7684\u6bd4\u4f8b\uff0c\u6bd4\u4f8b\u8d8a\u5927\u6211\u4eec\u626b\u63cf\u7684\u8bb0\u5f55\u6570\u8d8a\u5c11\uff0c\u552f\u4e00\u952e\u7684\u533a\u5206\u5ea6\u662f1\uff0c\u800c\u4e00\u4e9b\u72b6\u6001\u3001\u6027\u522b\u5b57\u6bb5\u53ef\u80fd\u5728\u5927\u6570\u636e\u9762\u524d\u533a\u5206\u5ea6\u5c31\u662f0\uff0c\u90a3\u53ef\u80fd\u6709\u4eba\u4f1a\u95ee\uff0c\u8fd9\u4e2a\u6bd4\u4f8b\u6709\u4ec0\u4e48\u7ecf\u9a8c\u503c\u5417\uff1f\u4f7f\u7528\u573a\u666f\u4e0d\u540c\uff0c\u8fd9\u4e2a\u503c\u4e5f\u5f88\u96be\u786e\u5b9a\uff0c\u4e00\u822c\u9700\u8981join\u7684\u5b57\u6bb5\u6211\u4eec\u90fd\u8981\u6c42\u662f0.1\u4ee5\u4e0a\uff0c\u5373\u5e73\u57471\u6761\u626b\u63cf10\u6761\u8bb0\u5f55\u3002</li> <li>\u7d22\u5f15\u5217\u4e0d\u80fd\u53c2\u4e0e\u8ba1\u7b97\uff0c\u4fdd\u6301\u5217\u201c\u5e72\u51c0\u201d\uff0c\u6bd4\u5982<code>from_unixtime(create_time) = \u20192014-05-29\u2019</code>\u5c31\u4e0d\u80fd\u4f7f\u7528\u5230\u7d22\u5f15\uff0c\u539f\u56e0\u5f88\u7b80\u5355\uff0c<code>b+\u6811</code>\u4e2d\u5b58\u7684\u90fd\u662f\u6570\u636e\u8868\u4e2d\u7684\u5b57\u6bb5\u503c\uff0c\u4f46\u8fdb\u884c\u68c0\u7d22\u65f6\uff0c\u9700\u8981\u628a\u6240\u6709\u5143\u7d20\u90fd\u5e94\u7528\u51fd\u6570\u624d\u80fd\u6bd4\u8f83\uff0c\u663e\u7136\u6210\u672c\u592a\u5927\u3002\u6240\u4ee5\u8bed\u53e5\u5e94\u8be5\u5199\u6210<code>create_time = unix_timestamp(\u20192014-05-29\u2019)</code>\u3002</li> <li>\u5c3d\u91cf\u7684\u6269\u5c55\u7d22\u5f15\uff0c\u4e0d\u8981\u65b0\u5efa\u7d22\u5f15\u3002\u6bd4\u5982\u8868\u4e2d\u5df2\u7ecf\u6709a\u7684\u7d22\u5f15\uff0c\u73b0\u5728\u8981\u52a0(a,b)\u7684\u7d22\u5f15\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u4fee\u6539\u539f\u6765\u7684\u7d22\u5f15\u5373\u53ef\u3002</li> </ol>"},{"location":"2019-01-31-nginx%E6%9E%B6%E6%9E%84/","title":"2019 01 31 nginx\u67b6\u6784","text":"<p>\u7ffb\u8bd1\u81eaThe Architecture of Open Source Applications (Volume 2): nginx</p> <p>nginx\uff08\u8bfb\u4f5c\"engine x\"\uff09\u662f\u7531Igor Sysoev\uff08\u4e00\u540d\u4fc4\u7f57\u65af\u8f6f\u4ef6\u5de5\u7a0b\u5e08\uff09\u5f00\u53d1\u7684\u4e00\u6b3e\u81ea\u7531\u5f00\u6e90\u7684Web\u670d\u52a1\u5668\u7a0b\u5e8f\u3002\u81ea2004\u5e74\u516c\u5f00\u53d1\u5e03\u4ee5\u6765\uff0cnginx\u4e00\u76f4\u4e13\u6ce8\u4e8e\u9ad8\u6027\u80fd\u3001\u9ad8\u5e76\u53d1\u884c\u548c\u4f4e\u5185\u5b58\u4f7f\u7528\u3002\u8d1f\u8f7d\u5747\u8861\u3001\u7f13\u5b58\u548c\u8bbf\u95ee\u53ca\u5e26\u5bbd\u63a7\u5236\u7b49Web\u670d\u52a1\u5668\u529f\u80fd\u4e4b\u4e0a\u7684\u5176\u4ed6\u529f\u80fd\uff0c\u4ee5\u53ca\u6709\u6548\u96c6\u6210\u5404\u79cd\u5e94\u7528\u7a0b\u5e8f\u7684\u80fd\u529b\uff0c\u90fd\u5e2e\u52a9\u4f7fnginx\u6210\u4e3a\u73b0\u4ee3\u67b6\u6784\u7684\u4e0d\u9519\u9009\u62e9\u3002\u5f53\u524dnginx\u662f\u4e92\u8054\u7f51\u4e0a\u7b2c\u4e8c\u53d7\u6b22\u8fce\u7684\u5f00\u6e90Web\u670d\u52a1\u5668\u3002</p>"},{"location":"2019-01-31-nginx%E6%9E%B6%E6%9E%84/#1","title":"1 \u4e3a\u4f55\u9ad8\u5e76\u53d1\u6027\u662f\u91cd\u8981\u7684","text":"<p>\u5982\u4eca\uff0c\u4e92\u8054\u7f51\u5982\u6b64\u5e7f\u6cdb\u548c\u65e0\u5904\u4e0d\u5728\uff0c\u5f88\u96be\u60f3\u8c61\u5b83\u4e0d\u662f\u5341\u5e74\u524d\u6211\u4eec\u6240\u77e5\u9053\u7684\u90a3\u6837\u3002\u4ece\u7b80\u5355\u7684HTML\u751f\u6210\u53ef\u70b9\u51fb\u6587\u672c\uff0c\u57fa\u4e8eNCSA\uff0c\u7136\u540e\u662fApache Web\u670d\u52a1\u5668\uff0c\u5230\u5168\u7403\u8d85\u8fc720\u4ebf\u7528\u6237\u4f7f\u7528\u7684\u5728\u7ebf\u901a\u4fe1\u5a92\u4f53\uff0c\u5b83\u5df2\u7ecf\u6709\u4e86\u957f\u8db3\u53d1\u5c55\u3002\u968f\u7740\u6c38\u4e45\u8fde\u63a5\u7684\u4e2a\u4eba\u7535\u8111\u3001\u79fb\u52a8\u8bbe\u5907\u548c\u5e73\u677f\u7535\u8111\u7684\u6fc0\u589e\uff0c\u4e92\u8054\u7f51\u9886\u57df\u6b63\u5728\u8fc5\u901f\u53d8\u5316\uff0c\u6574\u4e2a\u7ecf\u6d4e\u5df2\u7ecf\u6210\u4e3a\u6570\u5b57\u8fde\u7ebf\u3002\u5728\u7ebf\u670d\u52a1\u53d8\u5f97\u66f4\u52a0\u7cbe\u7ec6\uff0c\u660e\u663e\u504f\u5411\u5373\u4f7f\u53ef\u7528\u7684\u5b9e\u65f6\u4fe1\u606f\u548c\u5a31\u4e50\u3002\u8fd0\u884c\u5728\u7ebf\u4e1a\u52a1\u7684\u5b89\u5168\u65b9\u9762\u4e5f\u53d1\u751f\u4e86\u91cd\u5927\u53d8\u5316\u3002\u56e0\u6b64\uff0c\u73b0\u5728\u7684\u7f51\u7ad9\u6bd4\u4ee5\u524d\u590d\u6742\u5f97\u591a\uff0c\u5e76\u4e14\u901a\u5e38\u9700\u8981\u66f4\u591a\u7684\u5de5\u7a0b\u52aa\u529b\u624d\u80fd\u5177\u6709\u5065\u58ee\u6027\u548c\u53ef\u62d3\u5c55\u6027\u3002</p> <p>\u4e00\u4e2a\u7f51\u7ad9\u67b6\u6784\u7684\u6700\u5927\u7684\u53d8\u5316\u4e4b\u4e00\u7ecf\u5e38\u662f\u5e76\u53d1\u6027\u3002\u4eceWeb\u670d\u52a1\u5f00\u59cb\u4ee5\u6765\uff0c\u5e76\u53d1\u7ea7\u522b\u4e00\u76f4\u5728\u4e0d\u65ad\u589e\u957f\u3002\u4e00\u4e2a\u6d41\u884c\u7f51\u7ad9\u540c\u65f6\u670d\u52a1\u6570\u5341\u4e07\u751a\u81f3\u6570\u767e\u4e07\u7528\u6237\u7684\u60c5\u51b5\u5e76\u4e0d\u7f55\u89c1\u3002\u5341\u5e74\u524d\uff0c\u5e76\u53d1\u7684\u4e3b\u8981\u539f\u56e0\u662f\u6162\u5ba2\u6237\u7aef\uff08slow clients\uff09\u2014\u2014\u5177\u6709ADSL\u6216\u62e8\u53f7\u8fde\u63a5\u7684\u7528\u6237\u3002\u5982\u4eca\uff0c\u5e76\u53d1\u662f\u7531\u4e8e\u79fb\u52a8\u5ba2\u6237\u7aef\u548c\u8f83\u65b0\u7684\u5e94\u7528\u7a0b\u5e8f\u4f53\u7cfb\u67b6\u6784\u7684\u7ec4\u5408\u5f15\u8d77\u7684\uff0c\u8fd9\u4e9b\u4f53\u7cfb\u7ed3\u6784\u901a\u5e38\u57fa\u4e8e\u6301\u4e45\u8fde\u63a5\uff0c\u4ee5\u652f\u6301\u5ba2\u6237\u7aef\u5b9e\u65f6\u66f4\u65b0\u65b0\u95fb\u3001\u63a8\u6587\u548c\u670b\u53cb\u8ba2\u9605\u6e90\u7b49\u3002\u53e6\u4e00\u4e2a\u56e0\u7d20\u662f\u73b0\u4ee3\u6d4f\u89c8\u5668\u7684\u884c\u4e3a\u6539\u53d8\u2014\u2014\u5b83\u53ef\u4ee5\u6253\u5f00\u56db\u5230\u516d\u4e2a\u4e0e\u7f51\u7ad9\u7684\u540c\u65f6\u8fde\u63a5\uff0c\u4ee5\u63d0\u9ad8\u9875\u9762\u52a0\u8f7d\u901f\u5ea6\u3002</p> <p>\u4e3a\u4e86\u8bf4\u660e\u6162\u5ba2\u6237\u7aef\u7684\u95ee\u9898\uff0c\u60f3\u8c61\u4e00\u4e2a\u7b80\u5355\u7684\u57fa\u4e8eApache Web\u670d\u52a1\u5668\uff0c\u5b83\u4ea7\u751f\u4e00\u4e2a\u76f8\u5bf9\u8f83\u77ed\u7684100 KB\u54cd\u5e94\u2014\u2014\u4e00\u4e2a\u5e26\u6709\u6587\u672c\u6216\u56fe\u50cf\u7684\u7f51\u9875\u3002\u751f\u6210\u6216\u5065\u8bbc\u6b64\u9875\u9762\u53ea\u9700\u8981\u51e0\u5206\u4e4b\u4e00\u79d2\uff0c\u4f46\u9700\u898110\u79d2\u624d\u80fd\u5c06\u5176\u4f20\u8f93\u5230\u5e26\u5bbd\u4e3a80 kbps\uff0810KB/s\uff09\u7684\u5ba2\u6237\u7aef\u3002\u4ece\u672c\u8d28\u4e0a\u8bb2\uff0cWeb\u670d\u52a1\u5668\u4f1a\u76f8\u5bf9\u5feb\u90fd\u5730\u63d0\u53d6100KB\u7684\u5185\u5bb9\uff0c\u7136\u540e\u5728\u91ca\u653e\u8fde\u63a5\u4e4b\u524d\uff0c\u5b83\u5c06\u5fd9\u4e8e\u5c06\u5185\u5bb9\u7f13\u6162\u5730\uff0810\u79d2\uff09\u53d1\u9001\u5230\u5ba2\u6237\u7aef\u3002\u5047\u8bbe\u67091000\u4e2a\u540c\u65f6\u8fde\u63a5\u7684\u5ba2\u6237\uff0c\u4ed6\u4eec\u5462\u8bf7\u6c42\u4e86\u7c7b\u4f3c\u7684\u5185\u5bb9\u3002\u82e5\u6bcf\u4e2a\u5ba2\u6237\u7aef\u5206\u914d1MB\u7684\u989d\u5916\u5185\u5b58\uff0c\u5219\u4f1a\u4ea7\u751f1000 MB\uff08\u7ea61 GB\uff09\u7684\u989d\u5916\u5185\u5b58\uff0c\u4e13\u95e8\u7528\u4e8e\u4e3a1000\u4e2a\u7528\u6237\u7aef\u63d0\u4f9b100 KB\u7684\u5185\u5bb9\u3002\u5b9e\u9645\u4e0a\uff0c\u57fa\u4e8eApache\u7684\u5178\u578bWeb\u670d\u52a1\u5668\u901a\u5e38\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u5206\u914d\u8d85\u8fc71 MB\u7684\u989d\u5916\u5185\u5b58\uff0c\u4ee4\u4eba\u9057\u61be\u7684\u662f\uff0c\u6570\u5341kbps\u4ecd\u7136\u662f\u79fb\u52a8\u901a\u4fe1\u7684\u6709\u6548\u901f\u5ea6\u3002\u867d\u7136\u5728\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u901a\u8fc7\u589e\u52a0\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838socket\u7f13\u51b2\u533a\u5927\u5c0f\u6765\u6539\u5584\u5411\u6162\u901f\u5ba2\u6237\u7aef\u53d1\u9001\u5185\u61c2\u7684\u60c5\u51b5\uff0c\u4f46\u8fd9\u4e0d\u662f\u89e3\u51b3\u8be5\u95ee\u9898\u7684\u4e00\u822c\u529e\u6cd5\uff0c\u5e76\u4e14\u53ef\u80fd\u5177\u6709\u4e0d\u826f\u526f\u4f5c\u7528\u3002</p> <p>\u4e3a\u4e86\u907f\u514d\u5efa\u7acb\u65b0HTTP\u8fde\u63a5\u7684\u5ef6\u65f6\uff0c\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef\u4fdd\u6301\u8fde\u63a5\uff08persistent connection\uff09\uff0c\u5e76\u53d1\u5904\u7406\u7684\u95ee\u9898\u66f4\u52a0\u660e\u663e\uff0cWeb\u670d\u52a1\u5668\u4e3a\u6bcf\u4e2a\u5df2\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\u5206\u914d\u4e00\u5b9a\u6570\u91cf\u7684\u5185\u5b58\u3002</p> <p>\u56e0\u6b64\uff0c\u4e3a\u4e86\u5904\u7406\u4e0e\u589e\u957f\u7684\u53d7\u4f17\u76f8\u5173\u7684\u589e\u52a0\u7684\u5de5\u4f5c\u91cf\u4ee5\u53ca\u56e0\u6b64\u66f4\u9ad8\u7684\u5e76\u53d1\u6c34\u5e73\u2014\u2014\u5e76\u4e14\u80fd\u591f\u6301\u7eed\u8fd9\u6837\u505a\u2014\u2014\u7f51\u7ad9\u5e94\u8be5\u57fa\u4e8e\u8bb8\u591a\u975e\u5e38\u6709\u6548\u7684\u6784\u5efa\u5757\uff08building block\uff09\u3002\u786c\u4ef6\uff08CPU\u3001\u5185\u5b58\u3001\u78c1\u76d8\u7b49\uff09\u3001\u7f51\u7edc\u80fd\u529b\u3001\u6570\u636e\u5b58\u50a8\u67b6\u6784\u663e\u7136\u4e0eWeb\u670d\u52a1\u5668\u63a5\u53d7\u548c\u5904\u7406\u5ba2\u6237\u7aef\u8fde\u63a5\u540c\u7b49\u91cd\u8981\u3002\u56e0\u6b64\uff0cWeb\u670d\u52a1\u5668\u5e94\u8be5\u80fd\u591f\u968f\u7740\u5e76\u53d1\u8fde\u63a5\u548c\u8bf7\u6c42\u6570\u91cf\u7684\u589e\u52a0\u800c\u975e\u7ebf\u6027\u5730\u62d3\u5c55\u3002</p>"},{"location":"2019-01-31-nginx%E6%9E%B6%E6%9E%84/#apache","title":"Apache\u4e0d\u5408\u9002\u5417\uff1f","text":"<p>Apache\u8fd9\u6b3eweb\u670d\u52a1\u5668\u7a0b\u5e8f\u5728\u5f88\u5927\u7a0b\u5ea6\u4e0a\u4ecd\u7136\u4e3b\u5bb0\u7740\u4e92\u8054\u7f51\uff0c\u5b83\u8d77\u6e90\u4e8e20\u4e16\u7eaa90\u5e74\u4ee3\u521d\u3002\u6700\u521d\uff0c\u5b83\u7684\u67b6\u6784\u4e0e\u5f53\u65f6\u5b58\u5728\u7684\u64cd\u4f5c\u7cfb\u7edf\u548c\u786c\u4ef6\u76f8\u5339\u914d\uff0c\u5176\u4e2d\u7f51\u7ad9\u901a\u5e38\u662f\u8fd0\u884c\u5355\u4e2aApache\u5b9e\u4f8b\u7684\u72ec\u7acb\u7269\u7406\u670d\u52a1\u5668\u30022000\u5e74\u4ee3\u521d\uff0c\u8f7b\u677e\u590d\u5236\u72ec\u7acb\u7684Web\u670d\u52a1\u5668\u6a21\u578b\u663e\u7136\u4e0d\u8db3\u4ee5\u6ee1\u8db3\u4e0d\u65ad\u589e\u957f\u7684Web\u670d\u52a1\u9700\u6c42\u3002\u5c3d\u7ba1Apache\u4e3a\u672a\u6765\u7684\u5f00\u53d1\u63d0\u4f9b\u4e86\u575a\u5b9e\u7684\u57fa\u7840\uff0c\u4f46\u5b83\u7684\u67b6\u6784\u662f\u4e3a\u6bcf\u4e2a\u65b0\u8fde\u63a5\u751f\u6210\u81ea\u5df1\u7684\u526f\u672c\uff0c\u8fd9\u4e0d\u9002\u5408\u7f51\u7ad9\u7684\u975e\u7ebf\u6027\u53ef\u4f38\u7f29\u6027\u3002\u6700\u7ec8\uff0cApache\u6210\u4e3a\u4e86\u4e00\u4e2a\u901a\u7528\u7684Web\u670d\u52a1\u5668\uff0c\u4e13\u6ce8\u4e8e\u62e5\u6709\u8bb8\u591a\u4e0d\u540c\u7684\u529f\u80fd\uff0c\u5404\u79cd\u7b2c\u4e09\u65b9\u62d3\u5c55\uff0c\u4ee5\u53ca\u51e0\u4e4e\u4efb\u4f55\u7c7b\u578bWeb\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u7684\u666e\u904d\u9002\u7528\u6027\u3002\u7136\u540e\uff0c\u6ca1\u6709\u4efb\u4f55\u4ee3\u4ef7\u5730\u5728\u5355\u4e2a\u8f6f\u4ef6\u4e2d\u62e5\u6709\u5982\u6b64\u4e30\u5bcc\u548c\u901a\u7528\u7684\u5de5\u5177\u7ec4\u5408\u7684\u7f3a\u70b9\u662f\u53ef\u4f38\u7f29\u6027\u8f83\u5dee\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u90fd\u4f1a\u589e\u52a0CPU\u548c\u5185\u5b58\u7684\u4f7f\u7528\u91cf\u3002</p> <p>\u56e0\u6b64\uff0c\u5f53\u670d\u52a1\u5668\u786c\u4ef6\u3001\u64cd\u4f5c\u7cfb\u7edf\u548c\u7f51\u7edc\u8d44\u6e90\u4e0d\u518d\u6210\u4e3a\u7f51\u7ad9\u589e\u52a0\u7684\u4e3b\u8981\u9650\u5236\u65f6\uff0c\u5168\u7403\u7684Web\u5f00\u53d1\u4eba\u5458\u5f00\u59cb\u5bfb\u627e\u66f4\u6709\u6548\u7684\u8fd0\u884cWeb\u670d\u52a1\u5668\u7684\u65b9\u6cd5\u3002\u5927\u7ea6\u5341\u5e74\u524d\uff0c\u8457\u540d\u8f6f\u4ef6\u5de5\u7a0b\u5e08Daniel Kegel\u5ba3\u79f0\uff1a<code>Web\u670d\u52a1\u5668\u662f\u65f6\u5019\u540c\u65f6\u5904\u7406\u4e00\u4e07\u4e2a\u5ba2\u6237\u7aef\u7684\u65f6\u5019\u4e86</code>\uff0c\u5e76\u9884\u6d4b\u4e86\u6211\u4eec\u73b0\u5728\u6240\u8c13<code>\u4e92\u8054\u7f51\u4e91\u670d\u52a1</code>\u7684\u4e1c\u897f\u3002Kegel\u7684C10K\u6e05\u5355\u6fc0\u53d1\u4e86\u8bb8\u591a\u5c1d\u8bd5\u6765\u89e3\u51b3Web\u670d\u52a1\u5668\u4f18\u5316\u95ee\u9898\uff0c\u540c\u65f6\u5904\u7406\u5927\u91cf\u5ba2\u6237\u7aef\uff0c\u800cnginx\u6210\u4e3a\u6700\u6210\u529f\u7684\u4e4b\u4e00\u3002</p> <p>\u65e8\u5728\u89e3\u51b310,000\u4e2a\u540c\u65f6\u8fde\u63a5\u7684C10K\u95ee\u9898\uff0cnginx\u5728\u7f16\u5199\u65f6\u8003\u8651\u4e86\u4e0d\u540c\u7684\u4f53\u7cfb\u7ed3\u6784\u2014\u2014\u4e00\u4e2a\u66f4\u9002\u5408\u5e76\u53d1\u8fde\u63a5\u6570\u548c\u6bcf\u79d2\u8bf7\u6c42\u6570\u7684\u975e\u7ebf\u6027\u53ef\u4f38\u7f29\u6027\u3002nginx\u662f\u57fa\u4e8e\u4e8b\u4ef6\u7684\uff08event-based\uff09\uff0c\u5e76\u4e0d\u9075\u5faaApache\u4e3a\u6bcf\u4e2a\u7f51\u9875\u8bf7\u6c42\u751f\u6210\u65b0\u8fdb\u7a0b\u6216\u7ebf\u7a0b\u7684\u98ce\u683c\uff0c\u4ee5\u5b9e\u73b0\u5373\u4f7f\u8d1f\u8f7d\u589e\u52a0\uff0cCPU\u548c\u5185\u5b58\u9002\u7528\u4ecd\u7136\u53ef\u63a7\u3002nginx\u73b0\u5728\u53ef\u4ee5\u5728\u4e00\u53f0\u5178\u578b\u4e3b\u673a\u4e0a\u5904\u7406\u6570\u4e07\u4e2a\u5e76\u53d1\u8fde\u63a5\u3002</p> <p>nginx\u9996\u4e2a\u7248\u672c\u53d1\u5e03\u65f6\uff0c\u4f5c\u4e3a\u9759\u6001\u5185\u5bb9\uff08\u5982HTML\u3001CSS\u3001JavaScript\u548c\u56fe\u7247\uff09\u670d\u52a1\u5668\u4e0eApache\u4e00\u8d77\u90e8\u7f72\uff0c\u5206\u62c5\u57fa\u4e8eApache\u7684\u5e94\u7528\u670d\u52a1\u5668\u7684\u5e76\u53d1\u548c\u5ef6\u65f6\u3002\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0cnginx\u901a\u8fc7\u9002\u7528FastCGI\uff0cuSWGI\u6216SCGI\u534f\u8bae\u4ee5\u53ca\u5206\u5e03\u5f0f\u5185\u5b58\u5bf9\u8c61\u7f13\u5b58\u7cfb\u7edf\uff08\u5982memcached\uff09\u589e\u52a0\u4e86\u4e0e\u5e94\u7528\u7a0b\u5e8f\u7684\u96c6\u6210\uff0c\u5176\u4ed6\u6709\u7528\u7684\u529f\u80fd\u4e5f\u88ab\u5f00\u53d1\u51fa\u6765\uff0c\u5982\u5177\u6709\u8d1f\u8f7d\u5747\u8861\u548c\u7f13\u5b58\u53cd\u5411\u4ee3\u7406\uff08reverse proxy\uff09\u7b49\u7b49\u3002\u8fd9\u4e9b\u9644\u52a0\u529f\u80fd\u4f7fnginx\u6210\u4e3a\u6709\u6548\u7684\u5de5\u5177\u7ec4\u5408\uff0c\u53ef\u6784\u5efa\u53ef\u62d3\u5c55\u7684Web\u57fa\u7840\u67b6\u6784\u3002</p> <p>2012\u5e742\u6708\uff0cApache 2.4.x\u5206\u652f\u516c\u5f00\u53d1\u5e03\uff0c\u5c3d\u7ba1\u5176\u6700\u65b0\u7248\u672c\u6dfb\u52a0\u4e86\u65b0\u7684\u591a\u5904\u7406\u6838\u5fc3\u6a21\u5757\uff0c\u4ee5\u53ca\u65b0\u7684\u6307\u5411\u589e\u5f3a\u53ef\u4f38\u7f29\u6027\u548c\u6027\u80fd\u7684\u4ee3\u7406\u6a21\u5757\uff0c\u73b0\u5728\u8c08\u8bba\u5b83\u4e0e\u7eaf\u4e8b\u4ef6\u9a71\u52a8\u7684Web\u670d\u52a1\u5668\u8c01\u5728\u6027\u80fd\u3001\u5e76\u53d1\u548c\u8d44\u6e90\u5229\u7528\u7b49\u65b9\u9762\u66f4\u597d\u8fd8\u4e3a\u65f6\u5c1a\u65e9\u3002\u975e\u5e38\u9ad8\u5174\u80fd\u770b\u5230Apache\u5e94\u7528\u670d\u52a1\u5668\u4f38\u7f29\u6027\u80fd\u66f4\u597d\uff0c\u4e0d\u8fc7\uff0c\u53ef\u80fd\u7f13\u89e3\u5728\u5178\u578bnginx\u52a0Apache\u7684Web\u914d\u7f6e\u4e2d\u4ecd\u7136\u6ca1\u89e3\u51b3\u7684\u95ee\u9898\u3002</p>"},{"location":"2019-01-31-nginx%E6%9E%B6%E6%9E%84/#nginx","title":"\u4f7f\u7528nginx\u6709\u66f4\u591a\u7684\u4f18\u52bf\u5417\uff1f","text":"<p>\u4ee5\u9ad8\u6027\u80fd\u548c\u9ad8\u6548\u7387\u5904\u7406\u9ad8\u5e76\u53d1\u59cb\u7ec8\u662f\u90e8\u7f72nginx\u7684\u5173\u952e\u4f18\u52bf\uff0c\u4f46\u73b0\u5728\u6709\u66f4\u591a\u6709\u8da3\u7684\u597d\u5904\u3002</p> <p>\u5728\u6700\u8fd1\u51e0\u5e74\uff0cWeb\u67b6\u6784\u5e08\u5df2\u7ecf\u63a5\u53d7\u4e86\u5c06\u5176\u5e94\u7528\u7a0b\u5e8f\u57fa\u7840\u8bbe\u65bd\u4e0eWeb\u670d\u52a1\u5668\u89e3\u8026\u548c\u5206\u79bb\u7684\u60f3\u6cd5\u3002\u7136\u800c\uff0c\u4ee5\u524d\u4ee5LAMP\uff08Linux\uff0cApache\uff0cMySQL\uff0cPHP\uff0cPython\u6216Perl\uff09\u4e3a\u57fa\u7840\u7684\u7f51\u7ad9\u5f62\u5f0f\uff0c\u73b0\u5728\u53ef\u80fd\u4e0d\u4ec5\u4ec5\u662f\u4e00\u4e2a\u57fa\u4e8eLEMP\u7684\uff08E'\u4ee3\u8868'Engine x'\uff09\u4f46\u662f\uff0c\u8d8a\u6765\u8d8a\u591a\u7684\u505a\u6cd5\u662f\u5c06Web\u670d\u52a1\u5668\u63a8\u5411\u57fa\u7840\u8bbe\u65bd\u7684\u8fb9\u7f18\uff0c\u5e76\u4ee5\u4e0d\u540c\u7684\u65b9\u5f0f\u56f4\u7ed5\u5b83\u96c6\u6210\u76f8\u540c\u6216\u7ecf\u8fc7\u6539\u8fdb\u7684\u5e94\u7528\u7a0b\u5e8f\u548c\u6570\u636e\u5e93\u5de5\u5177\u96c6\u3002</p> <p>nginx\u5f88\u9002\u5408\u8fd9\u4e9b\uff0c\u56e0\u4e3a\u5b83\u63d0\u4f9b\u4e86\u65b9\u4fbf\u5904\u7406\u5e76\u53d1\u3001\u5ef6\u8fdf\uff0cSSL\uff0c\u9759\u6001\u5185\u5bb9\uff0c\u538b\u7f29\u548c\u7f13\u5b58\uff0c\u8fde\u63a5\u548c\u8bf7\u6c42\u9650\u5236\uff0c\u751a\u81f3\u6765\u81ea\u5e94\u7528\u7a0b\u5e8f\u7684HTTP\u5a92\u4f53\u6d41\u6240\u9700\u7684\u5173\u952e\u529f\u80fd\u5c42\u5230\u66f4\u6709\u6548\u7684\u8fb9\u7f18Web\u670d\u52a1\u5668\u5c42\uff0c\u5b83\u8fd8\u5141\u8bb8\u76f4\u63a5\u4e0ememcached / Redis\u6216\u5176\u4ed6\u201cNoSQL\u201d\u89e3\u51b3\u65b9\u6848\u96c6\u6210\uff0c\u4ee5\u5728\u4e3a\u5927\u91cf\u5e76\u53d1\u7528\u6237\u63d0\u4f9b\u670d\u52a1\u65f6\u63d0\u9ad8\u6027\u80fd\u3002</p> <p>nginx\u4ee3\u7801\u5e93\u662f\u539f\u521b\u7684\uff0c\u5b8c\u5168\u662f\u7528C\u7f16\u7a0b\u8bed\u8a00\u4ece\u5934\u5f00\u59cb\u7f16\u5199\u7684\u3002 nginx\u5df2\u7ecf\u79fb\u690d\u5230\u8bb8\u591a\u67b6\u6784\u548c\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5305\u62ecLinux\uff0cFreeBSD\uff0cSolaris\uff0cMac OS X\uff0cAIX\u548cMicrosoft Windows\u3002 nginx\u6709\u81ea\u5df1\u7684\u5e93\uff0c\u5176\u6807\u51c6\u6a21\u5757\u9664\u4e86zlib\uff0cPCRE\u548cOpenSSL\u4e4b\u5916\u4e0d\u4f1a\u8d85\u51fa\u7cfb\u7edf\u7684C\u5e93\uff0czlib\uff0cPCRE\u548cOpenSSL\u53ef\u4ee5\u9009\u62e9\u4ece\u6784\u5efa\u4e2d\u6392\u9664\uff0c\u5982\u679c\u4e0d\u9700\u8981\u6216\u8005\u7531\u4e8e\u6f5c\u5728\u7684\u8bb8\u53ef\u8bc1\u51b2\u7a81\u3002</p> <p>\u5173\u4e8eWindows\u7248nginx\u7684\u51e0\u53e5\u8bdd\u3002\u867d\u7136nginx\u9002\u7528\u4e8eWindows\u73af\u5883\uff0c\u4f46nginx\u7684Windows\u7248\u672c\u66f4\u50cf\u662f\u6982\u5ff5\u9a8c\u8bc1\uff08proof-of-concept\uff09\u800c\u4e0d\u662f\u529f\u80fd\u9f50\u5168\u7684\u79fb\u690d\u3002nginx\u548cWindows\u5185\u6838\u67b6\u6784\u5b58\u5728\u67d0\u4e9b\u9650\u5236\uff0c\u76ee\u524d\u8fd9\u4e9b\u67b6\u6784\u4e0d\u80fd\u5f88\u597d\u5730\u4ea4\u4e92\u3002Windows\u7684nginx\u7248\u672c\u7684\u5df2\u77e5\u95ee\u9898\u5305\u62ec\u5e76\u53d1\u8fde\u63a5\u6570\u91cf\u5c11\u5f97\u591a\uff0c\u6027\u80fd\u4e0b\u964d\uff0c\u6ca1\u6709\u7f13\u5b58\u4ee5\u53ca\u6ca1\u6709\u5e26\u5bbd\u76d1\u7ba1\u3002\u9762\u5411Windows\u7684nginx\u7684\u672a\u6765\u7248\u672c\u5c06\u66f4\u7d27\u5bc6\u5730\u5339\u914d\u4e3b\u6d41\u529f\u80fd\u3002</p>"},{"location":"2019-01-31-nginx%E6%9E%B6%E6%9E%84/#nginx_1","title":"nginx\u67b6\u6784\u6982\u8ff0","text":"<p>\u5904\u7406\u5e76\u53d1\u8fde\u63a5\u7684\u4f20\u7edf\u57fa\u4e8e\u8fdb\u7a0b\uff08\u6216\u7ebf\u7a0b\uff09\u7684\u6a21\u578b\u8bbe\u8ba1\u9002\u7528\u5355\u72ec\u7684\u8fdb\u7a0b\uff08\u6216\u7ebf\u7a0b\uff09\u5904\u7406\u6bcf\u4e2a\u8fde\u63a5\uff0c\u4ee5\u53ca\u963b\u585e\u7f51\u7edc\u8f93\u5165/\u8f93\u51fa\u3002\u6839\u636e\u5e94\u7528\u7a0b\u5e8f\u7684\u4e0d\u540c\uff0c\u5185\u5b58\u548cCPU\u6d88\u8017\u53ef\u80fd\u975e\u5e38\u4f4e\u6548\u3002\u751f\u6210\u4e00\u4e2a\u5355\u72ec\u7684\u8fdb\u7a0b\uff08\u6216\u7ebf\u7a0b\uff09\u9700\u8981\u51c6\u5907\u4e00\u4e2a\u65b0\u7684\u8fd0\u884c\u65f6\u73af\u5883\uff0c\u5305\u542b\u5206\u914d\u5806\u548c\u6808\u5185\u5b58\uff0c\u4ee5\u53ca\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6267\u884c\u4e0a\u4e0b\u6587\u3002\u521b\u5efa\u8fd9\u4e9b\u9879\u76ee\u4f1a\u8bdd\u8d39\u989d\u5916\u7684CPU\u65f6\u95f4\uff0c\u7531\u4e8e\u8fc7\u591a\u7684\u4e0a\u4e0b\u6587\u5207\u6362\uff08excessive context switching\uff09\u5bfc\u81f4\u7ebf\u7a0b\u6296\u52a8\uff08thread thrashing\uff09\uff0c\u6700\u7ec8\u4f1a\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u3002\u6240\u6709\u8fd9\u4e9b\u590d\u6742\u6027\u90fd\u8868\u73b0\u5728\u50cfApache\u8fd9\u6837\u7684\u8001\u5f0fWeb\u670d\u52a1\u5668\u67b6\u6784\u4e2d\u3002\u8fd9\u662f\u5728\u63d0\u4f9b\u4e30\u5bcc\u7684\u901a\u7528\u9002\u7528\u529f\u80fd\u548c\u4f18\u5316\u670d\u52a1\u5668\u8d44\u6e90\u9002\u7528\u4e4b\u95f4\u7684\u6743\u8861\u3002</p> <p>\u4ece\u4e00\u5f00\u59cb\uff0cnginx\u5c31\u662f\u4e00\u79cd\u4e13\u4e1a\u5de5\u5177\uff0c\u53ef\u4ee5\u5b9e\u73b0\u66f4\u9ad8\u7684\u6027\u80fd\u3001\u5bc6\u5ea6\u548c\u7ecf\u6d4e\u90fd\u9002\u7528\u670d\u52a1\u5668\u8d44\u6e90\uff0c\u540c\u65f6\u5b9e\u73b0\u7f51\u7ad9\u7684\u52a8\u6001\u589e\u957f\uff0c\u56e0\u6b64\u5b83\u9075\u5faa\u4e0d\u540c\u7684\u6a21\u5f0f\u3002\u5b9e\u9645\u4e0a\uff0c\u5b83\u53d7\u5230\u5404\u79cd\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u57fa\u4e8e\u4e8b\u4ef6\u7684\u9ad8\u7ea7\u673a\u5236\u6301\u7eed\u5f00\u53d1\u7684\u542f\u53d1\u3002\u7ed3\u679c\u662f\u6a21\u5757\u5316\uff0c\u4e8b\u4ef6\u9a71\u52a8\uff0c\u5f02\u6b65\uff0c\u5355\u7ebf\u7a0b\uff08single-threaded\uff09\uff0c\u975e\u963b\u585e\u67b6\u6784\uff08non-blocking architecture\uff09\uff0c\u5b83\u6210\u4e3anginx\u4ee3\u7801\u7684\u57fa\u7840\u3002</p> <p>nginx\u5927\u91cf\u4f7f\u7528\u591a\u8def\u590d\u7528\uff08multiplexing\uff09\u548c\u4e8b\u4ef6\u901a\u77e5\uff0c\u5e76\u5c06\u7279\u5b9a\u4efb\u52a1\u7531\u5355\u72ec\u7684\u8fdb\u7a0b\u5904\u7406\u3002\u8fde\u63a5\u5728\u4e00\u4e2a\u540d\u4e3a<code>workers</code>\u7684\u6709\u9650\u6570\u91cf\u7684\u4f46\u7ebf\u7a0b\u8fdb\u7a0b\u4e2d\u4ee5\u9ad8\u6548\u7684\u8fd0\u884c\u5faa\u73af\uff08run-loop\uff09\u8fdb\u884c\u5904\u7406\u3002\u5728\u6bcf\u4e2a<code>worker</code>\u4e2d\uff0cnginx\u53ef\u4ee5\u5904\u7406\u6570\u5343\u4e2a\u5e76\u53d1\u8fde\u63a5\u548c\u8bf7\u6c42\u3002</p>"},{"location":"2019-01-31-nginx%E6%9E%B6%E6%9E%84/#_1","title":"\u4ee3\u7801\u7ed3\u6784","text":"<p>nginx worker\u4ee3\u7801\u5305\u542b\u6838\u5fc3\u548c\u529f\u80fd\u6a21\u5757\uff08module\uff09\u3002nginx\u7684\u6838\u5fc3\u662f\u8d1f\u8d23\u7ef4\u62a4\u4e00\u4e2a\u7d27\u5bc6\u8fd0\u884c\u5faa\u73af\uff0c\u5e76\u5728\u6bcf\u4e2a\u8bf7\u6c42\u5904\u7406\u9636\u6bb5\uff08stage\uff09\u6267\u884c\u6a21\u5757\u4ee3\u7801\u7684\u9002\u5f53\u90e8\u5206\u3002\u6a21\u5757\u6784\u6210\u4e86\u5927\u90e8\u5206\u8868\u793a\u548c\u5e94\u7528\u7a0b\u5e8f\u5c42\u529f\u80fd\u3002\u6a21\u5757\u8bfb\u53d6\u548c\u5199\u5165\u7f51\u7edc\u548c\u5b58\u50a8\uff0c\u8f6c\u6362\u5185\u5bb9\uff0c\u6267\u884c\u51fa\u7ad9\u8fc7\u6ee4\uff0c\u5e94\u7528\u670d\u52a1\u5668\u7aef\u5305\u542b\u5305\u542b\u64cd\u4f5c\u3001\u5e76\u5728\u4ee3\u7406\u88ab\u542f\u7528\u4f7f\u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9\u4e0a\u6e38\uff08upstream\uff09\u670d\u52a1\u5668\u3002</p> <p>nginx\u7684\u6a21\u5757\u5316\u67b6\u6784\u901a\u5e38\u5141\u8bb8\u5f00\u53d1\u4eba\u5458\u5728\u4e0d\u4fee\u6539nginx\u6838\u5fc3\u7684\u60c5\u51b5\u4e0b\u62d3\u5c55Web\u670d\u52a1\u5668\u529f\u80fd\u96c6\u3002ngin\u6a21\u5757\u95f4\u5b58\u5728\u533a\u522b\uff0c\u4ea6\u5373\u6838\u5fc3\u6a21\u5757\u3001\u4e8b\u4ef6\u6a21\u5757\u3001\u9636\u6bb5\u5904\u7406\u5668\u3001\u534f\u8bae\u3001\u53d8\u91cf\u5904\u7406\u5668\u3001\u8fc7\u6ee4\u5668\u3001\u4e0a\u6e38\u548c\u8d1f\u8f7d\u5747\u8861\u5668\u3002\u76ee\u524d\uff0cnginx\u4e0d\u652f\u6301\u52a8\u6001\u52a0\u8f7d\u7684\uff08dynamically loaded\uff09\u6a21\u5757\uff0c\u5373\u6a21\u5757\u5728\u6784\u5efa\u9636\u6bb5\u4e0e\u6838\u5fc3\u4e00\u8d77\u7f16\u8bd1\u3002\u4f46\u662f\uff0c\u8ba1\u5212\u5728\u672a\u6765\u7684\u4e3b\u8981\uff08major\uff09\u7248\u672c\u4e2d\u652f\u6301\u53ef\u52a0\u8f7d\u6a21\u5757\u548cABI\u3002\u5173\u4e8e\u4e0d\u7528\u6a21\u5757\u89d2\u8272\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u7b2c14.4\u8282\u3002</p> <p>\u4e00\u4e2anginx\u67b6\u6784\u9ad8\u7ea7\u7684\u6982\u8ff0\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"2019-01-31-nginx%E6%9E%B6%E6%9E%84/#worker","title":"Worker\u6a21\u578b","text":"<p>\u5982\u524d\u6240\u8ff0\uff0cnginx\u4e0d\u4f1a\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u751f\u6210\u8fdb\u7a0b\uff08\u6216\u7ebf\u7a0b\uff09\u3002\u76f8\u53cd\uff0cworker\u8fdb\u7a0b\u63a5\u53d7\u6765\u81ea\u5171\u4eab\u4fa6\u542csocket\u7684\u65b0\u8bf7\u6c42\uff0c\u5e76\u5728\u6bcf\u4e2aworker\u5185\u6267\u884c\u9ad8\u6548\u7684\u8fd0\u884c\u5faa\u73af\uff0c\u4ee5\u5904\u7406\u6bcf\u4e2aworker\u7684\u6570\u5343\u4e2a\u8fde\u63a5\u3002nginx\u4e0d\u542b\u6709worker\u4e13\u95e8\u7684\u4ef2\u88c1\uff08arbitration\uff09\u6216\u5206\u914d\uff0c\u8fd9\u9879\u5de5\u4f5c\u7531OS\u5185\u6838\u673a\u5236\u5b8c\u6210\u3002\u542f\u52a8\u65f6\uff0c\u4e00\u7ec4\u521d\u59cb\u4fa6\u542csocket\uff0c\u7136\u540eworker\u5728\u5904\u7406HTTP\u8bf7\u6c42\u548c\u54cd\u5e94\u4e0d\u65adaccept\u3001\u8bfb\u53d6\u548c\u5199\u5165socket\u3002</p> <p>\u8fd0\u884c\u5faa\u73af\uff08run-loop\uff09\u662fworker\u4ee3\u7801\u4e2d\u6700\u590d\u6742\u7684\u90e8\u5206\u3002\u5b83\u5305\u62ec\u5168\u9762\u7684\u5185\u90e8\u8c03\u7528\uff0c\u5e76\u4e14\u5f88\u5927\u7a0b\u5ea6\u4f9d\u8d56\u4e8e\u5f02\u6b65\u4efb\u52a1\u5904\u7406\uff08synchronous task handing\uff09\u7684idea\u3002\u5f02\u6b65\u64cd\u4f5c\u901a\u8fc7\u6a21\u5757\u5316\uff08modularity\uff09\u3001\u4e8b\u4ef6\u901a\u77e5\uff08event notification\uff09\u3001\u56de\u8c03\u51fd\u6570\u7684\u5e7f\u6cdb\u4f7f\u7528\u548c\u5fae\u8c03\u5b9a\u65f6\u5668\uff08fine-tuned\uff09\u6765\u5b9e\u73b0\u3002\u603b\u7684\u6765\u8bf4\uff0c\u5173\u952e\u539f\u5219\u662f\u5c3d\u53ef\u80fd<code>non-blocking</code>\u3002nginx\u4ecd\u7136\u53ef\u4ee5\u963b\u585e\u7684\u60c5\u51b5\u662f\u5f53worker\u8fdb\u7a0b\u6ca1\u6709\u8db3\u591f\u7684\u78c1\u76d8\u5b58\u50a8\u6027\u80fd\u65f6\u3002</p> <p>\u56e0\u4e3anginx\u4e0d\u4f1a\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u590d\u5236\uff08fork\uff09\u8fdb\u7a0b\uff08\u6216\u7ebf\u7a0b\uff09\uff0c\u6240\u4ee5\u5728\u7edd\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u5185\u5b58\u4f7f\u7528\u975e\u5e38\u4fdd\u5b88\uff08conservative\uff09\u548c\u9ad8\u6548\u3002nginx\u4e5f\u5c3d\u91cf\u8282\u7701CPU\u5468\u671f\uff0c\u56e0\u4e3a\u8fdb\u7a0b\uff08\u6216\u7ebf\u7a0b\uff09\u6ca1\u6709\u6b63\u5728\u8fdb\u884c\u7684\u201c\u521b\u5efa\u2014\u9500\u6bc1\u201d\u6a21\u5f0f\u3002nginx\u505a\u7684\u662f\u68c0\u67e5\u7f51\u7edc\u548c\u5b58\u50a8\u7684\u72b6\u6001\uff0c\u521d\u59cb\u5316\u65b0\u8fde\u63a5\uff0c\u5c06\u5b83\u4eec\u6dfb\u52a0\u5230\u8fd0\u884c\u5faa\u73af\uff0c\u5e76\u5f02\u6b65\u5904\u7406\u76f4\u81f3\u5b8c\u6210\uff0c\u8fd9\u662f\u8fde\u63a5\u88ab\u89e3\u9664\u5206\u914d\u5e76\u4ece\u8fd0\u884c\u5faa\u73af\u4e2d\u5220\u9664\u3002\u7ed3\u5408\u7ec6\u5fc3\u4f7f\u7528\u7cfb\u7edf\u8c03\u7528\u548c\u7cbe\u786e\u5b9e\u73b0\u652f\u6301\u63a5\u53e3\uff0c\u5982\u6c60\u548c\u677f\u5185\u5b58\u5206\u914d\u5668\uff08slab memory allocator\uff09\uff0c\u5373\u4f7f\u5728\u6781\u7aef\u5de5\u4f5c\u8d1f\u8f7d\u4e0b\uff0cngixn\u901a\u5e38\u4e5f\u53ef\u5b9e\u73b0\u201c\u4e2d\u5230\u4f4e\u201d\u7684CPU\u4f7f\u7528\u7387\u3002</p> <p>\u56e0\u4e3anginx\u4f1a\u4ea7\u751f\u51e0\u4e2aworker\u5904\u7406\u8fde\u63a5\uff0c\u6240\u4ee5\u53ef\u4ee5\u8de8\u591a\u4e2a<code>CPU\u6838\u5fc3</code>\u5f88\u597d\u5730\u4f38\u7f29\u3002\u901a\u5e38\uff0c\u6bcf\u4e2aCPU\u6838\u5fc3\u7684\u5355\u72ecworker\u5141\u8bb8\u5145\u5206\u5229\u7528<code>\u591a\u6838\u67b6\u6784</code>\uff0c\u5e76\u9632\u6b62<code>\u7ebf\u7a0b\u6296\u52a8</code>\u548c<code>\u9501\u5b9a</code>\u3002\u5728\u5355\u7ebf\u7a0bworker\u8fdb\u7a0b\u4e2d\uff0c\u6ca1\u6709\u8d44\u6e90\u532e\u4e4f\uff0c\u8d44\u6e90\u63a7\u5236\u673a\u5236\u662f\u72ec\u7acb\uff08isolated\uff09\u7684\u3002\u6b64\u6a21\u578b\u8fd8\u5141\u8bb8\u8de8\u7269\u7406\u5b58\u50a8\u8bbe\u5907\u5b9e\u73b0\u66f4\u9ad8\u7684\u53ef\u4f38\u7f29\u6027\uff0c\u6709\u52a9\u4e8e\u63d0\u9ad8\u78c1\u76d8\u5229\u7528\u7387\u5e76\u907f\u514d\u963b\u585e<code>\u78c1\u76d8I/O</code>\u3002\u56e0\u6b64\uff0c\u5728\u591a\u4e2aworker\u5171\u4eab\u5de5\u4f5c\u8d1f\u8f7d\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u66f4\u6709\u6548\u5730\u5229\u7528\u670d\u52a1\u5668\u8d44\u6e90\u3002</p> <p>\u5bf9\u4e8e\u4e00\u4e9b\u78c1\u76d8\u4f7f\u7528\u548cCPU\u8d1f\u8f7d\u6a21\u5f0f\uff0c\u5e94\u8be5\u8c03\u6574worker\u7684\u6570\u91cf\uff0c\u8fd9\u4e2a\u89c4\u5219\u662f\u57fa\u7840\u7684\uff0c\u7cfb\u7edf\u7ba1\u7406\u5458\u5e94\u8be5\u4e3a\u4ed6\u4eec\u7684\u5de5\u4f5c\u8d1f\u8f7d\u5c1d\u8bd5\u51e0\u79cd\u914d\u7f6e\u3002\u4e00\u822c\u5efa\u8bae\u53ef\u80fd\u5982\u4e0b\uff1a</p> <ul> <li> <p>\u82e5\u8d1f\u8f7d\u662fCPU\u5bc6\u96c6\u578b\u2014\u2014\u4f8b\u5982\uff0c\u5904\u7406\u5927\u91cfTCP/IP\uff0c\u6267\u884cSSL\u6216\u538b\u7f29\u2014\u2014worker\u6570\u91cf\u5e94\u4e0eCPU\u6838\u5fc3\u6570\u5339\u914d\u3002</p> </li> <li> <p>\u82e5\u8d1f\u8f7d\u662fI/O\u5bc6\u96c6\u578b\u2014\u2014\u4f8b\u5982\uff0c\u670d\u52a1\u5b58\u50a8\u4e2d\u7684\u4e0d\u5bb9\u5185\u5bb9\u96c6\uff08\u6587\u4ef6\u670d\u52a1\u5668\uff09\u6216\u8005\u7e41\u91cd\u7684\u4ee3\u7406\u2014\u2014worker\u6570\u91cf\u53ef\u80fd\u662fCPU\u6838\u578b\u6570\u91cf\u76841.5\u52302\u500d\u3002</p> </li> </ul> <p>\u4e00\u4e9b\u5de5\u7a0b\u5e08\u6839\u636e\u5355\u4e2a\u5b58\u50a8\u5355\u5143\u7684\u6570\u91cf\u6765\u9009\u62e9worker\u6570\u91cf\uff0c\u4f46\u8fd9\u79cd\u65b9\u6cd5\u7684\u6548\u7387\u53d6\u51b3\u4e8e\u78c1\u76d8\u5b58\u50a8\u7684\u7c7b\u578b\u548c\u914d\u7f6e\u3002</p> <p>nginx\u7684\u5f00\u53d1\u4eba\u5458\u5c06\u5728\u5373\u5c06\u63a8\u51fa\u7684\u7248\u672c\u4e2d\u89e3\u51b3\u7684\u4e00\u4e2a\u4e3b\u8981\u95ee\u9898\u662f\u5982\u4f55\u4fbf\u9762\u78c1\u76d8I/O\u4e0a\u7684\u5927\u90e8\u5206\u963b\u585e\u3002\u76ee\u524d\uff0c\u5982\u679c\u6ca1\u6709\u8db3\u591f\u7684\u5b58\u50a8\u6027\u80fd\u6765\u4e3a\u7279\u5b9aworker\u751f\u6210\u7684\u78c1\u76d8\u64cd\u4f5c\u63d0\u4f9b\u670d\u52a1\uff0c\u90a3\u4e48\u8be5worker\u4ecd\u53ef\u80fd\u963b\u585e\u5730\u4ece\u78c1\u76d8\u8bfb\u53d6/\u5199\u5165\u3002\u5b58\u5728\u8bb8\u591a\u673a\u5236\u548c\u914d\u7f6e\u6587\u4ef6\u6307\u4ee4\u4ee5\u51cf\u8f7b\u6b64\u7c7b\u78c1\u76d8I/O\u963b\u65b9\u6848\u3002\u6700\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0csendfile\u548cAIO\u7b49\u9009\u9879\u7684\u7ec4\u5408\u901a\u5e38\u4f1a\u4e3a\u78c1\u76d8\u6027\u80fd\u5e26\u6765\u5f88\u5927\u7684\u7a7a\u95f4\u3002\u5e94\u6839\u636e\u6570\u636e\u96c6\uff0cnginx\u53ef\u7528\u7684\u5185\u5b58\u4eae\u4ee5\u53ca\u5e95\u5c42\u5b58\u50a8\u67b6\u6784\u6765\u89c4\u5212nginx\u5b89\u88c5\u3002</p> <p>\u73b0\u6709worker\u6a21\u578b\u7684\u53e6\u4e00\u4e2a\u95ee\u9898\u4e0e\u5d4c\u5165\u5f0f\u811a\u672c\u7684\u6709\u9650\u652f\u6301\u6709\u5173\u3002\u9996\u5148\uff0c\u4f7f\u7528\u6807\u51c6\u7684nginx\u53d1\u884c\u7248\uff0c\u53ea\u652f\u6301\u5d4c\u5165Perl\u811a\u672c\u3002\u7531\u4e00\u4e2a\u7b80\u5355\u7684\u89e3\u91ca\uff1a\u5173\u952e\u95ee\u9898\u662f\u5d4c\u5165\u5f0f\u811a\u672c\u53ef\u80fd\u7d20\u5219\u4efb\u4f55\u64cd\u4f5c\u6216\u610f\u5916\u9000\u51fa\u3002\u8fd9\u4e24\u79cd\u884c\u4e3a\u90fd\u4f1a\u7acb\u5373\u5bfc\u81f4worker\u88ab\u6302\u8d77\uff0c\u540c\u65f6\u5f71\u54cd\u6570\u5343\u4e2a\u8fde\u63a5\u3002\u66f4\u591a\u7684\u5de5\u4f5c\u4e2d\u6b63\u5728\u88ab\u8ba1\u5212\uff0c\u4f7fnginx\u7684\u5d4c\u5165\u5f0f\u811a\u672c\u66f4\u7b80\u5355\u3001\u53ef\u9760\u548c\u9002\u7528\u4e8e\u66f4\u5e7f\u6cdb\u7684\u5e94\u7528\u7a0b\u5e8f\u3002</p>"},{"location":"2019-01-31-nginx%E6%9E%B6%E6%9E%84/#nginx_2","title":"nginx\u8fdb\u7a0b\u89d2\u8272","text":"<p>nginx\u5728\u5185\u5b58\u4e2d\u8fd0\u884c\u51e0\u79cd\u8fdb\u7a0b\uff0c\u4e00\u4e2a<code>master</code>\u8fdb\u7a0b\u548c\u51e0\u4e2a<code>worker</code>\u8fdb\u7a0b\uff0c\u8fd8\u6709\u4e00\u4e9b\u7279\u6b8a\u7528\u9014\u7684\u8fdb\u7a0b\uff0c\u7279\u522b\u662f<code>cache loader</code>\u548c<code>cache manager</code>\u3002\u5728nginx\u7248\u672c1.x\u4e2d\u7684\u6240\u6709\u8fdb\u7a0b\u90fd\u662f\u5355\u7ebf\u7a0b\uff0c\u6240\u6709\u8fdb\u7a0b\u4e3b\u8981\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u673a\u5236\u8fdb\u884c\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff08inter-process communication\uff09\u3002master\u8fdb\u7a0b\u4ee5root\u7528\u6237\u8eab\u4efd\u8fd0\u884c\uff0ccache loader/cache manager/worker\u4f5c\u4e3a\u975e\u7279\u6743\u7528\u6237\u8fd0\u884c\u3002</p> <p>master\u8fdb\u7a0b\u8d1f\u8d23\u4ee5\u4e0b\u4efb\u52a1\uff1a</p> <ul> <li>\u8bfb\u53d6\u548c\u9a8c\u8bc1\u914d\u7f6e</li> <li>\u521b\u5efa\u3001\u7ed1\u5b9a\u548c\u5173\u95edsocket</li> <li>\u542f\u52a8\u3001\u7ec8\u6b62\u548c\u7ef4\u62a4\u914d\u7f6e\u7684worker\u8fdb\u7a0b\u6570</li> <li>\u65e0\u9700\u4e2d\u65ad\u670d\u52a1\u7684\u91cd\u65b0\u914d\u7f6e</li> <li>\u63a7\u5236\u4e0d\u505c\u673a\u7684\u4e8c\u8fdb\u5236\u5347\u7ea7\uff08\u542f\u52a8\u65b0\u4e8c\u8fdb\u5236\u5e76\u5728\u5fc5\u8981\u65f6\u56de\u6eda\uff09</li> <li>\u91cd\u65b0\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6</li> <li>\u7f16\u8bd1\u5d4c\u5165Perl\u811a\u672c</li> </ul> <p>Worker\u8fdb\u7a0b\u63a5\u6536\u3001\u5904\u7406\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\uff0c\u63d0\u4f9b\u53cd\u5411\u4ee3\u7406\u548c\u8fc7\u6ee4\u529f\u80fd\uff0c\u5e76\u6267\u884cnginx\u80fd\u591f\u6267\u884c\u7684\u51e0\u4e4e\u6240\u6709\u7684\u5176\u4ed6\u64cd\u4f5c\u3002\u5173\u4e8e\u76d1\u89c6nginx\u5b9e\u4f8b\u7684\u884c\u4e3a\uff0c\u7cfb\u7edf\u7ba1\u7406\u5458\u5e94\u8be5\u5173\u6ce8worker\uff0c\u56e0\u4e3a\u5b83\u4eec\u662f\u53cd\u6620Web\u670d\u52a1\u5668\u7684\u5b9e\u9645\u65e5\u5e38\uff08day-to-day\uff09\u64cd\u4f5c\u7684\u8fc7\u7a0b\u3002</p> <p>Cache loader\u8fdb\u7a0b\u8d1f\u8d23\u68c0\u67e5\u78c1\u76d8\u7f13\u5b58\u5e76\u4f7f\u7528\u7f13\u5b58\u5143\u6570\u636e\u586b\u5145nginx\u7684\u5185\u5b58\u6570\u636e\u5e93\u3002\u672c\u8d28\u4e0a\uff0ccache loader\u65b0\u5a5a\u88abnginx\u5b9e\u4f8b\u4ee5\u5904\u7406\u5df2\u7ecf\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u7684\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4f4d\u4e8e\u7279\u6b8a\u5206\u914d\u7684\u76ee\u5f55\u7ed3\u6784\u4e2d\u3002\u5b83\u904d\u5386\u76ee\u5f55\uff0c\u68c0\u67e5\u7f13\u5b58\u5185\u5bb9\u5143\u6570\u636e\uff0c\u66f4\u65b0\u5171\u4eab\u5185\u5b58\u4e2d\u7684\u76f8\u5173\u6761\u76ee\uff0c\u7136\u540e\u5728\u4e00\u5207\u90fd\u5e72\u51c0\u5e76\u51c6\u5907\u597d\u4f7f\u7528\u65f6\u9000\u51fa\u3002</p> <p>Cache manager\u4e3b\u8981\u8d1f\u8d23\u7f13\u5b58\u8fc7\u671f\u548c\u5931\u6548\u3002\u4ed6\u5728\u6b63\u5e38\u7684nginx\u64cd\u4f5c\u671f\u95f4\u4fdd\u7559\u5728\u5185\u5b58\u4e2d\uff0c\u5e76\u5728\u53d1\u751f\u6545\u969c\u65f6\u7531master\u8fdb\u7a0b\u91cd\u542f\u3002</p>"},{"location":"2019-01-31-nginx%E6%9E%B6%E6%9E%84/#nginx_3","title":"nginx\u7f13\u5b58\u6982\u8ff0","text":"<p>nginx\u4e2d\u7684\u7f13\u5b58\u662f\u4ee5\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u5206\u5c42\u6570\u636e\u5b58\u50a8\uff08hierarchical data storage\uff09\u7684\u5f62\u5f0f\u5b9e\u73b0\u7684\u3002\u7f13\u5b58\u952e\uff08cache key\uff09\u662f\u53ef\u914d\u7f6e\u7684\uff0c\u5e76\u4e14\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u7279\u5b9a\u4e8e\u8bf7\u6c42\u7684\u53c2\u6570\u6765\u63a7\u5236\u8fdb\u5165\u7f13\u5b58\u7684\u5185\u5bb9\u3002\u7f13\u5b58\u952e\uff0c\u548c\u7f13\u5b58\u5143\u6570\u636e\u5b58\u50a8\u5728\u5171\u4eab\u5185\u5b58\u6bb5\u4e2d\uff0ccache loader/code manager/worker\u90fd\u53ef\u4ee5\u8bbf\u95ee\u3002\u76ee\u524d\uff0c\u9664\u4e86\u64cd\u4f5c\u7cfb\u7edf\u7684\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\u673a\u5236\u6240\u6697\u793a\u7684\u4f18\u5316\u4e4b\u5916\uff0c\u6ca1\u6709\u4efb\u4f55\u5185\u5b58\u4e2d\u7684\u6587\u4ef6\u7f13\u5b58\u3002\u6bcf\u4e2a\u88ab\u7f13\u5b58\u7684\u54cd\u5e94\u90fd\u65b9\u5728\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u4e0d\u540c\u6587\u4ef6\u4e2d\uff0c\u5c42\u7ea7\u7ed3\u6784\uff08\u7ea7\u522b\u548c\u547d\u540d\u7ec6\u8282\uff09\u901a\u8fc7nginx\u914d\u7f6e\u6307\u4ee4\u63a7\u5236\u3002\u5c06\u54cd\u5e94\u5199\u5165\u7f13\u5b58\u76ee\u5f55\u7ed3\u6784\u65f6\uff0c\u6587\u4ef6\u7684\u8def\u5f84\u548c\u540d\u79f0\u5c06\u4ece\u4ee3\u7406URL\u7684MD5\u54c8\u5e0c\u6d3e\u751f\u3002</p> <p>\u5c06\u5185\u5bb9\u653e\u5165\u7f13\u5b58\u7684\u8fc7\u7a0b\u5982\u4e0b\uff1a\u5f53nginx\u4ece\u4e0a\u6e38\u670d\u52a1\u5668\u8bfb\u53d6\u54cd\u5e94\u65f6\uff0c\u9996\u76f8\u5c06\u5185\u5bb9\u5199\u5165\u7f13\u5b58\u76ee\u5f55\u7ed3\u6784\u4e4b\u5916\u7684\u4e34\u65f6\u6587\u4ef6\u3002\u5f53nginx\u5b8c\u6210\u5904\u7406\u8bf7\u6c42\u65f6\uff0c\u5b83\u4f1a\u91cd\u547d\u540d\u4e34\u65f6\u6587\u4ef6\u5e76\u5c06\u5176\u79fb\u52a8\u5230\u7f13\u5b58\u76ee\u5f55\u3002\u82e5\u4ee3\u7406\u7684\u4e34\u65f6\u6587\u4ef6\u76ee\u5f55\u4f4d\u4e8e\u53e6\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u4e0a\uff0c\u5219\u4f1a\u590d\u5236\u8be5\u6587\u4ef6\uff0c\u56e0\u6b64\u5efa\u8bae\u5c06\u4e34\u65f6\u76ee\u5f55\u548c\u7f13\u5b58\u76ee\u5f55\u4fdd\u7559\u5728\u540c\u4e00\u6587\u4ef6\u7cfb\u7edf\u4e0a\u3002\u5f53\u9700\u8981\u663e\u5f0f\u6e05\u9664\u6587\u4ef6\u65f6\uff0c\u4ece\u7f13\u5b58\u76ee\u5f55\u7ed3\u6784\u4e2d\u5220\u9664\u6587\u4ef6\u4e5f\u662f\u975e\u5e38\u5b89\u5168\u7684\u3002nginx\u6709\u7b2c\u4e09\u65b9\u62d3\u5c55\uff0c\u53ef\u4ee5\u8fdc\u7a0b\u63a7\u5236\u7f13\u5b58\u5185\u5bb9\uff0c\u5e76\u8ba1\u5212\u5728\u4e3b\u8981\u53d1\u884c\u7248\u4e2d\u96c6\u6210\u66f4\u591a\u529f\u80fd\u3002</p>"},{"location":"2019-01-31-nginx%E6%9E%B6%E6%9E%84/#nginx_4","title":"nginx\u914d\u7f6e","text":"<p>nginx\u7684\u914d\u7f6e\u7cfb\u7edf\u7684\u7075\u611f\u4e3b\u8981\u6765\u81eaIgor Sysoev\u7684Apache\u7ecf\u9a8c\uff0c\u4ed6\u7684\u4e3b\u8981\u89c2\u70b9\u65f6\u53ef\u62d3\u5c55\u7684\u914d\u7f6e\u7cfb\u7edf\u5bf9\u4e8eWeb\u670d\u52a1\u5668\u81f3\u5173\u91cd\u8981\u3002\u5728\u7ef4\u62a4\u5305\u542b\u5927\u91cf\u865a\u62df\u670d\u52a1\u5668\u3001\u76ee\u5f55\u3001\u672a\u77e5\u548c1\u6570\u636e\u96c6\u7684\u5927\u578b\u590d\u6742\u914d\u7f6e\u65f6\u9047\u5230\u4e86\u4e3b\u8981\u7684\u62d3\u5c55\u95ee\u9898\u3002\u5728\u76f8\u5bf9\u8f83\u5927\u7684Web\u914d\u7f6e\u4e2d\uff0c\u82e5\u5728\u5e94\u7528\u7a0b\u5e8f\u7ea7\u522b\u548c\u7cfb\u7edf\u5de5\u7a0b\u5e08\u6ca1\u6709\u6b63\u786e\u914d\u7f6e\uff0c\u5219\u53ef\u80fd\u662f\u4e00\u573a\u5669\u68a6\u3002</p> <p>\u56e0\u6b64\uff0cnginx\u914d\u7f6e\u65e8\u5728\u7b80\u5316\u65e5\u5e38\u64cd\u4f5c\uff0c\u5e76\u4e3a\u8fdb\u4e00\u6b65\u62d3\u5c55Web\u670d\u52a1\u5668\u914d\u7f6e\u63d0\u4f9b\u7b80\u4fbf\u65b9\u6cd5\u3002</p> <p>nginx\u914d\u7f6e\u4fdd\u5b58\u5728\u8bb8\u591a\u7eaf\u6587\u672c\u6587\u4ef6\u4e2d\uff0c\u8fd9\u4e9b\u6587\u4ef6\u901a\u5e38\u4f4d\u4e8e<code>/usr/local/etc/nginx</code>\u6216<code>/etc/nginx</code>\u4e2d\u3002\u4e3b\u914d\u7f6e\u6587\u4ef6\u901a\u5e38\u540d\u4e3a<code>nginx.conf</code>\uff0c\u4e3a\u4e86\u4fdd\u6301\u6574\u6d01\uff0c\u53ef\u4ee5\u5c06\u90e8\u5206\u914d\u7f6e\u653e\u5728\u5355\u72ec\u7684\u6587\u4ef6\u4e2d\uff0c\u8fd9\u4e9b\u6587\u4ef6\u53ef\u4ee5\u81ea\u52a8\u5305\u542b\u5728\u4e3b\u6587\u4ef6\u4e2d\u3002\u4f46\u662f\uff0c\u8fd9\u91cc\u5e94\u8be5\u6ce8\u610f\uff0cnginx\u76ee\u524d\u4e0d\u652f\u6301Apache\u98ce\u683c\u7684\u5206\u5e03\u5f0f\u914d\u7f6e\uff08\u5373.htaccess\u6587\u4ef6\uff09\u3002\u4e8enginx Web\u670d\u52a1\u5668\u884c\u4e3a\u76f8\u5173\u7684\u6240\u6709\u914d\u7f6e\u90fd\u5e94\u9a7b\u7559\u5728\u4e00\u7ec4\u96c6\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002</p> <p>\u914d\u7f6e\u6587\u4ef6\u6700\u521d\u7531\u4e3b\u8fdb\u7a0b\u8bfb\u53d6\u548c\u9a8c\u8bc1\uff0cnginx\u914d\u7f6e\u7684\u5df2\u7f16\u8bd1\u53ea\u8bfb\uff08compiled read-only\uff09\u5f62\u5f0f\u53ef\u4f9bworker\u8fdb\u7a0b\u4f7f\u7528\uff0c\u56e0\u4e3a\u5b83\u4eec\u65f6\u4ecemaster\u8fdb\u7a0b\u590d\u5236\uff08fork\uff09\u7684\u3002\u914d\u7f6e\u7ed3\u6784\u7531\u901a\u5e38\u7684\u865a\u62df\u5185\u5b58\u7ba1\u7406\u673a\u5236\u81ea\u52a8\u5171\u4eab\u3002</p> <p>nginx\u914d\u7f6e\u6709\u51e0\u4e2a\u4e0d\u540c\u7684\u4e0a\u4e0b\u6587\u7528\u4e8e<code>main</code>,<code>http</code>,<code>server</code>,<code>upstream</code>,<code>location</code>\uff08\u4ee5\u53ca\u90ae\u4ef6\u4ee3\u7406\u7684<code>mail</code>\uff09\u6307\u4ee4\u5757\u3002\u4e0a\u4e0b\u6587\u4ece\u4e0d\u91cd\u53e0\u3002\u4f8b\u5982\uff0c\u6ca1\u6709\u5c06<code>location</code>\u653e\u5728<code>main</code>\u6307\u4ee4\u5757\u4e2d\u3002\u6b64\u5916\uff0c\u4e3a\u4e86\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u6b67\u4e49\uff0c\u6ca1\u6709\u50cf\u201c\u5168\u5c40Web\u670d\u52a1\u5668\uff08global server configuration\uff09\u201d\u914d\u7f6e\u90a3\u6837\u7684\u4e1c\u897f\u3002nginx\u914d\u7f6e\u610f\u5473\u7740\u5e72\u51c0\u4e14\u5408\u4e4e\u903b\u8f91\uff0c\u5141\u8bb8\u7528\u6237\u7ef4\u62a4\u5305\u542b\u6570\u5343\u4e2a\u6307\u4ee4\u7684\u590d\u6742\u914d\u7f6e\u6587\u4ef6\u3002\u5728\u79c1\u4eba\u8c08\u8bdd\u4e2d\uff0cSysoev\u8bf4\uff0c\u201c\u5168\u5c40\u670d\u52a1\u5668\u914d\u7f6e\u4e2d\u7684\u4f4d\u7f6e\uff0c\u76ee\u5f55\u548c\u5176\u4ed6\u5757\u662f\u6211\u4ece\u672a\u5728Apache\u4e2d\u559c\u6b22\u7684\u529f\u80fd\uff0c\u6240\u4ee5\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u5b83\u4eec\u4ece\u672a\u5728nginx\u4e2d\u5b9e\u73b0\u7684\u539f\u56e0\u3002\u201d</p> <p>\u914d\u7f6e\u8bed\u6cd5\uff0c\u683c\u5f0f\u548c\u5b9a\u4e49\u9075\u5faa\u6240\u8c13\u7684C\u98ce\u683c\u7ea6\u5b9a\u3002\u5236\u4f5c\u914d\u7f6e\u6587\u4ef6\u7684\u8fd9\u79cd\u7279\u6b8a\u65b9\u6cd5\u5df2\u7ecf\u88ab\u5404\u79cd\u5f00\u6e90\u548c\u5546\u4e1a\u8f6f\u4ef6\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u3002\u901a\u8fc7\u8bbe\u8ba1\uff0cC\u98ce\u683c\u7684\u914d\u7f6e\u975e\u5e38\u9002\u5408\u5d4c\u5957\u63cf\u8ff0\uff0c\u5177\u6709\u903b\u8f91\u6027\uff0c\u6613\u4e8e\u521b\u5efa\uff0c\u8bfb\u53d6\u548c\u7ef4\u62a4\uff0c\u5e76\u4e14\u53d7\u5230\u8bb8\u591a\u5de5\u7a0b\u5e08\u7684\u559c\u7231\u3002nginx\u7684C\u98ce\u683c\u914d\u7f6e\u4e5f\u53ef\u4ee5\u8f7b\u677e\u5b9e\u73b0\u81ea\u52a8\u5316\u3002</p> <p>\u867d\u7136\u4e00\u4e9bnginx\u6307\u4ee4\u7c7b\u4f3c\u4e8eApache\u914d\u7f6e\u7684\u67d0\u4e9b\u90e8\u5206\uff0c\u4f46\u662f\u8bbe\u7f6enginx\u5b9e\u4f8b\u662f\u4e00\u79cd\u5b8c\u5168\u4e0d\u540c\u7684\u4f53\u9a8c\u3002\u4f8b\u5982\uff0cnginx\u652f\u6301\u91cd\u5199\u89c4\u5219\uff0c\u4f46\u9700\u8981\u7ba1\u7406\u5458\u624b\u52a8\u8c03\u6574\u9057\u7559Apache\u91cd\u5199\u914d\u7f6e\u4ee5\u5339\u914dnginx\u6837\u5f0f\u3002\u91cd\u5199\u5f15\u64ce\u7684\u5b9e\u73b0\u4e5f\u4e0d\u540c\u3002</p> <p>\u901a\u5e38\uff0cnginx\u8bbe\u7f6e\u8fd8\u652f\u6301\u51e0\u79cd\u539f\u59cb\u673a\u5236\uff0c\u8fd9\u4e9b\u673a\u5236\u4f5c\u4e3a\u7cbe\u7b80Web\u670d\u52a1\u5668\u914d\u7f6e\u7684\u4e00\u90e8\u5206\u975e\u5e38\u6709\u7528\u3002\u7b80\u5355\u5730\u63d0\u53ca\u53d8\u91cf\u548c<code>try_files</code>\u6307\u4ee4\u662f\u6709\u610f\u4e49\u7684\uff0c\u8fd9\u4e9b\u6307\u4ee4\u5bf9\u4e8enginx\u6765\u8bf4\u6709\u4e9b\u72ec\u7279\u3002\u5f00\u53d1\u4e86nginx\u4e2d\u7684\u53d8\u91cf\uff0c\u4ee5\u63d0\u4f9b\u989d\u5916\u7684\u66f4\u5f3a\u5927\u7684\u673a\u5236\u6765\u63a7\u5236Web\u670d\u52a1\u5668\u7684\u8fd0\u884c\u65f6\u914d\u7f6e\u3002\u53d8\u91cf\u9488\u5bf9\u5feb\u901f\u8bc4\u4f30\u8fdb\u884c\u4e86\u4f18\u5316\uff0c\u5e76\u5728\u5185\u90e8\u9884\u7f16\u8bd1\u4e3a\u7d22\u5f15\u3002\u8bc4\u4f30\u662f\u6309\u9700\u8fdb\u884c\u7684\uff0c\u5373\u53d8\u91cf\u7684\u503c\u901a\u5e38\u4ec5\u8ba1\u7b97\u4e00\u6b21\u5e76\u7f13\u5b58\u7279\u5b9a\u8bf7\u6c42\u7684\u751f\u547d\u5468\u671f\u3002\u53d8\u91cf\u53ef\u4ee5\u4e0e\u4e0d\u540c\u7684\u914d\u7f6e\u6307\u4ee4\u4e00\u8d77\u4f7f\u7528\uff0c\u4e3a\u63cf\u8ff0\u6761\u4ef6\u8bf7\u6c42\u5904\u7406\u884c\u4e3a\u63d0\u4f9b\u4e86\u989d\u5916\u7684\u7075\u6d3b\u6027\u3002</p> <p><code>try_files</code>\u6307\u4ee4\u6700\u521d\u610f\u5473\u7740\u4ee5\u66f4\u6070\u5f53\u7684\u65b9\u5f0f\u9010\u6b65\u66ff\u6362\u6761\u4ef6<code>if</code>\u914d\u7f6e\u8bed\u53e5\uff0c\u5e76\u4e14\u5b83\u65e8\u5728\u5feb\u901f\u6709\u6548\u5730\u5c1d\u8bd5/\u5339\u914d\u4e0d\u540c\u7684URI\u5230\u5185\u5bb9\u6620\u5c04\u3002\u603b\u7684\u6765\u8bf4\uff0c<code>try_files</code>\u6307\u4ee4\u8fd0\u884c\u826f\u597d\uff0c\u53ef\u4ee5\u975e\u5e38\u9ad8\u6548\u548c\u6709\u7528\u3002\u5efa\u8bae\u8bfb\u8005\u5f7b\u5e95\u68c0\u67e5<code>try_files</code>\u6307\u4ee4\u5e76\u5728\u9002\u7528\u65f6\u91c7\u7528\u5b83\u3002</p>"},{"location":"2019-01-31-nginx%E6%9E%B6%E6%9E%84/#nginx_5","title":"nginx\u5185\u90e8","text":"<p>\u5982\u524d\u6240\u8ff0\uff0cnginx\u4ee3\u7801\u5e93\u7531\u6838\u5fc3\u548c\u8bb8\u591a\u6a21\u5757\u7ec4\u6210\u3002nginx\u6838\u5fc3\u65f6\u8d1f\u8d23\u63d0\u4f9bWen\u670d\u52a1\u5668\uff0cWeb\u548c\u90ae\u4ef6\u548c\u53cd\u5411\u4ee3\u7406\u529f\u80fd\u7684\u57fa\u7840\uff0c\u5b83\u652f\u6301\u4f7f\u7528\u5e95\u5c42\u7f51\u7edc\u6d17\u8bf6\uff0c\u6784\u5efa\u5fc5\u8981\u7684\u8fd0\u884c\u65f6\u73af\u5883\uff0c\u5e76\u786e\u4fdd\u4e0d\u540c\u6a21\u5757\u4e4b\u95f4\u7684\u65e0\u7f1d\u4ea4\u4e92\u3002\u4f46\u662f\u5927\u591a\u6570\u534f\u8bae\u548c\u5e94\u7528\u7a0b\u5e8f\u7279\u5b9a\u7684\u529f\u80fd\u90fd\u662f\u7531\u5176\u4ed6\u6a21\u5757\u5b8c\u6210\u7684\uff0c\u800c\u4e0d\u662f\u6838\u5fc3\u6a21\u5757\u3002</p> <p>\u5728\u5185\u90e8\uff0cnginx\u901a\u8fc7\u6a21\u5757\u7684\u7ba1\u9053\u6216\u8005\u94fe\u6765\u5904\u7406\u8fde\u63a5\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u64cd\u4f5c\uff0c\u90fd\u6709\u4e00\u4e2a\u6b63\u5728\u8fdb\u884c\u7684\u76f8\u5173\u5de5\u4f5c\u7684\u6a21\u5757\uff1b\u4f8b\u5982\uff1a\u538b\u7f29\u3001\u4fee\u6539\u5185\u5bb9\u3001\u6267\u884c\u670d\u52a1\u5668\u7aef\u5305\u62ec\uff08server-side includes\uff09\uff0c\u901a\u8fc7FastCGI\u6216uwsgi\u534f\u8bae\u4e0e\u4e0a\u6e38\u5e94\u7528\u670d\u52a1\u5668\u901a\u4fe1\uff0c\u6216\u4e0ememcached\u901a\u4fe1\u3002</p> <p>\u6709\u51e0\u4e2anginx\u6a21\u5757\u4f4d\u4e8e\u6838\u5fc3\u548c\u771f\u6b63\u7684\u201c\u529f\u80fd\u201d\u6a21\u5757\u4e4b\u95f4\uff0c\u662f<code>http</code>\u548c<code>mail</code>\uff0c\u8fd9\u4e24\u4e2a\u6a21\u5757\u5728\u6838\u5fc3\u7ec4\u4ef6\u548c\u7f14\u7ed3\u7ec4\u4ef6\u4e4b\u95f4\u63d0\u4f9b\u4e86\u989d\u5916\u7684\u62bd\u8c61\u7ea7\u522b\u3002\u5728\u8fd9\u4e9b\u6a21\u5757\u4e2d\uff0c\u5b9e\u73b0\u4e86\u4e0e\u8bf8\u5982HTTP\uff0cSMTP\u6216IMAP\u7684\u76f8\u5e94\u5e94\u7528\u5c42\u534f\u8bae\u76f8\u5173\u8054\u7684\u4e8b\u4ef6\u5e8f\u5217\u7684\u5904\u7406\u3002\u7ed3\u5408nginx\u6838\u5fc3\uff0c\u8fd9\u4e9b\u4e0a\u5c42\u6a21\u5757\u8d1f\u8d23\u7ef4\u62a4\u5bf9\u5404\u4e2a\u529f\u80fd\u6a21\u5757\u7684\u6b63\u786e\u8c03\u7528\u987a\u5e8f\u3002\u867d\u7136HTTP\u534f\u8bae\u76ee\u524d\u662f\u4f5c\u4e3a<code>http</code>\u6a21\u5757\u7684\u4e00\u90e8\u5206\u5b9e\u73b0\u7684\uff0c\u4f46\u7531\u4e8e\u9700\u8981\u652f\u6301SPDY\u7b49\u5176\u4ed6\u534f\u8bae\uff0c\u56e0\u6b64\u8ba1\u5212\u5c06\u6765\u5c06\u5176\u5206\u79bb\u4e3a\u529f\u80fd\u6a21\u5757\uff08\u53c2\u89c1\"SPDY: An experimental protocol for a faster web\"\uff09\u3002</p> <p>\u529f\u80fd\u6a21\u5757\u53ef\u5206\u4e3a\u4e8b\u4ef6\u6a21\u5757\uff08event module\uff09\u3001\u9636\u6bb5\u5904\u7406\u5668\uff08phase handler\uff09\u3001\u8f93\u51fa\u8fc7\u6ee4\u5668\uff08output filter\uff09\u3001\u53d8\u91cf\u5904\u7406\u5668\uff08variable handler\uff09\u3001\u534f\u8bae\u3001\u4e0a\u6e38\uff08upstream\uff09\u548c\u8d1f\u8f7d\u5747\u8861\u5668\u3002\u8fd9\u4e9b\u6a21\u5757\u4e2d\u7684\u5927\u591a\u6570\u8865\u5145\u4e86nginx\u7684HTTP\u529f\u80fd\uff0c\u4f46<code>\u4e8b\u4ef6\u6a21\u5757</code>\u548c<code>\u534f\u8bae</code>\u4e5f\u7528\u4e8e<code>mail</code>\u3002\u4e8b\u4ef6\u6a21\u5757\u63d0\u4f9b\u7279\u5b9a\u7684OS\u4ee5\u6765\u7684\u4e8b\u4ef6\u901a\u77e5\u673a\u5236\uff0c\u5982<code>kqueue</code>\u548c<code>epoll</code>\u3002nginx\u4f7f\u7528\u7684\u4e8b\u4ef6\u6a21\u578b\u53d6\u51b3\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u529f\u80fd\u548c\u6784\u5efa\u914d\u7f6e\u3002\u534f\u8bae\u6a21\u5757\u5141\u8bb8nginx\u901a\u8fc7HTTPS\uff0cTLS / SSL\uff0cSMTP\uff0cPOP3\u548cIMAP\u8fdb\u884c\u901a\u4fe1\u3002</p> <p>\u5178\u578b\u7684HTTP\u8bf7\u6c42\u5904\u7406\u5468\u671f\u5982\u4e0b\u6240\u793a\uff1a</p> <p>1) \u5ba2\u6237\u7aef\u53d1\u9001HTTP\u8bf7\u6c42</p> <p>2) nginx\u6838\u5fc3\u6839\u636e\u4e0e\u8bf7\u6c42\u5339\u914d\u7684\u5df2\u914d\u7f6e\u4f4d\u7f6e\u9009\u62e9\u9002\u5f53\u7684\u9636\u6bb5\u5904\u7406\u5668</p> <p>3) \u5982\u679c\u914d\u7f6e\u4e3a\u6267\u884c\u6b64\u64cd\u4f5c\uff0c\u5219\u8d1f\u8f7d\u5747\u8861\u5668\u4f1a\u9009\u62e9\u4e0a\u6e38\u670d\u52a1\u5668\u8fdb\u884c\u4ee3\u7406</p> <p>4) \u9636\u6bb5\u5904\u7406\u5668\u5b8c\u6210\u5176\u5de5\u4f5c\u5e76\u5c06\u6bcf\u4e2a\u8f93\u51fa\u7f13\u51b2\u533a\u4f20\u9012\u7ed9\u7b2c\u4e00\u4e2a\u8fc7\u6ee4\u5668</p> <p>5) \u7b2c\u4e00\u4e2a\u8fc7\u6ee4\u5668\u5c06\u8f93\u51fa\u4f20\u9012\u7ed9\u7b2c\u4e8c\u4e2a\u8fc7\u6ee4\u5668</p> <p>6) \u7b2c\u4e8c\u4e2a\u8fc7\u6ee4\u5668\u5c06\u8f93\u51fa\u4f20\u9012\u7ed9\u7b2c\u4e09\u4e2a\uff08\u4f9d\u6b64\u7c7b\u63a8\uff09 </p> <p>7) \u54cd\u5e94\u5c06\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef</p> <p>nginx\u6a21\u5757\u8c03\u7528\u662f\u975e\u5e38\u53ef\u5b9a\u5236\u7684\uff0c\u5b83\u901a\u8fc7\u4f7f\u7528\u6307\u5411\u53ef\u6267\u884c\u51fd\u6570\u7684\u6307\u9488\u7684\u4e00\u7cfb\u5217\u56de\u8c03\u6765\u6267\u884c\u3002\u7136\u800c\uff0c\u8fd9\u6837\u505a\u7684\u7f3a\u70b9\u662f\u5b83\u53ef\u80fd\u7ed9\u60f3\u8981\u7f16\u5199\u81ea\u5df1\u7684\u6a21\u5757\u7684\u7a0b\u5e8f\u5458\u5e26\u6765\u5f88\u5927\u7684\u8d1f\u62c5\uff0c\u56e0\u4e3a\u4ed6\u4eec\u5fc5\u987b\u786e\u5207\u5730\u5b9a\u4e49\u6a21\u5757\u5e94\u8be5\u5982\u4f55\u4ee5\u53ca\u4f55\u65f6\u8fd0\u884c\u3002 nginx API\u548c\u5f00\u53d1\u4eba\u5458\u7684\u6587\u6863\u90fd\u5728\u4e0d\u65ad\u6539\u8fdb\uff0c\u5e76\u4e14\u53ef\u4ee5\u66f4\u591a\u5730\u7528\u6765\u7f13\u89e3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>\u6a21\u5757\u53ef\u4ee5\u9644\u52a0\u7684\u4e00\u4e9b\u793a\u4f8b\u662f\uff1a</p> <ul> <li>\u5728\u8bfb\u53d6\u548c\u5904\u7406\u914d\u7f6e\u6587\u4ef6\u4e4b\u524d</li> <li>\u5bf9\u4e8e\u4f4d\u7f6e\u7684\u6bcf\u4e2a\u914d\u7f6e\u6307\u4ee4\u4ee5\u53ca\u5b83\u51fa\u73b0\u7684\u670d\u52a1\u5668</li> <li>\u521d\u59cb\u5316\u4e3b\u914d\u7f6e\u65f6</li> <li>\u5f53\u521d\u59cb\u5316\u670d\u52a1\u5668\uff08\u5373\u4e3b\u673a/\u7aef\u53e3\uff09\u65f6</li> <li>\u5f53\u670d\u52a1\u5668\u914d\u7f6e\u4e0e\u4e3b\u914d\u7f6e\u5408\u5e76\u65f6</li> <li>\u521d\u59cb\u5316\u4f4d\u7f6e\u914d\u7f6e\u6216\u4e0e\u5176\u7236\u670d\u52a1\u5668\u914d\u7f6e\u5408\u5e76\u65f6</li> <li>\u4e3b\u7a0b\u5e8f\u542f\u52a8\u6216\u9000\u51fa\u65f6</li> <li>\u4e00\u4e2a\u65b0\u7684worker\u8fdb\u7a0b\u542f\u52a8\u6216\u9000\u51fa\u65f6</li> <li>\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\u65f6</li> <li>\u8fc7\u6ee4\u54cd\u5e94\u6807\u5934\uff08header\uff09\u548c\u6b63\u6587\uff08body\uff09\u65f6</li> <li>\u6311\u9009\u3001\u542f\u52a8\u5e76\u91cd\u542f\u5bf9\u4e0a\u6e38\u670d\u52a1\u5668\u7684\u8bf7\u6c42</li> <li>\u5904\u7406\u6765\u81ea\u4e0a\u6e38\u670d\u52a1\u5668\u7684\u54cd\u5e94\u65f6</li> <li>\u5b8c\u6210\u4e0e\u4e0a\u6e38\u670d\u52a1\u5668\u7684\u4ea4\u4e92\u65f6</li> </ul> <p>\u5728worker\u4e2d\uff0c\u5bfc\u81f4\u751f\u6210\u54cd\u5e94\u7684\u8fd0\u884c\u5faa\u73af\u7684\u64cd\u4f5c\u5e8f\u5217\u5982\u4e0b\u6240\u793a\uff1a</p> <p>1) \u5f00\u59cb<code>ngx_worker_process_cycle()</code></p> <p>2) \u5904\u7406OS\u7279\u5b9a\u673a\u5236\u7684\u4e8b\u4ef6\uff08\u5982<code>epoll</code>\u6216<code>kqueue</code>\uff09</p> <p>3) \u63a5\u6536\u4e8b\u4ef6\u548c\u5206\u914d\u76f8\u5173\u52a8\u4f5c</p> <p>4) \u5904\u7406\u6216\u4ee3\u7406\u8bf7\u6c42\u6807\u5934\u548c\u6b63\u6587</p> <p>5) \u751f\u6210\u54cd\u5e94\u5185\u5bb9\uff08\u6807\u9898\uff0c\u6b63\u6587\uff09\u5e76\u5c06\u5176\u6d41\u5f0f\u4f20\u8f93\u5230\u5ba2\u6237\u7aef</p> <p>6) \u5b8c\u6210\u8bf7\u6c42</p> <p>7) \u91cd\u65b0\u521d\u59cb\u5316\u8ba1\u65f6\u5668\u548c\u4e8b\u4ef6</p> <p>\u8fd0\u884c\u5faa\u73af\u672c\u8eab\uff08\u6b65\u9aa45\u548c6\uff09\u786e\u4fdd\u589e\u91cf\u751f\u6210\u54cd\u5e94\u5e76\u5c06\u5176\u6d41\u5f0f\u4f20\u8f93\u5230\u5ba2\u6237\u7aef\u3002</p> <p>\u5904\u7406HTTP\u8bf7\u6c42\u7684\u66f4\u8be6\u7ec6\u89c6\u56fe\u53ef\u80fd\u5982\u4e0b\u6240\u793a\uff1a</p> <p>1) \u521d\u59cb\u5316\u8bf7\u6c42\u5904\u7406</p> <p>2) \u5904\u7406\u6807\u5934</p> <p>3) \u5904\u7406\u6b63\u6587</p> <p>4) \u8c03\u7528\u5173\u8054\u7684\u5904\u7406\u7a0b\u5e8f</p> <p>5) \u8d2f\u7a7f\u5904\u7406\u9636\u6bb5\uff08processing phases\uff09</p> <p>\u8fd9\u5c06\u6211\u4eec\u5e26\u5230\u4e86\u9636\u6bb5\uff08phases\uff09\u3002\u5f53nginx\u5904\u7406HTTP\u8bf7\u6c42\u65f6\uff0c\u5b83\u4f1a\u5c06\u5176\u4f20\u9012\u7ed9\u8bb8\u591a\u5904\u7406\u9636\u6bb5\u3002\u5728\u6bcf\u4e2a\u9636\u6bb5\u90fd\u6709\u5904\u7406\u7a0b\u5e8f\u8c03\u7528\u3002\u901a\u5e38\uff0c\u9636\u6bb5\u5904\u7406\u7a0b\u5e8f\u5904\u7406\u8bf7\u6c42\u5e76\u751f\u6210\u76f8\u5173\u8f93\u51fa\u3002\u9636\u6bb5\u5904\u7406\u7a0b\u5e8f\u9644\u52a0\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u4f4d\u7f6e\u3002</p> <p>\u9636\u6bb5\u5904\u7406\u7a0b\u5e8f\u901a\u5e38\u6267\u884c\u4ee5\u4e0b\u56db\u9879\u64cd\u4f5c\uff1a\u83b7\u53d6\u4f4d\u7f6e\u914d\u7f6e\uff0c\u751f\u6210\u9002\u5f53\u7684\u54cd\u5e94\uff0c\u53d1\u9001\u6807\u5934\u4ee5\u53ca\u53d1\u9001\u6b63\u6587\u3002\u5904\u7406\u7a0b\u5e8f\u6709\u4e00\u4e2a\u53c2\u6570\uff1a\u63cf\u8ff0\u8bf7\u6c42\u7684\u7279\u5b9a\u7ed3\u6784\u3002\u8bf7\u6c42\u7ed3\u6784\u6709\u5f88\u591a\u5173\u4e8e\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u6709\u7528\u4fe1\u606f\uff0c\u4f8b\u5982\u8bf7\u6c42\u65b9\u6cd5\uff0cURI\u548c\u6807\u5934\u3002</p> <p>\u8bfb\u53d6HTTP\u8bf7\u6c42\u6807\u5934\u65f6\uff0cnginx\u4f1a\u67e5\u627e\u5173\u8054\u7684\u865a\u62df\u670d\u52a1\u5668\u3002\u82e5\u627e\u5230\u865a\u62df\u670d\u52a1\u5668\uff0c\u8bf7\u6c42\u5c06\u7ecf\u5386\u516d\u4e2a\u9636\u6bb5\uff1a</p> <p>1) \u670d\u52a1\u5668\u91cd\u5199\u9636\u6bb5</p> <p>2) \u4f4d\u7f6e\u9636\u6bb5</p> <p>3) \u4f4d\u7f6e\u91cd\u5199\u9636\u6bb5\uff08\u8fd9\u53ef\u4ee5\u5c06\u8bf7\u6c42\u5e26\u56de\u4e0a\u4e00\u9636\u6bb5\uff09</p> <p>4) \u8bbf\u95ee\u63a7\u5236\u9636\u6bb5</p> <p>5) <code>try_files</code>\u9636\u6bb5</p> <p>6) \u65e5\u5fd7\u9636\u6bb5</p> <p>\u4e3a\u4e86\u54cd\u5e94\u8bf7\u6c42\u751f\u6210\u5fc5\u8981\u7684\u5185\u5bb9\uff0cnginx\u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9\u5408\u9002\u7684\u5185\u5bb9\u5904\u7406\u7a0b\u5e8f\u3002\u6839\u636e\u786e\u5207\u7684\u4f4d\u7f6e\u914d\u7f6e\uff0cnginx\u53ef\u80fd\u9996\u5148\u5c1d\u8bd5\u6240\u8c13\u7684\u65e0\u6761\u4ef6\u5904\u7406\u7a0b\u5e8f\uff0c\u5982<code>perl</code>\uff0c<code>proxy_pass</code>\uff0c<code>flv</code>\uff0c<code>mp4</code>\u7b49\u3002\u5982\u679c\u8bf7\u6c42\u4e0e\u4e0a\u8ff0\u4efb\u4f55\u5185\u5bb9\u5904\u7406\u7a0b\u5e8f\u90fd\u4e0d\u5339\u914d\uff0c\u5219\u7531\u4ee5\u4e0b\u5904\u7406\u7a0b\u5e8f\u4e4b\u4e00\u6309\u7167\u4ee5\u4e0b\u786e\u5207\u987a\u5e8f\u9009\u62e9\uff1a\u968f\u673a\u7d22\u5f15\uff0c<code>index</code>\uff0c<code>autoindex</code>\uff0c<code>gzip_static</code>\uff0c<code>static</code>\u3002</p> <p>\u7d22\u5f15\u6a21\u5757\u7684\u8be6\u7ec6\u4fe1\u606f\u53ef\u4ee5\u5728nginx\u6587\u6863\u4e2d\u627e\u5230\uff0c\u4f46\u8fd9\u4e9b\u662f\u4f7f\u7528\u5c3e\u90e8\u659c\u6760\u5904\u7406\u8bf7\u6c42\u7684\u6a21\u5757\u3002\u5982\u679c\u50cf<code>mp4</code>\u6216<code>autoindex</code>\u8fd9\u6837\u7684\u4e13\u7528\u6a21\u5757\u4e0d\u5408\u9002\uff0c\u5219\u5185\u5bb9\u88ab\u8ba4\u4e3a\u53ea\u662f\u78c1\u76d8\u4e0a\u7684\u6587\u4ef6\u6216\u76ee\u5f55\uff08\u5373\u9759\u6001\uff09\uff0c\u5e76\u7531\u9759\u6001\u5185\u5bb9\u5904\u7406\u7a0b\u5e8f\u63d0\u4f9b\u670d\u52a1\u3002\u5bf9\u4e8e\u76ee\u5f55\uff0c\u5b83\u4f1a\u81ea\u52a8\u91cd\u5199URI\uff0c\u4ee5\u4fbf\u59cb\u7ec8\u5b58\u5728\u5c3e\u90e8\u659c\u6760\uff08\u7136\u540e\u53d1\u51faHTTP\u91cd\u5b9a\u5411\uff09\u3002</p> <p>\u7136\u540e\u5c06\u5185\u5bb9\u5904\u7406\u7a0b\u5e8f\u7684\u5185\u5bb9\u4f20\u9012\u7ed9\u8fc7\u6ee4\u5668\u3002\u8fc7\u6ee4\u5668\u4e5f\u9644\u52a0\u5230\u4f4d\u7f6e\uff0c\u5e76\u4e14\u53ef\u4ee5\u4e3a\u4f4d\u7f6e\u914d\u7f6e\u591a\u4e2a\u8fc7\u6ee4\u5668\u3002\u8fc7\u6ee4\u5668\u6267\u884c\u64cd\u4f5c\u5904\u7406\u7a0b\u5e8f\u751f\u6210\u7684\u8f93\u51fa\u7684\u4efb\u52a1\u3002\u8fc7\u6ee4\u5668\u6267\u884c\u7684\u987a\u5e8f\u5728\u7f16\u8bd1\u65f6\u786e\u5b9a\u3002\u5bf9\u4e8e\u9884\u5148\u5b9a\u4e49\u7684\u5f00\u7bb1\u5373\u7528\u8fc7\u6ee4\u5668\uff0c\u5bf9\u4e8e\u7b2c\u4e09\u65b9\u8fc7\u6ee4\u5668\uff0c\u53ef\u4ee5\u5728\u6784\u5efa\u9636\u6bb5\u5bf9\u5176\u8fdb\u884c\u914d\u7f6e\u3002\u5728\u73b0\u6709\u7684nginx\u5b9e\u73b0\u4e2d\uff0c\u8fc7\u6ee4\u5668\u53ea\u80fd\u8fdb\u884c\u51fa\u7ad9\u66f4\u6539\uff0c\u5e76\u4e14\u5f53\u524d\u6ca1\u6709\u673a\u5236\u6765\u7f16\u5199\u548c\u9644\u52a0\u8fc7\u6ee4\u5668\u6765\u8fdb\u884c\u8f93\u5165\u5185\u5bb9\u8f6c\u6362\u3002\u8f93\u5165\u8fc7\u6ee4\u5c06\u51fa\u73b0\u5728nginx\u7684\u672a\u6765\u7248\u672c\u4e2d\u3002</p> <p>\u8fc7\u6ee4\u5668\u9075\u5faa\u7279\u5b9a\u7684\u8bbe\u8ba1\u6a21\u5f0f\u3002\u8c03\u7528\u8fc7\u6ee4\u5668\uff0c\u5f00\u59cb\u5de5\u4f5c\uff0c\u5e76\u8c03\u7528\u4e0b\u4e00\u4e2a\u8fc7\u6ee4\u5668\uff0c\u76f4\u5230\u8c03\u7528\u94fe\u4e2d\u7684\u6700\u7ec8\u8fc7\u6ee4\u5668\u3002\u4e4b\u540e\uff0cnginx\u5b8c\u6210\u54cd\u5e94\u3002\u8fc7\u6ee4\u5668\u4e0d\u5fc5\u7b49\u5f85\u524d\u4e00\u4e2a\u8fc7\u6ee4\u5668\u5b8c\u6210\u3002\u94fe\u4e2d\u7684\u4e0b\u4e00\u4e2a\u8fc7\u6ee4\u5668\u53ef\u4ee5\u5728\u524d\u4e00\u4e2a\u8f93\u5165\u53ef\u7528\u65f6\u7acb\u5373\u5f00\u59cb\u5de5\u4f5c\u3002\u53cd\u8fc7\u6765\uff0c\u751f\u6210\u7684\u8f93\u51fa\u54cd\u5e94\u53ef\u4ee5\u5728\u6536\u5230\u6765\u81ea\u4e0a\u6e38\u670d\u52a1\u5668\u7684\u6574\u4e2a\u54cd\u5e94\u4e4b\u524d\u4f20\u9012\u7ed9\u5ba2\u6237\u7aef\u3002</p> <p>\u6709\u6807\u5934\u8fc7\u6ee4\u5668\uff08header filter\uff09\u548c\u6b63\u6587\u8fc7\u6ee4\u5668\uff08body filter\uff09; nginx\u5206\u522b\u5c06\u54cd\u5e94\u7684\u6807\u9898\u548c\u6b63\u6587\u63d0\u4f9b\u7ed9\u5173\u8054\u7684\u8fc7\u6ee4\u5668\u3002</p> <p>\u6807\u5934\u8fc7\u6ee4\u5668\u5305\u542b\u4e09\u4e2a\u57fa\u672c\u6b65\u9aa4\uff1a</p> <p>1) \u51b3\u5b9a\u662f\u5426\u5bf9\u6b64\u54cd\u5e94\u8fdb\u884c\u64cd\u4f5c</p> <p>2) \u54cd\u5e94\u64cd\u4f5c</p> <p>3) \u8c03\u7528\u4e0b\u4e00\u4e2a\u8fc7\u6ee4\u5668</p> <p>\u6b63\u6587\u8fc7\u6ee4\u5668\u8f6c\u6362\u751f\u6210\u7684\u5185\u5bb9\uff0c\u4f8b\u5b50\u5305\u62ec\uff1a</p> <ul> <li>\u670d\u52a1\u5668\u7aefinclude</li> <li>XSLT\u8fc7\u6ee4</li> <li>\u56fe\u50cf\u8fc7\u6ee4\uff08\u4f8b\u5982\uff0c\u52a8\u6001\u8c03\u6574\u56fe\u50cf\u5927\u5c0f\uff09</li> <li>\u5b57\u7b26\u96c6\u4fee\u6539</li> <li><code>gzip</code>\u538b\u7f29</li> <li>\u5206\u5757\u7f16\u7801</li> </ul> <p>\u5728\u8fc7\u6ee4\u5668\u94fe\u4e4b\u540e\uff0c\u54cd\u5e94\u88ab\u4f20\u9012\u7ed9writer\u3002\u4e0ewriter\u4e00\u8d77\uff0c\u8fd8\u6709\u4e00\u4e9b\u989d\u5916\u7684\u4e13\u7528\u8fc7\u6ee4\u5668\uff0c\u5373<code>copy</code>\u8fc7\u6ee4\u5668\u548c<code>postpone</code>\u8fc7\u6ee4\u5668\u3002<code>copy</code>\u8fc7\u6ee4\u5668\u8d1f\u8d23\u4f7f\u7528\u53ef\u80fd\u5b58\u50a8\u5728\u4ee3\u7406\u4e34\u65f6\u76ee\u5f55\u4e2d\u7684\u76f8\u5173\u54cd\u5e94\u5185\u5bb9\u586b\u5145\u5185\u5b58\u7f13\u51b2\u533a\u3002<code>postpone</code>\u8fc7\u6ee4\u5668\u7528\u4e8e\u5b50\u8bf7\u6c42\u3002</p> <p>\u5b50\u8bf7\u6c42\u662f\u8bf7\u6c42/\u54cd\u5e94\u5904\u7406\u7684\u975e\u5e38\u91cd\u8981\u7684\u673a\u5236\u3002\u5b50\u8bf7\u6c42\u4e5f\u662fnginx\u6700\u5f3a\u5927\u7684\u65b9\u9762\u4e4b\u4e00\u3002\u5bf9\u4e8e\u5b50\u8bf7\u6c42\uff0cnginx\u53ef\u4ee5\u4ece\u4e0e\u5ba2\u6237\u7aef\u6700\u521d\u8bf7\u6c42\u7684URL\u4e0d\u540c\u7684URL\u8fd4\u56de\u7ed3\u679c\u3002\u4e00\u4e9bWeb\u6846\u67b6\u5c06\u6b64\u79f0\u4e3a\u5185\u90e8\u91cd\u5b9a\u5411\u3002\u4f46\u662f\uff0cnginx\u66f4\u8fdb\u4e00\u6b65 - \u8fc7\u6ee4\u5668\u4e0d\u4ec5\u53ef\u4ee5\u6267\u884c\u591a\u4e2a\u5b50\u8bf7\u6c42\uff0c\u800c\u4e14\u53ef\u4ee5\u5c06\u8f93\u51fa\u7ec4\u5408\u6210\u5355\u4e2a\u54cd\u5e94\uff0c\u4f46\u5b50\u8bf7\u6c42\u4e5f\u53ef\u4ee5\u5d4c\u5957\u548c\u5206\u5c42\u3002\u5b50\u8bf7\u6c42\u53ef\u4ee5\u6267\u884c\u5176\u81ea\u5df1\u7684<code>\u5b50\u5b50\u8bf7\u6c42</code>\uff08sub-subrequest\uff09\uff0c\u5e76\u4e14\u5b50\u5b50\u8bf7\u6c42\u53ef\u4ee5\u53d1\u8d77\u5b50\u5b50\u5b50\u8bf7\u6c42\u3002\u5b50\u8bf7\u6c42\u53ef\u4ee5\u6620\u5c04\u5230\u786c\u76d8\uff0c\u5176\u4ed6\u5904\u7406\u7a0b\u5e8f\u6216\u4e0a\u6e38\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\u3002\u5b50\u8bf7\u6c42\u5bf9\u4e8e\u6839\u636e\u539f\u59cb\u54cd\u5e94\u4e2d\u7684\u6570\u636e\u63d2\u5165\u5176\u4ed6\u5185\u5bb9\u975e\u5e38\u6709\u7528\u3002\u4f8b\u5982\uff0cSSI\uff08\u670d\u52a1\u5668\u7aef\u5305\u542b\uff09\u6a21\u5757\u4f7f\u7528\u8fc7\u6ee4\u5668\u6765\u89e3\u6790\u8fd4\u56de\u6587\u6863\u7684\u5185\u5bb9\uff0c\u7136\u540e\u5c06<code>include</code>\u4f2a\u6307\u4ee4\u66ff\u6362\u4e3a\u6307\u5b9aURL\u7684\u5185\u5bb9\u3002\u6216\u8005\uff0c\u5b83\u53ef\u4ee5\u662f\u4e00\u4e2a\u8fc7\u6ee4\u5668\uff0c\u5c06\u6587\u6863\u7684\u6574\u4e2a\u5185\u5bb9\u89c6\u4e3a\u8981\u68c0\u7d22\u7684URL\uff0c\u7136\u540e\u5c06\u65b0\u6587\u6863\u9644\u52a0\u5230URL\u672c\u8eab\u3002</p> <p>\u4e0a\u6e38\u548c\u8d1f\u8f7d\u5e73\u8861\u5668\u4e5f\u503c\u5f97\u7b80\u8981\u63cf\u8ff0\u3002\u4e0a\u6e38\u7528\u4e8e\u5b9e\u73b0\u53ef\u4ee5\u88ab\u8bc6\u522b\u4e3a\u5185\u5bb9\u5904\u7406\u7a0b\u5e8f\u7684\u5185\u5bb9\uff0c\u8be5\u5185\u5bb9\u5904\u7406\u7a0b\u5e8f\u662f\u53cd\u5411\u4ee3\u7406\uff08<code>proxy_pass</code>\u5904\u7406\u7a0b\u5e8f\uff09\u3002\u4e0a\u6e38\u6a21\u5757\u4e3b\u8981\u51c6\u5907\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u4e0a\u6e38\u670d\u52a1\u5668\uff08\u6216\u201c\u540e\u7aef\u201d\uff09\u5e76\u4ece\u4e0a\u6e38\u670d\u52a1\u5668\u63a5\u6536\u54cd\u5e94\u3002\u8fd9\u91cc\u6ca1\u6709\u8c03\u7528\u8f93\u51fa\u8fc7\u6ee4\u5668\u3002\u5f53\u4e0a\u6e38\u670d\u52a1\u5668\u51c6\u5907\u597d\u88ab\u5199\u5165\u548c\u8bfb\u53d6\u65f6\uff0c\u4e0a\u6e38\u6a21\u5757\u786e\u5207\u5730\u505a\u7684\u662f\u8bbe\u7f6e\u8981\u8c03\u7528\u7684\u56de\u8c03\u3002</p> <p>\u5b58\u5728\u5b9e\u73b0\u4ee5\u4e0b\u529f\u80fd\u7684\u56de\u8c03\uff1a</p> <ul> <li>\u5236\u4f5c\u8981\u53d1\u9001\u5230\u4e0a\u6e38\u670d\u52a1\u5668\u7684\u8bf7\u6c42\u7f13\u51b2\u533a\uff08\u6216\u5b83\u4eec\u7684\u94fe\uff09</li> <li>\u91cd\u65b0\u521d\u59cb\u5316/\u91cd\u7f6e\u4e0e\u4e0a\u6e38\u670d\u52a1\u5668\u7684\u8fde\u63a5\uff08\u5728\u518d\u6b21\u521b\u5efa\u8bf7\u6c42\u4e4b\u524d\u53d1\u751f\uff09</li> <li>\u5904\u7406\u4e0a\u6e38\u54cd\u5e94\u7684\u7b2c\u4e00\u4f4d\u5e76\u4fdd\u5b58\u6307\u5411\u4ece\u4e0a\u6e38\u670d\u52a1\u5668\u63a5\u6536\u7684\u6709\u6548\u8d1f\u8f7d\u7684\u6307\u9488</li> <li>\u4e2d\u6b62\u8bf7\u6c42\uff08\u5728\u5ba2\u6237\u7aef\u8fc7\u65e9\u7ec8\u6b62\u65f6\u53d1\u751f\uff09</li> <li>\u5f53nginx\u5b8c\u6210\u4ece\u4e0a\u6e38\u670d\u52a1\u5668\u8bfb\u53d6\u65f6\u5b8c\u6210\u8bf7\u6c42</li> <li>\u4fee\u526a\u54cd\u5e94\u6b63\u6587\uff08\u4f8b\u5982\u79fb\u9664\u62d6\u8f66\uff09</li> </ul> <p>\u8d1f\u8f7d\u5e73\u8861\u5668\u6a21\u5757\u8fde\u63a5\u5230<code>proxy_pass</code>\u5904\u7406\u7a0b\u5e8f\uff0c\u4ee5\u4fbf\u5728\u591a\u4e2a\u4e0a\u6e38\u670d\u52a1\u5668\u7b26\u5408\u6761\u4ef6\u65f6\u63d0\u4f9b\u9009\u62e9\u4e0a\u6e38\u670d\u52a1\u5668\u7684\u529f\u80fd\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u6ce8\u518c\u542f\u7528\u914d\u7f6e\u6587\u4ef6\u6307\u4ee4\uff0c\u63d0\u4f9b\u989d\u5916\u7684\u4e0a\u6e38\u521d\u59cb\u5316\u51fd\u6570\uff08\u4ee5\u89e3\u6790DNS\u4e2d\u7684\u4e0a\u6e38\u540d\u79f0\u7b49\uff09\uff0c\u521d\u59cb\u5316\u8fde\u63a5\u7ed3\u6784\uff0c\u51b3\u5b9a\u5c06\u8bf7\u6c42\u8def\u7531\u5230\u4f55\u5904\u4ee5\u53ca\u66f4\u65b0\u7edf\u8ba1\u4fe1\u606f\u3002\u76ee\u524d\uff0cnginx\u652f\u6301\u4e24\u79cd\u6807\u51c6\u89c4\u5219\uff0c\u7528\u4e8e\u5bf9\u4e0a\u6e38\u670d\u52a1\u5668\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\uff1a<code>round-robin</code>\u548c<code>ip-hash</code>\u3002</p> <p>\u4e0a\u6e38\u548c\u8d1f\u8f7d\u5e73\u8861\u5904\u7406\u673a\u5236\u5305\u62ec\u7528\u4e8e\u68c0\u6d4b\u5931\u8d25\u7684\u4e0a\u6e38\u670d\u52a1\u5668\u5e76\u5c06\u65b0\u8bf7\u6c42\u91cd\u65b0\u8def\u7531\u5230\u5176\u4f59\u670d\u52a1\u5668\u7684\u7b97\u6cd5 - \u5c3d\u7ba1\u8ba1\u5212\u8fdb\u884c\u5927\u91cf\u989d\u5916\u5de5\u4f5c\u4ee5\u589e\u5f3a\u6b64\u529f\u80fd\u3002\u901a\u5e38\uff0c\u8ba1\u5212\u5728\u8d1f\u8f7d\u5e73\u8861\u5668\u4e0a\u5f00\u5c55\u66f4\u591a\u5de5\u4f5c\uff0c\u5e76\u4e14\u5728\u4e0b\u4e00\u7248\u672c\u7684nginx\u4e2d\uff0c\u5c06\u5927\u5927\u6539\u8fdb\u8de8\u4e0d\u540c\u4e0a\u6e38\u670d\u52a1\u5668\u5206\u914d\u8d1f\u8f7d\u4ee5\u53ca\u8fd0\u884c\u72b6\u51b5\u68c0\u67e5\u7684\u673a\u5236\u3002</p> <p>\u8fd8\u6709\u4e00\u4e9b\u5176\u4ed6\u6709\u8da3\u7684\u6a21\u5757\u63d0\u4f9b\u4e86\u4e00\u7ec4\u989d\u5916\u7684\u53d8\u91cf\u4f9b\u914d\u7f6e\u6587\u4ef6\u4f7f\u7528\u3002\u867d\u7136nginx\u4e2d\u7684\u53d8\u91cf\u662f\u5728\u4e0d\u540c\u6a21\u5757\u4e2d\u521b\u5efa\u548c\u66f4\u65b0\u7684\uff0c\u4f46\u6709\u4e24\u4e2a\u6a21\u5757\u5b8c\u5168\u4e13\u7528\u4e8e\u53d8\u91cf\uff1a<code>geo</code>\u548c<code>map</code>\u3002<code>geo</code>\u6a21\u5757\u7528\u4e8e\u6839\u636e\u5ba2\u6237\u7aef\u7684IP\u5730\u5740\u6765\u8ddf\u8e2a\u5ba2\u6237\u7aef\u3002\u6b64\u6a21\u5757\u53ef\u4ee5\u521b\u5efa\u4f9d\u8d56\u4e8e\u5ba2\u6237\u7aefIP\u5730\u5740\u7684\u4efb\u610f\u53d8\u91cf\u3002\u53e6\u4e00\u4e2a\u6a21\u5757map\u5141\u8bb8\u4ece\u5176\u4ed6\u53d8\u91cf\u521b\u5efa\u53d8\u91cf\uff0c\u5b9e\u8d28\u4e0a\u63d0\u4f9b\u4e86\u5bf9\u4e3b\u673a\u540d\u548c\u5176\u4ed6\u8fd0\u884c\u65f6\u53d8\u91cf\u8fdb\u884c\u7075\u6d3b\u6620\u5c04\u7684\u80fd\u529b\u3002\u8fd9\u79cd\u6a21\u5757\u53ef\u4ee5\u79f0\u4e3a\u53d8\u91cf\u5904\u7406\u5668\uff08variable handler\uff09\u3002</p> <p>\u5728\u4e00\u4e2anginx worker\u4e2d\u5b9e\u73b0\u7684\u5185\u5b58\u5206\u914d\u673a\u5236\u5728\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u53d7\u5230\u4e86Apache\u7684\u542f\u53d1\u3002 nginx\u5185\u5b58\u7ba1\u7406\u7684\u9ad8\u7ea7\u63cf\u8ff0\u5982\u4e0b\uff1a\u5bf9\u4e8e\u6bcf\u4e2a\u8fde\u63a5\uff0c\u5fc5\u8981\u7684\u5185\u5b58\u7f13\u51b2\u533a\u88ab\u52a8\u6001\u5206\u914d\uff0c\u94fe\u63a5\uff0c\u7528\u4e8e\u5b58\u50a8\u548c\u64cd\u4f5c\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u5934\u90e8\u548c\u4e3b\u4f53\uff0c\u7136\u540e\u5728\u8fde\u63a5\u91ca\u653e\u65f6\u91ca\u653e\u3002\u975e\u5e38\u91cd\u8981\u7684\u662f\u8981\u6ce8\u610fnginx\u5c3d\u91cf\u907f\u514d\u5728\u5185\u5b58\u4e2d\u590d\u5236\u6570\u636e\uff0c\u5e76\u4e14\u5927\u591a\u6570\u6570\u636e\u90fd\u662f\u901a\u8fc7\u6307\u9488\u503c\u4f20\u9012\u7684\uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u8c03\u7528<code>memcpy</code>\u4f20\u9012\u7684\u3002</p> <p>\u66f4\u6df1\u5165\u4e00\u70b9\uff0c\u5f53\u6a21\u5757\u751f\u6210\u54cd\u5e94\u65f6\uff0c\u5c06\u68c0\u7d22\u5230\u7684\u5185\u5bb9\u653e\u5165\u5185\u5b58\u7f13\u51b2\u533a\uff0c\u7136\u540e\u5c06\u5176\u6dfb\u52a0\u5230\u7f13\u51b2\u533a\u94fe\u63a5\u94fe\u63a5\u4e2d\u3002\u540e\u7eed\u5904\u7406\u4e5f\u9002\u7528\u4e8e\u6b64\u7f13\u51b2\u94fe\u94fe\u63a5\u3002\u7f13\u51b2\u94fe\u5728nginx\u4e2d\u975e\u5e38\u590d\u6742\uff0c\u56e0\u4e3a\u6709\u51e0\u79cd\u5904\u7406\u65b9\u6848\u56e0\u6a21\u5757\u7c7b\u578b\u800c\u5f02\u3002\u4f8b\u5982\uff0c\u5728\u5b9e\u73b0\u4f53\u6ee4\u6ce2\u5668\u6a21\u5757\u65f6\u7cbe\u786e\u7ba1\u7406\u7f13\u51b2\u533a\u53ef\u80fd\u975e\u5e38\u68d8\u624b\u3002\u8fd9\u6837\u7684\u6a21\u5757\u4e00\u6b21\u53ea\u80fd\u5728\u4e00\u4e2a\u7f13\u51b2\u533a\uff08\u94fe\u8def\u94fe\u8def\uff09\u4e0a\u8fd0\u884c\uff0c\u5b83\u5fc5\u987b\u51b3\u5b9a\u662f\u5426\u8986\u76d6\u8f93\u5165\u7f13\u51b2\u533a\uff0c\u7528\u65b0\u5206\u914d\u7684\u7f13\u51b2\u533a\u66ff\u6362\u7f13\u51b2\u533a\uff0c\u6216\u8005\u5728\u6709\u95ee\u9898\u7684\u7f13\u51b2\u533a\u4e4b\u524d\u6216\u4e4b\u540e\u63d2\u5165\u65b0\u7684\u7f13\u51b2\u533a\u3002\u66f4\u590d\u6742\u7684\u662f\uff0c\u6709\u65f6\u6a21\u5757\u4f1a\u6536\u5230\u51e0\u4e2a\u7f13\u51b2\u533a\uff0c\u56e0\u6b64\u5b83\u5fc5\u987b\u6709\u4e00\u4e2a\u4e0d\u5b8c\u6574\u7684\u7f13\u51b2\u533a\u94fe\u3002\u4f46\u662f\uff0c\u6b64\u65f6nginx\u53ea\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7528\u4e8e\u64cd\u4f5c\u7f13\u51b2\u533a\u94fe\u7684\u4f4e\u7ea7API\uff0c\u56e0\u6b64\u5728\u8fdb\u884c\u4efb\u4f55\u5b9e\u9645\u5b9e\u73b0\u4e4b\u524d\uff0c\u7b2c\u4e09\u65b9\u6a21\u5757\u5f00\u53d1\u4eba\u5458\u5e94\u8be5\u80fd\u591f\u719f\u7ec3\u4f7f\u7528nginx\u8fd9\u4e2a\u795e\u79d8\u7684\u90e8\u5206\u3002</p> <p>\u5173\u4e8e\u4e0a\u8ff0\u65b9\u6cd5\u7684\u6ce8\u91ca\u662f\u5728\u8fde\u63a5\u7684\u6574\u4e2a\u751f\u547d\u5468\u671f\u4e2d\u5206\u914d\u4e86\u5185\u5b58\u7f13\u51b2\u533a\uff0c\u56e0\u6b64\u5bf9\u4e8e\u957f\u671f\u8fde\u63a5\uff0c\u4fdd\u7559\u4e86\u4e00\u4e9b\u989d\u5916\u7684\u5185\u5b58\u3002\u540c\u65f6\uff0c\u5728\u7a7a\u95f2\u7684keepalive\u8fde\u63a5\u4e0a\uff0cnginx\u53ea\u82b1\u8d39550\u4e2a\u5b57\u8282\u7684\u5185\u5b58\u3002\u5bf9nginx\u7684\u672a\u6765\u7248\u672c\u8fdb\u884c\u53ef\u80fd\u7684\u4f18\u5316\u5c06\u662f\u91cd\u7528\u548c\u5171\u4eab\u5185\u5b58\u7f13\u51b2\u533a\u4ee5\u5b9e\u73b0\u957f\u671f\u8fde\u63a5\u3002</p> <p>\u7ba1\u7406\u5185\u5b58\u5206\u914d\u7684\u4efb\u52a1\u7531nginx\u6c60\u5206\u914d\u5668\u5b8c\u6210\u3002\u5171\u4eab\u5185\u5b58\u533a\u57df\u7528\u4e8e\u63a5\u53d7\u4e92\u65a5\u9501\uff0c\u7f13\u5b58\u5143\u6570\u636e\uff0cSSL\u4f1a\u8bdd\u7f13\u5b58\u4ee5\u53ca\u4e0e\u5e26\u5bbd\u7ba1\u5236\u548c\u7ba1\u7406\uff08\u9650\u5236\uff09\u76f8\u5173\u7684\u4fe1\u606f\u3002\u5728nginx\u4e2d\u5b9e\u73b0\u4e86\u4e00\u4e2aslab\u5206\u914d\u5668\u6765\u7ba1\u7406\u5171\u4eab\u5185\u5b58\u5206\u914d\u3002\u4e3a\u4e86\u5141\u8bb8\u540c\u65f6\u5b89\u5168\u4f7f\u7528\u5171\u4eab\u5185\u5b58\uff0c\u53ef\u4ee5\u4f7f\u7528\u8bb8\u591a\u9501\u5b9a\u673a\u5236\uff08\u4e92\u65a5\u9501\u548c\u4fe1\u53f7\u91cf\uff09\u3002\u4e3a\u4e86\u7ec4\u7ec7\u590d\u6742\u7684\u6570\u636e\u7ed3\u6784\uff0cnginx\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7ea2\u9ed1\u6811\u5b9e\u73b0\u3002\u7ea2\u9ed1\u6811\u7528\u4e8e\u5c06\u7f13\u5b58\u5143\u6570\u636e\u4fdd\u5b58\u5728\u5171\u4eab\u5185\u5b58\u4e2d\uff0c\u8ddf\u8e2a\u975e\u6b63\u5219\u8868\u8fbe\u5f0f\u4f4d\u7f6e\u5b9a\u4e49\u4ee5\u53ca\u5176\u4ed6\u51e0\u9879\u4efb\u52a1\u3002</p> <p>\u4e0d\u5e78\u7684\u662f\uff0c\u4ee5\u4e0a\u6240\u6709\u5185\u5bb9\u4ece\u672a\u4ee5\u4e00\u81f4\u548c\u7b80\u5355\u7684\u65b9\u5f0f\u63cf\u8ff0\uff0c\u4f7f\u5f97\u4e3anginx\u5f00\u53d1\u7b2c\u4e09\u65b9\u6269\u5c55\u7684\u5de5\u4f5c\u76f8\u5f53\u590d\u6742\u3002\u867d\u7136\u5b58\u5728\u5173\u4e8enginx\u5185\u90e8\u7684\u4e00\u4e9b\u597d\u7684\u6587\u6863 - \u4f8b\u5982\uff0c\u7531Evan Miller\u751f\u6210\u7684\u90a3\u4e9b\u6587\u6863 - \u9700\u8981\u5927\u91cf\u7684\u9006\u5411\u5de5\u7a0b\u5de5\u4f5c\uff0c\u5e76\u4e14nginx\u6a21\u5757\u7684\u5b9e\u73b0\u5bf9\u4e8e\u8bb8\u591a\u4eba\u6765\u8bf4\u4ecd\u7136\u662f\u9ed1\u8272\u827a\u672f\uff08balck art\uff09\u3002</p> <p>\u5c3d\u7ba1\u4e0e\u7b2c\u4e09\u65b9\u6a21\u5757\u5f00\u53d1\u76f8\u5173\u7684\u67d0\u4e9b\u56f0\u96be\uff0cnginx\u7528\u6237\u793e\u533a\u6700\u8fd1\u770b\u5230\u4e86\u8bb8\u591a\u6709\u7528\u7684\u7b2c\u4e09\u65b9\u6a21\u5757\u3002\u4f8b\u5982\uff0c\u6709\u4e00\u4e2a\u7528\u4e8enginx\u7684\u5d4c\u5165\u5f0fLua\u89e3\u91ca\u5668\u6a21\u5757\uff0c\u7528\u4e8e\u8d1f\u8f7d\u5e73\u8861\u7684\u9644\u52a0\u6a21\u5757\uff0c\u5b8c\u6574\u7684WebDAV\u652f\u6301\uff0c\u9ad8\u7ea7\u7f13\u5b58\u63a7\u5236\u4ee5\u53ca\u672c\u7ae0\u4f5c\u8005\u9f13\u52b1\u5e76\u5c06\u5728\u672a\u6765\u652f\u6301\u7684\u5176\u4ed6\u6709\u8da3\u7684\u7b2c\u4e09\u65b9\u5de5\u4f5c\u3002</p>"},{"location":"2019-01-31-nginx%E6%9E%B6%E6%9E%84/#_2","title":"\u5f97\u5230\u7684\u6559\u8bad","text":"<p>\u5f53Igor Sysoev\u5f00\u59cb\u7f16\u5199nginx\u65f6\uff0c\u5927\u591a\u6570\u652f\u6301Internet\u7684\u8f6f\u4ef6\u5df2\u7ecf\u5b58\u5728\uff0c\u5e76\u4e14\u8fd9\u79cd\u8f6f\u4ef6\u7684\u4f53\u7cfb\u7ed3\u6784\u901a\u5e38\u9075\u5faa\u4f20\u7edf\u670d\u52a1\u5668\u548c\u7f51\u7edc\u786c\u4ef6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u548c\u65e7\u7684Internet\u4f53\u7cfb\u7ed3\u6784\u7684\u5b9a\u4e49\u3002\u7136\u800c\uff0c\u8fd9\u5e76\u6ca1\u6709\u963b\u6b62Igor\u8ba4\u4e3a\u4ed6\u53ef\u80fd\u80fd\u591f\u6539\u8fdbWeb\u670d\u52a1\u5668\u9886\u57df\u7684\u4e1c\u897f\u3002\u6240\u4ee5\uff0c\u867d\u7136\u7b2c\u4e00\u8bfe\u53ef\u80fd\u770b\u8d77\u6765\u5f88\u660e\u663e\uff0c\u4f46\u4e8b\u5b9e\u662f\uff1a\u603b\u6709\u6539\u8fdb\u7684\u4f59\u5730\u3002</p> <p>\u8003\u8651\u5230\u66f4\u597d\u7684Web\u8f6f\u4ef6\u7684\u60f3\u6cd5\uff0cIgor\u82b1\u4e86\u5f88\u591a\u65f6\u95f4\u5f00\u53d1\u521d\u59cb\u4ee3\u7801\u7ed3\u6784\u5e76\u7814\u7a76\u4e3a\u5404\u79cd\u64cd\u4f5c\u7cfb\u7edf\u4f18\u5316\u4ee3\u7801\u7684\u4e0d\u540c\u65b9\u6cd5\u3002\u5341\u5e74\u540e\uff0c\u4ed6\u6b63\u5728\u5f00\u53d1nginx\u7248\u672c2.0\u7684\u539f\u578b\uff0c\u8003\u8651\u5230\u7248\u672c1\u7684\u591a\u5e74\u79ef\u6781\u5f00\u53d1\u3002\u5f88\u660e\u663e\uff0c\u65b0\u67b6\u6784\u7684\u521d\u59cb\u539f\u578b\u548c\u521d\u59cb\u4ee3\u7801\u7ed3\u6784\u5bf9\u4e8e\u672a\u6765\u7684\u91cd\u8981\u6027\u975e\u5e38\u91cd\u8981\u3002\u4e00\u4e2a\u8f6f\u4ef6\u4ea7\u54c1\u3002</p> <p>\u503c\u5f97\u4e00\u63d0\u7684\u53e6\u4e00\u70b9\u662f\u53d1\u5c55\u5e94\u8be5\u96c6\u4e2d\u3002 Windows\u7248\u672c\u7684nginx\u53ef\u80fd\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\uff0c\u8bf4\u660e\u5982\u4f55\u907f\u514d\u5728\u65e2\u4e0d\u662f\u5f00\u53d1\u4eba\u5458\u7684\u6838\u5fc3\u7ade\u4e89\u529b\u6216\u76ee\u6807\u5e94\u7528\u7a0b\u5e8f\u7684\u60c5\u51b5\u4e0b\u7a00\u91ca\u5f00\u53d1\u5de5\u4f5c\u3002\u5b83\u540c\u6837\u9002\u7528\u4e8e\u91cd\u5199\u5f15\u64ce\uff0c\u8be5\u5f15\u64ce\u5728\u591a\u6b21\u5c1d\u8bd5\u589e\u5f3anginx\u65f6\u51fa\u73b0\uff0c\u5177\u6709\u66f4\u591a\u529f\u80fd\uff0c\u4ee5\u4fbf\u4e0e\u73b0\u6709\u7684\u65e7\u8bbe\u7f6e\u5411\u540e\u517c\u5bb9\u3002</p> <p>\u6700\u540e\u4f46\u540c\u6837\u91cd\u8981\u7684\u662f\uff0c\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u5c3d\u7ba1nginx\u5f00\u53d1\u4eba\u5458\u793e\u533a\u4e0d\u662f\u5f88\u5927\uff0c\u4f46nginx\u7684\u7b2c\u4e09\u65b9\u6a21\u5757\u548c\u6269\u5c55\u4e00\u76f4\u662f\u5176\u53d7\u6b22\u8fce\u7a0b\u5ea6\u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\u3002 Evan Miller\uff0cPiotr Sikora\uff0cValery Kholodkov\uff0cZhang Yichun\uff08agentzh\uff09\u548c\u5176\u4ed6\u624d\u534e\u6a2a\u6ea2\u7684\u8f6f\u4ef6\u5de5\u7a0b\u5e08\u6240\u505a\u7684\u5de5\u4f5c\u5f97\u5230\u4e86nginx\u7528\u6237\u793e\u533a\u53ca\u5176\u539f\u59cb\u5f00\u53d1\u4eba\u5458\u7684\u8d5e\u8d4f\u3002</p>"},{"location":"2019-02-22-MySQL%E6%B5%8B%E8%AF%95%E8%A1%A8%E4%B8%AD%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E8%A1%8C%E7%9A%84%E6%9C%80%E4%BD%B3%E6%96%B9%E6%B3%95/","title":"2019 02 22 MySQL\u6d4b\u8bd5\u8868\u4e2d\u662f\u5426\u5b58\u5728\u884c\u7684\u6700\u4f73\u65b9\u6cd5","text":"<pre><code>SELECT EXISTS(\nSELECT id FROM funds\nWHERE user_id = #{userId}\nAND school_id = #{schoolId}\nLIMIT 1)\n</code></pre>"},{"location":"2019-02-22-MySQL%E6%B5%8B%E8%AF%95%E8%A1%A8%E4%B8%AD%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E8%A1%8C%E7%9A%84%E6%9C%80%E4%BD%B3%E6%96%B9%E6%B3%95/#_1","title":"\u53c2\u8003","text":"<ul> <li>best-way-to-test-if-a-row-exists-in-a-mysql-table</li> </ul>"},{"location":"2019-03-10-%E4%BD%BF%E7%94%A8tcpdump%E6%8A%93%E5%8C%85/","title":"2019 03 10 \u4f7f\u7528tcpdump\u6293\u5305","text":"<p>\u5728\u5f00\u53d1\u7f51\u7edc\u7a0b\u5e8f\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528WireShark\u7b49\u5de5\u5177\u5728\u672c\u5730\u6293\u5305\uff0c\u4f46\u5f80\u5f80\u672c\u5730\u65e0\u6cd5\u6a21\u62df\u751f\u4ea7\u73af\u5883\u7684\u7f51\u7edc\u72b6\u51b5\uff0c\u6240\u4ee5\u6211\u4eec\u6709\u5728\u670d\u52a1\u5668\u4e0a\u6293\u5305\u7684\u9700\u6c42\uff1btcpdump\u53ef\u4ee5\u80dc\u4efb\u8fd9\u4e2a\u5de5\u4f5c\uff0c\u9996\u5148\u4f60\u53ef\u4ee5\u4f7f\u7528\u5305\u7ba1\u7406\u5668\u76f4\u63a5\u5b89\u88c5\u5b83\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5df1\u6784\u5efa\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u4f7f\u7528\u5176\u8fc7\u6ee4\u8bed\u6cd5\u786e\u5b9a\u6293\u53d6\u7684\u6d41\u91cf\u7684\u8303\u56f4\uff0c\u4f8b\u5982\uff1a\u5728\u6240\u6709\u7f51\u7edc\u63a5\u53e3\u4e0a\u6293\u53d6\u7aef\u53e3\u662f<code>5070</code>\u7684\u6d41\u91cf\uff0c\u5e76\u4e14\u4fdd\u5b58\u5230\u6587\u4ef6<code>~/5070.pcap</code>\uff1a</p> <pre><code>$ sudo tcpdump -nvAx -i any 'port 5070' -w ~/5070.pcap\n</code></pre> <p>\u5c06\u6587\u4ef6\u62f7\u8d1d\u5230\u672c\u5730\u540e\uff0c\u53ef\u4f7f\u7528WireShark\u6253\u5f00\uff0c\u5982\u56fe\uff1a</p> <p></p>"},{"location":"2019-03-10-%E4%BD%BF%E7%94%A8tcpdump%E6%8A%93%E5%8C%85/#_1","title":"\u53c2\u8003","text":"<ul> <li>Let's learn tcpdump! by Julia Evans</li> <li>Tcpdump filters by Marios Iliofotou</li> </ul>"},{"location":"2019-03-10-%E5%AE%9E%E8%B7%B5java.util.concurrent.TransferQueue/","title":"2019 03 10 \u5b9e\u8df5java.util.concurrent.TransferQueue","text":""},{"location":"2019-03-10-%E5%AE%9E%E8%B7%B5java.util.concurrent.TransferQueue/#_1","title":"\u7efc\u8ff0","text":"<p>java.util.concurrent.TransferQueue\u662fJava Collections Framework\u7684\u6210\u5458\u4e4b\u4e00\uff0c\u5141\u8bb8\u6211\u4eec\u6839\u636e\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u6a21\u5f0f\u521b\u5efa\u7a0b\u5e8f\uff0c\u5e76\u534f\u8c03\u4ece\u751f\u4ea7\u8005\u4f20\u9012\u7ed9\u6d88\u8d39\u8005\u7684\u6d88\u606f\uff0c\u5176JDK\u5185\u7684\u5b9e\u73b0\u662f<code>java.util.concurrent.LinkedTransferQueue</code>\u3002</p> <p>\u5b9e\u73b0\u5b9e\u9645\u4e0a\u7c7b\u4f3c\u4e8e<code>BlockingQueue</code> - \u4f46\u662f\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u5b9e\u73b0<code>backpressure</code>\u5f62\u5f0f\u7684\u65b0\u529f\u80fd\u3002\u8fd9\u610f\u5473\u7740\uff0c\u5f53\u751f\u4ea7\u8005\u4f7f\u7528<code>transfer()</code>\u65b9\u6cd5\u5411\u4f7f\u7528\u8005\u53d1\u9001\u6d88\u606f\u65f6\uff0c\u751f\u4ea7\u8005\u5c06\u4fdd\u6301\u963b\u585e\u72b6\u6001\uff0c\u76f4\u5230\u6d88\u606f\u88ab\u6d88\u8017\u4e3a\u6b62\uff08<code>tryTransfer()</code>\u662f\u975e\u963b\u585e\u7684\uff09\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7<code>hasWaitingConsumer()</code>\u67e5\u8be2\u662f\u5426\u6709\u4efb\u4f55\u6d88\u8d39\u8005\u5728\u7b49\u5f85\uff0c\u4e0e<code>peek()</code>\u64cd\u4f5c\u76f8\u53cd\u3002</p>"},{"location":"2019-03-10-%E5%AE%9E%E8%B7%B5java.util.concurrent.TransferQueue/#_2","title":"\u4e00\u4e2a\u751f\u4ea7\u8005\u2014\u2014\u65e0\u6d88\u8d39\u8005","text":"<p>\u9996\u5148\uff0c\u8bbe\u8ba1\u4e00\u4e2a\u751f\u4ea7\u8005\u6765\u6d4b\u8bd5<code>transfer()</code>\u65b9\u6cd5 - \u9884\u671f\u662f\u751f\u4ea7\u8005\u5c06\u88ab\u963b\u585e\uff0c\u76f4\u5230\u6d88\u8d39\u8005\u4f7f\u7528<code>take()</code>\u65b9\u6cd5\u4ece\u961f\u5217\u63a5\u6536\u6d88\u606f\u3002</p> <pre><code>class Producer implements Runnable {\nprivate TransferQueue&lt;String&gt; transferQueue;\n\nprivate String name;\n\nprivate Integer numberOfMessagesToProduce;\n\npublic AtomicInteger numberOfProducedMessages\n= new AtomicInteger();\n\n@Override\npublic void run() {\nfor (int i = 0; i &lt; numberOfMessagesToProduce; i++) {\ntry {\nboolean added\n= transferQueue.tryTransfer(\"A\" + i, 4000, TimeUnit.MILLISECONDS);\nif(added){\nnumberOfProducedMessages.incrementAndGet();\n}\n} catch (InterruptedException e) {\ne.printStackTrace();\n}\n}\n}\n// standard constructors\n}\n</code></pre> <p>\u6211\u4eec\u5c06<code>\u4e00\u4e2aTransferQueue\u5b9e\u4f8b</code>\u4e0e\u6211\u4eec<code>\u60f3\u8981\u4e3a\u751f\u4ea7\u8005\u63d0\u4f9b\u7684\u540d\u79f0</code>\u4ee5\u53ca<code>\u5e94\u8be5\u4f20\u8f93\u5230\u961f\u5217\u7684\u5143\u7d20\u6570</code>\u4e00\u8d77\u4f20\u9012\u7ed9\u6784\u9020\u51fd\u6570\u3002</p> <p>\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u662f<code>tryTransfer()</code>\u65b9\u6cd5\uff0c\u5e76\u4e14\u5177\u6709\u7ed9\u5b9a\u7684\u8d85\u65f6\u3002\u6211\u4eec\u6b63\u5728\u7b49\u5f85<code>\u56db\u79d2\u949f</code>\uff0c\u5982\u679c\u751f\u4ea7\u8005\u65e0\u6cd5\u5728\u7ed9\u5b9a\u7684\u8d85\u65f6\u5185\u4f20\u8f93\u6d88\u606f\uff0c\u5219\u8fd4\u56de<code>false</code>\u5e76\u7ee7\u7eed\u6267\u884c\u4e0b\u4e00\u6761\u6d88\u606f\u3002\u751f\u4ea7\u8005\u6709\u4e00\u4e2a<code>numberOfProducedMessages</code>\u53d8\u91cf\u6765\u8ddf\u8e2a\u751f\u6210\u7684\u6d88\u606f\u6570\u91cf\u3002</p> <p>\u7136\u540e\uff0c\u6d88\u8d39\u8005\u8bbe\u8ba1\u5982\u4e0b\uff1a</p> <pre><code>class Consumer implements Runnable {\n\nprivate TransferQueue&lt;String&gt; transferQueue;\n\nprivate String name;\n\nprivate int numberOfMessagesToConsume;\n\npublic AtomicInteger numberOfConsumedMessages\n= new AtomicInteger();\n\n@Override\npublic void run() {\nfor (int i = 0; i &lt; numberOfMessagesToConsume; i++) {\ntry {\nString element = transferQueue.take();\nlongProcessing(element);\n} catch (InterruptedException e) {\ne.printStackTrace();\n}\n}\n}\n\nprivate void longProcessing(String element)\nthrows InterruptedException {\nnumberOfConsumedMessages.incrementAndGet();\nThread.sleep(500);\n}\n\n// standard constructors\n}\n</code></pre> <p>\u5b83\u4e0e\u751f\u4ea7\u8005\u7c7b\u4f3c\uff0c\u4f46\u6211\u4eec\u4f7f\u7528<code>take()</code>\u65b9\u6cd5\u4ece\u961f\u5217\u4e2d\u63a5\u6536\u5143\u7d20\u3002\u6211\u4eec\u8fd8\u901a\u8fc7\u4f7f\u7528<code>longProcessing()</code>\u65b9\u6cd5\u6a21\u62df\u4e00\u4e9b\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u64cd\u4f5c\uff0c\u5728\u8be5\u65b9\u6cd5\u4e2d\u6211\u4eec\u9012\u589e<code>numberOfConsumedMessages</code>\u53d8\u91cf\uff0c\u8be5\u53d8\u91cf\u662f\u63a5\u6536\u6d88\u606f\u7684\u8ba1\u6570\u5668\u3002</p> <p>\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u53ea\u7528\u4e00\u4e2a\u751f\u4ea7\u8005\u5f00\u59cb\u6211\u4eec\u7684\u7a0b\u5e8f\uff1a</p> <pre><code>@Test\npublic void whenUseOneProducerAndNoConsumers_thenShouldFailWithTimeout()\nthrows InterruptedException {\n// given\nTransferQueue&lt;String&gt; transferQueue = new LinkedTransferQueue&lt;&gt;();\nExecutorService exService = Executors.newFixedThreadPool(2);\nProducer producer = new Producer(transferQueue, \"1\", 3);\n\n// when\nexService.execute(producer);\n\n// then\nexService.awaitTermination(5000, TimeUnit.MILLISECONDS);\nexService.shutdown();\n\nassertEquals(producer.numberOfProducedMessages.intValue(), 0);\n}\n</code></pre> <p>\u6211\u4eec\u5e0c\u671b\u5411\u961f\u5217\u53d1\u9001\u4e09\u4e2a\u5143\u7d20\uff0c\u4f46\u751f\u6210\u5668\u5728\u7b2c\u4e00\u4e2a\u5143\u7d20\u4e0a\u88ab\u963b\u585e\uff0c\u5e76\u4e14\u6ca1\u6709\u6d88\u8d39\u8005\u4ece\u961f\u5217\u4e2d\u83b7\u53d6\u8be5\u5143\u7d20\u3002\u6211\u4eec\u6b63\u5728\u4f7f\u7528<code>tryTransfer()</code>\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u5c06\u963b\u585e\uff0c\u76f4\u5230\u6d88\u606f\u88ab\u6d88\u8017\u6216\u8fbe\u5230\u8d85\u65f6\u3002\u8d85\u65f6\u540e\uff0c\u5b83\u5c06\u8fd4\u56de<code>false</code>\u4ee5\u6307\u793a\u4f20\u8f93\u5931\u8d25\uff0c\u5b83\u5c06\u5c1d\u8bd5\u4f20\u8f93\u4e0b\u4e00\u4e2a\u3002\u8fd9\u662f\u4e0a\u4e00\u4e2a\u793a\u4f8b\u7684\u8f93\u51fa\uff1a</p> <pre><code>Producer: 1 is waiting to transfer...\ncan not add an element due to the timeout\nProducer: 1 is waiting to transfer...\n</code></pre>"},{"location":"2019-03-10-%E5%AE%9E%E8%B7%B5java.util.concurrent.TransferQueue/#_3","title":"\u4e00\u4e2a\u751f\u4ea7\u8005\u2014\u2014\u4e00\u4e2a\u6d88\u8d39\u8005","text":"<p>\u8ba9\u6211\u4eec\u6d4b\u8bd5\u4e00\u4e2a\u751f\u4ea7\u8005\u548c\u4e00\u4e2a\u6d88\u8d39\u8005\u7684\u60c5\u51b5\uff1a</p> <pre><code>@Test\npublic void whenUseOneConsumerAndOneProducer_thenShouldProcessAllMessages()\nthrows InterruptedException {\n// given\nTransferQueue&lt;String&gt; transferQueue = new LinkedTransferQueue&lt;&gt;();\nExecutorService exService = Executors.newFixedThreadPool(2);\nProducer producer = new Producer(transferQueue, \"1\", 3);\nConsumer consumer = new Consumer(transferQueue, \"1\", 3);\n\n// when\nexService.execute(producer);\nexService.execute(consumer);\n\n// then\nexService.awaitTermination(5000, TimeUnit.MILLISECONDS);\nexService.shutdown();\n\nassertEquals(producer.numberOfProducedMessages.intValue(), 3);\nassertEquals(consumer.numberOfConsumedMessages.intValue(), 3);\n}\n</code></pre> <p>TransferQueue\u7528\u4f5c<code>\u4ea4\u6362\u70b9</code>\uff0c\u5e76\u4e14\u5728<code>\u6d88\u8d39\u8005\u4f7f\u7528\u961f\u5217\u4e2d\u7684\u5143\u7d20</code>\u4e4b\u524d\uff0c\u751f\u4ea7\u8005\u4e0d\u80fd\u7ee7\u7eed\u5411\u5176\u6dfb\u52a0\u53e6\u4e00\u4e2a\u5143\u7d20\u3002\u6211\u4eec\u6765\u770b\u770b\u7a0b\u5e8f\u8f93\u51fa\uff1a</p> <pre><code>Producer: 1 is waiting to transfer...\nConsumer: 1 is waiting to take element...\nProducer: 1 transferred element: A0\nProducer: 1 is waiting to transfer...\nConsumer: 1 received element: A0\nConsumer: 1 is waiting to take element...\nProducer: 1 transferred element: A1\nProducer: 1 is waiting to transfer...\nConsumer: 1 received element: A1\nConsumer: 1 is waiting to take element...\nProducer: 1 transferred element: A2\nConsumer: 1 received element: A2\n</code></pre> <p>\u6211\u4eec\u770b\u5230\uff0c\u7531\u4e8eTransferQueue\u7684\u89c4\u8303\uff0c\u751f\u6210\u548c\u6d88\u8017\u961f\u5217\u4e2d\u7684\u5143\u7d20\u662f\u987a\u5e8f\u7684\u3002</p>"},{"location":"2019-03-10-%E5%AE%9E%E8%B7%B5java.util.concurrent.TransferQueue/#_4","title":"\u591a\u4e2a\u751f\u4ea7\u8005\u2014\u2014\u591a\u4e2a\u6d88\u8d39\u8005","text":"<p>\u5728\u6700\u540e\u4e00\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5c06\u8003\u8651\u62e5\u6709\u591a\u4e2a\u6d88\u8d39\u8005\u548c\u591a\u4e2a\u751f\u4ea7\u8005\uff1a</p> <pre><code>@Test\npublic void whenMultipleConsumersAndProducers_thenProcessAllMessages()\nthrows InterruptedException {\n// given\nTransferQueue&lt;String&gt; transferQueue = new LinkedTransferQueue&lt;&gt;();\nExecutorService exService = Executors.newFixedThreadPool(3);\nProducer producer1 = new Producer(transferQueue, \"1\", 3);\nProducer producer2 = new Producer(transferQueue, \"2\", 3);\nConsumer consumer1 = new Consumer(transferQueue, \"1\", 3);\nConsumer consumer2 = new Consumer(transferQueue, \"2\", 3);\n\n// when\nexService.execute(producer1);\nexService.execute(producer2);\nexService.execute(consumer1);\nexService.execute(consumer2);\n\n// then\nexService.awaitTermination(10_000, TimeUnit.MILLISECONDS);\nexService.shutdown();\n\nassertEquals(producer1.numberOfProducedMessages.intValue(), 3);\nassertEquals(producer2.numberOfProducedMessages.intValue(), 3);\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u6709\u4e24\u4e2a\u6d88\u8d39\u8005\u548c\u4e24\u4e2a\u751f\u4ea7\u8005\u3002\u5f53\u7a0b\u5e8f\u542f\u52a8\u65f6\uff0c\u6211\u4eec\u770b\u5230\u4e24\u4e2a\u751f\u4ea7\u8005\u90fd\u53ef\u4ee5\u751f\u6210\u4e00\u4e2a\u5143\u7d20\uff0c\u7136\u540e\uff0c\u5b83\u4eec\u5c06\u963b\u585e\uff0c\u76f4\u5230\u5176\u4e2d\u4e00\u4e2a\u6d88\u8d39\u8005\u4ece\u961f\u5217\u4e2d\u83b7\u53d6\u8be5\u5143\u7d20\uff1a</p> <pre><code>Producer: 1 is waiting to transfer...\nConsumer: 1 is waiting to take element...\nProducer: 2 is waiting to transfer...\nProducer: 1 transferred element: A0\nProducer: 1 is waiting to transfer...\nConsumer: 1 received element: A0\nConsumer: 1 is waiting to take element...\nProducer: 2 transferred element: A0\nProducer: 2 is waiting to transfer...\nConsumer: 1 received element: A0\nConsumer: 1 is waiting to take element...\nProducer: 1 transferred element: A1\nProducer: 1 is waiting to transfer...\nConsumer: 1 received element: A1\nConsumer: 2 is waiting to take element...\nProducer: 2 transferred element: A1\nProducer: 2 is waiting to transfer...\nConsumer: 2 received element: A1\nConsumer: 2 is waiting to take element...\nProducer: 1 transferred element: A2\nConsumer: 2 received element: A2\nConsumer: 2 is waiting to take element...\nProducer: 2 transferred element: A2\nConsumer: 2 received element: A2\n</code></pre>"},{"location":"2019-03-10-%E5%AE%9E%E8%B7%B5java.util.concurrent.TransferQueue/#_5","title":"\u603b\u7ed3","text":"<p>\u6211\u4eec\u770b\u5230\u4e86\u5982\u4f55\u4f7f\u7528\u8be5\u6784\u9020\u5b9e\u73b0\u751f\u4ea7\u8005 - \u6d88\u8d39\u8005\u8ba1\u5212\u3002\u6211\u4eec\u4f7f\u7528<code>transfer()</code>\u65b9\u6cd5\u521b\u5efa\u4e00\u79cdbackpressure\u5f62\u5f0f\uff0c\u5176\u4e2d\u751f\u4ea7\u8005\u5728\u6d88\u8d39\u8005\u4ece\u961f\u5217\u4e2d\u68c0\u7d22\u5143\u7d20\u4e4b\u524d\u4e0d\u80fd\u53d1\u5e03\u53e6\u4e00\u4e2a\u5143\u7d20\u3002</p> <p>\u5f53\u6211\u4eec\u4e0d\u5e0c\u671b\u8fc7\u5ea6\u751f\u6210\u7684\u751f\u4ea7\u8005\u4f7f\u7528\u6d88\u606f\u586b\u5145\u961f\u5217\uff0c\u4ece\u800c\u5bfc\u81f4OutOfMemory\u9519\u8bef\u65f6\uff0cTransferQueue\u4f1a\u975e\u5e38\u6709\u7528\u3002\u5728\u8fd9\u79cd\u8bbe\u8ba1\u4e2d\uff0c\u6d88\u8d39\u8005\u5c06\u51b3\u5b9a\u751f\u4ea7\u8005\u4ea7\u751f\u6d88\u606f\u7684\u901f\u5ea6\u3002</p>"},{"location":"2019-03-18-%E6%9C%89%E5%85%B3%E5%BC%82%E6%AD%A5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E5%AE%9E%E7%8E%B0%E7%9A%84%E8%AF%B4%E6%98%8E/","title":"2019 03 18 \u6709\u5173\u5f02\u6b65\u8f93\u5165\u8f93\u51fa\u5b9e\u73b0\u7684\u8bf4\u660e","text":"<p>\u672c\u6587\u7ffb\u8bd1\u81eaNotes on the Asynchronous I/O implementation</p>"},{"location":"2019-03-18-%E6%9C%89%E5%85%B3%E5%BC%82%E6%AD%A5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E5%AE%9E%E7%8E%B0%E7%9A%84%E8%AF%B4%E6%98%8E/#_1","title":"\u56fa\u5b9a\u7ebf\u7a0b\u6c60","text":"<p>\u4e0e\u5927\u5c0f\u4e3aN\u7684\u56fa\u5b9a\u7ebf\u7a0b\u6c60\u5173\u8054\u7684\u5f02\u6b65\u901a\u9053\u7ec4\uff08channel group\uff09\uff0c\u63d0\u4ea4\u7b49\u5f85I/O\u7684N\u4e2a\u4efb\u52a1\u6216\u6765\u81ea\u5185\u6838\u7684\u5b8c\u6210\u4e8b\u4ef6\u3002\u6bcf\u4e2a\u4efb\u52a1\u53ea\u662f\u5c06\u4e00\u4e2a\u4e8b\u4ef6\u51fa\u5217(dequeues)\uff0c\u6267\u884c\u4efb\u4f55\u5fc5\u8981\u7684I/O\u5b8c\u6210\u5de5\u4f5c\uff08completion\uff09\uff0c\u7136\u540e\u76f4\u63a5\u8c03\u5ea6\u5230\u4f7f\u7528\u8be5\u7ed3\u679c\u7684\u7528\u6237\u7684\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u3002\u5f53\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u6b63\u5e38\u7ec8\u6b62\u65f6\uff0c\u4efb\u52a1\u5c06\u8fd4\u56de\u7b49\u5f85\u4e0b\u4e00\u4e2a\u4e8b\u4ef6\u3002\u5982\u679c\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u7531\u4e8e\u672a\u6355\u83b7\u7684\u9519\u8bef\u6216\u8fd0\u884c\u65f6\u5f02\u5e38\u800c\u7ec8\u6b62\uff0c\u5219\u4efb\u52a1\u7ec8\u6b62\u5e76\u7acb\u5373\u88ab\u65b0\u4efb\u52a1\u66ff\u6362\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u8fd9\u79cd\u914d\u7f6e\u76f8\u5bf9\u7b80\u5355\uff0c\u53ef\u4e3a\u9002\u5f53\u8bbe\u8ba1\u7684\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u826f\u597d\u7684\u6027\u80fd\u3002\u8bf7\u6ce8\u610f\uff0c\u5b83\u4e0d\u652f\u6301\u6309\u9700\uff08on-demand\uff09\u521b\u5efa\u7ebf\u7a0b\u6216\u5728\u7a7a\u95f2\u65f6\u4fee\u526a\uff08trimming back\uff09\u7ebf\u7a0b\u6c60\u3002\u5b83\u4e5f\u4e0d\u9002\u7528\u4e8e\u5177\u6709\u65e0\u9650\u671f\u963b\u585e\uff08block indefinitely\uff09\u7684\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u5b9e\u73b0\u7684\u5e94\u7528\u7a0b\u5e8f\uff1b\u5982\u679c\u5728\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u4e2d\u963b\u585e\u4e86\u6240\u6709\u7ebf\u7a0b\uff0c\u5219\u65e0\u6cd5\u5904\u7406I/O\u4e8b\u4ef6\uff08\u4f8b\u5982\uff0c\u5f3a\u5236\u64cd\u4f5c\u7cfb\u7edf\u5c06\u63a5\u53d7\u7684\u8fde\u63a5\u6392\u961f\uff09\u3002\u8c03\u6574\u9700\u8981\u4e3aN\u9009\u62e9\u5408\u9002\u7684\u503c\u3002</p>"},{"location":"2019-03-18-%E6%9C%89%E5%85%B3%E5%BC%82%E6%AD%A5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E5%AE%9E%E7%8E%B0%E7%9A%84%E8%AF%B4%E6%98%8E/#_2","title":"\u7528\u6237\u63d0\u4f9b\u7684\u7ebf\u7a0b\u6c60","text":"<p>\u4e0e\u7528\u6237\u63d0\u4f9b\u7684\u7ebf\u7a0b\u6c60\u5173\u8054\u7684\u5f02\u6b65\u901a\u9053\u7ec4\u5c06\u4efb\u52a1\u63d0\u4ea4\u7ed9\u7ebf\u7a0b\u6c60\uff0c\u8be5\u7ebf\u7a0b\u6c60\u53ea\u8c03\u7528\u7528\u6237\u7684\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u3002\u6765\u81ea\u5185\u6838\u7684I/O\u548c\u5b8c\u6210\u4e8b\u4ef6\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u4e0d\u53ef\u89c1\u7684\u5185\u90e8\u7ebf\u7a0b\u5904\u7406\u3002\u8fd9\u79cd\u914d\u7f6e\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u6b64\u914d\u7f6e\u9002\u7528\u4e8e\u5927\u591a\u6570\u7ebf\u7a0b\u6c60\uff08\u7f13\u5b58\u6216\u56fa\u5b9a\uff09\uff0c\u4f46\u4ee5\u4e0b\u60c5\u51b5\u9664\u5916\uff1a</p> <ol> <li>\u7ebf\u7a0b\u6c60\u5fc5\u987b\u652f\u6301\u65e0\u754c\u961f\u5217\uff08unbounded queueing\uff09</li> <li>\u8c03\u7528execute\u65b9\u6cd5\u7684\u7ebf\u7a0b\u7edd\u4e0d\u80fd\u76f4\u63a5\u6267\u884c\u4efb\u52a1\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5185\u90e8\u7ebf\u7a0b\u4e0d\u4f1a\u8c03\u7528\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\uff08completion handlers\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u56de\u8c03\uff09</li> <li>\u5fc5\u987b\u5728\u65e7\u7248Windows\u4e0a\u7981\u7528<code>Thread poool keep alive</code>\u3002\u51fa\u73b0\u8fd9\u79cd\u9650\u5236\u662f\u56e0\u4e3a\u5185\u6838\u5c06I/O\u64cd\u4f5c\u7ed1\u5b9a\u5230\u542f\u52a8\u7ebf\u7a0b\uff08initiating thread\uff09\u3002</li> </ol> <p>\u5c3d\u7ba1\u6bcf\u4e2aI/O\u64cd\u4f5c\u90fd\u6709\u5207\u6362(hand-off)\uff0c\u4f46\u8fd9\u79cd\u914d\u7f6e\u53ef\u63d0\u4f9b\u826f\u597d\u7684\u6027\u80fd\u3002\u5f53\u4e0e\u6309\u9700\u521b\u5efa\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u6c60\u7ed3\u5408\u4f7f\u7528\u65f6\uff0c\u5b83\u9002\u7528\u4e8e\u5177\u6709\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u8fd9\u4e9b\u5904\u7406\u7a0b\u5e8f\u5076\u5c14\u9700\u8981\u957f\u65f6\u95f4\uff08\u6216\u65e0\u9650\u671f\u5730\uff09\u963b\u585e\u3002 M\u7684\u503c\uff08\u5185\u90e8\u7ebf\u7a0b\u6570\uff09\u672a\u5728API\u4e2d\u516c\u5f00\uff0c\u9700\u8981\u914d\u7f6e\u7cfb\u7edf\u5c5e\u6027\uff08system property\uff0c\u9ed8\u8ba4\u503c\u4e3a1\uff09\u3002</p>"},{"location":"2019-03-18-%E6%9C%89%E5%85%B3%E5%BC%82%E6%AD%A5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E5%AE%9E%E7%8E%B0%E7%9A%84%E8%AF%B4%E6%98%8E/#_3","title":"\u9ed8\u8ba4\u7ebf\u7a0b\u6c60","text":"<p>\u4e0d\u521b\u5efa\u81ea\u5df1\u7684\u5f02\u6b65\u901a\u9053\u7ec4\u7684\u66f4\u7b80\u5355\u7684\u5e94\u7528\u7a0b\u5e8f\u5c06\u4f7f\u7528\u5177\u6709\u81ea\u52a8\u521b\u5efa\u7684\u5173\u8054\u7ebf\u7a0b\u6c60\u7684\u9ed8\u8ba4\u7ec4\u3002\u6b64\u7ebf\u7a0b\u6c60\u662f\u4e0a\u8ff0\u914d\u7f6e\u7684\u6df7\u5408\u3002\u5b83\u662f\u4e00\u4e2a\u7f13\u5b58\u7684\u7ebf\u7a0b\u6c60\uff0c\u53ef\u4ee5\u6309\u9700\u521b\u5efa\u7ebf\u7a0b\uff08\u56e0\u4e3a\u5b83\u53ef\u80fd\u7531\u4f7f\u7528\u8c03\u7528\u963b\u585e\u64cd\u4f5c\u7684\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u7684\u4e0d\u540c\u5e94\u7528\u7a0b\u5e8f\u6216\u5e93\u5171\u4eab\uff09\u3002</p> <p>\u4e0e\u56fa\u5b9a\u7ebf\u7a0b\u6c60\u914d\u7f6e\u4e00\u6837\uff0c\u5b83\u5177\u6709N\u4e2a\u7ebf\u7a0b\uff0c\u8fd9\u4e9b\u7ebf\u7a0b\u4f7f\u4e8b\u4ef6\u51fa\u5217\u5e76\u76f4\u63a5\u5206\u6d3e\u7ed9\u7528\u6237\u7684\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u3002 N\u7684\u503c\u9ed8\u8ba4\u4e3a\u786c\u4ef6\u7ebf\u7a0b\u6570\uff0c\u4f46\u53ef\u4ee5\u7531\u7cfb\u7edf\u5c5e\u6027\u914d\u7f6e\u3002\u9664\u4e86N\u4e2a\u7ebf\u7a0b\u4e4b\u5916\uff0c\u8fd8\u6709\u4e00\u4e2a\u989d\u5916\u7684\u5185\u90e8\u7ebf\u7a0b\u4f7f\u4e8b\u4ef6\u51fa\u5217\uff0c\u5e76\u5c06\u4efb\u52a1\u63d0\u4ea4\u7ed9\u7ebf\u7a0b\u6c60\u4ee5\u8c03\u7528\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u3002\u6b64\u5185\u90e8\u7ebf\u7a0b\u786e\u4fdd\u5728\u6240\u6709\u56fa\u5b9a\u7ebf\u7a0b\u88ab\u963b\u6b62\u6216\u5fd9\u4e8e\u6267\u884c\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u65f6\u7cfb\u7edf\u4e0d\u4f1a\u505c\u6b62\u3002</p>"},{"location":"2019-03-18-%E6%9C%89%E5%85%B3%E5%BC%82%E6%AD%A5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E5%AE%9E%E7%8E%B0%E7%9A%84%E8%AF%B4%E6%98%8E/#io","title":"\u5f53I/O\u64cd\u4f5c\u7acb\u5373\u5b8c\u6210\u65f6\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f","text":"<p>\u5f53I/O\u64cd\u4f5c\u7acb\u5373\u5b8c\u6210\u65f6\uff0c\u5982\u679c\u542f\u52a8\u7ebf\u7a0b\u672c\u8eab\u662f\u6c60\u5316\u7ebf\u7a0b\u4e4b\u4e00\uff0c\u5219API\u5141\u8bb8\u542f\u52a8\u7ebf\u7a0b\u76f4\u63a5\u8c03\u7528\uff08invoked directly\uff09\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u3002\u8fd9\u5c31\u4ea7\u751f\u4e86\u5728\u7ebf\u7a0b\u5806\u6808\u4e0a\u53ef\u80fd\u6709\u591a\u4e2a\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u7684\u53ef\u80fd\u6027\u3002\u4e0b\u56fe\u63cf\u7ed8\u4e86\u4e00\u4e2a\u7ebf\u7a0b\u5806\u6808\uff0c\u5176\u4e2d\u8bfb\u53d6\u6216\u5199\u5165\u65b9\u6cd5\u7acb\u5373\u5b8c\u6210\uff0c\u5e76\u4e14\u76f4\u63a5\u8c03\u7528\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u3002\u53cd\u8fc7\u6765\uff0c\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u542f\u52a8\u53e6\u4e00\u4e2a\u7acb\u5373\u5b8c\u6210\u7684I/O\u64cd\u4f5c\uff0c\u56e0\u6b64\u76f4\u63a5\u8c03\u7528\u5176\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002</p> <p></p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728\u8981\u6c42\u7ebf\u7a0b\u5806\u6808\u4e0a\u7684\u6240\u6709\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u7ec8\u6b62\u4e4b\u524d\uff0c\u5b9e\u73b0\u5141\u8bb8\u76f4\u63a5\u5728\u542f\u52a8\u7ebf\u7a0b\u4e0a\u5b8c\u6210\u6700\u591a16\u4e2aI/O\u64cd\u4f5c\u3002\u6b64\u7b56\u7565\u6709\u52a9\u4e8e\u907f\u514d\u5806\u6808\u6ea2\u51fa\u4ee5\u53ca\u5728\u7ebf\u7a0b\u542f\u52a8\u8bb8\u591a\u7acb\u5373\u5b8c\u6210\u7684I/O\u64cd\u4f5c\u65f6\u53ef\u80fd\u51fa\u73b0\u7684\u7f3a\u9677\u3002\u6b64\u7b56\u7565\u4ee5\u53ca\u7ebf\u7a0b\u5806\u6808\u4e0a\u5141\u8bb8\u7684\u6700\u5927\u5b8c\u6210\u5904\u7406\u7a0b\u5e8f\u5e27\u6570\u7531\u7cfb\u7edf\u5c5e\u6027\uff08\u5982\u679c\u9700\u8981\uff09\u914d\u7f6e\u3002\u5c06\u6765\uff0cAPI\u7684\u4e00\u4e2a\u9644\u52a0\u529f\u80fd\u53ef\u80fd\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u6307\u5b9a\u5982\u4f55\u7acb\u5373\u5904\u7406\u5b8c\u6210\u7684I/O\u64cd\u4f5c\u3002</p>"},{"location":"2019-03-18-%E6%9C%89%E5%85%B3%E5%BC%82%E6%AD%A5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E5%AE%9E%E7%8E%B0%E7%9A%84%E8%AF%B4%E6%98%8E/#direct-buffers","title":"\u76f4\u63a5\u7f13\u51b2\u533a(Direct Buffers)","text":"<p>\u5f02\u6b65I/O\u5b9e\u73b0\u9488\u5bf9\u76f4\u63a5\u7f13\u51b2\u533a(Direct Buffers)\u8fdb\u884c\u4e86\u4f18\u5316\u3002\u4e0e<code>SocketChannels</code>\u4e00\u6837\uff0c\u6240\u6709I/O\u64cd\u4f5c\u90fd\u4f7f\u7528\u76f4\u63a5\u7f13\u51b2\u533a\u5b8c\u6210\u3002\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u975e\u76f4\u63a5\u7f13\u51b2\u533a\u542f\u52a8I/O\u64cd\u4f5c\uff0c\u5219\u5b9e\u73b0\u5c06\u7f13\u51b2\u533a\u900f\u660e\u5730\uff08transparently\uff09\u66ff\u6362\u4e3a\u76f4\u63a5\u7f13\u51b2\u533a\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5206\u914d\u7ed9\u76f4\u63a5\u7f13\u51b2\u533a\u7684\u6700\u5927\u5185\u5b58\u7b49\u4e8e\u6700\u5927Java\u5806\u5927\u5c0f\uff08Runtime.maxMemory\uff09\u3002\u53ef\u4ee5\u6839\u636e\u9700\u8981\u4f7f\u7528<code>MaxDirectMemorySize VM\u9009\u9879</code>\u914d\u7f6e\u6b64\u9009\u9879\uff08\u4f8b\u5982\uff1a<code>-XX:MaxDirectMemorySize=128m</code>\uff09\u3002</p> <p><code>jconsole</code>\u4e2d\u7684MBean\u6d4f\u89c8\u5668\u53ef\u7528\u4e8e\u76d1\u89c6\u4e0e\u76f4\u63a5\u7f13\u51b2\u533a\u5173\u8054\u7684\u8d44\u6e90\u3002</p>"},{"location":"2019-03-18-%E7%BC%93%E5%AD%98%E9%82%A3%E4%BA%9B%E4%BA%8B/","title":"2019 03 18 \u7f13\u5b58\u90a3\u4e9b\u4e8b","text":"<p>\u672c\u6587\u8f6c\u8f7d\u81ea\u7f8e\u56e2\u6280\u672f\u56e2\u961f\u2014\u2014\u7f13\u5b58\u90a3\u4e9b\u4e8b\uff0c\u5bf9\u76ee\u524d\u5e38\u7528\u7684\u7f13\u5b58\u7b97\u6cd5\u3001\u7f13\u5b58\u5de5\u5177\u505a\u4e86\u7fd4\u5b9e\u7684\u4ecb\u7ecd\u3002</p> <p>\u4e00\u822c\u800c\u8a00\uff0c\u73b0\u5728\u4e92\u8054\u7f51\u5e94\u7528\uff08\u7f51\u7ad9\u6216App\uff09\u7684\u6574\u4f53\u6d41\u7a0b\uff0c\u53ef\u4ee5\u6982\u62ec\u5982\u56fe1\u6240\u793a\uff0c\u7528\u6237\u8bf7\u6c42\u4ece\u754c\u9762\uff08\u6d4f\u89c8\u5668\u6216App\u754c\u9762\uff09\u5230\u7f51\u7edc\u8f6c\u53d1\u3001\u5e94\u7528\u670d\u52a1\u518d\u5230\u5b58\u50a8\uff08\u6570\u636e\u5e93\u6216\u6587\u4ef6\u7cfb\u7edf\uff09\uff0c\u7136\u540e\u8fd4\u56de\u5230\u754c\u9762\u5448\u73b0\u5185\u5bb9\u3002</p> <p>\u968f\u7740\u4e92\u8054\u7f51\u7684\u666e\u53ca\uff0c\u5185\u5bb9\u4fe1\u606f\u8d8a\u6765\u8d8a\u590d\u6742\uff0c\u7528\u6237\u6570\u548c\u8bbf\u95ee\u91cf\u8d8a\u6765\u8d8a\u5927\uff0c\u6211\u4eec\u7684\u5e94\u7528\u9700\u8981\u652f\u6491\u66f4\u591a\u7684\u5e76\u53d1\u91cf\uff0c\u540c\u65f6\u6211\u4eec\u7684\u5e94\u7528\u670d\u52a1\u5668\u548c\u6570\u636e\u5e93\u670d\u52a1\u5668\u6240\u505a\u7684\u8ba1\u7b97\u4e5f\u8d8a\u6765\u8d8a\u591a\u3002\u4f46\u662f\u5f80\u5f80\u6211\u4eec\u7684\u5e94\u7528\u670d\u52a1\u5668\u8d44\u6e90\u662f\u6709\u9650\u7684\uff0c\u4e14\u6280\u672f\u53d8\u9769\u662f\u7f13\u6162\u7684\uff0c\u6570\u636e\u5e93\u6bcf\u79d2\u80fd\u63a5\u53d7\u7684\u8bf7\u6c42\u6b21\u6570\u4e5f\u662f\u6709\u9650\u7684\uff08\u6216\u8005\u6587\u4ef6\u7684\u8bfb\u5199\u4e5f\u662f\u6709\u9650\u7684\uff09\uff0c\u5982\u4f55\u80fd\u591f\u6709\u6548\u5229\u7528\u6709\u9650\u7684\u8d44\u6e90\u6765\u63d0\u4f9b\u5c3d\u53ef\u80fd\u5927\u7684\u541e\u5410\u91cf\uff1f\u4e00\u4e2a\u6709\u6548\u7684\u529e\u6cd5\u5c31\u662f\u5f15\u5165\u7f13\u5b58\uff0c\u6253\u7834\u6807\u51c6\u6d41\u7a0b\uff0c\u6bcf\u4e2a\u73af\u8282\u4e2d\u8bf7\u6c42\u53ef\u4ee5\u4ece\u7f13\u5b58\u4e2d\u76f4\u63a5\u83b7\u53d6\u76ee\u6807\u6570\u636e\u5e76\u8fd4\u56de\uff0c\u4ece\u800c\u51cf\u5c11\u8ba1\u7b97\u91cf\uff0c\u6709\u6548\u63d0\u5347\u54cd\u5e94\u901f\u5ea6\uff0c\u8ba9\u6709\u9650\u7684\u8d44\u6e90\u670d\u52a1\u66f4\u591a\u7684\u7528\u6237\u3002</p> <p>\u5982\u56fe1\u6240\u793a\uff0c\u7f13\u5b58\u7684\u4f7f\u7528\u53ef\u4ee5\u51fa\u73b0\u57281\uff5e4\u7684\u5404\u4e2a\u73af\u8282\u4e2d\uff0c\u6bcf\u4e2a\u73af\u8282\u7684\u7f13\u5b58\u65b9\u6848\u4e0e\u4f7f\u7528\u5404\u6709\u7279\u70b9\u3002</p> <p></p> <p>\u7f13\u5b58\u4e5f\u662f\u4e00\u4e2a\u6570\u636e\u6a21\u578b\u5bf9\u8c61\uff0c\u90a3\u4e48\u5fc5\u7136\u6709\u5b83\u7684\u4e00\u4e9b\u7279\u5f81\uff1a</p> <p>\u547d\u4e2d\u7387 \u547d\u4e2d\u7387=\u8fd4\u56de\u6b63\u786e\u7ed3\u679c\u6570/\u8bf7\u6c42\u7f13\u5b58\u6b21\u6570\uff0c\u547d\u4e2d\u7387\u95ee\u9898\u662f\u7f13\u5b58\u4e2d\u7684\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u95ee\u9898\uff0c\u5b83\u662f\u8861\u91cf\u7f13\u5b58\u6709\u6548\u6027\u7684\u91cd\u8981\u6307\u6807\u3002\u547d\u4e2d\u7387\u8d8a\u9ad8\uff0c\u8868\u660e\u7f13\u5b58\u7684\u4f7f\u7528\u7387\u8d8a\u9ad8\u3002</p> <p>\u6700\u5927\u5143\u7d20\uff08\u6216\u6700\u5927\u7a7a\u95f4\uff09 \u7f13\u5b58\u4e2d\u53ef\u4ee5\u5b58\u653e\u7684\u6700\u5927\u5143\u7d20\u7684\u6570\u91cf\uff0c\u4e00\u65e6\u7f13\u5b58\u4e2d\u5143\u7d20\u6570\u91cf\u8d85\u8fc7\u8fd9\u4e2a\u503c\uff08\u6216\u8005\u7f13\u5b58\u6570\u636e\u6240\u5360\u7a7a\u95f4\u8d85\u8fc7\u5176\u6700\u5927\u652f\u6301\u7a7a\u95f4\uff09\uff0c\u90a3\u4e48\u5c06\u4f1a\u89e6\u53d1\u7f13\u5b58\u542f\u52a8\u6e05\u7a7a\u7b56\u7565\u6839\u636e\u4e0d\u540c\u7684\u573a\u666f\u5408\u7406\u7684\u8bbe\u7f6e\u6700\u5927\u5143\u7d20\u503c\u5f80\u5f80\u53ef\u4ee5\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u63d0\u9ad8\u7f13\u5b58\u7684\u547d\u4e2d\u7387\uff0c\u4ece\u800c\u66f4\u6709\u6548\u7684\u65f6\u5019\u7f13\u5b58\u3002</p> <p>\u6e05\u7a7a\u7b56\u7565 \u5982\u4e0a\u63cf\u8ff0\uff0c\u7f13\u5b58\u7684\u5b58\u50a8\u7a7a\u95f4\u6709\u9650\u5236\uff0c\u5f53\u7f13\u5b58\u7a7a\u95f4\u88ab\u7528\u6ee1\u65f6\uff0c\u5982\u4f55\u4fdd\u8bc1\u5728\u7a33\u5b9a\u670d\u52a1\u7684\u540c\u65f6\u6709\u6548\u63d0\u5347\u547d\u4e2d\u7387\uff1f\u8fd9\u5c31\u7531\u7f13\u5b58\u6e05\u7a7a\u7b56\u7565\u6765\u5904\u7406\uff0c\u8bbe\u8ba1\u9002\u5408\u81ea\u8eab\u6570\u636e\u7279\u5f81\u7684\u6e05\u7a7a\u7b56\u7565\u80fd\u6709\u6548\u63d0\u5347\u547d\u4e2d\u7387\u3002\u5e38\u89c1\u7684\u4e00\u822c\u7b56\u7565\u6709\uff1a</p> <ul> <li> <p>FIFO(first in first out) \u5148\u8fdb\u5148\u51fa\u7b56\u7565\uff0c\u6700\u5148\u8fdb\u5165\u7f13\u5b58\u7684\u6570\u636e\u5728\u7f13\u5b58\u7a7a\u95f4\u4e0d\u591f\u7684\u60c5\u51b5\u4e0b\uff08\u8d85\u51fa\u6700\u5927\u5143\u7d20\u9650\u5236\uff09\u4f1a\u88ab\u4f18\u5148\u88ab\u6e05\u9664\u6389\uff0c\u4ee5\u817e\u51fa\u65b0\u7684\u7a7a\u95f4\u63a5\u53d7\u65b0\u7684\u6570\u636e\u3002\u7b56\u7565\u7b97\u6cd5\u4e3b\u8981\u6bd4\u8f83\u7f13\u5b58\u5143\u7d20\u7684\u521b\u5efa\u65f6\u95f4\u3002\u5728\u6570\u636e\u5b9e\u6548\u6027\u8981\u6c42\u573a\u666f\u4e0b\u53ef\u9009\u62e9\u8be5\u7c7b\u7b56\u7565\uff0c\u4f18\u5148\u4fdd\u969c\u6700\u65b0\u6570\u636e\u53ef\u7528\u3002</p> </li> <li> <p>LFU(less frequently used) \u6700\u5c11\u4f7f\u7528\u7b56\u7565\uff0c\u65e0\u8bba\u662f\u5426\u8fc7\u671f\uff0c\u6839\u636e\u5143\u7d20\u7684\u88ab\u4f7f\u7528\u6b21\u6570\u5224\u65ad\uff0c\u6e05\u9664\u4f7f\u7528\u6b21\u6570\u8f83\u5c11\u7684\u5143\u7d20\u91ca\u653e\u7a7a\u95f4\u3002\u7b56\u7565\u7b97\u6cd5\u4e3b\u8981\u6bd4\u8f83\u5143\u7d20\u7684hitCount\uff08\u547d\u4e2d\u6b21\u6570\uff09\u3002\u5728\u4fdd\u8bc1\u9ad8\u9891\u6570\u636e\u6709\u6548\u6027\u573a\u666f\u4e0b\uff0c\u53ef\u9009\u62e9\u8fd9\u7c7b\u7b56\u7565\u3002</p> </li> <li> <p>LRU(least recently used) \u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7b56\u7565\uff0c\u65e0\u8bba\u662f\u5426\u8fc7\u671f\uff0c\u6839\u636e\u5143\u7d20\u6700\u540e\u4e00\u6b21\u88ab\u4f7f\u7528\u7684\u65f6\u95f4\u6233\uff0c\u6e05\u9664\u6700\u8fdc\u4f7f\u7528\u65f6\u95f4\u6233\u7684\u5143\u7d20\u91ca\u653e\u7a7a\u95f4\u3002\u7b56\u7565\u7b97\u6cd5\u4e3b\u8981\u6bd4\u8f83\u5143\u7d20\u6700\u8fd1\u4e00\u6b21\u88abget\u4f7f\u7528\u65f6\u95f4\u3002\u5728\u70ed\u70b9\u6570\u636e\u573a\u666f\u4e0b\u8f83\u9002\u7528\uff0c\u4f18\u5148\u4fdd\u8bc1\u70ed\u70b9\u6570\u636e\u7684\u6709\u6548\u6027\u3002</p> </li> </ul> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u6709\u4e00\u4e9b\u7b80\u5355\u7b56\u7565\u6bd4\u5982\uff1a</p> <ul> <li>\u6839\u636e\u8fc7\u671f\u65f6\u95f4\u5224\u65ad\uff0c\u6e05\u7406\u8fc7\u671f\u65f6\u95f4\u6700\u957f\u7684\u5143\u7d20\uff1b</li> <li>\u6839\u636e\u8fc7\u671f\u65f6\u95f4\u5224\u65ad\uff0c\u6e05\u7406\u6700\u8fd1\u8981\u8fc7\u671f\u7684\u5143\u7d20\uff1b</li> <li>\u968f\u673a\u6e05\u7406\uff1b</li> <li>\u6839\u636e\u5173\u952e\u5b57\uff08\u6216\u5143\u7d20\u5185\u5bb9\uff09\u957f\u77ed\u6e05\u7406\u7b49\u3002</li> </ul> <p>\u867d\u7136\u4ece\u786c\u4ef6\u4ecb\u8d28\u4e0a\u6765\u770b\uff0c\u65e0\u975e\u5c31\u662f\u5185\u5b58\u548c\u786c\u76d8\u4e24\u79cd\uff0c\u4f46\u4ece\u6280\u672f\u4e0a\uff0c\u53ef\u4ee5\u5206\u6210\u5185\u5b58\u3001\u786c\u76d8\u6587\u4ef6\u3001\u6570\u636e\u5e93\u3002</p> <ul> <li>\u5185\u5b58\uff1a\u5c06\u7f13\u5b58\u5b58\u50a8\u4e8e\u5185\u5b58\u4e2d\u662f\u6700\u5feb\u7684\u9009\u62e9\uff0c\u65e0\u9700\u989d\u5916\u7684I/O\u5f00\u9500\uff0c\u4f46\u662f\u5185\u5b58\u7684\u7f3a\u70b9\u662f\u6ca1\u6709\u6301\u4e45\u5316\u843d\u5730\u7269\u7406\u78c1\u76d8\uff0c\u4e00\u65e6\u5e94\u7528\u5f02\u5e38break down\u800c\u91cd\u65b0\u542f\u52a8\uff0c\u6570\u636e\u5f88\u96be\u6216\u8005\u65e0\u6cd5\u590d\u539f\u3002</li> <li>\u786c\u76d8\uff1a\u4e00\u822c\u6765\u8bf4\uff0c\u5f88\u591a\u7f13\u5b58\u6846\u67b6\u4f1a\u7ed3\u5408\u4f7f\u7528\u5185\u5b58\u548c\u786c\u76d8\uff0c\u5728\u5185\u5b58\u5206\u914d\u7a7a\u95f4\u6ee1\u4e86\u6216\u662f\u5728\u5f02\u5e38\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u88ab\u52a8\u6216\u4e3b\u52a8\u7684\u5c06\u5185\u5b58\u7a7a\u95f4\u6570\u636e\u6301\u4e45\u5316\u5230\u786c\u76d8\u4e2d\uff0c\u8fbe\u5230\u91ca\u653e\u7a7a\u95f4\u6216\u5907\u4efd\u6570\u636e\u7684\u76ee\u7684\u3002</li> <li>\u6570\u636e\u5e93\uff1a\u524d\u9762\u6709\u63d0\u5230\uff0c\u589e\u52a0\u7f13\u5b58\u7684\u7b56\u7565\u7684\u76ee\u7684\u4e4b\u4e00\u5c31\u662f\u4e3a\u4e86\u51cf\u5c11\u6570\u636e\u5e93\u7684I/O\u538b\u529b\u3002\u73b0\u5728\u4f7f\u7528\u6570\u636e\u5e93\u505a\u7f13\u5b58\u4ecb\u8d28\u662f\u4e0d\u662f\u53c8\u56de\u5230\u4e86\u8001\u95ee\u9898\u4e0a\u4e86\uff1f\ud83d\ude41\u5176\u5b9e\uff0c\u6570\u636e\u5e93\u4e5f\u6709\u5f88\u591a\u79cd\u7c7b\u578b\uff0c\u50cf\u90a3\u4e9b\u4e0d\u652f\u6301SQL\uff0c\u53ea\u662f\u7b80\u5355\u7684key-value\u5b58\u50a8\u7ed3\u6784\u7684\u7279\u6b8a\u6570\u636e\u5e93\uff08\u5982BerkeleyDB\u548cRedis\uff09\uff0c\u54cd\u5e94\u901f\u5ea6\u548c\u541e\u5410\u91cf\u90fd\u8fdc\u8fdc\u9ad8\u4e8e\u6211\u4eec\u5e38\u7528\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7b49\u3002</li> </ul> <p>\u7f13\u5b58\u6709\u5404\u7c7b\u7279\u5f81\uff0c\u800c\u4e14\u6709\u4e0d\u540c\u4ecb\u8d28\u7684\u533a\u522b\uff0c\u90a3\u4e48\u5b9e\u9645\u5de5\u7a0b\u4e2d\u6211\u4eec\u600e\u4e48\u53bb\u5bf9\u7f13\u5b58\u5206\u7c7b\u5462\uff1f\u5728\u76ee\u524d\u7684\u5e94\u7528\u670d\u52a1\u6846\u67b6\u4e2d\uff0c\u6bd4\u8f83\u5e38\u89c1\u7684\uff0c\u65f6\u6839\u636e\u7f13\u5b58\u96e8\u5e94\u7528\u7684\u85d5\u5408\u5ea6\uff0c\u5206\u4e3alocal cache\uff08\u672c\u5730\u7f13\u5b58\uff09\u548cremote cache\uff08\u5206\u5e03\u5f0f\u7f13\u5b58\uff09\uff1a</p> <ul> <li>\u672c\u5730\u7f13\u5b58\uff1a\u6307\u7684\u662f\u5728\u5e94\u7528\u4e2d\u7684\u7f13\u5b58\u7ec4\u4ef6\uff0c\u5176\u6700\u5927\u7684\u4f18\u70b9\u662f\u5e94\u7528\u548ccache\u662f\u5728\u540c\u4e00\u4e2a\u8fdb\u7a0b\u5185\u90e8\uff0c\u8bf7\u6c42\u7f13\u5b58\u975e\u5e38\u5feb\u901f\uff0c\u6ca1\u6709\u8fc7\u591a\u7684\u7f51\u7edc\u5f00\u9500\u7b49\uff0c\u5728\u5355\u5e94\u7528\u4e0d\u9700\u8981\u96c6\u7fa4\u652f\u6301\u6216\u8005\u96c6\u7fa4\u60c5\u51b5\u4e0b\u5404\u8282\u70b9\u65e0\u9700\u4e92\u76f8\u901a\u77e5\u7684\u573a\u666f\u4e0b\u4f7f\u7528\u672c\u5730\u7f13\u5b58\u8f83\u5408\u9002\uff1b\u540c\u65f6\uff0c\u5b83\u7684\u7f3a\u70b9\u4e5f\u662f\u5e94\u4e3a\u7f13\u5b58\u8ddf\u5e94\u7528\u7a0b\u5e8f\u8026\u5408\uff0c\u591a\u4e2a\u5e94\u7528\u7a0b\u5e8f\u65e0\u6cd5\u76f4\u63a5\u7684\u5171\u4eab\u7f13\u5b58\uff0c\u5404\u5e94\u7528\u6216\u96c6\u7fa4\u7684\u5404\u8282\u70b9\u90fd\u9700\u8981\u7ef4\u62a4\u81ea\u5df1\u7684\u5355\u72ec\u7f13\u5b58\uff0c\u5bf9\u5185\u5b58\u662f\u4e00\u79cd\u6d6a\u8d39\u3002</li> <li>\u5206\u5e03\u5f0f\u7f13\u5b58\uff1a\u6307\u7684\u662f\u4e0e\u5e94\u7528\u5206\u79bb\u7684\u7f13\u5b58\u7ec4\u4ef6\u6216\u670d\u52a1\uff0c\u5176\u6700\u5927\u7684\u4f18\u70b9\u662f\u81ea\u8eab\u5c31\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u5e94\u7528\uff0c\u4e0e\u672c\u5730\u5e94\u7528\u9694\u79bb\uff0c\u591a\u4e2a\u5e94\u7528\u53ef\u76f4\u63a5\u7684\u5171\u4eab\u7f13\u5b58\u3002</li> </ul> <p>\u76ee\u524d\u5404\u79cd\u7c7b\u578b\u7684\u7f13\u5b58\u90fd\u6d3b\u8dc3\u5728\u6210\u5343\u4e0a\u4e07\u7684\u5e94\u7528\u670d\u52a1\u4e2d\uff0c\u8fd8\u6ca1\u6709\u4e00\u79cd\u7f13\u5b58\u65b9\u6848\u53ef\u4ee5\u89e3\u51b3\u4e00\u5207\u7684\u4e1a\u52a1\u573a\u666f\u6216\u6570\u636e\u7c7b\u578b\uff0c\u6211\u4eec\u9700\u8981\u6839\u636e\u81ea\u8eab\u7684\u7279\u6b8a\u573a\u666f\u548c\u80cc\u666f\uff0c\u9009\u62e9\u6700\u9002\u5408\u7684\u7f13\u5b58\u65b9\u6848\u3002\u7f13\u5b58\u7684\u4f7f\u7528\u662f\u7a0b\u5e8f\u5458\u3001\u67b6\u6784\u5e08\u7684\u5fc5\u5907\u6280\u80fd\uff0c\u597d\u7684\u7a0b\u5e8f\u5458\u80fd\u6839\u636e\u6570\u636e\u7c7b\u578b\u3001\u4e1a\u52a1\u573a\u666f\u6765\u51c6\u786e\u5224\u65ad\u4f7f\u7528\u4f55\u79cd\u7c7b\u578b\u7684\u7f13\u5b58\uff0c\u5982\u4f55\u4f7f\u7528\u8fd9\u79cd\u7f13\u5b58\uff0c\u4ee5\u6700\u5c0f\u7684\u6210\u672c\u6700\u5feb\u7684\u6548\u7387\u8fbe\u5230\u6700\u4f18\u7684\u76ee\u7684\u3002</p>"},{"location":"2019-03-18-%E7%BC%93%E5%AD%98%E9%82%A3%E4%BA%9B%E4%BA%8B/#_1","title":"\u672c\u5730\u7f13\u5b58","text":""},{"location":"2019-03-18-%E7%BC%93%E5%AD%98%E9%82%A3%E4%BA%9B%E4%BA%8B/#_2","title":"\u7f16\u7a0b\u76f4\u63a5\u5b9e\u73b0\u7f13\u5b58","text":"<p>\u4e2a\u522b\u573a\u666f\u4e0b\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7b80\u5355\u7684\u7f13\u5b58\u6570\u636e\u7684\u529f\u80fd\uff0c\u800c\u65e0\u9700\u5173\u6ce8\u66f4\u591a\u5b58\u53d6\u3001\u6e05\u7a7a\u7b56\u7565\u7b49\u6df1\u5165\u7684\u7279\u6027\u65f6\uff0c\u76f4\u63a5\u7f16\u7a0b\u5b9e\u73b0\u7f13\u5b58\u5219\u662f\u6700\u4fbf\u6377\u548c\u9ad8\u6548\u7684\u3002</p>"},{"location":"2019-03-18-%E7%BC%93%E5%AD%98%E9%82%A3%E4%BA%9B%E4%BA%8B/#a","title":"a. \u6210\u5458\u53d8\u91cf\u6216\u5c40\u90e8\u53d8\u91cf\u5b9e\u73b0","text":"<p>\u7b80\u5355\u4ee3\u7801\u793a\u4f8b\u5982\u4e0b\uff1a</p> <pre><code>public void UseLocalCache(){\n//\u4e00\u4e2a\u672c\u5730\u7684\u7f13\u5b58\u53d8\u91cf\nMap&lt;String, Object&gt; localCacheStoreMap = new HashMap&lt;String, Object&gt;();\n\nList&lt;Object&gt; infosList = this.getInfoList();\nfor(Object item:infosList){\nif(localCacheStoreMap.containsKey(item)){ //\u7f13\u5b58\u547d\u4e2d \u4f7f\u7528\u7f13\u5b58\u6570\u636e\n// todo\n} else { // \u7f13\u5b58\u672a\u547d\u4e2d  IO\u83b7\u53d6\u6570\u636e\uff0c\u7ed3\u679c\u5b58\u5165\u7f13\u5b58\nObject valueObject = this.getInfoFromDB();\nlocalCacheStoreMap.put(valueObject.toString(), valueObject);\n\n}\n}\n}\n//\u793a\u4f8b\nprivate List&lt;Object&gt; getInfoList(){\nreturn new ArrayList&lt;Object&gt;();\n}\n//\u793a\u4f8b\u6570\u636e\u5e93IO\u83b7\u53d6\nprivate Object getInfoFromDB(){\nreturn new Object();\n}\n</code></pre> <p>\u4ee5\u5c40\u90e8\u53d8\u91cfmap\u7ed3\u6784\u7f13\u5b58\u90e8\u5206\u4e1a\u52a1\u6570\u636e\uff0c\u51cf\u5c11\u9891\u7e41\u7684\u91cd\u590d\u6570\u636e\u5e93I/O\u64cd\u4f5c\u3002\u7f3a\u70b9\u4ec5\u9650\u4e8e\u7c7b\u7684\u81ea\u8eab\u4f5c\u7528\u57df\u5185\uff0c\u7c7b\u95f4\u65e0\u6cd5\u5171\u4eab\u7f13\u5b58\u3002</p>"},{"location":"2019-03-18-%E7%BC%93%E5%AD%98%E9%82%A3%E4%BA%9B%E4%BA%8B/#b","title":"b.\u9759\u6001\u53d8\u91cf\u5b9e\u73b0","text":"<p>\u6700\u5e38\u7528\u7684\u5355\u4f8b\u5b9e\u73b0\u9759\u6001\u8d44\u6e90\u7f13\u5b58\uff0c\u4ee3\u7801\u793a\u4f8b\u5982\u4e0b\uff1a</p> <pre><code>    public class CityUtils {\nprivate static final HttpClient httpClient = ServerHolder.createClientWithPool();\nprivate static Map&lt;Integer, String&gt; cityIdNameMap = new HashMap&lt;Integer, String&gt;();\nprivate static Map&lt;Integer, String&gt; districtIdNameMap = new HashMap&lt;Integer, String&gt;();\n\nstatic {\nHttpGet get = new HttpGet(\"http://gis-in.sankuai.com/api/location/city/all\");\nBaseAuthorizationUtils.generateAuthAndDateHeader(get,\nBaseAuthorizationUtils.CLIENT_TO_REQUEST_MDC,\nBaseAuthorizationUtils.SECRET_TO_REQUEST_MDC);\ntry {\nString resultStr = httpClient.execute(get, new BasicResponseHandler());\nJSONObject resultJo = new JSONObject(resultStr);\nJSONArray dataJa = resultJo.getJSONArray(\"data\");\nfor (int i = 0; i &lt; dataJa.length(); i++) {\nJSONObject itemJo = dataJa.getJSONObject(i);\ncityIdNameMap.put(itemJo.getInt(\"id\"), itemJo.getString(\"name\"));\n}\n} catch (Exception e) {\nthrow new RuntimeException(\"Init City List Error!\", e);\n}\n}\n\nstatic {\nHttpGet get = new HttpGet(\"http://gis-in.sankuai.com/api/location/district/all\");\nBaseAuthorizationUtils.generateAuthAndDateHeader(get,\nBaseAuthorizationUtils.CLIENT_TO_REQUEST_MDC,\nBaseAuthorizationUtils.SECRET_TO_REQUEST_MDC);\ntry {\nString resultStr = httpClient.execute(get, new BasicResponseHandler());\nJSONObject resultJo = new JSONObject(resultStr);\nJSONArray dataJa = resultJo.getJSONArray(\"data\");\nfor (int i = 0; i &lt; dataJa.length(); i++) {\nJSONObject itemJo = dataJa.getJSONObject(i);\ndistrictIdNameMap.put(itemJo.getInt(\"id\"), itemJo.getString(\"name\"));\n}\n} catch (Exception e) {\nthrow new RuntimeException(\"Init District List Error!\", e);\n}\n}\n\npublic static String getCityName(int cityId) {\nString name = cityIdNameMap.get(cityId);\nif (name == null) {\nname = \"\u672a\u77e5\";\n}\nreturn name;\n}\n\npublic static String getDistrictName(int districtId) {\nString name = districtIdNameMap.get(districtId);\nif (name == null) {\nname = \"\u672a\u77e5\";\n}\nreturn name;\n}\n}\n</code></pre> <p>O2O\u4e1a\u52a1\u4e2d\u5e38\u7528\u7684<code>\u57ce\u5e02\u57fa\u7840\u57fa\u672c\u4fe1\u606f\u5224\u65ad</code>\uff0c\u901a\u8fc7\u9759\u6001\u53d8\u91cf\u4e00\u6b21\u83b7\u53d6\u7f13\u5b58\u5185\u5b58\u4e2d\uff0c\u51cf\u5c11\u9891\u7e41\u7684I/O\u8bfb\u53d6\uff0c\u9759\u6001\u53d8\u91cf\u5b9e\u73b0\u7c7b\u95f4\u53ef\u5171\u4eab\uff0c\u8fdb\u7a0b\u5185\u53ef\u5171\u4eab\uff0c\u7f13\u5b58\u7684\u5b9e\u65f6\u6027\u7a0d\u5dee\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u672c\u5730\u7f13\u5b58\u6570\u636e\u7684\u5b9e\u65f6\u6027\u95ee\u9898\uff0c\u76ee\u524d\u5927\u91cf\u4f7f\u7528\u7684\u662f\u7ed3\u5408<code>ZooKeeper\u7684\u81ea\u52a8\u53d1\u73b0\u673a\u5236</code>\uff0c\u5b9e\u65f6\u53d8\u66f4\u672c\u5730\u9759\u6001\u53d8\u91cf\u7f13\u5b58\uff1a</p> <p>\u7f8e\u56e2\u5185\u90e8\u7684\u57fa\u7840\u914d\u7f6e\u7ec4\u4ef6<code>MtConfig</code>\uff0c\u91c7\u7528\u7684\u5c31\u662f\u7c7b\u4f3c\u539f\u7406\uff0c\u4f7f\u7528\u9759\u6001\u53d8\u91cf\u7f13\u5b58\uff0c\u7ed3\u5408ZooKeeper\u7684<code>\u7edf\u4e00\u7ba1\u7406</code>\uff0c\u505a\u5230\u81ea\u52a8\u52a8\u6001\u66f4\u65b0\u7f13\u5b58\uff0c\u5982\u56fe2\u6240\u793a\u3002</p> <p></p> <p>\u8fd9\u7c7b\u7f13\u5b58\u5b9e\u73b0\uff0c\u4f18\u70b9\u662f\u80fd\u76f4\u63a5\u5728heap\u533a\u5185\u8bfb\u5199\uff0c\u6700\u5feb\u4e5f\u6700\u65b9\u4fbf\uff1b\u7f3a\u70b9\u540c\u6837\u662f\u53d7heap\u533a\u57df\u5f71\u54cd\uff0c\u7f13\u5b58\u7684\u6570\u636e\u91cf\u975e\u5e38\u6709\u9650\uff0c\u540c\u65f6\u7f13\u5b58\u65f6\u95f4\u53d7GC\u5f71\u54cd\u3002\u4e3b\u8981\u6ee1\u8db3\u5355\u673a\u573a\u666f\u4e0b\u7684\u5c0f\u6570\u636e\u91cf\u7f13\u5b58\u9700\u6c42\uff0c\u540c\u65f6\u5bf9\u7f13\u5b58\u6570\u636e\u7684\u53d8\u66f4\u65e0\u9700\u592a\u654f\u611f\u611f\u77e5\uff0c\u5982\u4e0a\u4e00\u822c\u914d\u7f6e\u7ba1\u7406\u3001\u57fa\u7840\u9759\u6001\u6570\u636e\u7b49\u573a\u666f\u3002</p>"},{"location":"2019-03-18-%E7%BC%93%E5%AD%98%E9%82%A3%E4%BA%9B%E4%BA%8B/#ehcache","title":"Ehcache","text":"<p>Ehcache\u662f\u73b0\u5728\u6700\u6d41\u884c\u7684\u7eafJava\u5f00\u6e90\u7f13\u5b58\u6846\u67b6\uff0c\u914d\u7f6e\u7b80\u5355\u3001\u7ed3\u6784\u6e05\u6670\u3001\u529f\u80fd\u5f3a\u5927\uff0c\u662f\u4e00\u4e2a\u975e\u5e38\u8f7b\u91cf\u7ea7\u7684\u7f13\u5b58\u5b9e\u73b0\uff0c\u6211\u4eec\u5e38\u7528\u7684Hibernate\u91cc\u9762\u5c31\u96c6\u6210\u4e86\u76f8\u5173\u7f13\u5b58\u529f\u80fd\u3002</p> <p></p> <p>\u4ece\u56fe3\u4e2d\u6211\u4eec\u53ef\u4ee5\u4e86\u89e3\u5230\uff0cEhcache\u7684\u6838\u5fc3\u5b9a\u4e49\u4e3b\u8981\u5305\u62ec\uff1a</p> <ul> <li> <p>cache manager\uff1a\u7f13\u5b58\u7ba1\u7406\u5668\uff0c\u4ee5\u524d\u662f\u53ea\u5141\u8bb8\u5355\u4f8b\u7684\uff0c\u4e0d\u8fc7\u73b0\u5728\u4e5f\u53ef\u4ee5\u591a\u5b9e\u4f8b\u4e86\u3002</p> </li> <li> <p>cache\uff1a\u7f13\u5b58\u7ba1\u7406\u5668\u5185\u53ef\u4ee5\u653e\u7f6e\u82e5\u5e72cache\uff0c\u5b58\u653e\u6570\u636e\u7684\u5b9e\u8d28\uff0c\u6240\u6709cache\u90fd\u5b9e\u73b0\u4e86Ehcache\u63a5\u53e3\uff0c\u8fd9\u662f\u4e00\u4e2a\u771f\u6b63\u4f7f\u7528\u7684\u7f13\u5b58\u5b9e\u4f8b\uff1b\u901a\u8fc7\u7f13\u5b58\u7ba1\u7406\u5668\u7684\u6a21\u5f0f\uff0c\u53ef\u4ee5\u5728\u5355\u4e2a\u5e94\u7528\u4e2d\u8f7b\u677e\u9694\u79bb\u591a\u4e2a\u7f13\u5b58\u5b9e\u4f8b\uff0c\u72ec\u7acb\u670d\u52a1\u4e8e\u4e0d\u540c\u4e1a\u52a1\u573a\u666f\u9700\u6c42\uff0c\u7f13\u5b58\u6570\u636e\u7269\u7406\u9694\u79bb\uff0c\u540c\u65f6\u9700\u8981\u65f6\u53c8\u53ef\u5171\u4eab\u4f7f\u7528\u3002</p> </li> <li> <p>element\uff1a\u5355\u6761\u7f13\u5b58\u6570\u636e\u7684\u7ec4\u6210\u5355\u4f4d\u3002</p> </li> <li> <p>system of record(SOR)\uff1a\u53ef\u4ee5\u53d6\u5230\u771f\u5b9e\u6570\u636e\u7684\u7ec4\u4ef6\uff0c\u53ef\u4ee5\u662f\u771f\u6b63\u7684\u4e1a\u52a1\u903b\u8f91\u3001\u5916\u90e8\u63a5\u53e3\u8c03\u7528\u3001\u5b58\u653e\u771f\u5b9e\u6570\u636e\u7684\u6570\u636e\u5e93\u7b49\uff0c\u7f13\u5b58\u5c31\u662f\u4eceSOR\u4e2d\u8bfb\u53d6\u6216\u8005\u5199\u5165\u5230SOR\u4e2d\u53bb\u7684\u3002</p> </li> </ul> <p>\u5728\u4e0a\u5c42\u53ef\u4ee5\u770b\u5230\uff0c\u6574\u4e2aEhcache\u63d0\u4f9b\u4e86\u5bf9JSR\u3001JMX\u7b49\u7684\u6807\u51c6\u652f\u6301\uff0c\u80fd\u591f\u8f83\u597d\u7684\u517c\u5bb9\u548c\u79fb\u690d\uff0c\u540c\u65f6\u5bf9\u5404\u7c7b\u5bf9\u8c61\u6709\u8f83\u5b8c\u5584\u7684\u76d1\u63a7\u7ba1\u7406\u673a\u5236\u3002\u5b83\u7684\u7f13\u5b58\u4ecb\u8d28\u6db5\u76d6\u5806\u5185\u5b58\uff08heap\uff09\u3001\u5806\u5916\u5185\u5b58\uff08BigMemory\u5546\u7528\u7248\u672c\u652f\u6301\uff09\u548c\u78c1\u76d8\uff0c\u5404\u4ecb\u8d28\u53ef\u72ec\u7acb\u8bbe\u7f6e\u5c5e\u6027\u548c\u7b56\u7565\u3002Ehcache\u6700\u521d\u662f\u72ec\u7acb\u7684\u672c\u5730\u7f13\u5b58\u6846\u67b6\u7ec4\u4ef6\uff0c\u5728\u540e\u671f\u7684\u53d1\u5c55\u4e2d\uff0c\u7ed3\u5408Terracotta\u670d\u52a1\u9635\u5217\u6a21\u578b\uff0c\u53ef\u4ee5\u652f\u6301\u5206\u5e03\u5f0f\u7f13\u5b58\u96c6\u7fa4\uff0c\u4e3b\u8981\u6709RMI\u3001JGroups\u3001JMS\u548cCache Server\u7b49\u4f20\u64ad\u65b9\u5f0f\u8fdb\u884c\u8282\u70b9\u95f4\u901a\u4fe1\uff0c\u5982\u56fe3\u7684\u5de6\u4fa7\u90e8\u5206\u63cf\u8ff0\u3002</p> <p>\u6574\u4f53\u6570\u636e\u6d41\u8f6c\u5305\u62ec\u8fd9\u6837\u51e0\u7c7b\u884c\u4e3a:</p> <ul> <li>Flush\uff1a\u7f13\u5b58\u6761\u76ee\u5411\u4f4e\u5c42\u6b21\u79fb\u52a8\u3002</li> <li>Fault\uff1a\u4ece\u4f4e\u5c42\u62f7\u8d1d\u4e00\u4e2a\u5bf9\u8c61\u5230\u9ad8\u5c42\u3002\u5728\u83b7\u53d6\u7f13\u5b58\u7684\u8fc7\u7a0b\u4e2d\uff0c\u67d0\u4e00\u5c42\u53d1\u73b0\u81ea\u5df1\u7684\u8be5\u7f13\u5b58\u6761\u76ee\u5df2\u7ecf\u5931\u6548\uff0c\u5c31\u89e6\u53d1\u4e86Fault\u884c\u4e3a\u3002</li> <li>Eviction\uff1a\u628a\u7f13\u5b58\u6761\u76ee\u9664\u53bb\u3002</li> <li>Expiration\uff1a\u5931\u6548\u72b6\u6001\u3002</li> <li>Pinning\uff1a\u5f3a\u5236\u7f13\u5b58\u6761\u76ee\u4fdd\u6301\u5728\u67d0\u4e00\u5c42\u3002</li> </ul> <p>\u56fe4\u53cd\u6620\u4e86\u6570\u636e\u5728\u5404\u4e2a\u5c42\u4e4b\u95f4\u7684\u6d41\u8f6c\uff0c\u540c\u65f6\u4e5f\u4f53\u73b0\u4e86\u5404\u5c42\u6570\u636e\u7684\u4e00\u4e2a\u751f\u547d\u5468\u671f\u3002</p> <p></p> <p>Ehcache\u7684XML\u914d\u7f6e\u4f7f\u7528\u5982\u4e0b\uff1a</p> <pre><code>&lt;ehcache&gt;\n&lt;!-- \u6307\u5b9a\u4e00\u4e2a\u6587\u4ef6\u76ee\u5f55\uff0c\u5f53Ehcache\u628a\u6570\u636e\u5199\u5230\u786c\u76d8\u4e0a\u65f6\uff0c\u5c06\u628a\u6570\u636e\u5199\u5230\u8fd9\u4e2a\u6587\u4ef6\u76ee\u5f55\u4e0b --&gt;\n&lt;diskStore path=\"java.io.tmpdir\"/&gt;\n\n&lt;!-- \u8bbe\u5b9a\u7f13\u5b58\u7684\u9ed8\u8ba4\u6570\u636e\u8fc7\u671f\u7b56\u7565 --&gt;\n&lt;defaultCache\nmaxElementsInMemory=\"10000\"\neternal=\"false\"\noverflowToDisk=\"true\"\ntimeToIdleSeconds=\"0\"\ntimeToLiveSeconds=\"0\"\ndiskPersistent=\"false\"\ndiskExpiryThreadIntervalSeconds=\"120\"/&gt;\n\n&lt;!--  \n    \u8bbe\u5b9a\u5177\u4f53\u7684\u547d\u540d\u7f13\u5b58\u7684\u6570\u636e\u8fc7\u671f\u7b56\u7565\n\n    cache\u5143\u7d20\u7684\u5c5e\u6027\uff1a\n        name\uff1a\u7f13\u5b58\u540d\u79f0\n\n        maxElementsInMemory\uff1a\u5185\u5b58\u4e2d\u6700\u5927\u7f13\u5b58\u5bf9\u8c61\u6570\n\n        maxElementsOnDisk\uff1a\u786c\u76d8\u4e2d\u6700\u5927\u7f13\u5b58\u5bf9\u8c61\u6570\uff0c\u82e5\u662f0\u8868\u793a\u65e0\u7a77\u5927\n\n        eternal\uff1atrue\u8868\u793a\u5bf9\u8c61\u6c38\u4e0d\u8fc7\u671f\uff0c\u6b64\u65f6\u4f1a\u5ffd\u7565timeToIdleSeconds\u548ctimeToLiveSeconds\u5c5e\u6027\uff0c\u9ed8\u8ba4\u4e3afalse\n\n        overflowToDisk\uff1atrue\u8868\u793a\u5f53\u5185\u5b58\u7f13\u5b58\u7684\u5bf9\u8c61\u6570\u76ee\u8fbe\u5230\u4e86maxElementsInMemory\u754c\u9650\u540e\uff0c\u4f1a\u628a\u6ea2\u51fa\u7684\u5bf9\u8c61\u5199\u5230\u786c\u76d8\u7f13\u5b58\u4e2d\u3002\u6ce8\u610f\uff1a\u5982\u679c\u7f13\u5b58\u7684\u5bf9\u8c61\u8981\u5199\u5165\u5230\u786c\u76d8\u4e2d\u7684\u8bdd\uff0c\u5219\u8be5\u5bf9\u8c61\u5fc5\u987b\u5b9e\u73b0\u4e86Serializable\u63a5\u53e3\u624d\u884c\u3002\n\n        diskSpoolBufferSizeMB\uff1a\u78c1\u76d8\u7f13\u5b58\u533a\u5927\u5c0f\uff0c\u9ed8\u8ba4\u4e3a30MB\u3002\u6bcf\u4e2aCache\u90fd\u5e94\u8be5\u6709\u81ea\u5df1\u7684\u4e00\u4e2a\u7f13\u5b58\u533a\u3002\n\n        diskPersistent\uff1a\u662f\u5426\u7f13\u5b58\u865a\u62df\u673a\u91cd\u542f\u671f\u6570\u636e\n\n        diskExpiryThreadIntervalSeconds\uff1a\u78c1\u76d8\u5931\u6548\u7ebf\u7a0b\u8fd0\u884c\u65f6\u95f4\u95f4\u9694\uff0c\u9ed8\u8ba4\u4e3a120\u79d2\n\n        timeToIdleSeconds\uff1a \u8bbe\u5b9a\u5141\u8bb8\u5bf9\u8c61\u5904\u4e8e\u7a7a\u95f2\u72b6\u6001\u7684\u6700\u957f\u65f6\u95f4\uff0c\u4ee5\u79d2\u4e3a\u5355\u4f4d\u3002\u5f53\u5bf9\u8c61\u81ea\u4ece\u6700\u8fd1\u4e00\u6b21\u88ab\u8bbf\u95ee\u540e\uff0c\u5982\u679c\u5904\u4e8e\u7a7a\u95f2\u72b6\u6001\u7684\u65f6\u95f4\u8d85\u8fc7\u4e86timeToIdleSeconds\u5c5e\u6027\u503c\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u4f1a\u8fc7\u671f\uff0cEHCache\u5c06\u628a\u5b83\u4ece\u7f13\u5b58\u4e2d\u6e05\u7a7a\u3002\u53ea\u6709\u5f53eternal\u5c5e\u6027\u4e3afalse\uff0c\u8be5\u5c5e\u6027\u624d\u6709\u6548\u3002\u5982\u679c\u8be5\u5c5e\u6027\u503c\u4e3a0\uff0c\u5219\u8868\u793a\u5bf9\u8c61\u53ef\u4ee5\u65e0\u9650\u671f\u5730\u5904\u4e8e\u7a7a\u95f2\u72b6\u6001\n\n        timeToLiveSeconds\uff1a\u8bbe\u5b9a\u5bf9\u8c61\u5141\u8bb8\u5b58\u5728\u4e8e\u7f13\u5b58\u4e2d\u7684\u6700\u957f\u65f6\u95f4\uff0c\u4ee5\u79d2\u4e3a\u5355\u4f4d\u3002\u5f53\u5bf9\u8c61\u81ea\u4ece\u88ab\u5b58\u653e\u5230\u7f13\u5b58\u4e2d\u540e\uff0c\u5982\u679c\u5904\u4e8e\u7f13\u5b58\u4e2d\u7684\u65f6\u95f4\u8d85\u8fc7\u4e86 timeToLiveSeconds\u5c5e\u6027\u503c\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u4f1a\u8fc7\u671f\uff0cEhcache\u5c06\u628a\u5b83\u4ece\u7f13\u5b58\u4e2d\u6e05\u9664\u3002\u53ea\u6709\u5f53eternal\u5c5e\u6027\u4e3afalse\uff0c\u8be5\u5c5e\u6027\u624d\u6709\u6548\u3002\u5982\u679c\u8be5\u5c5e\u6027\u503c\u4e3a0\uff0c\u5219\u8868\u793a\u5bf9\u8c61\u53ef\u4ee5\u65e0\u9650\u671f\u5730\u5b58\u5728\u4e8e\u7f13\u5b58\u4e2d\u3002timeToLiveSeconds\u5fc5\u987b\u5927\u4e8etimeToIdleSeconds\u5c5e\u6027\uff0c\u624d\u6709\u610f\u4e49\n\n        memoryStoreEvictionPolicy\uff1a\u5f53\u8fbe\u5230maxElementsInMemory\u9650\u5236\u65f6\uff0cEhcache\u5c06\u4f1a\u6839\u636e\u6307\u5b9a\u7684\u7b56\u7565\u53bb\u6e05\u7406\u5185\u5b58\u3002\u53ef\u9009\u7b56\u7565\u6709\uff1aLRU\uff08\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\uff0c\u9ed8\u8ba4\u7b56\u7565\uff09\u3001FIFO\uff08\u5148\u8fdb\u5148\u51fa\uff09\u3001LFU\uff08\u6700\u5c11\u8bbf\u95ee\u6b21\u6570\uff09\u3002\n--&gt;\n&lt;cache name=\"CACHE1\"\nmaxElementsInMemory=\"1000\"\neternal=\"true\"\noverflowToDisk=\"true\"/&gt;  &lt;cache name=\"CACHE2\"\nmaxElementsInMemory=\"1000\"\neternal=\"false\"\ntimeToIdleSeconds=\"200\"\ntimeToLiveSeconds=\"4000\"\noverflowToDisk=\"true\"/&gt;\n&lt;/ehcache&gt;\n</code></pre> <p>\u6574\u4f53\u4e0a\u770b\uff0cEhcache\u7684\u4f7f\u7528\u8fd8\u662f\u76f8\u5bf9\u7b80\u5355\u4fbf\u6377\u7684\uff0c\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u5404\u7c7bAPI\u63a5\u53e3\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u867d\u7136Ehcache\u652f\u6301\u78c1\u76d8\u7684\u6301\u4e45\u5316\uff0c\u4f46\u662f\u7531\u4e8e\u5b58\u5728\u4e24\u7ea7\u7f13\u5b58\u4ecb\u8d28\uff0c\u5728\u4e00\u7ea7\u5185\u5b58\u4e2d\u7684\u7f13\u5b58\uff0c\u5982\u679c\u6ca1\u6709\u4e3b\u52a8\u7684\u5237\u5165\u78c1\u76d8\u6301\u4e45\u5316\u7684\u8bdd\uff0c\u5728\u5e94\u7528\u5f02\u5e38down\u673a\u7b49\u60c5\u5f62\u4e0b\uff0c\u4f9d\u7136\u4f1a\u51fa\u73b0\u7f13\u5b58\u6570\u636e\u4e22\u5931\uff0c\u4e3a\u6b64\u53ef\u4ee5\u6839\u636e\u9700\u8981\u5c06\u7f13\u5b58\u5237\u5230\u78c1\u76d8\uff0c\u5c06\u7f13\u5b58\u6761\u76ee\u5237\u5230\u78c1\u76d8\u7684\u64cd\u4f5c\u53ef\u4ee5\u901a\u8fc7cache.flush()\u65b9\u6cd5\u6765\u6267\u884c\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5bf9\u4e8e\u5bf9\u8c61\u7684\u78c1\u76d8\u5199\u5165\uff0c\u524d\u63d0\u662f\u8981\u5c06\u5bf9\u8c61\u8fdb\u884c\u5e8f\u5217\u5316\u3002</p>"},{"location":"2019-03-18-%E7%BC%93%E5%AD%98%E9%82%A3%E4%BA%9B%E4%BA%8B/#_3","title":"\u4e3b\u8981\u7279\u6027","text":"<ul> <li>\u5feb\u901f\uff0c\u9488\u5bf9\u5927\u578b\u9ad8\u5e76\u53d1\u7cfb\u7edf\u573a\u666f\uff0cEhcache\u7684\u591a\u7ebf\u7a0b\u673a\u5236\u6709\u76f8\u5e94\u7684\u4f18\u5316\u6539\u5584\u3002</li> <li>\u7b80\u5355\uff0c\u5f88\u5c0f\u7684jar\u5305\uff0c\u7b80\u5355\u914d\u7f6e\u5c31\u53ef\u76f4\u63a5\u4f7f\u7528\uff0c\u5355\u673a\u573a\u666f\u4e0b\u65e0\u9700\u8fc7\u591a\u7684\u5176\u4ed6\u670d\u52a1\u4f9d\u8d56\u3002</li> <li>\u652f\u6301\u591a\u79cd\u7684\u7f13\u5b58\u7b56\u7565\uff0c\u7075\u6d3b\u3002</li> <li>\u7f13\u5b58\u6570\u636e\u6709\u4e24\u7ea7\uff1a\u5185\u5b58\u548c\u78c1\u76d8\uff0c\u4e0e\u4e00\u822c\u7684\u672c\u5730\u5185\u5b58\u7f13\u5b58\u76f8\u6bd4\uff0c\u6709\u4e86\u78c1\u76d8\u7684\u5b58\u50a8\u7a7a\u95f4\uff0c\u5c06\u53ef\u4ee5\u652f\u6301\u66f4\u5927\u91cf\u7684\u6570\u636e\u7f13\u5b58\u9700\u6c42\u3002</li> <li>\u5177\u6709\u7f13\u5b58\u548c\u7f13\u5b58\u7ba1\u7406\u5668\u7684\u4fa6\u542c\u63a5\u53e3\uff0c\u80fd\u66f4\u7b80\u5355\u65b9\u4fbf\u7684\u8fdb\u884c\u7f13\u5b58\u5b9e\u4f8b\u7684\u76d1\u63a7\u7ba1\u7406\u3002</li> <li>\u652f\u6301\u591a\u7f13\u5b58\u7ba1\u7406\u5668\u5b9e\u4f8b\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5b9e\u4f8b\u7684\u591a\u4e2a\u7f13\u5b58\u533a\u57df\u3002</li> </ul> <p>\u6ce8\u610f\uff1aEhcache\u7684\u8d85\u65f6\u8bbe\u7f6e\u4e3b\u8981\u662f\u9488\u5bf9\u6574\u4e2acache\u5b9e\u4f8b\u8bbe\u7f6e\u6574\u4f53\u7684\u8d85\u65f6\u7b56\u7565\uff0c\u800c\u6ca1\u6709\u8f83\u597d\u7684\u5904\u7406\u9488\u5bf9\u5355\u72ec\u7684key\u7684\u4e2a\u6027\u7684\u8d85\u65f6\u8bbe\u7f6e\uff08\u6709\u7b56\u7565\u8bbe\u7f6e\uff0c\u4f46\u662f\u6bd4\u8f83\u590d\u6742\uff0c\u5c31\u4e0d\u63cf\u8ff0\u4e86\uff09\uff0c\u56e0\u6b64\uff0c\u5728\u4f7f\u7528\u4e2d\u8981\u6ce8\u610f\u8fc7\u671f\u5931\u6548\u7684\u7f13\u5b58\u5143\u7d20\u65e0\u6cd5\u88abGC\u56de\u6536\uff0c\u65f6\u95f4\u8d8a\u957f\u7f13\u5b58\u8d8a\u591a\uff0c\u5185\u5b58\u5360\u7528\u4e5f\u5c31\u8d8a\u5927\uff0c\u5185\u5b58\u6cc4\u9732\u7684\u6982\u7387\u4e5f\u8d8a\u5927\u3002</p>"},{"location":"2019-03-18-%E7%BC%93%E5%AD%98%E9%82%A3%E4%BA%9B%E4%BA%8B/#guava-cache","title":"Guava Cache","text":"<p>Guava Cache\u662fGoogle\u5f00\u6e90\u7684Java\u91cd\u7528\u5de5\u5177\u96c6\u5e93<code>Guava</code>\u91cc\u7684\u4e00\u6b3e\u7f13\u5b58\u5de5\u5177\uff0c\u5176\u4e3b\u8981\u5b9e\u73b0\u7684\u7f13\u5b58\u529f\u80fd\u6709\uff1a</p> <ul> <li>\u81ea\u52a8\u5c06entry\u8282\u70b9\u52a0\u8f7d\u8fdb\u7f13\u5b58\u7ed3\u6784\u4e2d\uff1b</li> <li>\u5f53\u7f13\u5b58\u7684\u6570\u636e\u8d85\u8fc7\u8bbe\u7f6e\u7684\u6700\u5927\u503c\u65f6\uff0c\u4f7f\u7528<code>LRU\u7b97\u6cd5</code>\u79fb\u9664\uff1b</li> <li>\u5177\u5907\u6839\u636eentry\u8282\u70b9\u4e0a\u6b21\u88ab\u8bbf\u95ee\u6216\u8005\u5199\u5165\u65f6\u95f4\u8ba1\u7b97\u5b83\u7684\u8fc7\u671f\u673a\u5236\uff1b</li> <li>\u7f13\u5b58\u7684key\u88ab\u5c01\u88c5\u5728<code>WeakReference</code>\u5f15\u7528\u5185\uff1b</li> <li>\u7f13\u5b58\u7684Value\u88ab\u5c01\u88c5\u5728WeakReference\u6216<code>SoftReference</code>\u5f15\u7528\u5185\uff1b</li> <li>\u7edf\u8ba1\u7f13\u5b58\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u547d\u4e2d\u7387\u3001\u5f02\u5e38\u7387\u3001\u672a\u547d\u4e2d\u7387\u7b49<code>\u7edf\u8ba1\u6570\u636e</code>\u3002</li> </ul> <p>Guava Cache\u7684\u67b6\u6784\u8bbe\u8ba1\u7075\u611f\u6765\u6e90\u4e8e<code>ConcurrentHashMap</code>\uff0c\u6211\u4eec\u524d\u9762\u4e5f\u63d0\u5230\u8fc7\uff0c\u7b80\u5355\u573a\u666f\u4e0b\u53ef\u4ee5\u81ea\u884c\u7f16\u7801\u901a\u8fc7hashmap\u6765\u505a\u5c11\u91cf\u6570\u636e\u7684\u7f13\u5b58\uff0c\u4f46\u662f\uff0c\u5982\u679c\u7ed3\u679c\u53ef\u80fd\u968f\u65f6\u95f4\u6539\u53d8\u6216\u8005\u662f\u5e0c\u671b\u5b58\u50a8\u7684\u6570\u636e\u7a7a\u95f4\u53ef\u63a7\u7684\u8bdd\uff0c\u81ea\u5df1\u5b9e\u73b0\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u8fd8\u662f\u6709\u5fc5\u8981\u7684\u3002</p> <p>Guava Cache\u7ee7\u627f\u4e86ConcurrentHashMap\u7684\u601d\u8def\uff0c\u4f7f\u7528<code>\u591a\u4e2asegments\u65b9\u5f0f\u7684\u7ec6\u7c92\u5ea6\u9501</code>\uff0c\u5728\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\u7684\u540c\u65f6\uff0c\u652f\u6301\u9ad8\u5e76\u53d1\u573a\u666f\u9700\u6c42\u3002Cache\u7c7b\u4f3c\u4e8eMap\uff0c\u5b83\u662f\u5b58\u50a8\u952e\u503c\u5bf9\u7684\u96c6\u5408\uff0c\u4e0d\u540c\u7684\u662f\u5b83\u8fd8\u9700\u8981\u5904\u7406evict\u3001expire\u3001dynamic load\u7b49\u7b97\u6cd5\u903b\u8f91\uff0c\u9700\u8981\u4e00\u4e9b\u989d\u5916\u4fe1\u606f\u6765\u5b9e\u73b0\u8fd9\u4e9b\u64cd\u4f5c\u3002\u5bf9\u6b64\uff0c\u6839\u636e\u9762\u5411\u5bf9\u8c61\u601d\u60f3\uff0c\u9700\u8981\u505a<code>\u65b9\u6cd5\u4e0e\u6570\u636e\u7684\u5173\u8054\u5c01\u88c5</code>\u3002\u5982\u56fe5\u6240\u793acache\u7684\u5185\u5b58\u6570\u636e\u6a21\u578b\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u4f7f\u7528<code>ReferenceEntry</code>\u63a5\u53e3\u6765\u5c01\u88c5\u4e00\u4e2a<code>\u952e\u503c\u5bf9</code>\uff0c\u800c\u7528<code>ValueReference</code>\u6765\u5c01\u88c5<code>Value\u503c</code>\uff0c\u4e4b\u6240\u4ee5\u7528Reference\u547d\u4ee4\uff0c\u662f\u56e0\u4e3aCache\u8981\u652f\u6301WeakReference Key\u548cSoftReference\u3001WeakReference value\u3002</p> <p></p> <p><code>ReferenceEntry</code>\u662f\u5bf9\u4e00\u4e2a\u952e\u503c\u5bf9\u8282\u70b9\u7684\u62bd\u8c61\uff0c\u5b83\u5305\u542b\u4e86key\u548c\u503c\u7684ValueReference\u62bd\u8c61\u7c7b\uff0cCache\u7531\u591a\u4e2aSegment\u7ec4\u6210\uff0c\u800c\u6bcf\u4e2aSegment\u5305\u542b\u4e00\u4e2aReferenceEntry\u6570\u7ec4\uff0c\u6bcf\u4e2aReferenceEntry\u6570\u7ec4\u9879\u90fd\u662f\u4e00\u6761ReferenceEntry\u94fe\uff0c\u4e14\u4e00\u4e2aReferenceEntry\u5305\u542bkey\u3001hash\u3001valueReference\u3001next\u5b57\u6bb5\u3002\u9664\u4e86\u5728ReferenceEntry\u6570\u7ec4\u9879\u4e2d\u7ec4\u6210\u7684\u94fe\uff0c\u5728\u4e00\u4e2aSegment\u4e2d\uff0c\u6240\u6709ReferenceEntry\u8fd8\u7ec4\u6210access\u94fe\uff08accessQueue\uff09\u548cwrite\u94fe\uff08writeQueue\uff09\uff08\u540e\u9762\u4f1a\u4ecb\u7ecd\u94fe\u7684\u4f5c\u7528\uff09\u3002<code>ReferenceEntry</code>\u53ef\u4ee5\u662f\u5f3a\u5f15\u7528\u7c7b\u578b\u7684key\uff0c\u4e5f\u53ef\u4ee5WeakReference\u7c7b\u578b\u7684key\uff0c\u4e3a\u4e86\u51cf\u5c11\u5185\u5b58\u4f7f\u7528\u91cf\uff0c\u8fd8\u53ef\u4ee5\u6839\u636e\u662f\u5426\u914d\u7f6e\u4e86expireAfterWrite\u3001expireAfterAccess\u3001maximumSize\u6765\u51b3\u5b9a\u662f\u5426\u9700\u8981write\u94fe\u548caccess\u94fe\u786e\u5b9a\u8981\u521b\u5efa\u7684\u5177\u4f53Reference\uff1aStrongEntry\u3001StrongWriteEntry\u3001StrongAccessEntry\u3001StrongWriteAccessEntry\u7b49\u3002</p> <p>\u5bf9\u4e8e<code>ValueReference</code>\uff0c\u56e0\u4e3aCache\u652f\u6301\u5f3a\u5f15\u7528\u7684Value\u3001SoftReference Value\u4ee5\u53caWeakReference Value\uff0c\u56e0\u800c\u5b83\u5bf9\u5e94\u4e09\u4e2a\u5b9e\u73b0\u7c7b\uff1aStrongValueReference\u3001SoftValueReference\u3001WeakValueReference\u3002\u4e3a\u4e86\u652f\u6301\u52a8\u6001\u52a0\u8f7d\u673a\u5236\uff0c\u5b83\u8fd8\u6709\u4e00\u4e2aLoadingValueReference\uff0c\u5728\u9700\u8981\u52a8\u6001\u52a0\u8f7d\u4e00\u4e2akey\u7684\u503c\u65f6\uff0c\u5148\u628a\u8be5\u503c\u5c01\u88c5\u5728LoadingValueReference\u4e2d\uff0c\u4ee5\u8868\u8fbe\u8be5key\u5bf9\u5e94\u7684\u503c\u5df2\u7ecf\u5728\u52a0\u8f7d\u4e86\uff0c\u5982\u679c\u5176\u4ed6\u7ebf\u7a0b\u4e5f\u8981\u67e5\u8be2\u8be5key\u5bf9\u5e94\u7684\u503c\uff0c\u5c31\u80fd\u5f97\u5230\u8be5\u5f15\u7528\uff0c\u5e76\u4e14\u7b49\u5f85\u6539\u503c\u52a0\u8f7d\u5b8c\u6210\uff0c\u4ece\u800c\u4fdd\u8bc1\u8be5\u503c\u53ea\u88ab\u52a0\u8f7d\u4e00\u6b21\uff0c\u5728\u8be5\u503c\u52a0\u8f7d\u5b8c\u6210\u540e\uff0c\u5c06LoadingValueReference\u66ff\u6362\u6210\u5176\u4ed6ValueReference\u7c7b\u578b\u3002ValueReference\u5bf9\u8c61\u4e2d\u4f1a\u4fdd\u7559\u5bf9ReferenceEntry\u7684\u5f15\u7528\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728Value\u56e0\u4e3aWeakReference\u3001SoftReference\u88ab\u56de\u6536\u65f6\uff0c\u9700\u8981\u4f7f\u7528\u5176key\u5c06\u5bf9\u5e94\u7684\u9879\u4eceSegment\u7684table\u4e2d\u79fb\u9664\u3002</p> <p><code>WriteQueue\u548cAccessQueue</code> \uff1a\u4e3a\u4e86\u5b9e\u73b0\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7b97\u6cd5\uff0cGuava Cache\u5728Segment\u4e2d\u6dfb\u52a0\u4e86\u4e24\u6761\u94fe\uff1awrite\u94fe\uff08writeQueue\uff09\u548caccess\u94fe\uff08accessQueue\uff09\uff0c\u8fd9\u4e24\u6761\u94fe\u90fd\u662f\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\uff0c\u901a\u8fc7ReferenceEntry\u4e2d\u7684previousInWriteQueue\u3001nextInWriteQueue\u548cpreviousInAccessQueue\u3001nextInAccessQueue\u94fe\u63a5\u800c\u6210\uff0c\u4f46\u662f\u4ee5Queue\u7684\u5f62\u5f0f\u8868\u8fbe\u3002WriteQueue\u548cAccessQueue\u90fd\u662f\u81ea\u5b9a\u4e49\u4e86offer\u3001add\uff08\u76f4\u63a5\u8c03\u7528offer\uff09\u3001remove\u3001poll\u7b49\u64cd\u4f5c\u7684\u903b\u8f91\uff0c\u5bf9offer\uff08add\uff09\u64cd\u4f5c\uff0c\u5982\u679c\u662f\u65b0\u52a0\u7684\u8282\u70b9\uff0c\u5219\u76f4\u63a5\u52a0\u5165\u5230\u8be5\u94fe\u7684\u7ed3\u5c3e\uff0c\u5982\u679c\u662f\u5df2\u5b58\u5728\u7684\u8282\u70b9\uff0c\u5219\u5c06\u8be5\u8282\u70b9\u94fe\u63a5\u7684\u94fe\u5c3e\uff1b\u5bf9remove\u64cd\u4f5c\uff0c\u76f4\u63a5\u4ece\u8be5\u94fe\u4e2d\u79fb\u9664\u8be5\u8282\u70b9\uff1b\u5bf9poll\u64cd\u4f5c\uff0c\u5c06\u5934\u8282\u70b9\u7684\u4e0b\u4e00\u4e2a\u8282\u70b9\u79fb\u9664\uff0c\u5e76\u8fd4\u56de\u3002</p> <p>\u4e86\u89e3\u4e86cache\u7684\u6574\u4f53\u6570\u636e\u7ed3\u6784\u540e\uff0c\u518d\u6765\u770b\u4e0b\u9488\u5bf9\u7f13\u5b58\u7684\u76f8\u5173\u64cd\u4f5c\u5c31\u7b80\u5355\u591a\u4e86\uff1a</p> <ul> <li> <p>Segment\u4e2d\u7684evict\u6e05\u9664\u7b56\u7565\u64cd\u4f5c\uff0c\u662f\u5728\u6bcf\u4e00\u6b21\u8c03\u7528\u64cd\u4f5c\u7684\u5f00\u59cb\u548c\u7ed3\u675f\u65f6\u89e6\u53d1\u6e05\u7406\u5de5\u4f5c\uff0c\u8fd9\u6837\u6bd4\u4e00\u822c\u7684\u7f13\u5b58\u53e6\u8d77\u7ebf\u7a0b\u76d1\u63a7\u6e05\u7406\u76f8\u6bd4\uff0c\u53ef\u4ee5\u51cf\u5c11\u5f00\u9500\uff0c\u4f46\u5982\u679c\u957f\u65f6\u95f4\u6ca1\u6709\u8c03\u7528\u65b9\u6cd5\u7684\u8bdd\uff0c\u4f1a\u5bfc\u81f4\u4e0d\u80fd\u53ca\u65f6\u7684\u6e05\u7406\u91ca\u653e\u5185\u5b58\u7a7a\u95f4\u7684\u95ee\u9898\u3002evict\u4e3b\u8981\u5904\u7406\u56db\u4e2aQueue\uff1a</p> </li> <li> <p>keyReferenceQueue</p> </li> <li>valueReferenceQueue</li> <li>writeQueue</li> <li>accessQueue</li> </ul> <p>\u524d\u4e24\u4e2aqueue\u662f\u56e0\u4e3aWeakReference\u3001SoftReference\u88ab\u5783\u573e\u56de\u6536\u65f6\u52a0\u5165\u7684\uff0c\u6e05\u7406\u65f6\u53ea\u9700\u8981\u904d\u5386\u6574\u4e2aqueue\uff0c\u5c06\u5bf9\u5e94\u7684\u9879\u4eceLocalCache\u4e2d\u79fb\u9664\u5373\u53ef\uff0c\u8fd9\u91cckeyReferenceQueue\u5b58\u653eReferenceEntry\uff0c\u800cvalueReferenceQueue\u5b58\u653e\u7684\u662fValueReference\uff0c\u8981\u4eceCache\u4e2d\u79fb\u9664\u9700\u8981\u6709key\uff0c\u56e0\u800cValueReference\u9700\u8981\u6709\u5bf9ReferenceEntry\u7684\u5f15\u7528\uff0c\u8fd9\u4e2a\u524d\u9762\u4e5f\u63d0\u5230\u8fc7\u4e86\u3002\u800c\u5bf9\u540e\u9762\u4e24\u4e2aQueue\uff0c\u53ea\u9700\u8981\u68c0\u67e5\u662f\u5426\u914d\u7f6e\u4e86\u76f8\u5e94\u7684expire\u65f6\u95f4\uff0c\u7136\u540e\u4ece\u5934\u5f00\u59cb\u67e5\u627e\u5df2\u7ecfexpire\u7684Entry\uff0c\u5c06\u5b83\u4eec\u79fb\u9664\u5373\u53ef\u3002</p> <ul> <li>Segment\u4e2d\u7684put\u64cd\u4f5c\uff1aput\u64cd\u4f5c\u76f8\u5bf9\u6bd4\u8f83\u7b80\u5355\uff0c\u9996\u5148\u5b83\u9700\u8981\u83b7\u5f97\u9501\uff0c\u7136\u540e\u5c1d\u8bd5\u505a\u4e00\u4e9b\u6e05\u7406\u5de5\u4f5c\uff0c\u63a5\u4e0b\u6765\u7684\u903b\u8f91\u7c7b\u4f3cConcurrentHashMap\u4e2d\u7684rehash\uff0c\u67e5\u627e\u4f4d\u7f6e\u5e76\u6ce8\u5165\u6570\u636e\u3002\u9700\u8981\u8bf4\u660e\u7684\u662f\u5f53\u627e\u5230\u4e00\u4e2a\u5df2\u5b58\u5728\u7684Entry\u65f6\uff0c\u9700\u8981\u5148\u5224\u65ad\u5f53\u524d\u7684ValueRefernece\u4e2d\u7684\u503c\u4e8b\u5b9e\u4e0a\u5df2\u7ecf\u88ab\u56de\u6536\u4e86\uff0c\u56e0\u4e3a\u5b83\u4eec\u53ef\u4ee5\u662fWeakReference\u3001SoftReference\u7c7b\u578b\uff0c\u5982\u679c\u5df2\u7ecf\u88ab\u56de\u6536\u4e86\uff0c\u5219\u5c06\u65b0\u503c\u5199\u5165\u3002\u5e76\u4e14\u5728\u6bcf\u6b21\u66f4\u65b0\u65f6\u6ce8\u518c\u5f53\u524d\u64cd\u4f5c\u5f15\u8d77\u7684\u79fb\u9664\u4e8b\u4ef6\uff0c\u6307\u5b9a\u76f8\u5e94\u7684\u539f\u56e0\uff1aCOLLECTED\u3001REPLACED\u7b49\uff0c\u8fd9\u4e9b\u6ce8\u518c\u7684\u4e8b\u4ef6\u5728\u9000\u51fa\u7684\u65f6\u5019\u7edf\u4e00\u8c03\u7528Cache\u6ce8\u518c\u7684RemovalListener\uff0c\u7531\u4e8e\u4e8b\u4ef6\u5904\u7406\u53ef\u80fd\u4f1a\u6709\u5f88\u957f\u65f6\u95f4\uff0c\u56e0\u800c\u8fd9\u91cc\u5c06\u4e8b\u4ef6\u5904\u7406\u7684\u903b\u8f91\u5728\u9000\u51fa\u9501\u4ee5\u540e\u624d\u505a\u3002\u6700\u540e\uff0c\u5728\u66f4\u65b0\u5df2\u5b58\u5728\u7684Entry\u7ed3\u675f\u540e\u90fd\u5c1d\u8bd5\u7740\u5c06\u90a3\u4e9b\u5df2\u7ecfexpire\u7684Entry\u79fb\u9664\u3002\u53e6\u5916put\u64cd\u4f5c\u4e2d\u8fd8\u9700\u8981\u66f4\u65b0writeQueue\u548caccessQueue\u7684\u8bed\u4e49\u6b63\u786e\u6027\u3002</li> <li>Segment\u5e26CacheLoader\u7684get\u64cd\u4f5c\uff1a1. \u5148\u67e5\u627etable\u4e2d\u662f\u5426\u5df2\u5b58\u5728\u6ca1\u6709\u88ab\u56de\u6536\u3001\u4e5f\u6ca1\u6709expire\u7684entry\uff0c\u5982\u679c\u627e\u5230\uff0c\u5e76\u5728CacheBuilder\u4e2d\u914d\u7f6e\u4e86refreshAfterWrite\uff0c\u5e76\u4e14\u5f53\u524d\u65f6\u95f4\u95f4\u9694\u5df2\u7ecf\u64cd\u4f5c\u8fd9\u4e2a\u4e8b\u4ef6\uff0c\u5219\u91cd\u65b0\u52a0\u8f7d\u503c\uff0c\u5426\u5219\uff0c\u76f4\u63a5\u8fd4\u56de\u539f\u6709\u7684\u503c\uff1b2. \u5982\u679c\u67e5\u627e\u5230\u7684ValueReference\u662fLoadingValueReference\uff0c\u5219\u7b49\u5f85\u8be5LoadingValueReference\u52a0\u8f7d\u7ed3\u675f\uff0c\u5e76\u8fd4\u56de\u52a0\u8f7d\u7684\u503c\uff1b3. \u5982\u679c\u6ca1\u6709\u627e\u5230entry\uff0c\u6216\u8005\u627e\u5230\u7684entry\u7684\u503c\u4e3anull\uff0c\u5219\u52a0\u9501\u540e\uff0c\u7ee7\u7eed\u5728table\u4e2d\u67e5\u627e\u5df2\u5b58\u5728key\u5bf9\u5e94\u7684entry\uff0c\u5982\u679c\u627e\u5230\u5e76\u4e14\u5bf9\u5e94\u7684entry.isLoading()\u4e3atrue\uff0c\u5219\u8868\u793a\u6709\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u6b63\u5728\u52a0\u8f7d\uff0c\u56e0\u800c\u7b49\u5f85\u90a3\u4e2a\u7ebf\u7a0b\u52a0\u8f7d\u5b8c\u6210\uff0c\u5982\u679c\u627e\u5230\u4e00\u4e2a\u975enull\u503c\uff0c\u8fd4\u56de\u8be5\u503c\uff0c\u5426\u5219\u521b\u5efa\u4e00\u4e2aLoadingValueReference\uff0c\u5e76\u8c03\u7528loadSync\u52a0\u8f7d\u76f8\u5e94\u7684\u503c\uff0c\u5728\u52a0\u8f7d\u5b8c\u6210\u540e\uff0c\u5c06\u65b0\u52a0\u8f7d\u7684\u503c\u66f4\u65b0\u5230table\u4e2d\uff0c\u5373\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u66ff\u6362\u539f\u6765\u7684LoadingValueReference\u3002</li> </ul> <p>Guava Cache\u63d0\u4f9bBuilder\u6a21\u5f0f\u7684CacheBuilder\u751f\u6210\u5668\u6765\u521b\u5efa\u7f13\u5b58\u7684\u65b9\u5f0f\uff0c\u5341\u5206\u65b9\u4fbf\uff0c\u5e76\u4e14\u5404\u4e2a\u7f13\u5b58\u53c2\u6570\u7684\u914d\u7f6e\u8bbe\u7f6e\uff0c\u7c7b\u4f3c\u4e8e\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u5199\u6cd5\uff0c\u53ef\u81ea\u884c\u8bbe\u7f6e\u5404\u7c7b\u53c2\u6570\u9009\u578b\u3002\u5b83\u63d0\u4f9b\u4e09\u79cd\u65b9\u5f0f\u52a0\u8f7d\u5230\u7f13\u5b58\u4e2d\u3002\u5206\u522b\u662f\uff1a</p> <ol> <li>\u5728\u6784\u5efa\u7f13\u5b58\u7684\u65f6\u5019\uff0c\u4f7f\u7528build\u65b9\u6cd5\u5185\u90e8\u8c03\u7528CacheLoader\u65b9\u6cd5\u52a0\u8f7d\u6570\u636e\uff1b</li> <li>callable \u3001callback\u65b9\u5f0f\u52a0\u8f7d\u6570\u636e\uff1b</li> <li>\u4f7f\u7528\u7c97\u66b4\u76f4\u63a5\u7684\u65b9\u5f0f\uff0c\u76f4\u63a5Cache.put \u52a0\u8f7d\u6570\u636e\uff0c\u4f46\u81ea\u52a8\u52a0\u8f7d\u662f\u9996\u9009\u7684\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u66f4\u5bb9\u6613\u7684\u63a8\u65ad\u6240\u6709\u7f13\u5b58\u5185\u5bb9\u7684\u4e00\u81f4\u6027\u3002</li> </ol> <p>build\u751f\u6210\u5668\u7684\u4e24\u79cd\u65b9\u5f0f\u90fd\u5b9e\u73b0\u4e86\u4e00\u79cd\u903b\u8f91\uff1a\u4ece\u7f13\u5b58\u4e2d\u53d6key\u7684\u503c\uff0c\u5982\u679c\u8be5\u503c\u5df2\u7ecf\u7f13\u5b58\u8fc7\u4e86\u5219\u8fd4\u56de\u7f13\u5b58\u4e2d\u7684\u503c\uff0c\u5982\u679c\u6ca1\u6709\u7f13\u5b58\u8fc7\u53ef\u4ee5\u901a\u8fc7\u67d0\u4e2a\u65b9\u6cd5\u6765\u83b7\u53d6\u8fd9\u4e2a\u503c\uff0c\u4e0d\u540c\u7684\u5730\u65b9\u5728\u4e8ecacheloader\u7684\u5b9a\u4e49\u6bd4\u8f83\u5bbd\u6cdb\uff0c\u662f\u9488\u5bf9\u6574\u4e2acache\u5b9a\u4e49\u7684\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u662f\u7edf\u4e00\u7684\u6839\u636ekey\u503cload value\u7684\u65b9\u6cd5\uff0c\u800ccallable\u7684\u65b9\u5f0f\u8f83\u4e3a\u7075\u6d3b\uff0c\u5141\u8bb8\u4f60\u5728get\u7684\u65f6\u5019\u6307\u5b9aload\u65b9\u6cd5\u3002\u4f7f\u7528\u793a\u4f8b\u5982\u4e0b\uff1a</p> <pre><code>   /**\n    * CacheLoader\n   */\npublic void loadingCache()\n{\nLoadingCache&lt;String, String&gt; graphs =CacheBuilder.newBuilder()\n.maximumSize(1000).build(new CacheLoader&lt;String, String&gt;()\n{\n@Override\npublic String load(String key) throws Exception\n{\nSystem.out.println(\"key:\"+key);\nif(\"key\".equals(key)){\nreturn \"key return result\";\n}else{\nreturn \"get-if-absent-compute\";\n}\n}\n});\nString resultVal = null;\ntry {\nresultVal = graphs.get(\"key\");\n} catch (ExecutionException e) {\ne.printStackTrace();\n}\n\nSystem.out.println(resultVal);\n}\n\n/**\n    *\n    * Callable\n   */\npublic void callablex() throws ExecutionException\n{\nCache&lt;String, String&gt; cache = CacheBuilder.newBuilder()\n.maximumSize(1000).build();\nString result = cache.get(\"key\", new Callable&lt;String&gt;()\n{\npublic String call()\n{\nreturn \"result\";\n}\n});\nSystem.out.println(result);\n}\n</code></pre> <p>\u603b\u4f53\u6765\u770b\uff0cGuava Cache\u57fa\u4e8eConcurrentHashMap\u7684\u4f18\u79c0\u8bbe\u8ba1\u501f\u9274\uff0c\u5728\u9ad8\u5e76\u53d1\u573a\u666f\u652f\u6301\u548c\u7ebf\u7a0b\u5b89\u5168\u4e0a\u90fd\u6709\u76f8\u5e94\u7684\u6539\u8fdb\u7b56\u7565\uff0c\u4f7f\u7528Reference\u5f15\u7528\u547d\u4ee4\uff0c\u63d0\u5347\u9ad8\u5e76\u53d1\u4e0b\u7684\u6570\u636e\u2026\u2026\u8bbf\u95ee\u901f\u5ea6\u5e76\u4fdd\u6301\u4e86GC\u7684\u53ef\u56de\u6536\uff0c\u6709\u6548\u8282\u7701\u7a7a\u95f4\uff1b\u540c\u65f6\uff0cwrite\u94fe\u548caccess\u94fe\u7684\u8bbe\u8ba1\uff0c\u80fd\u66f4\u7075\u6d3b\u3001\u9ad8\u6548\u7684\u5b9e\u73b0\u591a\u79cd\u7c7b\u578b\u7684\u7f13\u5b58\u6e05\u7406\u7b56\u7565\uff0c\u5305\u62ec\u57fa\u4e8e\u5bb9\u91cf\u7684\u6e05\u7406\u3001\u57fa\u4e8e\u65f6\u95f4\u7684\u6e05\u7406\u3001\u57fa\u4e8e\u5f15\u7528\u7684\u6e05\u7406\u7b49\uff1b\u7f16\u7a0b\u5f0f\u7684build\u751f\u6210\u5668\u7ba1\u7406\uff0c\u8ba9\u4f7f\u7528\u8005\u6709\u66f4\u591a\u7684\u81ea\u7531\u5ea6\uff0c\u80fd\u591f\u6839\u636e\u4e0d\u540c\u573a\u666f\u8bbe\u7f6e\u5408\u9002\u7684\u6a21\u5f0f\u3002</p>"},{"location":"2019-03-18-%E7%BC%93%E5%AD%98%E9%82%A3%E4%BA%9B%E4%BA%8B/#_4","title":"\u5206\u5e03\u5f0f\u7f13\u5b58","text":""},{"location":"2019-03-18-%E7%BC%93%E5%AD%98%E9%82%A3%E4%BA%9B%E4%BA%8B/#memcached","title":"memcached\u7f13\u5b58","text":"<p>memcached\u662f\u5e94\u7528\u8f83\u5e7f\u7684\u5f00\u6e90\u5206\u5e03\u5f0f\u7f13\u5b58\u4ea7\u54c1\u4e4b\u4e00\uff0c\u5b83\u672c\u8eab\u5176\u5b9e\u4e0d\u63d0\u4f9b\u5206\u5e03\u5f0f\u89e3\u51b3\u65b9\u6848\u3002\u5728\u670d\u52a1\u7aef\uff0cmemcached\u96c6\u7fa4\u73af\u5883\u5b9e\u9645\u5c31\u662f\u4e00\u4e2a\u4e2amemcached\u670d\u52a1\u5668\u7684\u5806\u79ef\uff0c\u73af\u5883\u642d\u5efa\u8f83\u4e3a\u7b80\u5355\uff1bcache\u7684\u5206\u5e03\u5f0f\u4e3b\u8981\u662f\u5728\u5ba2\u6237\u7aef\u5b9e\u73b0\uff0c\u901a\u8fc7\u5ba2\u6237\u7aef\u7684\u8def\u7531\u5904\u7406\u6765\u8fbe\u5230\u5206\u5e03\u5f0f\u89e3\u51b3\u65b9\u6848\u7684\u76ee\u7684\u3002\u5ba2\u6237\u7aef\u505a\u8def\u7531\u7684\u539f\u7406\u975e\u5e38\u7b80\u5355\uff0c\u5e94\u7528\u670d\u52a1\u5668\u5728\u6bcf\u6b21\u5b58\u53d6\u67d0key\u7684value\u65f6\uff0c\u901a\u8fc7\u67d0\u79cd\u7b97\u6cd5\u628akey\u6620\u5c04\u5230\u67d0\u53f0memcached\u670d\u52a1\u5668nodeA\u4e0a\uff0c\u56e0\u6b64\u8fd9\u4e2akey\u6240\u6709\u64cd\u4f5c\u90fd\u5728nodeA\u4e0a\uff0c\u7ed3\u6784\u56fe\u5982\u56fe6\u3001\u56fe7\u6240\u793a\u3002</p> <p></p> <p></p> <p>memcached\u5ba2\u6237\u7aef\u91c7\u7528\u4e00\u81f4\u6027hash\u7b97\u6cd5\u4f5c\u4e3a\u8def\u7531\u7b56\u7565\uff0c\u5982\u56fe7\uff0c\u76f8\u5bf9\u4e8e\u4e00\u822chash\uff08\u5982\u7b80\u5355\u53d6\u6a21\uff09\u7684\u7b97\u6cd5\uff0c\u4e00\u81f4\u6027hash\u7b97\u6cd5\u9664\u4e86\u8ba1\u7b97key\u7684hash\u503c\u5916\uff0c\u8fd8\u4f1a\u8ba1\u7b97\u6bcf\u4e2aserver\u5bf9\u5e94\u7684hash\u503c\uff0c\u7136\u540e\u5c06\u8fd9\u4e9bhash\u503c\u6620\u5c04\u5230\u4e00\u4e2a\u6709\u9650\u7684\u503c\u57df\u4e0a\uff08\u6bd4\u59820~2^32\uff09\u3002\u901a\u8fc7\u5bfb\u627ehash\u503c\u5927\u4e8ehash(key)\u7684\u6700\u5c0fserver\u4f5c\u4e3a\u5b58\u50a8\u8be5key\u6570\u636e\u7684\u76ee\u6807server\u3002\u5982\u679c\u627e\u4e0d\u5230\uff0c\u5219\u76f4\u63a5\u628a\u5177\u6709\u6700\u5c0fhash\u503c\u7684server\u4f5c\u4e3a\u76ee\u6807server\u3002\u540c\u65f6\uff0c\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\uff0c\u89e3\u51b3\u4e86\u6269\u5bb9\u95ee\u9898\uff0c\u589e\u52a0\u6216\u5220\u9664\u5355\u4e2a\u8282\u70b9\uff0c\u5bf9\u4e8e\u6574\u4e2a\u96c6\u7fa4\u6765\u8bf4\uff0c\u4e0d\u4f1a\u6709\u5927\u7684\u5f71\u54cd\u3002\u6700\u8fd1\u7248\u672c\uff0c\u589e\u52a0\u4e86\u865a\u62df\u8282\u70b9\u7684\u8bbe\u8ba1\uff0c\u8fdb\u4e00\u6b65\u63d0\u5347\u4e86\u53ef\u7528\u6027\u3002</p> <p>memcached\u662f\u4e00\u4e2a\u9ad8\u6548\u7684\u5206\u5e03\u5f0f\u5185\u5b58cache\uff0c\u4e86\u89e3memcached\u7684\u5185\u5b58\u7ba1\u7406\u673a\u5236\uff0c\u624d\u80fd\u66f4\u597d\u7684\u638c\u63e1memcached\uff0c\u8ba9\u6211\u4eec\u53ef\u4ee5\u9488\u5bf9\u6211\u4eec\u6570\u636e\u7279\u70b9\u8fdb\u884c\u8c03\u4f18\uff0c\u8ba9\u5176\u66f4\u597d\u7684\u4e3a\u6211\u6240\u7528\u3002\u6211\u4eec\u77e5\u9053memcached\u4ec5\u652f\u6301\u57fa\u7840\u7684key-value\u952e\u503c\u5bf9\u7c7b\u578b\u6570\u636e\u5b58\u50a8\u3002\u5728memcached\u5185\u5b58\u7ed3\u6784\u4e2d\u6709\u4e24\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u6982\u5ff5\uff1aslab\u548cchunk\u3002\u5982\u56fe8\u6240\u793a\u3002</p> <p></p> <p>slab\u662f\u4e00\u4e2a\u5185\u5b58\u5757\uff0c\u5b83\u662fmemcached\u4e00\u6b21\u7533\u8bf7\u5185\u5b58\u7684\u6700\u5c0f\u5355\u4f4d\u3002\u5728\u542f\u52a8memcached\u7684\u65f6\u5019\u4e00\u822c\u4f1a\u4f7f\u7528\u53c2\u6570-m\u6307\u5b9a\u5176\u53ef\u7528\u5185\u5b58\uff0c\u4f46\u662f\u5e76\u4e0d\u662f\u5728\u542f\u52a8\u7684\u90a3\u4e00\u523b\u6240\u6709\u7684\u5185\u5b58\u5c31\u5168\u90e8\u5206\u914d\u51fa\u53bb\u4e86\uff0c\u53ea\u6709\u5728\u9700\u8981\u7684\u65f6\u5019\u624d\u4f1a\u53bb\u7533\u8bf7\uff0c\u800c\u4e14\u6bcf\u6b21\u7533\u8bf7\u4e00\u5b9a\u662f\u4e00\u4e2aslab\u3002Slab\u7684\u5927\u5c0f\u56fa\u5b9a\u4e3a1M\uff081048576 Byte\uff09\uff0c\u4e00\u4e2aslab\u7531\u82e5\u5e72\u4e2a\u5927\u5c0f\u76f8\u7b49\u7684chunk\u7ec4\u6210\u3002\u6bcf\u4e2achunk\u4e2d\u90fd\u4fdd\u5b58\u4e86\u4e00\u4e2aitem\u7ed3\u6784\u4f53\u3001\u4e00\u5bf9key\u548cvalue\u3002</p> <p>\u867d\u7136\u5728\u540c\u4e00\u4e2aslab\u4e2dchunk\u7684\u5927\u5c0f\u76f8\u7b49\u7684\uff0c\u4f46\u662f\u5728\u4e0d\u540c\u7684slab\u4e2dchunk\u7684\u5927\u5c0f\u5e76\u4e0d\u4e00\u5b9a\u76f8\u7b49\uff0c\u5728memcached\u4e2d\u6309\u7167chunk\u7684\u5927\u5c0f\u4e0d\u540c\uff0c\u53ef\u4ee5\u628aslab\u5206\u4e3a\u5f88\u591a\u79cd\u7c7b\uff08class\uff09\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0bmemcached\u628aslab\u5206\u4e3a40\u7c7b\uff08class1\uff5eclass40\uff09\uff0c\u5728class 1\u4e2d\uff0cchunk\u7684\u5927\u5c0f\u4e3a80\u5b57\u8282\uff0c\u7531\u4e8e\u4e00\u4e2aslab\u7684\u5927\u5c0f\u662f\u56fa\u5b9a\u76841048576\u5b57\u8282\uff081M\uff09\uff0c\u56e0\u6b64\u5728class1\u4e2d\u6700\u591a\u53ef\u4ee5\u670913107\u4e2achunk\uff08\u4e5f\u5c31\u662f\u8fd9\u4e2aslab\u80fd\u5b58\u6700\u591a13107\u4e2a\u5c0f\u4e8e80\u5b57\u8282\u7684key-value\u6570\u636e\uff09\u3002</p> <p>memcached\u5185\u5b58\u7ba1\u7406\u91c7\u53d6\u9884\u5206\u914d\u3001\u5206\u7ec4\u7ba1\u7406\u7684\u65b9\u5f0f\uff0c\u5206\u7ec4\u7ba1\u7406\u5c31\u662f\u6211\u4eec\u4e0a\u9762\u63d0\u5230\u7684<code>slab class</code>\uff0c\u6309\u7167chunk\u7684\u5927\u5c0fslab\u88ab\u5206\u4e3a\u5f88\u591a\u79cd\u7c7b\u3002\u5185\u5b58\u9884\u5206\u914d\u8fc7\u7a0b\u662f\u600e\u6837\u7684\u5462\uff1f\u5411memcached\u6dfb\u52a0\u4e00\u4e2aitem\u65f6\u5019\uff0cmemcached\u9996\u5148\u4f1a\u6839\u636eitem\u7684\u5927\u5c0f\uff0c\u6765\u9009\u62e9\u6700\u5408\u9002\u7684slab class\uff1a\u4f8b\u5982item\u7684\u5927\u5c0f\u4e3a190\u5b57\u8282\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0bclass 4\u7684chunk\u5927\u5c0f\u4e3a160\u5b57\u8282\u663e\u7136\u4e0d\u5408\u9002\uff0cclass 5\u7684chunk\u5927\u5c0f\u4e3a200\u5b57\u8282\uff0c\u5927\u4e8e190\u5b57\u8282\uff0c\u56e0\u6b64\u8be5item\u5c06\u653e\u5728class 5\u4e2d\uff08\u663e\u7136\u8fd9\u91cc\u4f1a\u670910\u5b57\u8282\u7684\u6d6a\u8d39\u662f\u4e0d\u53ef\u907f\u514d\u7684\uff09\uff0c\u8ba1\u7b97\u597d\u6240\u8981\u653e\u5165\u7684chunk\u4e4b\u540e\uff0cmemcached\u4f1a\u53bb\u68c0\u67e5\u8be5\u7c7b\u5927\u5c0f\u7684chunk\u8fd8\u6709\u6ca1\u6709\u7a7a\u95f2\u7684\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5c06\u4f1a\u7533\u8bf71M\uff081\u4e2aslab\uff09\u7684\u7a7a\u95f4\u5e76\u5212\u5206\u4e3a\u8be5\u79cd\u7c7bchunk\u3002\u4f8b\u5982\u6211\u4eec\u7b2c\u4e00\u6b21\u5411memcached\u4e2d\u653e\u5165\u4e00\u4e2a190\u5b57\u8282\u7684item\u65f6\uff0cmemcached\u4f1a\u4ea7\u751f\u4e00\u4e2aslab class 2\uff08\u4e5f\u53eb\u4e00\u4e2apage\uff09\uff0c\u5e76\u4f1a\u7528\u53bb\u4e00\u4e2achunk\uff0c\u5269\u4f595241\u4e2achunk\u4f9b\u4e0b\u6b21\u6709\u9002\u5408\u5927\u5c0fitem\u65f6\u4f7f\u7528\uff0c\u5f53\u6211\u4eec\u7528\u5b8c\u8fd9\u6240\u6709\u76845242\u4e2achunk\u4e4b\u540e\uff0c\u4e0b\u6b21\u518d\u6709\u4e00\u4e2a\u5728160\uff5e200\u5b57\u8282\u4e4b\u95f4\u7684item\u6dfb\u52a0\u8fdb\u6765\u65f6\uff0cmemcached\u4f1a\u518d\u6b21\u4ea7\u751f\u4e00\u4e2aclass 5\u7684slab\uff08\u8fd9\u6837\u5c31\u5b58\u5728\u4e862\u4e2apages\uff09\u3002</p> <p>\u603b\u7ed3\u6765\u770b\uff0cmemcached\u5185\u5b58\u7ba1\u7406\u9700\u8981\u6ce8\u610f\u7684\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>chunk\u662f\u5728page\u91cc\u9762\u5212\u5206\u7684\uff0c\u800cpage\u56fa\u5b9a\u4e3a1m\uff0c\u6240\u4ee5chunk\u6700\u5927\u4e0d\u80fd\u8d85\u8fc71m\u3002</li> <li>chunk\u5b9e\u9645\u5360\u7528\u5185\u5b58\u8981\u52a048B\uff0c\u56e0\u4e3achunk\u6570\u636e\u7ed3\u6784\u672c\u8eab\u9700\u8981\u5360\u752848B\u3002</li> <li>\u5982\u679c\u7528\u6237\u6570\u636e\u5927\u4e8e1m\uff0c\u5219memcached\u4f1a\u5c06\u5176\u5207\u5272\uff0c\u653e\u5230\u591a\u4e2achunk\u5185\u3002</li> <li>\u5df2\u5206\u914d\u51fa\u53bb\u7684page\u4e0d\u80fd\u56de\u6536\u3002</li> </ul> <p>\u5bf9\u4e8e<code>key-value</code>\u4fe1\u606f\uff0c\u6700\u597d\u4e0d\u8981\u8d85\u8fc71m\u7684\u5927\u5c0f\uff1b\u540c\u65f6\u4fe1\u606f\u957f\u5ea6\u6700\u597d\u76f8\u5bf9\u662f\u6bd4\u8f83\u5747\u8861\u7a33\u5b9a\u7684\uff0c\u8fd9\u6837\u80fd\u591f\u4fdd\u969c\u6700\u5927\u9650\u5ea6\u7684\u4f7f\u7528\u5185\u5b58\uff1b\u540c\u65f6\uff0cmemcached\u91c7\u7528\u7684LRU\u6e05\u7406\u7b56\u7565\uff0c\u5408\u7406\u751a\u81f3\u8fc7\u671f\u65f6\u95f4\uff0c\u63d0\u9ad8\u547d\u4e2d\u7387\u3002</p> <p>\u65e0\u7279\u6b8a\u573a\u666f\u4e0b\uff0ckey-value\u80fd\u6ee1\u8db3\u9700\u6c42\u7684\u524d\u63d0\u4e0b\uff0c\u4f7f\u7528memcached\u5206\u5e03\u5f0f\u96c6\u7fa4\u662f\u8f83\u597d\u7684\u9009\u62e9\uff0c\u642d\u5efa\u4e0e\u64cd\u4f5c\u4f7f\u7528\u90fd\u6bd4\u8f83\u7b80\u5355\uff1b\u5206\u5e03\u5f0f\u96c6\u7fa4\u5728\u5355\u70b9\u6545\u969c\u65f6\uff0c\u53ea\u5f71\u54cd\u5c0f\u90e8\u5206\u6570\u636e\u5f02\u5e38\uff0c\u76ee\u524d\u8fd8\u53ef\u4ee5\u901a\u8fc7Magent\u7f13\u5b58\u4ee3\u7406\u6a21\u5f0f\uff0c\u505a\u5355\u70b9\u5907\u4efd\uff0c\u63d0\u5347\u9ad8\u53ef\u7528\uff1b\u6574\u4e2a\u7f13\u5b58\u90fd\u662f\u57fa\u4e8e\u5185\u5b58\u7684\uff0c\u56e0\u6b64\u54cd\u5e94\u65f6\u95f4\u662f\u5f88\u5feb\uff0c\u4e0d\u9700\u8981\u989d\u5916\u7684\u5e8f\u5217\u5316\u3001\u53cd\u5e8f\u5217\u5316\u7684\u7a0b\u5e8f\uff0c\u4f46\u540c\u65f6\u7531\u4e8e\u57fa\u4e8e\u5185\u5b58\uff0c\u6570\u636e\u6ca1\u6709\u6301\u4e45\u5316\uff0c\u96c6\u7fa4\u6545\u969c\u91cd\u542f\u6570\u636e\u65e0\u6cd5\u6062\u590d\u3002\u9ad8\u7248\u672c\u7684memcached\u5df2\u7ecf\u652f\u6301CAS\u6a21\u5f0f\u7684\u539f\u5b50\u64cd\u4f5c\uff0c\u53ef\u4ee5\u4f4e\u6210\u672c\u7684\u89e3\u51b3\u5e76\u53d1\u63a7\u5236\u95ee\u9898\u3002</p>"},{"location":"2019-03-18-%E7%BC%93%E5%AD%98%E9%82%A3%E4%BA%9B%E4%BA%8B/#redis","title":"Redis\u7f13\u5b58","text":"<p>Redis\u662f\u4e00\u4e2a\u8fdc\u7a0b\u5185\u5b58\u6570\u636e\u5e93\uff08\u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff09\uff0c\u6027\u80fd\u5f3a\u52b2\uff0c\u5177\u6709\u590d\u5236\u7279\u6027\u4ee5\u53ca\u89e3\u51b3\u95ee\u9898\u800c\u751f\u7684\u72ec\u4e00\u65e0\u4e8c\u7684\u6570\u636e\u6a21\u578b\u3002\u5b83\u53ef\u4ee5\u5b58\u50a8\u952e\u503c\u5bf9\u4e0e5\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u503c\u4e4b\u95f4\u7684\u6620\u5c04\uff0c\u53ef\u4ee5\u5c06\u5b58\u50a8\u5728\u5185\u5b58\u7684\u952e\u503c\u5bf9\u6570\u636e\u6301\u4e45\u5316\u5230\u786c\u76d8\uff0c\u53ef\u4ee5\u4f7f\u7528\u590d\u5236\u7279\u6027\u6765\u6269\u5c55\u8bfb\u6027\u80fd\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5ba2\u6237\u7aef\u5206\u7247\u6765\u6269\u5c55\u5199\u6027\u80fd\u3002</p> <p></p> <p>\u5982\u56fe9\uff0cRedis\u5185\u90e8\u4f7f\u7528\u4e00\u4e2a<code>redisObject</code>\u5bf9\u8c61\u6765\u6807\u8bc6\u6240\u6709\u7684<code>key\u548cvalue\u6570\u636e</code>\uff0credisObject\u6700\u4e3b\u8981\u7684\u4fe1\u606f\u5982\u56fe\u6240\u793a\uff1a<code>type</code>\u4ee3\u8868\u4e00\u4e2avalue\u5bf9\u8c61\u5177\u4f53\u662f\u4f55\u79cd\u6570\u636e\u7c7b\u578b\uff0c<code>encoding</code>\u662f\u4e0d\u540c\u6570\u636e\u7c7b\u578b\u5728Redis\u5185\u90e8\u7684\u5b58\u50a8\u65b9\u5f0f\uff0c\u6bd4\u5982\u2014\u2014type=string\u4ee3\u8868value\u5b58\u50a8\u7684\u662f\u4e00\u4e2a\u666e\u901a\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u5bf9\u5e94\u7684encoding\u53ef\u4ee5\u662fraw\u6216\u662fint\uff0c\u5982\u679c\u662fint\u5219\u4ee3\u8868\u4e16\u754cRedis\u5185\u90e8\u662f\u6309\u6570\u503c\u7c7b\u578b\u5b58\u50a8\u548c\u8868\u793a\u8fd9\u4e2a\u5b57\u7b26\u4e32\u3002</p> <p>\u56fe9\u5de6\u8fb9\u7684raw\u5217\u4e3a\u5bf9\u8c61\u7684\u7f16\u7801\u65b9\u5f0f\uff1a\u5b57\u7b26\u4e32\u53ef\u4ee5\u88ab\u7f16\u7801\u4e3araw\uff08\u4e00\u822c\u5b57\u7b26\u4e32\uff09\u6216Rint\uff08\u4e3a\u4e86\u8282\u7ea6\u5185\u5b58\uff0cRedis\u4f1a\u5c06\u5b57\u7b26\u4e32\u8868\u793a\u768464\u4f4d\u6709\u7b26\u53f7\u6574\u6570\u7f16\u7801\u4e3a\u6574\u6570\u6765\u8fdb\u884c\u50a8\u5b58\uff09\uff1b\u5217\u8868\u53ef\u4ee5\u88ab\u7f16\u7801\u4e3aziplist\u6216linkedlist\uff0cziplist\u662f\u4e3a\u8282\u7ea6\u5927\u5c0f\u8f83\u5c0f\u7684\u5217\u8868\u7a7a\u95f4\u800c\u4f5c\u7684\u7279\u6b8a\u8868\u793a\uff1b\u96c6\u5408\u53ef\u4ee5\u88ab\u7f16\u7801\u4e3aintset\u6216\u8005hashtable\uff0cintset\u662f\u53ea\u50a8\u5b58\u6570\u5b57\u7684\u5c0f\u96c6\u5408\u7684\u7279\u6b8a\u8868\u793a\uff1bhash\u8868\u53ef\u4ee5\u7f16\u7801\u4e3azipmap\u6216\u8005hashtable\uff0czipmap\u662f\u5c0fhash\u8868\u7684\u7279\u6b8a\u8868\u793a\uff1b\u6709\u5e8f\u96c6\u5408\u53ef\u4ee5\u88ab\u7f16\u7801\u4e3aziplist\u6216\u8005skiplist\u683c\u5f0f\uff0cziplist\u7528\u4e8e\u8868\u793a\u5c0f\u7684\u6709\u5e8f\u96c6\u5408\uff0c\u800cskiplist\u5219\u7528\u4e8e\u8868\u793a\u4efb\u4f55\u5927\u5c0f\u7684\u6709\u5e8f\u96c6\u5408\u3002</p> <p>\u4ece<code>\u7f51\u7edcI/O\u6a21\u578b</code>\u4e0a\u770b\uff0cRedis\u4f7f\u7528\u5355\u7ebf\u7a0b\u7684I/O\u590d\u7528\u6a21\u578b\uff0c\u81ea\u5df1\u5c01\u88c5\u4e86\u4e00\u4e2a\u7b80\u5355\u7684AeEvent\u4e8b\u4ef6\u5904\u7406\u6846\u67b6\uff0c\u4e3b\u8981\u5b9e\u73b0\u4e86epoll\u3001kqueue\u548cselect\u3002\u5bf9\u4e8e\u5355\u7eaf\u53ea\u6709I/O\u64cd\u4f5c\u6765\u8bf4\uff0c\u5355\u7ebf\u7a0b\u53ef\u4ee5\u5c06\u901f\u5ea6\u4f18\u52bf\u53d1\u6325\u5230\u6700\u5927\uff0c\u4f46\u662fRedis\u4e5f\u63d0\u4f9b\u4e86\u4e00\u4e9b\u7b80\u5355\u7684\u8ba1\u7b97\u529f\u80fd\uff0c\u6bd4\u5982\u6392\u5e8f\u3001\u805a\u5408\u7b49\uff0c\u5bf9\u4e8e\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u5355\u7ebf\u7a0b\u6a21\u578b\u5b9e\u9645\u4f1a\u4e25\u91cd\u5f71\u54cd\u6574\u4f53\u541e\u5410\u91cf\uff0cCPU\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\uff0c\u6574\u4e2aI/O\u8c03\u5ea6\u90fd\u662f\u88ab\u963b\u585e\u4f4f\u7684\uff0c\u5728\u8fd9\u4e9b\u7279\u6b8a\u573a\u666f\u7684\u4f7f\u7528\u4e2d\uff0c\u9700\u8981\u989d\u5916\u7684\u8003\u8651\u3002\u76f8\u8f83\u4e8ememcached\u7684\u9884\u5206\u914d\u5185\u5b58\u7ba1\u7406\uff0cRedis\u4f7f\u7528\u73b0\u573a\u7533\u8bf7\u5185\u5b58\u7684\u65b9\u5f0f\u6765\u5b58\u50a8\u6570\u636e\uff0c\u5e76\u4e14\u5f88\u5c11\u4f7f\u7528free-list\u7b49\u65b9\u5f0f\u6765\u4f18\u5316\u5185\u5b58\u5206\u914d\uff0c\u4f1a\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5b58\u5728\u5185\u5b58\u788e\u7247\u3002Redis\u8ddf\u636e\u5b58\u50a8\u547d\u4ee4\u53c2\u6570\uff0c\u4f1a\u628a\u5e26\u8fc7\u671f\u65f6\u95f4\u7684\u6570\u636e\u5355\u72ec\u5b58\u653e\u5728\u4e00\u8d77\uff0c\u5e76\u628a\u5b83\u4eec\u79f0\u4e3a\u4e34\u65f6\u6570\u636e\uff0c\u975e\u4e34\u65f6\u6570\u636e\u662f\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u5254\u9664\u7684\uff0c\u5373\u4fbf\u7269\u7406\u5185\u5b58\u4e0d\u591f\uff0c\u5bfc\u81f4swap\u4e5f\u4e0d\u4f1a\u5254\u9664\u4efb\u4f55\u975e\u4e34\u65f6\u6570\u636e\uff08\u4f46\u4f1a\u5c1d\u8bd5\u5254\u9664\u90e8\u5206\u4e34\u65f6\u6570\u636e\uff09\u3002</p> <p>\u6211\u4eec\u63cf\u8ff0Redis\u4e3a\u5185\u5b58\u6570\u636e\u5e93\uff0c\u4f5c\u4e3a\u7f13\u5b58\u670d\u52a1\uff0c\u5927\u91cf\u4f7f\u7528\u5185\u5b58\u95f4\u7684\u6570\u636e\u5feb\u901f\u8bfb\u5199\uff0c\u652f\u6301\u9ad8\u5e76\u53d1\u5927\u541e\u5410\uff1b\u800c\u4f5c\u4e3a\u6570\u636e\u5e93\uff0c\u5219\u662f\u6307Redis\u5bf9\u7f13\u5b58\u7684\u6301\u4e45\u5316\u652f\u6301\u3002Redis\u7531\u4e8e\u652f\u6301\u4e86\u975e\u5e38\u4e30\u5bcc\u7684\u5185\u5b58\u6570\u636e\u5e93\u7ed3\u6784\u7c7b\u578b\uff0c\u5982\u4f55\u628a\u8fd9\u4e9b\u590d\u6742\u7684\u5185\u5b58\u7ec4\u7ec7\u65b9\u5f0f\u6301\u4e45\u5316\u5230\u78c1\u76d8\u4e0a\uff1fRedis\u7684\u6301\u4e45\u5316\u4e0e\u4f20\u7edf\u6570\u636e\u5e93\u7684\u65b9\u5f0f\u5dee\u5f02\u8f83\u5927\uff0cRedis\u4e00\u5171\u652f\u6301\u56db\u79cd\u6301\u4e45\u5316\u65b9\u5f0f\uff0c\u4e3b\u8981\u4f7f\u7528\u7684\u4e24\u79cd\uff1a</p> <ol> <li>\u5b9a\u65f6\u5feb\u7167\u65b9\u5f0f(snapshot)\uff1a\u8be5\u6301\u4e45\u5316\u65b9\u5f0f\u5b9e\u9645\u662f\u5728Redis\u5185\u90e8\u4e00\u4e2a\u5b9a\u65f6\u5668\u4e8b\u4ef6\uff0c\u6bcf\u9694\u56fa\u5b9a\u65f6\u95f4\u53bb\u68c0\u67e5\u5f53\u524d\u6570\u636e\u53d1\u751f\u7684\u6539\u53d8\u6b21\u6570\u4e0e\u65f6\u95f4\u662f\u5426\u6ee1\u8db3\u914d\u7f6e\u7684\u6301\u4e45\u5316\u89e6\u53d1\u7684\u6761\u4ef6\uff0c\u5982\u679c\u6ee1\u8db3\u5219\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edffork\u8c03\u7528\u6765\u521b\u5efa\u51fa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u8fd9\u4e2a\u5b50\u8fdb\u7a0b\u9ed8\u8ba4\u4f1a\u4e0e\u7236\u8fdb\u7a0b\u5171\u4eab\u76f8\u540c\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u8fd9\u65f6\u5c31\u53ef\u4ee5\u901a\u8fc7\u5b50\u8fdb\u7a0b\u6765\u904d\u5386\u6574\u4e2a\u5185\u5b58\u6765\u8fdb\u884c\u5b58\u50a8\u64cd\u4f5c\uff0c\u800c\u4e3b\u8fdb\u7a0b\u5219\u4ecd\u7136\u53ef\u4ee5\u63d0\u4f9b\u670d\u52a1\uff0c\u5f53\u6709\u5199\u5165\u65f6\u7531\u64cd\u4f5c\u7cfb\u7edf\u6309\u7167\u5185\u5b58\u9875\uff08page\uff09\u4e3a\u5355\u4f4d\u6765\u8fdb\u884ccopy-on-write\u4fdd\u8bc1\u7236\u5b50\u8fdb\u7a0b\u4e4b\u95f4\u4e0d\u4f1a\u4e92\u76f8\u5f71\u54cd\u3002\u5b83\u7684\u7f3a\u70b9\u662f\u5feb\u7167\u53ea\u662f\u4ee3\u8868\u4e00\u6bb5\u65f6\u95f4\u5185\u7684\u5185\u5b58\u6620\u50cf\uff0c\u6240\u4ee5\u7cfb\u7edf\u91cd\u542f\u4f1a\u4e22\u5931\u4e0a\u6b21\u5feb\u7167\u4e0e\u91cd\u542f\u4e4b\u95f4\u6240\u6709\u7684\u6570\u636e\u3002</li> <li>\u57fa\u4e8e\u8bed\u53e5\u8ffd\u52a0\u6587\u4ef6\u7684\u65b9\u5f0f(aof)\uff1aaof\u65b9\u5f0f\u5b9e\u9645\u7c7b\u4f3cMySQl\u7684\u57fa\u4e8e\u8bed\u53e5\u7684binlog\u65b9\u5f0f\uff0c\u5373\u6bcf\u6761\u4f1a\u4f7fRedis\u5185\u5b58\u6570\u636e\u53d1\u751f\u6539\u53d8\u7684\u547d\u4ee4\u90fd\u4f1a\u8ffd\u52a0\u5230\u4e00\u4e2alog\u6587\u4ef6\u4e2d\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e2alog\u6587\u4ef6\u5c31\u662fRedis\u7684\u6301\u4e45\u5316\u6570\u636e\u3002</li> </ol> <p>aof\u7684\u65b9\u5f0f\u7684\u4e3b\u8981\u7f3a\u70b9\u662f\u8ffd\u52a0log\u6587\u4ef6\u53ef\u80fd\u5bfc\u81f4\u4f53\u79ef\u8fc7\u5927\uff0c\u5f53\u7cfb\u7edf\u91cd\u542f\u6062\u590d\u6570\u636e\u65f6\u5982\u679c\u662faof\u7684\u65b9\u5f0f\u5219\u52a0\u8f7d\u6570\u636e\u4f1a\u975e\u5e38\u6162\uff0c\u51e0\u5341G\u7684\u6570\u636e\u53ef\u80fd\u9700\u8981\u51e0\u5c0f\u65f6\u624d\u80fd\u52a0\u8f7d\u5b8c\uff0c\u5f53\u7136\u8fd9\u4e2a\u8017\u65f6\u5e76\u4e0d\u662f\u56e0\u4e3a\u78c1\u76d8\u6587\u4ef6\u8bfb\u53d6\u901f\u5ea6\u6162\uff0c\u800c\u662f\u7531\u4e8e\u8bfb\u53d6\u7684\u6240\u6709\u547d\u4ee4\u90fd\u8981\u5728\u5185\u5b58\u4e2d\u6267\u884c\u4e00\u904d\u3002\u53e6\u5916\u7531\u4e8e\u6bcf\u6761\u547d\u4ee4\u90fd\u8981\u5199log\uff0c\u6240\u4ee5\u4f7f\u7528aof\u7684\u65b9\u5f0f\uff0cRedis\u7684\u8bfb\u5199\u6027\u80fd\u4e5f\u4f1a\u6709\u6240\u4e0b\u964d\u3002</p> <p>Redis\u7684\u6301\u4e45\u5316\u4f7f\u7528\u4e86<code>Buffer I/O</code>\uff0c\u6240\u8c13Buffer I/O\u662f\u6307Redis\u5bf9\u6301\u4e45\u5316\u6587\u4ef6\u7684\u5199\u5165\u548c\u8bfb\u53d6\u64cd\u4f5c\u90fd\u4f1a\u4f7f\u7528<code>\u7269\u7406\u5185\u5b58\u7684Page Cache</code>\uff0c\u800c\u5927\u591a\u6570\u6570\u636e\u5e93\u7cfb\u7edf\u4f1a\u4f7f\u7528<code>Direct I/O</code>\u6765\u7ed5\u8fc7\u8fd9\u5c42Page Cache\u5e76\u81ea\u884c\u7ef4\u62a4\u4e00\u4e2a\u6570\u636e\u7684Cache\u3002\u800c\u5f53Redis\u7684\u6301\u4e45\u5316\u6587\u4ef6\u8fc7\u5927\uff08\u5c24\u5176\u662f\u5feb\u7167\u6587\u4ef6\uff09\uff0c\u5e76\u5bf9\u5176\u8fdb\u884c\u8bfb\u5199\u65f6\uff0c\u78c1\u76d8\u6587\u4ef6\u4e2d\u7684\u6570\u636e\u90fd\u4f1a\u88ab\u52a0\u8f7d\u5230\u7269\u7406\u5185\u5b58\u4e2d\u4f5c\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8be5\u6587\u4ef6\u7684\u4e00\u5c42Cache\uff0c\u800c\u8fd9\u5c42Cache\u7684\u6570\u636e\u4e0eRedis\u5185\u5b58\u4e2d\u7ba1\u7406\u7684\u6570\u636e\u5b9e\u9645\u662f\u91cd\u590d\u5b58\u50a8\u7684\u3002\u867d\u7136\u5185\u6838\u5728\u7269\u7406\u5185\u5b58\u7d27\u5f20\u65f6\u4f1a\u505aPage Cache\u7684\u5254\u9664\u5de5\u4f5c\uff0c\u4f46\u5185\u6838\u5f88\u53ef\u80fd\u8ba4\u4e3a\u67d0\u5757Page Cache\u66f4\u91cd\u8981\uff0c\u800c\u8ba9\u4f60\u7684\u8fdb\u7a0b\u5f00\u59cbSwap\uff0c\u8fd9\u65f6\u4f60\u7684\u7cfb\u7edf\u5c31\u4f1a\u5f00\u59cb\u51fa\u73b0<code>\u4e0d\u7a33\u5b9a</code>\u6216\u8005<code>\u5d29\u6e83</code>\u4e86\uff0c\u56e0\u6b64\u5728\u6301\u4e45\u5316\u914d\u7f6e\u540e\uff0c\u9488\u5bf9\u5185\u5b58\u4f7f\u7528\u9700\u8981<code>\u5b9e\u65f6\u76d1\u63a7\u89c2\u5bdf</code>\u3002</p> <p>\u4e0ememcached\u5ba2\u6237\u7aef\u652f\u6301\u5206\u5e03\u5f0f\u65b9\u6848\u4e0d\u540c\uff0cRedis\u66f4\u503e\u5411\u4e8e\u5728\u670d\u52a1\u7aef\u6784\u5efa\u5206\u5e03\u5f0f\u5b58\u50a8\uff0c\u5982\u56fe10\u300111\u3002</p> <p></p> <p></p> <p>Redis Cluster\u662f\u4e00\u4e2a\u5b9e\u73b0\u4e86\u5206\u5e03\u5f0f\u4e14\u5141\u8bb8\u5355\u70b9\u6545\u969c\u7684Redis\u9ad8\u7ea7\u7248\u672c\uff0c\u5b83\u6ca1\u6709\u4e2d\u5fc3\u8282\u70b9\uff0c\u5177\u6709\u7ebf\u6027\u53ef\u4f38\u7f29\u7684\u529f\u80fd\u3002\u5982\u56fe11\uff0c\u5176\u4e2d\u8282\u70b9\u4e0e\u8282\u70b9\u4e4b\u95f4\u901a\u8fc7\u4e8c\u8fdb\u5236\u534f\u8bae\u8fdb\u884c\u901a\u4fe1\uff0c\u8282\u70b9\u4e0e\u5ba2\u6237\u7aef\u4e4b\u95f4\u901a\u8fc7ascii\u534f\u8bae\u8fdb\u884c\u901a\u4fe1\u3002\u5728\u6570\u636e\u7684\u653e\u7f6e\u7b56\u7565\u4e0a\uff0cRedis Cluster\u5c06\u6574\u4e2akey\u7684\u6570\u503c\u57df\u5206\u62104096\u4e2ahash\u69fd\uff0c\u6bcf\u4e2a\u8282\u70b9\u4e0a\u53ef\u4ee5\u5b58\u50a8\u4e00\u4e2a\u6216\u591a\u4e2ahash\u69fd\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53\u524dRedis Cluster\u652f\u6301\u7684\u6700\u5927\u8282\u70b9\u6570\u5c31\u662f4096\u3002Redis Cluster\u4f7f\u7528\u7684\u5206\u5e03\u5f0f\u7b97\u6cd5\u4e5f\u5f88\u7b80\u5355\uff1a<code>crc16( key ) % HASH_SLOTS_NUMBER</code>\u3002\u6574\u4f53\u8bbe\u8ba1\u53ef\u603b\u7ed3\u4e3a\uff1a</p> <ul> <li>\u6570\u636ehash\u5206\u5e03\u5728<code>\u4e0d\u540c\u7684Redis\u8282\u70b9\u5b9e\u4f8b</code>\u4e0a\uff1b</li> <li>M/S\u7684\u5207\u6362\u91c7\u7528Sentinel\uff1b</li> <li>\u5199\uff1a\u53ea\u4f1a\u5199<code>master Instance</code>\uff0c\u4ecesentinel\u83b7\u53d6\u5f53\u524d\u7684master Instance\uff1b</li> <li>\u8bfb\uff1a\u4eceRedis Node\u4e2d<code>\u57fa\u4e8e\u6743\u91cd</code>\u9009\u53d6\u4e00\u4e2aInstance\u8bfb\u53d6\uff0c\u5931\u8d25/\u8d85\u65f6\u5219\u8f6e\u8be2\u5176\u4ed6Instance\uff1bRedis\u672c\u8eab\u5c31\u5f88\u597d\u7684\u652f\u6301\u8bfb\u5199- \u5206\u79bb\uff0c\u5728\u5355\u8fdb\u7a0b\u7684I/O\u573a\u666f\u4e0b\uff0c\u53ef\u4ee5\u6709\u6548\u7684\u907f\u514d\u4e3b\u5e93\u7684\u963b\u585e\u98ce\u9669\uff1b</li> <li>\u901a\u8fc7RPC\u670d\u52a1\u8bbf\u95ee\uff0cRPC server\u7aef\u5c01\u88c5\u4e86Redis\u5ba2\u6237\u7aef\uff0c\u5ba2\u6237\u7aef\u57fa\u4e8eJedis\u5f00\u53d1\u3002</li> </ul> <p>\u4ee5\u770b\u5230\uff0c\u901a\u8fc7<code>\u96c6\u7fa4+\u4e3b\u4ece\u7ed3\u5408</code>\u7684\u8bbe\u8ba1\uff0cRedis\u5728<code>\u6269\u5c55\u548c\u7a33\u5b9a\u9ad8\u53ef\u7528\u6027\u80fd</code>\u65b9\u9762\u90fd\u662f\u6bd4\u8f83\u6210\u719f\u7684\u3002\u4f46\u662f\uff0c\u5728<code>\u6570\u636e\u4e00\u81f4\u6027</code>\u95ee\u9898\u4e0a\uff0cRedis\u6ca1\u6709\u63d0\u4f9bCAS\u64cd\u4f5c\u547d\u4ee4\u6765\u4fdd\u969c\u9ad8\u5e76\u53d1\u573a\u666f\u4e0b\u7684\u6570\u636e\u4e00\u81f4\u6027\u95ee\u9898\uff0c\u4e0d\u8fc7\u5b83\u5374\u63d0\u4f9b\u4e86\u4e8b\u52a1\u7684\u529f\u80fd\uff0cRedis\u7684Transactions\u63d0\u4f9b\u7684<code>\u5e76\u4e0d\u662f</code>\u4e25\u683c\u7684<code>ACID</code>\u7684\u4e8b\u52a1\uff08\u6bd4\u5982\u4e00\u4e32\u7528<code>EXEC</code>\u63d0\u4ea4\u6267\u884c\u7684\u547d\u4ee4\uff0c\u5728\u6267\u884c\u4e2d\u670d\u52a1\u5668\u5b95\u673a\uff0c\u90a3\u4e48\u4f1a\u6709\u4e00\u90e8\u5206\u547d\u4ee4\u6267\u884c\u4e86\uff0c\u5269\u4e0b\u7684\u6ca1\u6267\u884c\uff09\u3002\u4f46\u662f\u8fd9\u4e2aTransactions\u8fd8\u662f\u63d0\u4f9b\u4e86\u57fa\u672c\u7684\u547d\u4ee4\u6253\u5305\u6267\u884c\u7684\u529f\u80fd\uff08\u5728\u670d\u52a1\u5668\u4e0d\u51fa\u95ee\u9898\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u4e00\u8fde\u4e32\u7684\u547d\u4ee4\u662f\u987a\u5e8f\u5728\u4e00\u8d77\u6267\u884c\u7684\uff0c\u4e2d\u95f4\u6709\u4f1a\u6709\u5176\u5b83\u5ba2\u6237\u7aef\u547d\u4ee4\u63d2\u8fdb\u6765\u6267\u884c\uff09\u3002Redis\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2aWatch\u529f\u80fd\uff0c\u4f60\u53ef\u4ee5\u5bf9\u4e00\u4e2akey\u8fdb\u884c<code>Watch</code>\uff0c\u7136\u540e\u518d\u6267\u884cTransactions\uff0c\u5728\u8fd9\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u8fd9\u4e2aWatched\u7684\u503c\u8fdb\u884c\u4e86\u4fee\u6539\uff0c\u90a3\u4e48\u8fd9\u4e2aTransactions\u4f1a<code>\u53d1\u73b0\u5e76\u62d2\u7edd\u6267\u884c</code>\u3002</p> <p>\u5728\u5931\u6548\u7b56\u7565\u4e0a\uff0cRedis\u652f\u6301\u591a\u59276\u79cd\u7684\u6570\u636e\u6dd8\u6c70\u7b56\u7565\uff1a</p> <ol> <li>volatile-lru\uff1a\u4ece\u5df2\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7684\u6570\u636e\u96c6\uff08server.db[i].expires\uff09\u4e2d\u6311\u9009\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u6570\u636e\u6dd8\u6c70\uff1b</li> <li>volatile-ttl\uff1a\u4ece\u5df2\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7684\u6570\u636e\u96c6\uff08server.db[i].expires\uff09\u4e2d\u6311\u9009\u5c06\u8981\u8fc7\u671f\u7684\u6570\u636e\u6dd8\u6c70\uff1b</li> <li>volatile-random\uff1a\u4ece\u5df2\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7684\u6570\u636e\u96c6\uff08server.db[i].expires\uff09\u4e2d\u4efb\u610f\u9009\u62e9\u6570\u636e\u6dd8\u6c70 \uff1b</li> <li>allkeys-lru\uff1a\u4ece\u6570\u636e\u96c6\uff08server.db[i].dict\uff09\u4e2d\u6311\u9009\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u6570\u636e\u6dd8\u6c70\uff1b</li> <li>allkeys-random\uff1a\u4ece\u6570\u636e\u96c6\uff08server.db[i].dict\uff09\u4e2d\u4efb\u610f\u9009\u62e9\u6570\u636e\u6dd8\u6c70\uff1b</li> <li>no-enviction\uff08\u9a71\u9010\uff09\uff1a\u7981\u6b62\u9a71\u9010\u6570\u636e\u3002</li> </ol> <p>\u4e2a\u4eba\u603b\u7ed3\u4e86\u4ee5\u4e0b\u591a\u79cdWeb\u5e94\u7528\u573a\u666f\uff0c\u5728\u8fd9\u4e9b\u573a\u666f\u4e0b\u53ef\u4ee5\u5145\u5206\u7684\u5229\u7528Redis\u7684\u7279\u6027\uff0c\u5927\u5927\u63d0\u9ad8\u6548\u7387\u3002</p> <ul> <li>\u5728\u4e3b\u9875\u4e2d\u663e\u793a\u6700\u65b0\u7684\u9879\u76ee\u5217\u8868\uff1aRedis\u4f7f\u7528\u7684\u662f\u5e38\u9a7b\u5185\u5b58\u7684\u7f13\u5b58\uff0c\u901f\u5ea6\u975e\u5e38\u5feb\u3002LPUSH\u7528\u6765\u63d2\u5165\u4e00\u4e2a\u5185\u5bb9ID\uff0c\u4f5c\u4e3a\u5173\u952e\u5b57\u5b58\u50a8\u5728\u5217\u8868\u5934\u90e8\u3002LTRIM\u7528\u6765\u9650\u5236\u5217\u8868\u4e2d\u7684\u9879\u76ee\u6570\u6700\u591a\u4e3a5000\u3002\u5982\u679c\u7528\u6237\u9700\u8981\u7684\u68c0\u7d22\u7684\u6570\u636e\u91cf\u8d85\u8d8a\u8fd9\u4e2a\u7f13\u5b58\u5bb9\u91cf\uff0c\u8fd9\u65f6\u624d\u9700\u8981\u628a\u8bf7\u6c42\u53d1\u9001\u5230\u6570\u636e\u5e93\u3002</li> <li>\u5220\u9664\u548c\u8fc7\u6ee4\uff1a\u5982\u679c\u4e00\u7bc7\u6587\u7ae0\u88ab\u5220\u9664\uff0c\u53ef\u4ee5\u4f7f\u7528LREM\u4ece\u7f13\u5b58\u4e2d\u5f7b\u5e95\u6e05\u9664\u6389\u3002</li> <li>\u6392\u884c\u699c\u53ca\u76f8\u5173\u95ee\u9898\uff1a\u6392\u884c\u699c\uff08leader board\uff09\u6309\u7167\u5f97\u5206\u8fdb\u884c\u6392\u5e8f\u3002ZADD\u547d\u4ee4\u53ef\u4ee5\u76f4\u63a5\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\uff0c\u800cZREVRANGE\u547d\u4ee4\u53ef\u4ee5\u7528\u6765\u6309\u7167\u5f97\u5206\u6765\u83b7\u53d6\u524d100\u540d\u7684\u7528\u6237\uff0cZRANK\u53ef\u4ee5\u7528\u6765\u83b7\u53d6\u7528\u6237\u6392\u540d\uff0c\u975e\u5e38\u76f4\u63a5\u800c\u4e14\u64cd\u4f5c\u5bb9\u6613\u3002</li> <li>\u6309\u7167\u7528\u6237\u6295\u7968\u548c\u65f6\u95f4\u6392\u5e8f\uff1a\u6392\u884c\u699c\uff0c\u5f97\u5206\u4f1a\u968f\u7740\u65f6\u95f4\u53d8\u5316\u3002LPUSH\u548cLTRIM\u547d\u4ee4\u7ed3\u5408\u8fd0\u7528\uff0c\u628a\u6587\u7ae0\u6dfb\u52a0\u5230\u4e00\u4e2a\u5217\u8868\u4e2d\u3002\u4e00\u9879\u540e\u53f0\u4efb\u52a1\u7528\u6765\u83b7\u53d6\u5217\u8868\uff0c\u5e76\u91cd\u65b0\u8ba1\u7b97\u5217\u8868\u7684\u6392\u5e8f\uff0cZADD\u547d\u4ee4\u7528\u6765\u6309\u7167\u65b0\u7684\u987a\u5e8f\u586b\u5145\u751f\u6210\u5217\u8868\u3002\u5217\u8868\u53ef\u4ee5\u5b9e\u73b0\u975e\u5e38\u5feb\u901f\u7684\u68c0\u7d22\uff0c\u5373\u4f7f\u662f\u8d1f\u8f7d\u5f88\u91cd\u7684\u7ad9\u70b9\u3002</li> <li>\u8fc7\u671f\u9879\u76ee\u5904\u7406\uff1a\u4f7f\u7528Unix\u65f6\u95f4\u4f5c\u4e3a\u5173\u952e\u5b57\uff0c\u7528\u6765\u4fdd\u6301\u5217\u8868\u80fd\u591f\u6309\u65f6\u95f4\u6392\u5e8f\u3002\u5bf9current_time\u548ctime_to_live\u8fdb\u884c\u68c0\u7d22\uff0c\u5b8c\u6210\u67e5\u627e\u8fc7\u671f\u9879\u76ee\u7684\u8270\u5de8\u4efb\u52a1\u3002\u53e6\u4e00\u9879\u540e\u53f0\u4efb\u52a1\u4f7f\u7528ZRANGE\u2026WITHSCORES\u8fdb\u884c\u67e5\u8be2\uff0c\u5220\u9664\u8fc7\u671f\u7684\u6761\u76ee\u3002</li> <li>\u8ba1\u6570\uff1a\u8fdb\u884c\u5404\u79cd\u6570\u636e\u7edf\u8ba1\u7684\u7528\u9014\u662f\u975e\u5e38\u5e7f\u6cdb\u7684\uff0c\u6bd4\u5982\u60f3\u77e5\u9053\u4ec0\u4e48\u65f6\u5019\u5c01\u9501\u4e00\u4e2aIP\u5730\u5740\u3002INCRBY\u547d\u4ee4\u8ba9\u8fd9\u4e9b\u53d8\u5f97\u5f88\u5bb9\u6613\uff0c\u901a\u8fc7\u539f\u5b50\u9012\u589e\u4fdd\u6301\u8ba1\u6570\uff1bGETSET\u7528\u6765\u91cd\u7f6e\u8ba1\u6570\u5668\uff1b\u8fc7\u671f\u5c5e\u6027\u7528\u6765\u786e\u8ba4\u4e00\u4e2a\u5173\u952e\u5b57\u4ec0\u4e48\u65f6\u5019\u5e94\u8be5\u5220\u9664\u3002</li> <li>\u7279\u5b9a\u65f6\u95f4\u5185\u7684\u7279\u5b9a\u9879\u76ee\uff1a\u8fd9\u662f\u7279\u5b9a\u8bbf\u95ee\u8005\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u901a\u8fc7\u7ed9\u6bcf\u6b21\u9875\u9762\u6d4f\u89c8\u4f7f\u7528SADD\u547d\u4ee4\u6765\u89e3\u51b3\u3002SADD\u4e0d\u4f1a\u5c06\u5df2\u7ecf\u5b58\u5728\u7684\u6210\u5458\u6dfb\u52a0\u5230\u4e00\u4e2a\u96c6\u5408\u3002</li> <li>Pub/Sub\uff1a\u5728\u66f4\u65b0\u4e2d\u4fdd\u6301\u7528\u6237\u5bf9\u6570\u636e\u7684\u6620\u5c04\u662f\u7cfb\u7edf\u4e2d\u7684\u4e00\u4e2a\u666e\u904d\u4efb\u52a1\u3002Redis\u7684pub/sub\u529f\u80fd\u4f7f\u7528\u4e86SUBSCRIBE\u3001UNSUBSCRIBE\u548cPUBLISH\u547d\u4ee4\uff0c\u8ba9\u8fd9\u4e2a\u53d8\u5f97\u66f4\u52a0\u5bb9\u6613\u3002</li> <li>\u961f\u5217\uff1a\u5728\u5f53\u524d\u7684\u7f16\u7a0b\u4e2d\u961f\u5217\u968f\u5904\u53ef\u89c1\u3002\u9664\u4e86push\u548cpop\u7c7b\u578b\u7684\u547d\u4ee4\u4e4b\u5916\uff0cRedis\u8fd8\u6709\u963b\u585e\u961f\u5217\u7684\u547d\u4ee4\uff0c\u80fd\u591f\u8ba9\u4e00\u4e2a\u7a0b\u5e8f\u5728\u6267\u884c\u65f6\u88ab\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u6dfb\u52a0\u5230\u961f\u5217\u3002</li> </ul> <p>\u5b9e\u9645\u5de5\u7a0b\u4e2d\uff0c\u5bf9\u4e8e\u7f13\u5b58\u7684\u5e94\u7528\u53ef\u4ee5\u6709\u591a\u79cd\u7684\u5b9e\u6218\u65b9\u5f0f\uff0c\u5305\u62ec<code>\u4fb5\u5165\u5f0f\u786c\u7f16\u7801</code>\u3001<code>\u62bd\u8c61\u670d\u52a1\u5316\u5e94\u7528</code>\u4ee5\u53ca\u8f7b\u91cf\u7684<code>\u6ce8\u89e3\u5f0f\u4f7f\u7528</code>\u7b49\u3002\u672c\u6587\u5c06\u4e3b\u8981\u4ecb\u7ecd\u4e0b\u6ce8\u89e3\u5f0f\u65b9\u5f0f\u3002</p>"},{"location":"2019-03-18-%E7%BC%93%E5%AD%98%E9%82%A3%E4%BA%9B%E4%BA%8B/#spring","title":"Spring\u6ce8\u89e3\u7f13\u5b58","text":"<p><code>Spring 3.1</code>\u4e4b\u540e\uff0c\u5f15\u5165\u4e86<code>\u6ce8\u89e3\u7f13\u5b58\u6280\u672f</code>\uff0c\u5176\u672c\u8d28\u4e0a\u4e0d\u662f\u4e00\u4e2a\u5177\u4f53\u7684\u7f13\u5b58\u5b9e\u73b0\u65b9\u6848\uff0c\u800c\u662f<code>\u4e00\u4e2a\u5bf9\u7f13\u5b58\u4f7f\u7528\u7684\u62bd\u8c61</code>\uff0c\u901a\u8fc7\u5728\u65e2\u6709\u4ee3\u7801\u4e2d\u6dfb\u52a0\u5c11\u91cf\u81ea\u5b9a\u4e49\u7684\u5404\u79cdannotation\uff0c\u5373\u80fd\u591f\u8fbe\u5230\u4f7f\u7528<code>\u7f13\u5b58\u5bf9\u8c61\u548c\u7f13\u5b58\u65b9\u6cd5</code>\u7684\u8fd4\u56de\u5bf9\u8c61\u7684\u6548\u679c\u3002Spring\u7684\u7f13\u5b58\u6280\u672f\u5177\u5907\u76f8\u5f53\u7684\u7075\u6d3b\u6027\uff0c\u4e0d\u4ec5\u80fd\u591f\u4f7f\u7528<code>SpEL(Spring Expression Language)</code>\u6765\u5b9a\u4e49\u7f13\u5b58\u7684key\u548c\u5404\u79cdcondition\uff0c\u8fd8\u63d0\u4f9b<code>\u5f00\u7bb1\u5373\u7528</code>\u7684\u7f13\u5b58\u4e34\u65f6\u5b58\u50a8\u65b9\u6848\uff0c\u4e5f\u652f\u6301\u548c\u4e3b\u6d41\u7684\u4e13\u4e1a\u7f13\u5b58\u96c6\u6210\u3002\u5176\u7279\u70b9\u603b\u7ed3\u5982\u4e0b\uff1a</p> <ul> <li>\u5c11\u91cf\u7684\u914d\u7f6eannotation\u6ce8\u91ca\u5373\u53ef\u4f7f\u5f97\u65e2\u6709\u4ee3\u7801\u652f\u6301\u7f13\u5b58\uff1b</li> <li>\u652f\u6301\u5f00\u7bb1\u5373\u7528\uff0c\u4e0d\u7528\u5b89\u88c5\u548c\u90e8\u7f72\u989d\u5916\u7684\u7b2c\u4e09\u65b9\u7ec4\u4ef6\u5373\u53ef\u4f7f\u7528\u7f13\u5b58\uff1b</li> <li>\u652f\u6301Spring Express Language\uff08SpEL\uff09\uff0c\u80fd\u4f7f\u7528\u5bf9\u8c61\u7684\u4efb\u4f55\u5c5e\u6027\u6216\u8005\u65b9\u6cd5\u6765\u5b9a\u4e49\u7f13\u5b58\u7684key\u548c\u4f7f\u7528\u89c4\u5219\u6761\u4ef6\uff1b</li> <li>\u652f\u6301\u81ea\u5b9a\u4e49key\u548c\u81ea\u5b9a\u4e49\u7f13\u5b58\u7ba1\u7406\u8005\uff0c\u5177\u6709\u76f8\u5f53\u7684\u7075\u6d3b\u6027\u548c\u53ef\u6269\u5c55\u6027\u3002</li> </ul> <p>\u548cSpring\u7684\u4e8b\u52a1\u7ba1\u7406\u7c7b\u4f3c\uff0cSpring Cache\u7684\u5173\u952e\u539f\u7406\u5c31\u662f<code>Spring AOP</code>\uff0c\u901a\u8fc7Spring AOP\u5b9e\u73b0\u4e86\u5728\u65b9\u6cd5\u8c03\u7528\u524d\u3001\u8c03\u7528\u540e\u83b7\u53d6\u65b9\u6cd5\u7684\u5165\u53c2\u548c\u8fd4\u56de\u503c\uff0c\u8fdb\u800c\u5b9e\u73b0\u4e86\u7f13\u5b58\u7684\u903b\u8f91\u3002\u800cSpring Cache\u5229\u7528\u4e86Spring AOP\u7684\u52a8\u6001\u4ee3\u7406\u6280\u672f\uff0c\u5373\u5f53\u5ba2\u6237\u7aef\u5c1d\u8bd5\u8c03\u7528pojo\u7684foo()\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u7ed9\u5b83\u7684\u4e0d\u662fpojo\u81ea\u8eab\u7684\u5f15\u7528\uff0c\u800c\u662f\u4e00\u4e2a\u52a8\u6001\u751f\u6210\u7684\u4ee3\u7406\u7c7b\u3002</p> <p></p> <p>\u5982\u56fe12\u6240\u793a\uff0c\u5b9e\u9645\u5ba2\u6237\u7aef\u83b7\u53d6\u7684\u662f\u4e00\u4e2a\u4ee3\u7406\u7684\u5f15\u7528\uff0c\u5728\u8c03\u7528foo()\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u4f1a\u9996\u5148\u8c03\u7528proxy\u7684foo()\u65b9\u6cd5\uff0c\u8fd9\u4e2a\u65f6\u5019proxy\u53ef\u4ee5\u6574\u4f53\u63a7\u5236\u5b9e\u9645\u7684pojo.foo()\u65b9\u6cd5\u7684\u5165\u53c2\u548c\u8fd4\u56de\u503c\uff0c\u6bd4\u5982\u7f13\u5b58\u7ed3\u679c\uff0c\u6bd4\u5982\u76f4\u63a5\u7565\u8fc7\u6267\u884c\u5b9e\u9645\u7684foo()\u65b9\u6cd5\u7b49\uff0c\u90fd\u662f\u53ef\u4ee5\u8f7b\u677e\u505a\u5230\u7684\u3002Spring Cache\u4e3b\u8981\u4f7f\u7528\u4e09\u4e2a\u6ce8\u91ca\u6807\u7b7e\uff0c\u5373<code>@Cacheable</code>\u3001<code>@CachePut</code>\u548c<code>@CacheEvict</code>\uff0c\u4e3b\u8981\u9488\u5bf9<code>\u65b9\u6cd5</code>\u4e0a\u6ce8\u89e3\u4f7f\u7528\uff0c\u90e8\u5206\u573a\u666f\u4e5f\u53ef\u4ee5\u76f4\u63a5<code>\u7c7b</code>\u4e0a\u6ce8\u89e3\u4f7f\u7528\uff0c\u5f53\u5728\u7c7b\u4e0a\u4f7f\u7528\u65f6\uff0c\u8be5\u7c7b\u6240\u6709\u65b9\u6cd5\u90fd\u5c06\u53d7\u5f71\u54cd\u3002\u6211\u4eec\u603b\u7ed3\u4e00\u4e0b\u5176\u4f5c\u7528\u548c\u914d\u7f6e\u65b9\u6cd5\uff0c\u5982\u88681\u6240\u793a\u3002</p> \u6807\u7b7e\u7c7b\u578b \u4f5c\u7528 \u4e3b\u8981\u914d\u7f6e\u53c2\u6570\u8bf4\u660e @Cacheable \u4e3b\u8981\u9488\u5bf9\u65b9\u6cd5\u914d\u7f6e\uff0c\u80fd\u591f\u6839\u636e\u65b9\u6cd5\u7684\u8bf7\u6c42\u53c2\u6570\u5bf9\u5176\u7ed3\u679c\u8fdb\u884c\u7f13\u5b58 value\uff1a\u7f13\u5b58\u7684\u540d\u79f0\uff0c\u5728 Spring \u914d\u7f6e\u6587\u4ef6\u4e2d\u5b9a\u4e49\uff0c\u5fc5\u987b\u6307\u5b9a\u81f3\u5c11\u4e00\u4e2a\uff1b key\uff1a\u7f13\u5b58\u7684 key\uff0c\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u5982\u679c\u6307\u5b9a\u8981\u6309\u7167 SpEL \u8868\u8fbe\u5f0f\u7f16\u5199\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u9ed8\u8ba4\u6309\u7167\u65b9\u6cd5\u7684\u6240\u6709\u53c2\u6570\u8fdb\u884c\u7ec4\u5408\uff1b condition\uff1a\u7f13\u5b58\u7684\u6761\u4ef6\uff0c\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u4f7f\u7528 SpEL \u7f16\u5199\uff0c\u8fd4\u56de true \u6216\u8005 false\uff0c\u53ea\u6709\u4e3a true \u624d\u8fdb\u884c\u7f13\u5b58 @CachePut \u4e3b\u8981\u9488\u5bf9\u65b9\u6cd5\u914d\u7f6e\uff0c\u80fd\u591f\u6839\u636e\u65b9\u6cd5\u7684\u8bf7\u6c42\u53c2\u6570\u5bf9\u5176\u7ed3\u679c\u8fdb\u884c\u7f13\u5b58\uff0c\u548c @Cacheable \u4e0d\u540c\u7684\u662f\uff0c\u5b83\u6bcf\u6b21\u90fd\u4f1a\u89e6\u53d1\u771f\u5b9e\u65b9\u6cd5\u7684\u8c03\u7528 value\uff1a\u7f13\u5b58\u7684\u540d\u79f0\uff0c\u5728 spring \u914d\u7f6e\u6587\u4ef6\u4e2d\u5b9a\u4e49\uff0c\u5fc5\u987b\u6307\u5b9a\u81f3\u5c11\u4e00\u4e2a; key\uff1a\u7f13\u5b58\u7684 key\uff0c\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u5982\u679c\u6307\u5b9a\u8981\u6309\u7167 SpEL \u8868\u8fbe\u5f0f\u7f16\u5199\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u9ed8\u8ba4\u6309\u7167\u65b9\u6cd5\u7684\u6240\u6709\u53c2\u6570\u8fdb\u884c\u7ec4\u5408\uff1b condition\uff1a\u7f13\u5b58\u7684\u6761\u4ef6\uff0c\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u4f7f\u7528 SpEL \u7f16\u5199\uff0c\u8fd4\u56de true \u6216\u8005 false\uff0c\u53ea\u6709\u4e3a true \u624d\u8fdb\u884c\u7f13\u5b58 @CacheEvict \u4e3b\u8981\u9488\u5bf9\u65b9\u6cd5\u914d\u7f6e\uff0c\u80fd\u591f\u6839\u636e\u4e00\u5b9a\u7684\u6761\u4ef6\u5bf9\u7f13\u5b58\u8fdb\u884c\u6e05\u7a7a value\uff1a\u7f13\u5b58\u7684\u540d\u79f0\uff0c\u5728 Spring \u914d\u7f6e\u6587\u4ef6\u4e2d\u5b9a\u4e49\uff0c\u5fc5\u987b\u6307\u5b9a\u81f3\u5c11\u4e00\u4e2a\uff1b key\uff1a\u7f13\u5b58\u7684 key\uff0c\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u5982\u679c\u6307\u5b9a\u8981\u6309\u7167 SpEL \u8868\u8fbe\u5f0f\u7f16\u5199\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u9ed8\u8ba4\u6309\u7167\u65b9\u6cd5\u7684\u6240\u6709\u53c2\u6570\u8fdb\u884c\u7ec4\u5408\uff1b condition\uff1a\u7f13\u5b58\u7684\u6761\u4ef6\uff0c\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u4f7f\u7528 SpEL \u7f16\u5199\uff0c\u8fd4\u56de true \u6216\u8005 false\uff0c\u53ea\u6709\u4e3a true \u624d\u8fdb\u884c\u7f13\u5b58\uff1b allEntries\uff1a\u662f\u5426\u6e05\u7a7a\u6240\u6709\u7f13\u5b58\u5185\u5bb9\uff0c\u9ed8\u8ba4\u4e3a false\uff0c\u5982\u679c\u6307\u5b9a\u4e3a true\uff0c\u5219\u65b9\u6cd5\u8c03\u7528\u540e\u5c06\u7acb\u5373\u6e05\u7a7a\u6240\u6709\u7f13\u5b58\uff1b beforeInvocation\uff1a\u662f\u5426\u5728\u65b9\u6cd5\u6267\u884c\u524d\u5c31\u6e05\u7a7a\uff0c\u9ed8\u8ba4\u4e3a false\uff0c\u5982\u679c\u6307\u5b9a\u4e3a true\uff0c\u5219\u5728\u65b9\u6cd5\u8fd8\u6ca1\u6709\u6267\u884c\u7684\u65f6\u5019\u5c31\u6e05\u7a7a\u7f13\u5b58\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u65b9\u6cd5\u6267\u884c\u629b\u51fa\u5f02\u5e38\uff0c\u5219\u4e0d\u4f1a\u6e05\u7a7a\u7f13\u5b58 <p>\u53ef\u6269\u5c55\u652f\u6301\uff1aSpring\u6ce8\u89e3cache\u80fd\u591f\u6ee1\u8db3\u4e00\u822c\u5e94\u7528\u5bf9\u7f13\u5b58\u7684\u9700\u6c42\uff0c\u4f46\u968f\u7740\u5e94\u7528\u670d\u52a1\u7684\u590d\u6742\u5316\uff0c\u5927\u5e76\u53d1\u9ad8\u53ef\u7528\u6027\u80fd\u8981\u6c42\u4e0b\uff0c\u9700\u8981\u8fdb\u884c\u4e00\u5b9a\u7684\u6269\u5c55\uff0c\u8fd9\u65f6\u5bf9\u5176\u81ea\u8eab\u96c6\u6210\u7684\u7f13\u5b58\u65b9\u6848\u53ef\u80fd\u4e0d\u592a\u9002\u7528\uff0c\u8be5\u600e\u4e48\u529e\uff1fSpring\u9884\u5148\u6709\u8003\u8651\u5230\u8fd9\u70b9\uff0c\u90a3\u4e48\u600e\u6837\u5229\u7528Spring\u63d0\u4f9b\u7684\u6269\u5c55\u70b9\u5b9e\u73b0\u6211\u4eec\u81ea\u5df1\u7684\u7f13\u5b58\uff0c\u4e14\u5728\u4e0d\u6539\u53d8\u539f\u6765\u5df2\u6709\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u6269\u5c55\uff1f\u662f\u5426\u5728\u65b9\u6cd5\u6267\u884c\u524d\u5c31\u6e05\u7a7a\uff0c\u9ed8\u8ba4\u4e3afalse\uff0c\u5982\u679c\u6307\u5b9a\u4e3atrue\uff0c\u5219\u5728\u65b9\u6cd5\u8fd8\u6ca1\u6709\u6267\u884c\u7684\u65f6\u5019\u5c31\u6e05\u7a7a\u7f13\u5b58\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u65b9\u6cd5\u6267\u884c\u629b\u51fa\u5f02\u5e38\uff0c\u5219\u4e0d\u4f1a\u6e05\u7a7a\u7f13\u5b58\u3002</p> <p>\u8fd9\u57fa\u672c\u80fd\u591f\u6ee1\u8db3\u4e00\u822c\u5e94\u7528\u5bf9\u7f13\u5b58\u7684\u9700\u6c42\uff0c\u4f46\u73b0\u5b9e\u603b\u662f\u5f88\u590d\u6742\uff0c\u5f53\u4f60\u7684\u7528\u6237\u91cf\u4e0a\u53bb\u6216\u8005\u6027\u80fd\u8ddf\u4e0d\u4e0a\uff0c\u603b\u9700\u8981\u8fdb\u884c\u6269\u5c55\uff0c\u8fd9\u4e2a\u65f6\u5019\u4f60\u6216\u8bb8\u5bf9\u5176\u63d0\u4f9b\u7684\u5185\u5b58\u7f13\u5b58\u4e0d\u6ee1\u610f\u4e86\uff0c\u56e0\u4e3a\u5176\u4e0d\u652f\u6301\u9ad8\u53ef\u7528\u6027\uff0c\u4e5f\u4e0d\u5177\u5907\u6301\u4e45\u5316\u6570\u636e\u80fd\u529b\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c\u4f60\u5c31\u9700\u8981\u81ea\u5b9a\u4e49\u4f60\u7684\u7f13\u5b58\u65b9\u6848\u4e86\uff0c\u8fd8\u597d\uff0cSpring\u4e5f\u60f3\u5230\u4e86\u8fd9\u4e00\u70b9\u3002</p> <p>\u6211\u4eec\u5148\u4e0d\u8003\u8651\u5982\u4f55\u6301\u4e45\u5316\u7f13\u5b58\uff0c\u6bd5\u7adf\u8fd9\u79cd\u7b2c\u4e09\u65b9\u7684\u5b9e\u73b0\u65b9\u6848\u5f88\u591a\uff0c\u6211\u4eec\u8981\u8003\u8651\u7684\u662f\uff0c\u600e\u4e48\u5229\u7528Spring\u63d0\u4f9b\u7684\u6269\u5c55\u70b9\u5b9e\u73b0\u6211\u4eec\u81ea\u5df1\u7684\u7f13\u5b58\uff0c\u4e14\u5728\u4e0d\u6539\u539f\u6765\u5df2\u6709\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u6269\u5c55\u3002\u8fd9\u9700\u8981\u7b80\u5355\u7684\u4e09\u6b65\u9aa4\uff1a</p> <ol> <li>\u9996\u5148\u9700\u8981\u63d0\u4f9b\u4e00\u4e2aCacheManager\u63a5\u53e3\u7684\u5b9e\u73b0\uff08\u7ee7\u627f\u81f3<code>AbstractCacheManager</code>\uff09\uff0c\u7ba1\u7406\u81ea\u8eab\u7684cache\u5b9e\u4f8b\uff1b</li> <li>\u5176\u6b21\uff0c\u5b9e\u73b0\u81ea\u5df1\u7684cache\u5b9e\u4f8bMyCache(\u7ee7\u627f\u81f3Cache)\uff0c\u5728\u8fd9\u91cc\u9762<code>\u5f15\u5165\u6211\u4eec\u9700\u8981\u7684\u7b2c\u4e09\u65b9cache\u6216\u81ea\u5b9a\u4e49cache</code>\uff1b</li> <li>\u6700\u540e\u5c31\u662f\u5bf9\u914d\u7f6e\u9879\u8fdb\u884c\u58f0\u660e\uff0c\u5c06MyCache\u5b9e\u4f8b\u6ce8\u5165<code>CacheManager</code>\u8fdb\u884c\u7edf\u4e00\u7ba1\u7406\u3002</li> </ol>"},{"location":"2019-03-18-%E7%BC%93%E5%AD%98%E9%82%A3%E4%BA%9B%E4%BA%8B/#_5","title":"\u9152\u5e97\u5546\u5bb6\u7aef\u81ea\u5b9a\u4e49\u6ce8\u89e3\u7f13\u5b58","text":"<p>\u6ce8\u89e3\u7f13\u5b58\u7684\u4f7f\u7528\uff0c\u53ef\u4ee5\u6709\u6548\u589e\u5f3a\u5e94\u7528\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\uff0c\u540c\u65f6\u7edf\u4e00\u7ba1\u7406\u7f13\u5b58\uff0c\u63d0\u4f9b\u8f83\u597d\u7684\u53ef\u6269\u5c55\u6027\uff0c\u4e3a\u6b64\uff0c\u9152\u5e97\u5546\u5bb6\u7aef\u5728Spring\u6ce8\u89e3\u7f13\u5b58\u57fa\u7840\u4e0a\uff0c\u81ea\u5b9a\u4e49\u4e86\u9002\u5408\u81ea\u8eab\u4e1a\u52a1\u7279\u6027\u7684\u6ce8\u89e3\u7f13\u5b58\u3002</p> <p>\u4e3b\u8981\u4f7f\u7528\u4e24\u4e2a\u6807\u7b7e\uff0c\u5373<code>@HotelCacheable</code>\u3001<code>@HotelCacheEvict</code>\uff0c\u5176\u4f5c\u7528\u548c\u914d\u7f6e\u65b9\u6cd5\u89c1\u88682\u3002</p> \u6807\u7b7e\u7c7b\u578b \u4f5c\u7528 \u4e3b\u8981\u914d\u7f6e\u53c2\u6570\u8bf4\u660e @HotelCacheable \u4e3b\u8981\u9488\u5bf9\u65b9\u6cd5\u914d\u7f6e\uff0c\u80fd\u591f\u6839\u636e\u65b9\u6cd5\u7684\u8bf7\u6c42\u53c2\u6570\u5bf9\u5176\u7ed3\u679c\u8fdb\u884c\u7f13\u5b58 domain\uff1a\u4f5c\u7528\u57df\uff0c\u9488\u5bf9\u96c6\u5408\u573a\u666f\uff0c\u89e3\u51b3\u6279\u91cf\u66f4\u65b0\u95ee\u9898\uff1b domainKey\uff1a\u4f5c\u7528\u57df\u5bf9\u5e94\u7684\u7f13\u5b58key\uff1b key\uff1a\u7f13\u5b58\u5bf9\u8c61key \u524d\u7f00\uff1b fieldKey\uff1a\u7f13\u5b58\u5bf9\u8c61key\uff0c\u4e0e\u524d\u7f00\u5408\u5e76\u751f\u6210\u5bf9\u8c61key\uff1b condition\uff1a\u7f13\u5b58\u83b7\u53d6\u524d\u7f6e\u6761\u4ef6\uff0c\u652f\u6301spel\u8bed\u6cd5\uff1b cacheCondition\uff1a\u7f13\u5b58\u5237\u5165\u524d\u7f6e\u6761\u4ef6\uff0c\u652f\u6301spel\u8bed\u6cd5\uff1b expireTime\uff1a\u8d85\u65f6\u65f6\u95f4\u8bbe\u7f6e @HotelCacheEvict \u4e3b\u8981\u9488\u5bf9\u65b9\u6cd5\u914d\u7f6e\uff0c\u80fd\u591f\u6839\u636e\u4e00\u5b9a\u7684\u6761\u4ef6\u5bf9\u7f13\u5b58\u8fdb\u884c\u6e05\u7a7a \u540c\u4e0a <p>\u589e\u52a0\u4f5c\u7528\u57df\u7684\u6982\u5ff5\uff0c\u89e3\u51b3\u5546\u5bb6\u4fe1\u606f\u53d8\u66f4\u4e0b\uff0c\u591a\u91cd\u91cd\u8981\u4fe1\u606f\u5b9e\u65f6\u66f4\u65b0\u7684\u95ee\u9898\u3002</p> <p></p> <p>\u5982\u56fe13\uff0c\u6309\u65e7\u7684\u65b9\u6848\uff0c\u5f53cache0\u53d1\u9001\u53d8\u5316\u65f6\uff0c\u4e3a\u4e86\u4fdd\u6301\u4fe1\u606f\u7684\u5b9e\u65f6\u66f4\u65b0\uff0c\u9700\u8981\u624b\u52a8\u5220\u9664cache1\u3001cache2\u3001cache3\u7b49\u76f8\u5173\u5904\u7684\u7f13\u5b58\u6570\u636e\u3002\u589e\u52a0\u57df\u7f13\u5b58\u6982\u5ff5\uff0ccache0\u3001cache1\u3001cache2\u3001cache3\u662f\u4ee5\u8d26\u53f7ID\u4e3a\u57fa\u7840\uff0c\u76f8\u4e92\u5b58\u5728\u5f71\u54cd\u7ea6\u675f\u7684\u96c6\u5408\u4f53\uff0c\u6211\u4eec\u4f5c\u4e3a\u4e00\u4e2a\u57df\u96c6\u5408\uff0c\u589e\u52a0\u57df\u7f13\u5b58\u5904\u7406\uff0c\u5f53cache0\u53d1\u9001\u53d8\u5316\u65f6\uff0c\u6574\u4f53\u7684\u8d26\u53f7ID domain\u57df\u5df2\u53d1\u751f\u66f4\u65b0\uff0c\u81ea\u52a8\u5f71\u54cdcache1\u3001cache2\u3001cache3\u7b49\u5904\u7684\u7f13\u5b58\u6570\u636e\u3002\u5c06\u76f8\u5173\u8054\u903b\u8f91\u7f13\u5b58\u7edf\u4e00\u5316\uff0c\u6709\u6548\u63d0\u5347\u4ee3\u7801\u53ef\u8bfb\u6027\uff0c\u540c\u65f6\u66f4\u597d\u670d\u52a1\u4e1a\u52a1\uff0c\u8d26\u53f7\u91cd\u70b9\u4fe1\u606f\u80fd\u591f\u5b9e\u65f6\u53d8\u66f4\u5237\u65b0\uff0c\u76f8\u5173\u670d\u52a1\u54cd\u5e94\u901f\u5ea6\u63d0\u5347\u3002</p> <p>\u53e6\u5916\uff0c\u589e\u52a0\u4e86cacheCondition\u7f13\u5b58\u5237\u5165\u524d\u7f6e\u5224\u65ad\uff0c\u6709\u6548\u89e3\u51b3\u5546\u5bb6\u4e1a\u52a1\u591a\u91cd\u5916\u90e8\u4f9d\u8d56\u573a\u666f\u4e0b\uff0c\u4e1a\u52a1\u964d\u7ea7\u6709\u635f\u670d\u52a1\u4e0b\uff0c\u4e1a\u52a1\u6570\u636e\u4e00\u81f4\u6027\u4fdd\u8bc1\uff0c\u4e0d\u56e0\u4e3a\u7f13\u5b58\u7684\u589e\u52a0\u5f71\u54cd\u4e1a\u52a1\u7684\u51c6\u786e\u6027\uff1b\u81ea\u5b9a\u4e49CacheManager\u7f13\u5b58\u7ba1\u7406\u5668\uff0c\u53ef\u4ee5\u6709\u6548\u517c\u5bb9\u516c\u5171\u57fa\u7840\u7ec4\u4ef6Medis\u3001Cellar\u76f8\u5173\u670d\u52a1\uff0c\u5728\u5bf9\u5e94\u7528\u7a0b\u5e8f\u4e0d\u505a\u6539\u52a8\u7684\u60c5\u51b5\u4e0b\uff0c\u6709\u6548\u5207\u6362\u7f13\u5b58\u65b9\u5f0f\uff1b\u540c\u65f6\uff0c\u7edf\u4e00\u7684\u7f13\u5b58\u670d\u52a1AOP\u5165\u53e3\uff0c\u7ed3\u5408\u63a5\u5165Mtconfig\u7edf\u4e00\u914d\u7f6e\u7ba1\u7406\uff0c\u5bf9\u5e94\u7528\u5185\u7f13\u5b58\u505a\u597d\u964d\u7ea7\u51c6\u5907\uff0c\u4e00\u952e\u5173\u95ed\u7f13\u5b58\u3002\u51e0\u70b9\u5efa\u8bae\uff1a</p> <ul> <li>\u4e0a\u9762\u4ecb\u7ecd\u8fc7Spring Cache\u7684\u539f\u7406\u662f\u57fa\u4e8e\u52a8\u6001\u751f\u6210\u7684proxy\u4ee3\u7406\u673a\u5236\u6765\u8fdb\u884c\u5207\u9762\u5904\u7406\uff0c\u5173\u952e\u70b9\u662f\u5bf9\u8c61\u7684\u5f15\u7528\u95ee\u9898\uff0c\u5982\u679c\u5bf9\u8c61\u7684\u65b9\u6cd5\u662f\u7c7b\u91cc\u9762\u7684\u5185\u90e8\u8c03\u7528\uff08this\u5f15\u7528\uff09\u800c\u4e0d\u662f\u5916\u90e8\u5f15\u7528\u7684\u573a\u666f\u4e0b\uff0c\u4f1a\u5bfc\u81f4proxy\u5931\u8d25\uff0c\u90a3\u4e48\u6211\u4eec\u6240\u505a\u7684\u7f13\u5b58\u5207\u9762\u5904\u7406\u4e5f\u5c31\u5931\u6548\u4e86\u3002\u56e0\u6b64\uff0c\u5e94\u907f\u514d\u5df2\u6ce8\u89e3\u7f13\u5b58\u7684\u65b9\u6cd5\u5728\u7c7b\u91cc\u9762\u7684\u5185\u90e8\u8c03\u7528\u3002</li> <li>\u4f7f\u7528\u7684key\u7ea6\u675f\uff0c\u7f13\u5b58\u7684key\u5e94\u5c3d\u91cf\u4f7f\u7528\u7b80\u5355\u7684\u53ef\u533a\u522b\u7684\u5143\u7d20\uff0c\u5982ID\u3001\u540d\u79f0\u7b49\uff0c\u4e0d\u80fd\u4f7f\u7528list\u7b49\u5bb9\u5668\u7684\u503c\uff0c\u6216\u8005\u4f7f\u7528\u6574\u4f53model\u5bf9\u8c61\u7684\u503c\u3002\u975epublic\u65b9\u6cd5\u65e0\u6cd5\u4f7f\u7528\u6ce8\u89e3\u7f13\u5b58\u5b9e\u73b0\u3002</li> </ul> <p>\u603b\u4e4b\uff0c\u6ce8\u91ca\u9a71\u52a8\u7684Spring Cache\u80fd\u591f\u6781\u5927\u7684\u51cf\u5c11\u6211\u4eec\u7f16\u5199\u5e38\u89c1\u7f13\u5b58\u7684\u4ee3\u7801\u91cf\uff0c\u901a\u8fc7\u5c11\u91cf\u7684\u6ce8\u91ca\u6807\u7b7e\u548c\u914d\u7f6e\u6587\u4ef6\uff0c\u5373\u53ef\u8fbe\u5230\u4f7f\u4ee3\u7801\u5177\u5907\u7f13\u5b58\u7684\u80fd\u529b\uff0c\u4e14\u5177\u5907\u5f88\u597d\u7684\u7075\u6d3b\u6027\u548c\u6269\u5c55\u6027\u3002\u4f46\u662f\u6211\u4eec\u4e5f\u5e94\u8be5\u770b\u5230\uff0cSpring Cache\u7531\u4e8e\u57fa\u4e8eSpring AOP\u6280\u672f\uff0c\u5c24\u5176\u662f\u52a8\u6001\u7684proxy\u6280\u672f\uff0c\u5bfc\u81f4\u5176\u4e0d\u80fd\u5f88\u597d\u7684\u652f\u6301\u65b9\u6cd5\u7684\u5185\u90e8\u8c03\u7528\u6216\u8005\u975epublic\u65b9\u6cd5\u7684\u7f13\u5b58\u8bbe\u7f6e\uff0c\u5f53\u7136\u8fd9\u4e9b\u90fd\u662f\u53ef\u4ee5\u89e3\u51b3\u7684\u95ee\u9898\u3002</p> <p>\u660e\u8f89\uff0c\u7f8e\u56e2\u9152\u65c5\u4e8b\u4e1a\u7fa4\u9152\u5e97\u4f4f\u5bbf\u7814\u53d1\u56e2\u961fB\u7aef\u5546\u5bb6\u4e1a\u52a1\u5e73\u53f0\u8d1f\u8d23\u4eba\uff0c\u4e3b\u5bfc\u6784\u5efa\u5546\u5bb6\u4e1a\u52a1\u5e73\u53f0\u7cfb\u7edf\uff0c\u652f\u6491\u7f8e\u56e2\u9152\u5e97\u4f4f\u5bbf\u4e1a\u52a1\u7684\u98de\u901f\u53d1\u5c55\u9700\u6c42\u3002\u66fe\u4efb\u804c\u4e8e\u8054\u60f3\u96c6\u56e2\u3001\u767e\u5ea6\u3002</p>"},{"location":"2019-03-21-Git%E6%9E%B6%E6%9E%84/","title":"2019 03 21 Git\u67b6\u6784","text":"<p>\u7ffb\u8bd1\u81eaThe Architecture of Open Source Applications (Volume 2): Git</p>"},{"location":"2019-03-21-Git%E6%9E%B6%E6%9E%84/#_1","title":"\u7b80\u8ff0","text":"<p>Git\u5141\u8bb8\u8bb8\u591a\u534f\u4f5c\u8005\u4f7f\u7528\u5bf9\u7b49\u7684\u5b58\u50a8\u5e93\u7f51\u7edc\u7ef4\u62a4\u6570\u5b57\u5316\u5de5\u4f5c\u4f53\uff08\u901a\u5e38\u4f46\u4e0d\u9650\u4e8e\u4ee3\u7801\uff09\uff0c\u652f\u6301\u5206\u5e03\u5f0f\u5de5\u4f5c\u6d41\uff0c\u5141\u8bb8\u5de5\u4f5c\u4f53\u6700\u7ec8\u7684\u4ea4\u6c47\u6216\u6682\u65f6\u7684\u5206\u6b67\u3002\u672c\u7ae0\u5c06\u5c55\u793aGit\u7684\u5404\u4e2a\u65b9\u9762\u5982\u4f55\u5b9e\u73b0\uff0c\u4ee5\u53ca\u4e0e\u5176\u4ed6\u7248\u672c\u63a7\u5236\u7cfb\u7edf\uff08VCS\uff09\u7684\u533a\u522b\u3002</p>"},{"location":"2019-03-21-Git%E6%9E%B6%E6%9E%84/#_2","title":"\u6765\u6e90","text":"<p>\u4e3a\u4e86\u66f4\u597d\u5730\u7406\u89e3Git\u7684\u8bbe\u8ba1\u7406\u5ff5\uff0c\u6709\u52a9\u4e8e\u7406\u89e3\u5728<code>Linux\u5185\u6838\u793e\u533a</code>\u4e2d\u542f\u52a8Git\u9879\u76ee\u7684\u73af\u5883\u3002</p> <p>\u76f8\u8f83\u4e8e\u5f53\u65f6\u7684\u5176\u4ed6\u5546\u4e1a\u8f6f\u4ef6\u9879\u76ee\uff0cLinux\u5185\u6838\u662f\u4e0d\u5bfb\u5e38\u7684\uff0c\u56e0\u4e3a\u63d0\u4ea4\u8005\u6570\u91cf\u4f17\u591a\uff0c\u8d21\u732e\u8005\u53c2\u4e0e\u5ea6\u548c\u73b0\u6709\u4ee3\u7801\u5e93\u77e5\u8bc6\u7684\u5dee\u5f02\u5f88\u5927\u3002\u591a\u5e74\u6765\uff0c\u5185\u6838\u4e00\u76f4\u901a\u8fc7tarball\u548c\u8865\u4e01\u8fdb\u884c\u7ef4\u62a4\uff0c\u6838\u5fc3\u5f00\u53d1\u793e\u533a\u52aa\u529b\u5bfb\u627e\u6ee1\u8db3\u5176\u5927\u90e8\u5206\u9700\u6c42\u7684VCS\u3002</p> <p>Git\u662f\u4e00\u4e2a\u5f00\u6e90\u9879\u76ee\uff0c\u6e90\u4e8e2005\u5e74\u7684\u9700\u6c42\u548c\u632b\u6298\u3002\u5f53\u65f6\u7684Linux\u5185\u884c\u4eba\u4ee3\u7801\u5e93\u7531\u4e24\u4e2aVCS\uff08BitKeeper\u548cCVS\uff09\u7531\u4e0d\u540c\u7684\u6838\u5fc3\u5f00\u53d1\u8005\u7ba1\u7406\u3002BitKeeper\u63d0\u4f9b\u4e86\u4e0e\u5f53\u524d\u6d41\u884c\u7684\u5f00\u6e90VCS\u63d0\u4f9b\u7684VCS\u5386\u53f2\u8c31\u7cfb\u4e0d\u540c\u7684\u89c6\u56fe\u3002</p> <p>BitKeeper\u7684\u5236\u9020\u5546<code>BitMover</code>\u5ba3\u5e03\u5c06\u53d6\u6d88\u4e00\u4e9b\u6838\u5fc3Linux\u5185\u6838\u5f00\u53d1\u4eba\u5458\u7684\u8bb8\u53ef\u540e\u51e0\u5929\uff0c<code>Linus Torvalds</code>\u5f00\u59cb\u6025\u4e8e\u5f00\u53d1Git\u3002\u4ed6\u9996\u5148\u7f16\u5199\u4e86\u4e00\u7cfb\u5217\u811a\u672c\u6765\u5e2e\u52a9\u4ed6\u7ba1\u7406\u7535\u5b50\u90ae\u4ef6\u8865\u4e01\uff0c\u4ee5\u4fbf\u4e00\u4e2a\u63a5\u4e00\u4e2a\u5730\u5e94\u7528\u3002\u8fd9\u4e2a\u521d\u59cb\u811a\u672c\u96c6\u5408\u7684\u76ee\u7684\u662f\u80fd\u591f\u5feb\u901f\u4e2d\u6b62\u5408\u5e76\uff0c\u4ee5\u4fbf\u7ef4\u62a4\u8005\u53ef\u4ee5\u4fee\u6539<code>code-mid-patch-stream</code>\u4e2d\u7684\u4ee3\u7801\u5e93\u4ee5\u624b\u52a8\u5408\u5e76\uff0c\u7136\u540e\u7ee7\u7eed\u5408\u5e76\u540e\u7eed\u8865\u4e01\u3002</p> <p>\u4ece\u4e00\u5f00\u59cb\uff0cTorvalds\u5bf9Git\u6709\u4e00\u4e2a\u54f2\u5b66\u76ee\u6807\u2014\u2014\u6210\u4e3a<code>\u53cdCVS</code>\u52a0<code>\u4e09\u4e2a\u53ef\u7528\u6027\u8bbe\u8ba1\u76ee\u6807</code>\uff1a</p> <ul> <li>\u652f\u6301\u5206\u5e03\u5f0f\u5de5\u4f5c\u6d41\uff0c\u7c7b\u4f3c\u4e8eBitKeeper\u542f\u7528\u7684\u5de5\u4f5c\u6d41\u3002</li> <li>\u63d0\u4f9b\u9632\u8303\u5185\u5bb9\u635f\u574f\u7684\u4fdd\u62a4\u63aa\u65bd\u3002</li> <li>\u63d0\u4f9b\u9ad8\u6027\u80fd\u3002</li> </ul> <p>\u8fd9\u4e9b\u8bbe\u8ba1\u76ee\u6807\u5df2\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5b8c\u6210\u548c\u7ef4\u62a4\uff0c\u6b63\u5982\u6211\u5c06\u8bd5\u56fe\u901a\u8fc7\u5256\u6790Git\u4f7f\u7528\u6709\u5411\u65e0\u73af\u56fe\uff08DAG\uff09\u8fdb\u884c\u5185\u5bb9\u5b58\u50a8\uff0c\u5934\u90e8\u53c2\u8003\u6307\u9488\uff0c\u5bf9\u8c61\u6a21\u578b\u8868\u793a\u548c\u8fdc\u7a0b\u534f\u8bae\u6765\u5c55\u793a;\u6700\u540eGit\u5982\u4f55\u8ddf\u8e2a\u6811\u7684\u5408\u5e76\u3002</p> <p>\u5c3d\u7ba1BitKeeper\u5f71\u54cd\u4e86Git\u7684\u539f\u59cb\u8bbe\u8ba1\uff0c\u4f46\u5b83\u4ee5\u5b8c\u5168\u4e0d\u540c\u7684\u65b9\u5f0f\u5b9e\u73b0\uff0c\u5e76\u5141\u8bb8\u66f4\u591a\u7684\u5206\u5e03\u5f0f\u52a0\u4e0a\u4ec5\u9650\u672c\u5730\u7684\u5de5\u4f5c\u6d41\uff0c\u8fd9\u662fBitKeeper\u65e0\u6cd5\u5b9e\u73b0\u7684\u3002 Monotone\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5206\u5e03\u5f0fVCS\uff0c\u59cb\u4e8e2003\u5e74\uff0c\u53ef\u80fd\u662fGit\u65e9\u671f\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u7684\u53e6\u4e00\u4e2a\u7075\u611f\u6765\u6e90\u3002</p> <p>\u5206\u5e03\u5f0f\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u63d0\u4f9b\u4e86\u6781\u5927\u7684\u5de5\u4f5c\u6d41\u7a0b\u7075\u6d3b\u6027\uff0c\u901a\u5e38\u4ee5\u7b80\u5355\u6027\u4e3a\u4ee3\u4ef7\u5206\u5e03\u5f0f\u6a21\u578b\u7684\u7279\u5b9a\u4f18\u52bf\u5305\u62ec\uff1a</p> <ul> <li>\u4e3a\u534f\u4f5c\u8005\u63d0\u4f9b\u8131\u673a\u5de5\u4f5c\u548c\u9012\u589e\u63d0\u4ea4\u7684\u80fd\u529b\u3002</li> <li>\u5141\u8bb8\u534f\u4f5c\u8005\u786e\u5b9a\u4ed6/\u5979\u7684\u5de5\u4f5c\u4f55\u65f6\u53ef\u4ee5\u5206\u4eab\u3002</li> <li>\u5728\u79bb\u7ebf\u65f6\u63d0\u4f9b\u534f\u4f5c\u8005\u5bf9\u5b58\u50a8\u5e93\u5386\u53f2\u8bb0\u5f55\u7684\u8bbf\u95ee\u6743\u9650\u3002</li> <li>\u5141\u8bb8\u5c06\u6258\u7ba1\u4f5c\u4e1a\u53d1\u5e03\u5230\u591a\u4e2a\u5b58\u50a8\u5e93\uff0c\u53ef\u80fd\u4f1a\u663e\u793a\u4e0d\u540c\u7684\u5206\u652f\u6216\u66f4\u6539\u7c92\u5ea6\u3002</li> </ul> <p>\u5728Git\u9879\u76ee\u542f\u52a8\u7684\u65f6\u5019\uff0c\u542f\u52a8\u4e86\u53e6\u5916\u4e09\u4e2a\u5f00\u6e90\u5206\u5e03\u5f0fVCS\u9879\u76ee\u3002 \uff08\u5176\u4e2d\u4e4b\u4e00\uff0c<code>Mercurial</code>\uff0c\u5728\u5f00\u6e90\u5e94\u7528\u7a0b\u5e8f\u67b6\u6784\u7684\u7b2c1\u5377\u4e2d\u8fdb\u884c\u4e86\u8ba8\u8bba\u3002\uff09\u6240\u6709\u8fd9\u4e9bdVCS\u5de5\u5177\u90fd\u63d0\u4f9b\u4e86\u7a0d\u5fae\u4e0d\u540c\u7684\u65b9\u6cd5\u6765\u5b9e\u73b0\u9ad8\u5ea6\u7075\u6d3b\u7684\u5de5\u4f5c\u6d41\u7a0b\uff0c\u8fd9\u4e9b\u5de5\u4f5c\u6d41\u7a0b\u96c6\u4e2d\u4e86VCS\uff0c\u76f4\u5230\u5b83\u4eec\u65e0\u6cd5\u76f4\u63a5\u5904\u7406\u3002\u6ce8\u610f\uff1a<code>Subversion</code>\u6709\u4e00\u4e2a\u540d\u4e3aSVK\u7684\u6269\u5c55\uff0c\u7531\u4e0d\u540c\u7684\u5f00\u53d1\u4eba\u5458\u7ef4\u62a4\uff0c\u4ee5\u652f\u6301\u670d\u52a1\u5668\u5230\u670d\u52a1\u5668\u7684\u540c\u6b65\u3002</p> <p>\u4eca\u5929\u6d41\u884c\u4e14\u79ef\u6781\u7ef4\u62a4\u7684\u5f00\u6e90dVCS\u9879\u76ee\u5305\u62ec<code>Bazaar</code>\uff0c<code>Darcs</code>\uff0c<code>Fossil</code>\uff0c<code>Git</code>\uff0c<code>Mercurial</code>\u548c<code>Veracity</code>\u3002</p>"},{"location":"2019-03-21-Git%E6%9E%B6%E6%9E%84/#_3","title":"\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u8bbe\u8ba1","text":"<p>\u73b0\u5728\u662f\u9000\u4e00\u6b65\u770b\u770bGit\u7684\u66ff\u4ee3VCS\u89e3\u51b3\u65b9\u6848\u7684\u597d\u65f6\u673a\u3002\u4e86\u89e3\u4ed6\u4eec\u7684\u5dee\u5f02\u5c06\u4f7f\u6211\u4eec\u80fd\u591f\u63a2\u7d22\u5728\u5f00\u53d1Git\u65f6\u9762\u4e34\u7684\u67b6\u6784\u9009\u62e9\u3002</p> <p>\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u901a\u5e38\u6709\u4e09\u4e2a\u6838\u5fc3\u529f\u80fd\u8981\u6c42\uff0c\u5373\uff1a</p> <ul> <li>\u5185\u5bb9\u5b58\u50a8</li> <li>\u8ddf\u8e2a\u5185\u5bb9\u66f4\u6539\uff08\u5305\u62ec\u5408\u5e76\u5143\u6570\u636e\u7684\u5386\u53f2\u8bb0\u5f55\uff09</li> <li>\u4e0e\u534f\u4f5c\u8005\u5206\u53d1\u5185\u5bb9\u548c\u5386\u53f2\u8bb0\u5f55</li> </ul> <p>\u6ce8\u610f\uff1a\u4e0a\u8ff0\u7b2c\u4e09\u4e2a\u8981\u6c42<code>\u4e0d\u662f</code>\u6240\u6709VCS\u7684\u529f\u80fd\u8981\u6c42\u3002</p>"},{"location":"2019-03-21-Git%E6%9E%B6%E6%9E%84/#_4","title":"\u5185\u5bb9\u5b58\u50a8","text":"<p>\u7528\u4e8e\u5728VCS\u4e16\u754c\u4e2d\u5b58\u50a8\u5185\u5bb9\u7684\u6700\u5e38\u89c1\u8bbe\u8ba1\u9009\u62e9\u662f\u57fa\u4e8e\u589e\u91cf\u7684\u53d8\u66f4\u96c6\uff0c\u6216\u8005\u5177\u6709\u6709\u5411\u65e0\u73af\u56fe\uff08DAG\uff09\u5185\u5bb9\u8868\u793a\u3002</p> <p>\u57fa\u4e8eDelta\u7684\u53d8\u66f4\u96c6\u5c01\u88c5\u4e86\u6241\u5e73\u5185\u5bb9\u7684\u4e24\u4e2a\u7248\u672c\u4e4b\u95f4\u7684\u5dee\u5f02\uff0c\u4ee5\u53ca\u4e00\u4e9b\u5143\u6570\u636e\u3002\u5c06\u5185\u5bb9\u8868\u793a\u4e3a\u6709\u5411\u975e\u5faa\u73af\u56fe\u5305\u542b\u5f62\u6210\u5c42\u6b21\u7ed3\u6784\u7684\u5bf9\u8c61\uff0c\u8be5\u5c42\u6b21\u7ed3\u6784\u5c06\u5185\u5bb9\u7684\u6587\u4ef6\u7cfb\u7edf\u6811\u955c\u50cf\u4e3a\u63d0\u4ea4\u7684\u5feb\u7167\uff08\u5c3d\u53ef\u80fd\u91cd\u7528\u6811\u5185\u672a\u66f4\u6539\u7684\u5bf9\u8c61\uff09\u3002 Git\u4f7f\u7528\u4e0d\u540c\u7c7b\u578b\u7684\u5bf9\u8c61\u5c06\u5185\u5bb9\u5b58\u50a8\u4e3a\u6709\u5411\u975e\u5faa\u73af\u56fe\u3002\u672c\u7ae0\u540e\u9762\u7684\u201c\u5bf9\u8c61\u6570\u636e\u5e93\u201d\u90e8\u5206\u63cf\u8ff0\u4e86\u53ef\u4ee5\u5728Git\u5b58\u50a8\u5e93\u4e2d\u5f62\u6210DAG\u7684\u4e0d\u540c\u7c7b\u578b\u7684\u5bf9\u8c61\u3002</p>"},{"location":"2019-03-21-Git%E6%9E%B6%E6%9E%84/#_5","title":"\u63d0\u4ea4\u548c\u5408\u5e76\u5386\u53f2","text":"<p>\u5728\u5386\u53f2\u548c\u53d8\u66f4\u8ddf\u8e2a\u65b9\u9762\uff0c\u5927\u591a\u6570VCS\u8f6f\u4ef6\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\u4e4b\u4e00\uff1a </p> <ul> <li>\u7ebf\u6027\u5386\u53f2</li> <li>\u6709\u5411\u5386\u53f2\u7684\u6709\u5411\u65e0\u73af\u56fe</li> </ul> <p>Git\u518d\u6b21\u4f7f\u7528DAG\u6765\u5b58\u50a8\u5176\u5386\u53f2\u8bb0\u5f55\u3002\u6bcf\u4e2a\u63d0\u4ea4\u90fd\u5305\u542b\u6709\u5173\u5176\u7956\u5148\u7684\u5143\u6570\u636e; Git\u4e2d\u7684\u63d0\u4ea4\u53ef\u4ee5\u6709\u96f6\u4e2a\u6216\u591a\u4e2a\uff08\u7406\u8bba\u4e0a\u65e0\u9650\u5236\uff09\u7236\u63d0\u4ea4\u3002\u4f8b\u5982\uff0cGit\u5b58\u50a8\u5e93\u4e2d\u7684\u7b2c\u4e00\u4e2a\u63d0\u4ea4\u5c06\u5177\u6709\u96f6\u7236\u9879\uff0c\u800c\u4e09\u5411\u5408\u5e76\u7684\u7ed3\u679c\u5c06\u5177\u6709\u4e09\u4e2a\u7236\u9879\u3002 Git\u548cSubversion\u53ca\u5176\u7ebf\u6027\u5386\u53f2\u7956\u5148\u4e4b\u95f4\u7684\u53e6\u4e00\u4e2a\u4e3b\u8981\u533a\u522b\u662f\u5b83\u80fd\u591f\u76f4\u63a5\u652f\u6301\u5c06\u8bb0\u5f55\u5927\u591a\u6570\u5408\u5e76\u5386\u53f2\u6848\u4f8b\u7684\u5206\u652f\u3002</p> <p></p> <p>Git\u4f7f\u7528\u6709\u5411\u975e\u5faa\u73af\u56fe\u6765\u5b58\u50a8\u5185\u5bb9\uff0c\u4ece\u800c\u5b9e\u73b0\u5b8c\u5168\u5206\u652f\u529f\u80fd\u3002\u6587\u4ef6\u7684\u5386\u53f2\u8bb0\u5f55\u4ece\u5176\u76ee\u5f55\u7ed3\u6784\uff08\u901a\u8fc7\u8868\u793a\u76ee\u5f55\u7684\u8282\u70b9\uff09\u4e00\u76f4\u94fe\u63a5\u5230\u6839\u76ee\u5f55\uff0c\u7136\u540e\u6839\u76ee\u5f55\u94fe\u63a5\u5230\u63d0\u4ea4\u8282\u70b9\u3002\u53cd\u8fc7\u6765\uff0c\u8be5\u63d0\u4ea4\u8282\u70b9\u53ef\u4ee5\u5177\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u7236\u8282\u70b9\u3002\u8fd9\u4e3aGit\u63d0\u4f9b\u4e86\u4e24\u4e2a\u5c5e\u6027\uff0c\u4f7f\u6211\u4eec\u80fd\u591f\u4ee5\u6bd4\u4eceRCS\u6d3e\u751f\u7684VCS\u7cfb\u5217\u66f4\u660e\u786e\u7684\u65b9\u5f0f\u63a8\u65ad\u5386\u53f2\u548c\u5185\u5bb9\uff0c\u5373\uff1a</p> <ul> <li>\u5f53\u56fe\u4e2d\u7684\u5185\u5bb9\uff08\u5373\u6587\u4ef6\u6216\u76ee\u5f55\uff09\u8282\u70b9\u4e0e\u4e0d\u540c\u63d0\u4ea4\u4e2d\u7684\u5185\u5bb9\uff08\u5373Git\u4e2d\u7684SHA\uff09\u5177\u6709\u76f8\u540c\u7684\u5f15\u7528\u6807\u8bc6\u65f6\uff0c\u4e24\u4e2a\u8282\u70b9\u4fdd\u8bc1\u5305\u542b\u76f8\u540c\u7684\u5185\u5bb9\uff0c\u5141\u8bb8Git\u77ed\u8def\u5185\u5bb9\u6709\u6548\u5730\u5206\u5316\u3002</li> <li>\u5408\u5e76\u4e24\u4e2a\u5206\u652f\u65f6\uff0c\u6211\u4eec\u6b63\u5728\u5408\u5e76DAG\u4e2d\u4e24\u4e2a\u8282\u70b9\u7684\u5185\u5bb9\u3002 DAG\u5141\u8bb8Git\u201c\u6709\u6548\u201d\uff08\u4e0eVCS\u7684RCS\u7cfb\u5217\u76f8\u6bd4\uff09\u786e\u5b9a\u5171\u540c\u7684\u7956\u5148\u3002</li> </ul>"},{"location":"2019-03-21-Git%E6%9E%B6%E6%9E%84/#_6","title":"\u5206\u914d","text":"<p>VCS\u89e3\u51b3\u65b9\u6848\u901a\u8fc7\u4ee5\u4e0b\u4e09\u79cd\u65b9\u5f0f\u4e4b\u4e00\u5904\u7406\u9879\u76ee\u534f\u4f5c\u8005\u7684\u5de5\u4f5c\u526f\u672c\u5185\u5bb9\u5206\u53d1\uff1a</p> <ul> <li> <p>\u4ec5\u9650\u672c\u5730\uff1a\u9002\u7528\u4e8e\u6ca1\u6709\u4e0a\u8ff0\u7b2c\u4e09\u529f\u80fd\u8981\u6c42\u7684VCS\u89e3\u51b3\u65b9\u6848\u3002</p> </li> <li> <p>\u4e2d\u592e\u670d\u52a1\u5668\uff1a\u5bf9\u5b58\u50a8\u5e93\u7684\u6240\u6709\u66f4\u6539\u5fc5\u987b\u901a\u8fc7\u4e00\u4e2a\u7279\u5b9a\u7684\u5b58\u50a8\u5e93\u8fdb\u884c\u4ea4\u6613\uff0c\u4ee5\u4fbf\u5c06\u5176\u8bb0\u5f55\u5728\u5386\u53f2\u8bb0\u5f55\u4e2d\u3002</p> </li> <li>\u5206\u5e03\u5f0f\u6a21\u578b\uff1a\u901a\u5e38\u4f1a\u6709\u53ef\u516c\u5f00\u8bbf\u95ee\u7684\u5b58\u50a8\u5e93\u4f9b\u534f\u4f5c\u8005\u201c\u63a8\u9001\u201d\uff0c\u4f46\u662f\u53ef\u4ee5\u5728\u672c\u5730\u8fdb\u884c\u63d0\u4ea4\u5e76\u7a0d\u540e\u63a8\u9001\u5230\u8fd9\u4e9b\u516c\u5171\u8282\u70b9\uff0c\u4ece\u800c\u5141\u8bb8\u8131\u673a\u5de5\u4f5c\u3002</li> </ul> <p>\u4e3a\u4e86\u6f14\u793a\u6bcf\u4e2a\u4e3b\u8981\u8bbe\u8ba1\u9009\u62e9\u7684\u597d\u5904\u548c\u5c40\u9650\u6027\uff0c\u6211\u4eec\u5c06\u8003\u8651Subversion\u5b58\u50a8\u5e93\u548cGit\u5b58\u50a8\u5e93\uff08\u5728\u670d\u52a1\u5668\u4e0a\uff09\uff0c\u5177\u6709\u76f8\u540c\u7684\u5185\u5bb9\uff08\u5373\uff0cGit\u5b58\u50a8\u5e93\u4e2d\u9ed8\u8ba4\u5206\u652f\u7684HEAD\u5177\u6709\u4e0eSubversion\u5b58\u50a8\u5e93\u5728trunk\u4e0a\u7684\u6700\u65b0\u7248\u672c\uff09\u3002\u540d\u4e3aAlex\u7684\u5f00\u53d1\u4eba\u5458\u62e5\u6709Subversion\u5b58\u50a8\u5e93\u7684\u672c\u5730\u7b7e\u51fa\u548cGit\u5b58\u50a8\u5e93\u7684\u672c\u5730\u514b\u9686\u3002</p> <p>\u8ba9\u6211\u4eec\u8bf4Alex\u5728\u672c\u5730Subversion\u7ed3\u5e10\u4e2d\u66f4\u65391 MB\u6587\u4ef6\uff0c\u7136\u540e\u63d0\u4ea4\u66f4\u6539\u3002\u5728\u672c\u5730\uff0c\u6587\u4ef6\u7684\u7ed3\u5e10\u6a21\u62df\u6700\u65b0\u7684\u66f4\u6539\u5e76\u66f4\u65b0\u672c\u5730\u5143\u6570\u636e\u3002\u5728Alex\u5728\u96c6\u4e2d\u5f0fSubversion\u5b58\u50a8\u5e93\u4e2d\u63d0\u4ea4\u671f\u95f4\uff0c\u5728\u6587\u4ef6\u7684\u5148\u524d\u5feb\u7167\u548c\u65b0\u66f4\u6539\u4e4b\u95f4\u751f\u6210\u5dee\u5f02\uff0c\u5e76\u4e14\u6b64\u5dee\u5f02\u5b58\u50a8\u5728\u5b58\u50a8\u5e93\u4e2d\u3002</p> <p>\u4e0eGit\u7684\u5de5\u4f5c\u65b9\u5f0f\u5f62\u6210\u5bf9\u6bd4\u3002\u5f53Alex\u5bf9\u672c\u5730Git\u514b\u9686\u4e2d\u7684\u7b49\u6548\u6587\u4ef6\u8fdb\u884c\u76f8\u540c\u7684\u4fee\u6539\u65f6\uff0c\u66f4\u6539\u5c06\u9996\u5148\u5728\u672c\u5730\u8bb0\u5f55\uff0c\u7136\u540eAlex\u53ef\u4ee5\u5c06\u672c\u5730\u6302\u8d77\u7684\u63d0\u4ea4\u201c\u63a8\u9001\u201d\u5230\u516c\u5171\u5b58\u50a8\u5e93\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u4e0e\u9879\u76ee\u4e0a\u7684\u5176\u4ed6\u534f\u4f5c\u8005\u5171\u4eab\u5de5\u4f5c\u3002\u5bf9\u4e8e\u63d0\u4ea4\u6240\u5b58\u5728\u7684\u6bcf\u4e2aGit\u5b58\u50a8\u5e93\uff0c\u5185\u5bb9\u66f4\u6539\u7684\u5b58\u50a8\u65b9\u5f0f\u76f8\u540c\u3002\u5728\u672c\u5730\u63d0\u4ea4\uff08\u6700\u7b80\u5355\u7684\u60c5\u51b5\uff09\u65f6\uff0c\u672c\u5730Git\u5b58\u50a8\u5e93\u5c06\u521b\u5efa\u4e00\u4e2a\u65b0\u5bf9\u8c61\uff0c\u8868\u793a\u5df2\u66f4\u6539\u6587\u4ef6\u7684\u6587\u4ef6\uff08\u5176\u4e2d\u5305\u542b\u6240\u6709\u5185\u5bb9\uff09\u3002\u5bf9\u4e8e\u66f4\u6539\u6587\u4ef6\u4e0a\u65b9\u7684\u6bcf\u4e2a\u76ee\u5f55\uff08\u4ee5\u53ca\u5b58\u50a8\u5e93\u6839\u76ee\u5f55\uff09\uff0c\u5c06\u4f7f\u7528\u65b0\u6807\u8bc6\u7b26\u521b\u5efa\u65b0\u6811\u5bf9\u8c61\u3002\u4ece\u65b0\u521b\u5efa\u7684\u6307\u5411blob\u7684\u6839\u6811\u5bf9\u8c61\u5f00\u59cb\u521b\u5efaDAG\uff08\u91cd\u7528\u73b0\u6709blob\u5f15\u7528\uff0c\u5176\u4e2d\u6587\u4ef6\u5185\u5bb9\u5728\u6b64\u63d0\u4ea4\u4e2d\u672a\u66f4\u6539\uff09\u5e76\u5f15\u7528\u65b0\u521b\u5efa\u7684blob\u4ee3\u66ff\u5148\u524d\u6811\u5c42\u6b21\u7ed3\u6784\u4e2d\u8be5\u6587\u4ef6\u7684\u5148\u524dblob\u5bf9\u8c61\u3002 \uff08blob\u8868\u793a\u5b58\u50a8\u5728\u5b58\u50a8\u5e93\u4e2d\u7684\u6587\u4ef6\u3002\uff09</p> <p>\u6b64\u65f6\uff0c\u63d0\u4ea4\u4ecd\u7136\u662fAlex\u672c\u5730\u8bbe\u5907\u4e0a\u5f53\u524dGit\u514b\u9686\u7684\u672c\u5730\u63d0\u4ea4\u3002\u5f53Alex\u5c06\u63d0\u4ea4\u201c\u63a8\u9001\u201d\u5230\u53ef\u516c\u5f00\u8bbf\u95ee\u7684Git\u5b58\u50a8\u5e93\u65f6\uff0c\u6b64\u63d0\u4ea4\u5c06\u88ab\u53d1\u9001\u5230\u8be5\u5b58\u50a8\u5e93\u3002\u5728\u516c\u5171\u5b58\u50a8\u5e93\u9a8c\u8bc1\u63d0\u4ea4\u53ef\u4ee5\u5e94\u7528\u4e8e\u5206\u652f\u4e4b\u540e\uff0c\u76f8\u540c\u7684\u5bf9\u8c61\u5b58\u50a8\u5728\u516c\u5171\u5b58\u50a8\u5e93\u4e2d\uff0c\u4e0e\u6700\u521d\u5728\u672c\u5730Git\u5b58\u50a8\u5e93\u4e2d\u521b\u5efa\u7684\u4e00\u6837\u3002</p> <p>Git\u573a\u666f\u4e2d\u6709\u8bb8\u591a\u79fb\u52a8\u90e8\u4ef6\uff0c\u65e0\u8bba\u662f\u5728\u5e55\u540e\u8fd8\u662f\u7528\u6237\uff0c\u90fd\u8981\u6c42\u4ed6\u4eec\u660e\u786e\u8868\u8fbe\u4e0e\u8fdc\u7a0b\u5b58\u50a8\u5e93\u5171\u4eab\u66f4\u6539\u7684\u610f\u56fe\uff0c\u800c\u4e0d\u662f\u5c06\u66f4\u6539\u4f5c\u4e3a\u672c\u5730\u63d0\u4ea4\u8fdb\u884c\u8ddf\u8e2a\u3002\u4f46\u662f\uff0c\u8fd9\u4e24\u4e2a\u589e\u52a0\u7684\u590d\u6742\u7a0b\u5ea6\u4e3a\u56e2\u961f\u63d0\u4f9b\u4e86\u66f4\u5927\u7684\u5de5\u4f5c\u6d41\u7a0b\u548c\u53d1\u5e03\u529f\u80fd\u7075\u6d3b\u6027\uff0c\u5982\u4e0a\u9762\u201cGit\u7684\u8d77\u6e90\u201d\u90e8\u5206\u6240\u8ff0\u3002</p> <p>\u5728Subversion\u573a\u666f\u4e2d\uff0c\u534f\u4f5c\u8005\u5728\u51c6\u5907\u597d\u8ba9\u5176\u4ed6\u4eba\u67e5\u770b\u6240\u505a\u7684\u66f4\u6539\u65f6\uff0c\u4e0d\u5fc5\u8bb0\u5f97\u63a8\u9001\u5230\u516c\u5171\u8fdc\u7a0b\u5b58\u50a8\u5e93\u3002\u5f53\u5bf9\u8f83\u5927\u6587\u4ef6\u7684\u5c0f\u4fee\u6539\u53d1\u9001\u5230\u4e2d\u592eSubversion\u5b58\u50a8\u5e93\u65f6\uff0c\u5b58\u50a8\u7684\u589e\u91cf\u6bd4\u5b58\u50a8\u6bcf\u4e2a\u7248\u672c\u7684\u5b8c\u6574\u6587\u4ef6\u5185\u5bb9\u66f4\u6709\u6548\u3002\u4f46\u662f\uff0c\u6b63\u5982\u6211\u4eec\u7a0d\u540e\u5c06\u770b\u5230\u7684\uff0c\u6709\u4e00\u79cd\u89e3\u51b3\u65b9\u6cd5\uff0cGit\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u53ef\u4ee5\u5229\u7528\u5b83\u3002</p>"},{"location":"2019-03-21-Git%E6%9E%B6%E6%9E%84/#_7","title":"\u5de5\u5177\u5305","text":"<p>\u4eca\u5929\uff0cGit\u751f\u6001\u7cfb\u7edf\u5728\u8bb8\u591a\u64cd\u4f5c\u7cfb\u7edf\uff08\u5305\u62ec\u6700\u521d\u51e0\u4e4e\u4e0d\u652f\u6301\u7684Windows\uff09\u4e0a\u5305\u542b\u8bb8\u591a\u547d\u4ee4\u884c\u548cUI\u5de5\u5177\u3002\u5927\u591a\u6570\u8fd9\u4e9b\u5de5\u5177\u5927\u591a\u5efa\u7acb\u5728Git\u6838\u5fc3\u5de5\u5177\u5305\u4e4b\u4e0a\u3002</p> <p>\u7531\u4e8eGit\u6700\u521d\u662f\u7531Linus\u7f16\u5199\u7684\uff0c\u5e76\u4e14\u5b83\u5728Linux\u793e\u533a\u4e2d\u7684\u5f00\u53d1\uff0c\u56e0\u6b64\u5b83\u5728Unix\u547d\u4ee4\u884c\u5de5\u5177\u7684\u4f20\u7edf\u4e2d\u4f7f\u7528\u5de5\u5177\u5305\u8bbe\u8ba1\u7406\u5ff5\u3002</p> <p>Git\u5de5\u5177\u5305\u5206\u4e3a\u4e24\u90e8\u5206\uff1a<code>plumbing</code>\uff08\u8bd1\u8005\u6ce8\uff1a\u4e0d\u77e5\u600e\u4e48\u7ffb\u8bd1\ud83d\ude02\uff09\u548c<code>porcelain</code>\u3002plumbing\u7531\u4f4e\u7ea7\u547d\u4ee4\u7ec4\u6210\uff0c\u8fd9\u4e9b\u547d\u4ee4\u652f\u6301\u57fa\u672c\u5185\u5bb9\u8ddf\u8e2a\u548c\u6709\u5411\u65e0\u73af\u56fe\uff08DAG\uff09\u7684\u64cd\u4f5c\u3002porcelain\u662fgit\u547d\u4ee4\u7684\u8f83\u5c0f\u5b50\u96c6\uff0c\u5927\u591a\u6570Git\u6700\u7ec8\u7528\u6237\u53ef\u80fd\u9700\u8981\u4f7f\u7528\u5b83\u6765\u7ef4\u62a4\u5b58\u50a8\u5e93\u5e76\u5728\u5b58\u50a8\u5e93\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\u4ee5\u8fdb\u884c\u534f\u4f5c\u3002</p> <p>\u867d\u7136\u5de5\u5177\u5305\u8bbe\u8ba1\u63d0\u4f9b\u4e86\u8db3\u591f\u7684\u547d\u4ee4\u6765\u4e3a\u8bb8\u591a\u811a\u672c\u7f16\u5199\u8005\u63d0\u4f9b\u7ec6\u7c92\u5ea6\u7684\u529f\u80fd\u8bbf\u95ee\uff0c\u4f46\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u62b1\u6028\u7f3a\u5c11Git\u7684\u53ef\u94fe\u63a5\u5e93\u3002\u7531\u4e8eGit\u4e8c\u8fdb\u5236\u6587\u4ef6\u8c03\u7528<code>die()</code>\uff0c\u5b83\u4e0d\u662f<code>\u53ef\u91cd\u5165</code>\u7684\uff0cGUI\uff0cWeb\u63a5\u53e3\u6216\u66f4\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u670d\u52a1\u5fc5\u987b<code>fork/exec</code>\u5bf9Git\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u8c03\u7528\uff0c\u8fd9\u53ef\u80fd\u5f88\u6162\u3002</p> <p>\u6b63\u5728\u52aa\u529b\u6539\u5584\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u7684\u60c5\u51b5;\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u201c\u5f53\u524d\u548c\u672a\u6765\u5de5\u4f5c\u201d\u90e8\u5206\u3002</p>"},{"location":"2019-03-21-Git%E6%9E%B6%E6%9E%84/#_8","title":"\u5b58\u50a8\u5e93\u3001\u7d22\u5f15\u548c\u5de5\u4f5c\u533a\u57df","text":"<p>\u5982\u679c\u53ea\u662f\u4e3a\u4e86\u7406\u89e3\u4e00\u4e9b\u57fa\u672c\u6982\u5ff5\uff0c\u8ba9\u6211\u4eec\u4eb2\u81ea\u52a8\u624b\u5e76\u6df1\u5165\u4f7f\u7528Git\u672c\u5730\u5316\u3002 \u9996\u5148\u5728\u6211\u4eec\u7684\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u4e0a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u521d\u59cb\u5316Git\u5b58\u50a8\u5e93\uff08\u4f7f\u7528Unix\u7cfb\u7684\u64cd\u4f5c\u7cfb\u7edf\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u505a\uff1a</p> <pre><code>$ mkdir testgit\n$ cd testgit\n$ git init\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5728testgit\u76ee\u5f55\u4e2d\u6709\u4e00\u4e2a\u7a7a\u7684\u4f46\u5df2\u521d\u59cb\u5316\u7684Git\u5b58\u50a8\u5e93\u3002\u6211\u4eec\u53ef\u4ee5\u5206\u652f\uff0c\u63d0\u4ea4\uff0c\u6807\u8bb0\u751a\u81f3\u4e0e\u5176\u4ed6\u672c\u5730\u548c\u8fdc\u7a0bGit\u5b58\u50a8\u5e93\u8fdb\u884c\u901a\u4fe1\u3002\u5373\u4f7f\u53ea\u4f7f\u7528\u5c11\u91cfgit\u547d\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u4e0e\u5176\u4ed6\u7c7b\u578b\u7684VCS\u5b58\u50a8\u5e93\u8fdb\u884c\u901a\u4fe1\u3002</p> <p><code>git init</code>\u547d\u4ee4\u5728testgit\u4e2d\u521b\u5efa\u4e00\u4e2a<code>.git</code>\u5b50\u76ee\u5f55\u3002\u6211\u4eec\u6765\u770b\u770b\u5427\uff1a</p> <pre><code>$ tree .git/\n.git/\n|-- HEAD\n|-- config\n|-- description\n|-- hooks\n|   |-- applypatch-msg.sample\n|   |-- commit-msg.sample\n|   |-- post-commit.sample\n|   |-- post-receive.sample\n|   |-- post-update.sample\n|   |-- pre-applypatch.sample\n|   |-- pre-commit.sample\n|   |-- pre-rebase.sample\n|   |-- prepare-commit-msg.sample\n|   |-- update.sample\n|-- info\n|   |-- exclude\n|-- objects\n|   |-- info\n|   |-- pack\n|-- refs\n    |-- heads\n    |-- tags\n</code></pre> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4e0a\u9762\u7684<code>.git</code>\u76ee\u5f55\u662f\u6839\u5de5\u4f5c\u76ee\u5f55<code>testgit</code>\u7684\u5b50\u76ee\u5f55\u3002\u5b83\u5305\u542b\u4e00\u4e9b\u4e0d\u540c\u7c7b\u578b\u7684\u6587\u4ef6\u548c\u76ee\u5f55\uff1a</p> <ul> <li>\u914d\u7f6e\uff1a<code>.git/config</code>\uff0c<code>.git/description</code>\u548c<code>.git/info/exclude</code>\u6587\u4ef6\u672c\u8d28\u4e0a\u6709\u52a9\u4e8e\u914d\u7f6e\u672c\u5730\u5b58\u50a8\u5e93\u3002</li> <li>\u94a9\u5b50\uff1a<code>.git/hooks</code>\u76ee\u5f55\u5305\u542b\u53ef\u4ee5\u5728\u5b58\u50a8\u5e93\u7684\u67d0\u4e9b\u751f\u547d\u5468\u671f\u4e8b\u4ef6\u4e0a\u8fd0\u884c\u7684\u811a\u672c\u3002</li> <li>\u6682\u5b58\u533a\u57df\uff1a<code>.git/index</code>\u6587\u4ef6\uff08\u4e0a\u9762\u7684\u6811\u5217\u8868\u4e2d\u5c1a\u4e0d\u5b58\u5728\uff09\u5c06\u4e3a\u6211\u4eec\u7684\u5de5\u4f5c\u76ee\u5f55\u63d0\u4f9b\u6682\u5b58\u533a\u57df\u3002</li> <li>\u5bf9\u8c61\u6570\u636e\u5e93\uff1a<code>.git/objects</code>\u76ee\u5f55\u662f\u9ed8\u8ba4\u7684Git\u5bf9\u8c61\u6570\u636e\u5e93\uff0c\u5b83\u5305\u542b\u672c\u5730\u5185\u5bb9\u7684\u6240\u6709\u5185\u5bb9\u6216\u6307\u9488\u3002\u4e00\u65e6\u521b\u5efa\uff0c\u6240\u6709\u5bf9\u8c61\u90fd\u662f\u4e0d\u53ef\u53d8\u7684\u3002</li> <li>\u53c2\u8003\uff1a<code>.git/refs</code>\u76ee\u5f55\u662f\u5b58\u50a8\u672c\u5730\u548c\u8fdc\u7a0b\u5206\u652f\u3002\u6807\u7b7e\u548c\u5934\u90e8\u7684\u5f15\u7528\u6307\u9488\u7684\u9ed8\u8ba4\u4f4d\u7f6e\u3002\u5f15\u7528\u662f\u6307\u5411\u5bf9\u8c61\u7684\u6307\u9488\uff0c\u901a\u5e38\u662f\u7c7b\u578b<code>tag</code>\u6216<code>commit</code>\u3002\u5f15\u7528\u5728\u5bf9\u8c61\u6570\u636e\u5e93\u4e4b\u5916\u8fdb\u884c\u7ba1\u7406\uff0c\u4ee5\u5141\u8bb8\u5f15\u7528\u5728\u5b58\u50a8\u5e93\u53d1\u5c55\u65f6\u66f4\u6539\u5b83\u4eec\u6307\u5411\u7684\u4f4d\u7f6e\u3002\u5f15\u7528\u7684\u7279\u6b8a\u60c5\u51b5\u53ef\u80fd\u6307\u5411\u5176\u4ed6\u53c2\u8003\uff0c\u4f8b\u5982<code>HEAD</code>\u3002</li> </ul> <p><code>.git</code>\u76ee\u5f55\u662f\u5b9e\u9645\u7684\u5b58\u50a8\u5e93\u3002\u5305\u542b\u5de5\u4f5c\u6587\u4ef6\u96c6\u7684\u76ee\u5f55\u662f\u5de5\u4f5c\u76ee\u5f55\uff0c\u901a\u5e38\u662f<code>.git</code>\u76ee\u5f55\uff08\u6216\u5b58\u50a8\u5e93\uff09\u7684\u7236\u76ee\u5f55\u3002\u5982\u679c\u60a8\u6b63\u5728\u521b\u5efa\u4e00\u4e2a\u6ca1\u6709\u5de5\u4f5c\u76ee\u5f55\u7684Git\u8fdc\u7a0b\u5b58\u50a8\u5e93\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528<code>git init --bare</code>\u547d\u4ee4\u5bf9\u5176\u8fdb\u884c\u521d\u59cb\u5316\u3002\u8fd9\u5c06\u5728\u6839\u76ee\u5f55\u4e0b\u521b\u5efa\u7cbe\u7b80\u7684\u5b58\u50a8\u5e93\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u5c06\u5b58\u50a8\u5e93\u521b\u5efa\u4e3a\u5de5\u4f5c\u6811\u4e0b\u7684\u5b50\u76ee\u5f55\u3002</p> <p>\u53e6\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u6587\u4ef6\u662fGit\u7d22\u5f15<code>.git/index</code>\u3002\u5b83\u63d0\u4f9b\u672c\u5730\u5de5\u4f5c\u76ee\u5f55\u548c\u672c\u5730\u5b58\u50a8\u5e93\u4e4b\u95f4\u7684\u6682\u5b58\u533a\u57df\u3002\u7d22\u5f15\u7528\u4e8e\u5728\u4e00\u4e2a\u6587\u4ef6\uff08\u6216\u66f4\u591a\uff09\u4e2d\u6682\u5b58\u7279\u5b9a\u66f4\u6539\uff0c\u4ee5\u4fbf\u4e00\u8d77\u63d0\u4ea4\u3002\u5373\u4f7f\u60a8\u8fdb\u884c\u4e86\u4e0e\u5404\u79cd\u7c7b\u578b\u7684\u529f\u80fd\u76f8\u5173\u7684\u66f4\u6539\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u66f4\u6539\u8fdb\u884c\u63d0\u4ea4\uff0c\u4ee5\u4fbf\u5728\u63d0\u4ea4\u6d88\u606f\u4e2d\u66f4\u52a0\u903b\u8f91\u5730\u63cf\u8ff0\u5b83\u4eec\u3002\u8981\u6709\u9009\u62e9\u5730\u6682\u5b58\u6587\u4ef6\u6216\u6587\u4ef6\u96c6\u4e2d\u7684\u7279\u5b9a\u66f4\u6539\uff0c\u53ef\u4ee5\u4f7f\u7528<code>git add -p</code>\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cGit\u7d22\u5f15\u5b58\u50a8\u4e3a\u5b58\u50a8\u5e93\u76ee\u5f55\u4e2d\u7684\u5355\u4e2a\u6587\u4ef6\u3002\u53ef\u4ee5\u4f7f\u7528\u73af\u5883\u53d8\u91cf\u81ea\u5b9a\u4e49\u8fd9\u4e09\u4e2a\u533a\u57df\u7684\u8def\u5f84\u3002 \u7406\u89e3\u5728\u6267\u884c\u51e0\u4e2a\u6838\u5fc3Git\u547d\u4ee4\u671f\u95f4\u5728\u8fd9\u4e09\u4e2a\u533a\u57df\uff08\u5b58\u50a8\u5e93\uff0c\u7d22\u5f15\u548c\u5de5\u4f5c\u533a\u57df\uff09\u4e4b\u95f4\u53d1\u751f\u7684\u4ea4\u4e92\u662f\u6709\u5e2e\u52a9\u7684\uff1a</p> <ul> <li> <p><code>git checkout [branch]</code>\uff0c\u8fd9\u4f1a\u5c06\u672c\u5730\u5b58\u50a8\u5e93\u7684<code>HEAD</code>\u5f15\u7528\u79fb\u52a8\u5230\u5206\u652f\u5f15\u7528\u8def\u5f84\uff08\u4f8b\u5982<code>refs/heads/master</code>\uff09\uff0c\u4f7f\u7528\u6b64\u5934\u6570\u636e\u586b\u5145\u7d22\u5f15\u5e76\u5237\u65b0\u5de5\u4f5c\u76ee\u5f55\u4ee5\u8868\u793a\u8be5\u5934\u90e8\u7684\u6811\u3002</p> </li> <li> <p><code>git add [files]</code>\uff0c\u8fd9\u5c06\u4ea4\u53c9\u5f15\u7528\u4f7f\u7528Git\u7d22\u5f15\u4e2d\u76f8\u5e94\u6761\u76ee\u6307\u5b9a\u7684\u6587\u4ef6\u7684\u6821\u9a8c\u548c\uff0c\u4ee5\u67e5\u770b\u5206\u9636\u6bb5\u6587\u4ef6\u7684\u7d22\u5f15\u662f\u5426\u9700\u8981\u4f7f\u7528\u5de5\u4f5c\u76ee\u5f55\u7684\u7248\u672c\u8fdb\u884c\u66f4\u65b0\u3002 Git\u76ee\u5f55\uff08\u6216\u5b58\u50a8\u5e93\uff09\u4e2d\u6ca1\u6709\u4efb\u4f55\u53d8\u5316\u3002</p> </li> </ul> <p>\u8ba9\u6211\u4eec\u901a\u8fc7\u68c0\u67e5<code>.git</code>\u76ee\u5f55\uff08\u6216\u5b58\u50a8\u5e93\uff09\u4e0b\u7684\u6587\u4ef6\u5185\u5bb9\u6765\u66f4\u5177\u4f53\u5730\u63a2\u8ba8\u8fd9\u610f\u5473\u7740\u4ec0\u4e48\u3002</p> <pre><code>$ GIT_DIR=$PWD/.git\n$ cat $GIT_DIR/HEAD\n\nref: refs/heads/master\n\n$ MY_CURRENT_BRANCH=$(cat .git/HEAD | sed 's/ref: //g')\n$ cat $GIT_DIR/$MY_CURRENT_BRANCH\n\ncat: .git/refs/heads/master: No such file or directory\n</code></pre> <p>\u6211\u4eec\u5f97\u5230\u4e00\u4e2a\u9519\u8bef\uff0c\u56e0\u4e3a\u5728\u5bf9Git\u5b58\u50a8\u5e93\u8fdb\u884c\u4efb\u4f55\u63d0\u4ea4\u4e4b\u524d\uff0c\u9664\u4e86Git\u4e2d\u7684\u9ed8\u8ba4\u5206\u652f\uff08\u65e0\u8bba\u662f\u5426\u5b58\u5728\uff09\u4e4b\u5916\uff0c\u4e0d\u5b58\u5728\u4efb\u4f55\u5206\u652f\u3002</p> <p>\u73b0\u5728\uff0c\u5982\u679c\u6211\u4eec\u8fdb\u884c\u65b0\u7684\u63d0\u4ea4\uff0c\u5219\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f1a\u4e3a\u6b64\u63d0\u4ea4\u521b\u5efa\u4e3b\u5206\u652f\u3002\u8ba9\u6211\u4eec\u8fd9\u6837\u505a\uff08\u7ee7\u7eed\u5728\u540c\u4e00\u4e2ashell\u4e2d\uff0c\u4fdd\u7559\u5386\u53f2\u548c\u4e0a\u4e0b\u6587\uff09\uff1a</p> <pre><code>$ git commit -m \"Initial empty commit\" --allow-empty\n$ git branch\n\n* master\n\n$ cat $GIT_DIR/$MY_CURRENT_BRANCH\n\n3bce5b130b17b7ce2f98d17b2998e32b1bc29d68\n\n$ git cat-file -p $(cat $GIT_DIR/$MY_CURRENT_BRANCH)\n</code></pre> <p>\u6211\u4eec\u5728\u8fd9\u91cc\u5f00\u59cb\u770b\u5230\u7684\u662fGit\u5bf9\u8c61\u6570\u636e\u5e93\u4e2d\u7684\u5185\u5bb9\u8868\u793a\u3002</p>"},{"location":"2019-03-21-Git%E6%9E%B6%E6%9E%84/#_9","title":"\u5bf9\u8c61\u6570\u636e\u5e93","text":"<p>Git\u6709\u56db\u4e2a\u57fa\u672c\u7684\u539f\u59cb\u5bf9\u8c61\uff0c\u672c\u5730\u5b58\u50a8\u5e93\u4e2d\u7684\u6bcf\u79cd\u7c7b\u578b\u7684\u5185\u5bb9\u90fd\u662f\u56f4\u7ed5\u5b83\u6784\u5efa\u7684\u3002\u6bcf\u79cd\u5bf9\u8c61\u7c7b\u578b\u90fd\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a<code>\u7c7b\u578b</code>\uff0c<code>\u5927\u5c0f</code>\u548c<code>\u5185\u5bb9</code>\u3002\u539f\u59cb\u5bf9\u8c61\u7c7b\u578b\u662f\uff1a</p> <ul> <li>\u6811\uff1a\u8868\u793a\u5185\u5bb9\u76ee\u5f55\u65f6\uff0c\u6811\u4e2d\u7684\u5143\u7d20\u53ef\u4ee5\u662f\u53e6\u4e00\u4e2a\u6811\u6216blob\u3002</li> <li>Blob\uff1ablob\u8868\u793a\u5b58\u50a8\u5728\u5b58\u50a8\u5e93\u4e2d\u7684\u6587\u4ef6\u3002</li> <li>\u63d0\u4ea4\uff1a\u63d0\u4ea4\u6307\u5411\u8868\u793a\u8be5\u63d0\u4ea4\u7684\u9876\u7ea7\u76ee\u5f55\u7684\u6811\u4ee5\u53ca\u7236\u63d0\u4ea4\u548c\u6807\u51c6\u5c5e\u6027\u3002</li> <li>\u6807\u8bb0\uff1a\u6807\u8bb0\u5177\u6709\u540d\u79f0\uff0c\u5e76\u6307\u5411\u6807\u8bb0\u6240\u4ee3\u8868\u7684\u5b58\u50a8\u5e93\u5386\u53f2\u8bb0\u5f55\u4e2d\u7684\u63d0\u4ea4\u3002</li> </ul> <p>\u6240\u6709\u5bf9\u8c61\u57fa\u5143\u90fd\u7531SHA\u5f15\u7528\uff0c\u8fd9\u662f\u4e00\u4e2a40\u4f4d\u7684\u5bf9\u8c61\u6807\u8bc6\uff0c\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a</p> <ul> <li>\u5982\u679c\u4e24\u4e2a\u5bf9\u8c61\u76f8\u540c\uff0c\u5219\u5b83\u4eec\u5c06\u5177\u6709\u76f8\u540c\u7684SHA\u3002</li> <li>\u5982\u679c\u4e24\u4e2a\u5bf9\u8c61\u4e0d\u540c\uff0c\u5b83\u4eec\u5c06\u5177\u6709\u4e0d\u540c\u7684SHA\u3002</li> <li>\u5982\u679c\u4ec5\u90e8\u5206\u590d\u5236\u5bf9\u8c61\u6216\u53d1\u751f\u5176\u4ed6\u5f62\u5f0f\u7684\u6570\u636e\u635f\u574f\uff0c\u5219\u91cd\u65b0\u8ba1\u7b97\u5f53\u524d\u5bf9\u8c61\u7684SHA\u5c06\u8bc6\u522b\u6b64\u7c7b\u635f\u574f\u3002</li> </ul> <p>SHA\u7684\u524d\u4e24\u4e2a\u5c5e\u6027\u4e0e\u5bf9\u8c61\u7684\u8eab\u4efd\u76f8\u5173\uff0c\u5728\u542f\u7528Git\u7684\u5206\u5e03\u5f0f\u6a21\u578b\uff08Git\u7684\u7b2c\u4e8c\u4e2a\u76ee\u6807\uff09\u65f6\u6700\u6709\u7528\u3002\u540e\u4e00\u79cd\u5c5e\u6027\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e9b\u9632\u6b62\u8150\u8d25\u7684\u4fdd\u62a4\u63aa\u65bd\uff08Git\u7684\u7b2c\u4e09\u4e2a\u76ee\u6807\uff09\u3002</p> <p>\u5c3d\u7ba1\u4f7f\u7528\u57fa\u4e8eDAG\u7684\u5b58\u50a8\u7528\u4e8e\u5185\u5bb9\u5b58\u50a8\u548c\u5408\u5e76\u5386\u53f2\u7684\u7406\u60f3\u7ed3\u679c\uff0c\u4f46\u5bf9\u4e8e\u8bb8\u591a\u5b58\u50a8\u5e93\u800c\u8a00\uff0c\u589e\u91cf\u5b58\u50a8\u5c06\u6bd4\u4f7f\u7528\u677e\u6563DAG\u5bf9\u8c61\u66f4\u8282\u7701\u7a7a\u95f4\u3002</p>"},{"location":"2019-03-21-Git%E6%9E%B6%E6%9E%84/#_10","title":"\u5b58\u50a8\u548c\u538b\u7f29\u6280\u672f","text":"<p>Git\u901a\u8fc7\u4ee5\u538b\u7f29\u683c\u5f0f\u6253\u5305\u5bf9\u8c61\u6765\u89e3\u51b3\u5b58\u50a8\u7a7a\u95f4\u95ee\u9898\uff0c\u4f7f\u7528\u6307\u5411\u504f\u79fb\u91cf\u7684\u7d22\u5f15\u6587\u4ef6\u6765\u5b9a\u4f4d\u76f8\u5e94\u6253\u5305\u6587\u4ef6\u4e2d\u7684\u7279\u5b9a\u5bf9\u8c61\u3002</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528git count-objects\u8ba1\u7b97\u672c\u5730Git\u5b58\u50a8\u5e93\u4e2d\u7684\u677e\u6563\uff08\u6216\u89e3\u5305\uff09\u5bf9\u8c61\u7684\u6570\u91cf\u3002\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u8ba9Git\u5728\u5bf9\u8c61\u6570\u636e\u5e93\u4e2d\u6253\u5305\u677e\u6563\u5bf9\u8c61\uff0c\u5220\u9664\u5df2\u7ecf\u6253\u5305\u7684\u677e\u6563\u5bf9\u8c61\uff0c\u5e76\u6839\u636e\u9700\u8981\u4f7f\u7528Git\u7ba1\u9053\u547d\u4ee4\u67e5\u627e\u5197\u4f59\u5305\u6587\u4ef6\u3002</p> <p>Git\u4e2d\u7684\u5305\u6587\u4ef6\u683c\u5f0f\u5df2\u7ecf\u53d1\u5c55\uff0c\u521d\u59cb\u683c\u5f0f\u5728\u7d22\u5f15\u6587\u4ef6\u672c\u8eab\u4e2d\u5b58\u50a8\u5305\u6587\u4ef6\u548c\u7d22\u5f15\u6587\u4ef6\u7684CRC\u6821\u9a8c\u548c\u3002\u4f46\u662f\uff0c\u8fd9\u610f\u5473\u7740\u538b\u7f29\u6570\u636e\u4e2d\u53ef\u80fd\u5b58\u5728\u65e0\u6cd5\u68c0\u6d4b\u5230\u7684\u635f\u574f\uff0c\u56e0\u4e3a\u91cd\u65b0\u5305\u88c5\u9636\u6bb5\u4e0d\u6d89\u53ca\u4efb\u4f55\u8fdb\u4e00\u6b65\u7684\u68c0\u67e5\u3002\u5305\u6587\u4ef6\u683c\u5f0f\u7684\u7248\u672c2\u901a\u8fc7\u5728\u5305\u7d22\u5f15\u6587\u4ef6\u4e2d\u5305\u62ec\u6bcf\u4e2a\u538b\u7f29\u5bf9\u8c61\u7684CRC\u6821\u9a8c\u548c\u6765\u514b\u670d\u8be5\u95ee\u9898\u3002\u7248\u672c2\u8fd8\u5141\u8bb8\u5927\u4e8e4 GB\u7684packfiles\uff0c\u521d\u59cb\u683c\u5f0f\u4e0d\u652f\u6301\u3002\u4f5c\u4e3a\u5feb\u901f\u68c0\u6d4b\u5305\u6587\u4ef6\u635f\u574f\u7684\u4e00\u79cd\u65b9\u6cd5\uff0c\u5305\u6587\u4ef6\u7684\u672b\u5c3e\u5305\u542b\u8be5\u6587\u4ef6\u4e2d\u6240\u6709SHA\u7684\u6709\u5e8f\u5217\u8868\u768420\u5b57\u8282SHA1\u548c\u3002\u65b0\u7684\u5305\u6587\u4ef6\u683c\u5f0f\u7684\u91cd\u70b9\u662f\u5e2e\u52a9\u5b9e\u73b0Git\u7684\u7b2c\u4e8c\u4e2a\u53ef\u7528\u6027\u8bbe\u8ba1\u76ee\u6807\uff0c\u5373\u9632\u6b62\u6570\u636e\u635f\u574f\u3002</p> <p>\u5bf9\u4e8e\u8fdc\u7a0b\u901a\u4fe1\uff0cGit\u8ba1\u7b97\u9700\u8981\u901a\u8fc7\u7ebf\u8def\u53d1\u9001\u7684\u63d0\u4ea4\u548c\u5185\u5bb9\u4ee5\u540c\u6b65\u5b58\u50a8\u5e93\uff08\u6216\u4ec5\u4ec5\u662f\u5206\u652f\uff09\uff0c\u5e76\u52a8\u6001\u751f\u6210\u5305\u6587\u4ef6\u683c\u5f0f\u4ee5\u4f7f\u7528\u5ba2\u6237\u7aef\u7684\u6240\u9700\u534f\u8bae\u53d1\u56de\u3002</p>"},{"location":"2019-03-21-Git%E6%9E%B6%E6%9E%84/#_11","title":"\u5408\u5e76\u5386\u53f2","text":"<p>\u5982\u524d\u6240\u8ff0\uff0cGit\u5728\u5408\u5e76\u5386\u53f2\u65b9\u6cd5\u4e0a\u4e0eRCS VCS\u7cfb\u5217\u5728\u672c\u8d28\u4e0a\u6709\u6240\u4e0d\u540c\u3002\u4f8b\u5982\uff0cSubversion\u4ee5\u7ebf\u6027\u7ea7\u6570\u8868\u793a\u6587\u4ef6\u6216\u6811\u5386\u53f2;\u4efb\u4f55\u5177\u6709\u66f4\u9ad8\u7248\u672c\u53f7\u7684\u5185\u5bb9\u90fd\u5c06\u53d6\u4ee3\u4e4b\u524d\u7684\u4efb\u4f55\u5185\u5bb9\u3002\u4e0d\u76f4\u63a5\u652f\u6301\u5206\u652f\uff0c\u53ea\u80fd\u901a\u8fc7\u5b58\u50a8\u5e93\u4e2d\u7684\u672a\u5f3a\u5236\u76ee\u5f55\u7ed3\u6784\u3002</p> <p></p> <p>\u8ba9\u6211\u4eec\u9996\u5148\u4f7f\u7528\u4e00\u4e2a\u793a\u4f8b\u6765\u8bf4\u660e\u5728\u7ef4\u62a4\u5de5\u4f5c\u7684\u591a\u4e2a\u5206\u652f\u65f6\u8fd9\u53ef\u80fd\u4f1a\u6709\u4ec0\u4e48\u95ee\u9898\u3002\u7136\u540e\u6211\u4eec\u5c06\u770b\u4e00\u4e2a\u573a\u666f\u6765\u5c55\u793a\u5b83\u7684\u5c40\u9650\u6027\u3002</p> <p>\u5728\u5178\u578b\u7684\u6839<code>branches/branch-name</code>\u4e2d\u5904\u7406Subversion\u4e2d\u7684\u201c\u5206\u652f\u201d\u65f6\uff0c\u6211\u4eec\u6b63\u5728\u5904\u7406\u4e0e<code>trunk</code>\u76f8\u90bb\u7684\u76ee\u5f55\u5b50\u6811\uff08\u901a\u5e38\u662f\u5b9e\u65f6\u6216\u4e3b\u7b49\u6548\u4ee3\u7801\u6240\u5728\u7684\u76ee\u5f55\u5b50\u6811\uff09\u3002\u8ba9\u6211\u4eec\u8bf4\u8fd9\u4e2a\u5206\u652f\u4ee3\u8868<code>trunk</code>\u6811\u7684\u5e76\u884c\u5f00\u53d1\u3002</p> <p>\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u80fd\u6b63\u5728\u91cd\u5199\u4ee3\u7801\u5e93\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u6570\u636e\u5e93\u3002\u901a\u8fc7\u6211\u4eec\u7684\u91cd\u5199\u7684\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u5e0c\u671b\u5408\u5e76\u6765\u81ea\u53e6\u4e00\u4e2a\u5206\u652f\u5b50\u6811\uff08\u4e0d\u662f<code>trunk</code>\uff09\u7684\u4e0a\u6e38\u66f4\u6539\u3002\u5982\u6709\u5fc5\u8981\uff0c\u6211\u4eec\u4f1a\u624b\u52a8\u5408\u5e76\u8fd9\u4e9b\u66f4\u6539\uff0c\u7136\u540e\u7ee7\u7eed\u8fdb\u884c\u91cd\u5199\u3002\u5f53\u5929\u665a\u4e9b\u65f6\u5019\uff0c\u6211\u4eec\u5728<code>branches/branch-name</code>\u5206\u652f\u4e0a\u5b8c\u6210\u6570\u636e\u5e93\u4f9b\u5e94\u5546\u8fc1\u79fb\u4ee3\u7801\u66f4\u6539\uff0c\u5e76\u5c06\u6211\u4eec\u7684\u66f4\u6539\u5408\u5e76\u5230<code>trunk</code>\u4e2d\u3002\u50cfSubversion\u8fd9\u6837\u7684\u7ebf\u6027\u5386\u53f2VCS\u5904\u7406\u8fd9\u4e2a\u95ee\u9898\u7684\u65b9\u6cd5\u662f\uff0c\u65e0\u6cd5\u77e5\u9053\u6765\u81ea\u53e6\u4e00\u4e2a\u5206\u652f\u7684\u53d8\u66f4\u96c6\u73b0\u5728\u5305\u542b\u5728<code>trunk</code>\u4e2d\u3002</p> <p>\u57fa\u4e8eDAG\u7684\u5408\u5e76\u5386\u53f2VCS\uff0c\u5982Git\uff0c\u53ef\u4ee5\u5f88\u597d\u5730\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u3002\u5047\u8bbe\u5176\u4ed6\u5206\u652f\u4e0d\u5305\u542b\u5c1a\u672a\u5408\u5e76\u5230\u6211\u4eec\u7684\u6570\u636e\u5e93\u4f9b\u5e94\u5546\u8fc1\u79fb\u5206\u652f\u4e2d\u7684\u63d0\u4ea4\uff08\u4f8b\u5982\uff0c\u6211\u4eec\u7684Git\u5b58\u50a8\u5e93\u4e2d\u7684db-migration\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u63d0\u4ea4\u5bf9\u8c61\u7236\u5173\u7cfb\u786e\u5b9adb-migration\u4e0a\u7684\u63d0\u4ea4branch\u5305\u542b\u53e6\u4e00\u4e2a\u4e0a\u6e38\u5206\u652f\u7684tip\uff08\u6216HEAD\uff09\u3002\u8bf7\u6ce8\u610f\uff0c\u63d0\u4ea4\u5bf9\u8c61\u53ef\u4ee5\u5177\u6709\u96f6\u6216\u66f4\u591a\uff08\u4ec5\u9650\u4e8e\u5408\u5e76\u7684\u80fd\u529b\uff09\u7236\u9879\u3002\u56e0\u6b64\uff0cdb-migration\u5206\u652f\u4e0a\u7684\u5408\u5e76\u63d0\u4ea4\u77e5\u9053\u5b83\u901a\u8fc7\u7236\u8282\u70b9\u7684SHA\u54c8\u5e0c\u503c\u5408\u5e76\u5230\u5f53\u524d\u5206\u652f\u7684\u5f53\u524dHEAD\u548c\u53e6\u4e00\u4e2a\u4e0a\u6e38\u5206\u652f\u7684HEAD\u4e2d\u3002\u5728master\u4e2d\u7684\u5408\u5e76\u63d0\u4ea4\uff08Git\u4e2d\u7684trunk\u7b49\u4ef7\u7269\uff09\u4e5f\u662f\u5982\u6b64\u3002</p> <p>\u4f7f\u7528\u57fa\u4e8eDAG\uff08\u548c\u57fa\u4e8e\u7ebf\u6027\uff09\u7684\u5408\u5e76\u5386\u53f2\u5f88\u96be\u660e\u786e\u56de\u7b54\u7684\u95ee\u9898\u662f\u6bcf\u4e2a\u5206\u652f\u4e2d\u5305\u542b\u54ea\u4e9b\u63d0\u4ea4\u3002\u4f8b\u5982\uff0c\u5728\u4e0a\u9762\u7684\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u5047\u8bbe\u6211\u4eec\u5c06\u6765\u81ea\u4e24\u4e2a\u5206\u652f\u7684\u6240\u6709\u66f4\u6539\u5408\u5e76\u5230\u6bcf\u4e2a\u5206\u652f\u4e2d\u3002\u60c5\u51b5\u53ef\u80fd\u5e76\u975e\u5982\u6b64\u3002 \u5bf9\u4e8e\u66f4\u7b80\u5355\u7684\u60c5\u51b5\uff0cGit\u80fd\u591f\u4ece\u5176\u4ed6\u5206\u652f\u4e2d\u63d0\u53d6\u63d0\u4ea4\u5230\u5f53\u524d\u5206\u652f\uff0c\u5047\u8bbe\u63d0\u4ea4\u53ef\u4ee5\u5e72\u51c0\u5730\u5e94\u7528\u4e8e\u5206\u652f\u3002</p>"},{"location":"2019-03-21-Git%E6%9E%B6%E6%9E%84/#_12","title":"\u4e0b\u4e00\u6b65\uff1f","text":"<p>\u5982\u524d\u6240\u8ff0\uff0c\u6211\u4eec\u4eca\u5929\u6240\u77e5\u7684Git\u6838\u5fc3\u57fa\u4e8eUnix\u4e16\u754c\u7684\u5de5\u5177\u5305\u8bbe\u8ba1\u7406\u5ff5\uff0c\u8fd9\u5bf9\u4e8e\u811a\u672c\u975e\u5e38\u65b9\u4fbf\uff0c\u4f46\u5bf9\u4e8e\u5d4c\u5165\u5185\u90e8\u6216\u4e0e\u66f4\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u6216\u670d\u52a1\u94fe\u63a5\u4e0d\u592a\u6709\u7528\u3002\u867d\u7136\u76ee\u524d\u5728\u8bb8\u591a\u6d41\u884c\u7684\u96c6\u6210\u5f00\u53d1\u73af\u5883\u4e2d\u90fd\u6709Git\u652f\u6301\uff0c\u4f46\u6dfb\u52a0\u6b64\u652f\u6301\u5e76\u7ef4\u62a4\u5b83\u6bd4\u96c6\u6210\u5bf9VCS\u7684\u652f\u6301\u66f4\u5177\u6311\u6218\u6027\uff0cVCS\u4e3a\u591a\u4e2a\u5e73\u53f0\u63d0\u4f9b\u6613\u4e8e\u94fe\u63a5\u548c\u5171\u4eab\u7684\u5e93\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cShawn Pearce\uff08\u8c37\u6b4c\u7684\u5f00\u6e90\u9879\u76ee\u529e\u516c\u5ba4\uff09\u5e26\u5934\u52aa\u529b\u521b\u5efa\u4e00\u4e2a\u53ef\u94fe\u63a5\u7684Git\u5e93\uff0c\u5176\u4e2d\u5305\u542b\u66f4\u591a\u8bb8\u53ef\uff0c\u4e0d\u4f1a\u7981\u6b62\u4f7f\u7528\u8be5\u5e93\u3002\u8fd9\u88ab\u79f0\u4e3alibgit2\u3002\u76f4\u5230\u4e00\u4f4d\u540d\u53ebVincent Marti\u7684\u5b66\u751f\u53bb\u5e74\u4e3a\u4ed6\u7684Google Summer of Code\u9879\u76ee\u9009\u62e9\u5b83\u4e4b\u540e\uff0c\u5b83\u624d\u6709\u4e86\u592a\u5927\u7684\u5438\u5f15\u529b\u3002\u4ece\u90a3\u65f6\u8d77\uff0cVincent\u548cGithub\u5de5\u7a0b\u5e08\u7ee7\u7eed\u4e3alibgit2\u9879\u76ee\u505a\u51fa\u8d21\u732e\uff0c\u5e76\u4e3a\u8bb8\u591a\u5176\u4ed6\u6d41\u884c\u8bed\u8a00\uff08\u5982Ruby\uff0cPython\uff0cPHP\uff0c.NET\u8bed\u8a00\uff0cLua\u548cObjective-C\uff09\u521b\u5efa\u4e86\u7ed1\u5b9a\u3002</p> <p>Shawn Pearce\u8fd8\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3aJGit\u7684BSD\u8bb8\u53ef\u7eafJava\u5e93\uff0c\u5b83\u652f\u6301Git\u5b58\u50a8\u5e93\u4e0a\u7684\u8bb8\u591a\u5e38\u89c1\u64cd\u4f5c\u3002\u5b83\u73b0\u5728\u7531Eclipse Foundation\u7ef4\u62a4\uff0c\u7528\u4e8eEclipse IDE Git\u96c6\u6210\u3002</p> <p>Git\u6838\u5fc3\u9879\u76ee\u4e4b\u5916\u7684\u5176\u4ed6\u6709\u8da3\u548c\u5b9e\u9a8c\u6027\u7684\u5f00\u6e90\u5de5\u4f5c\u662f\u4f7f\u7528\u66ff\u4ee3\u6570\u636e\u5b58\u50a8\u4f5c\u4e3aGit\u5bf9\u8c61\u6570\u636e\u5e93\u7684\u540e\u7aef\u7684\u8bb8\u591a\u5b9e\u73b0\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>jgit_cassandra\uff0c\u5b83\u4f7f\u7528Apache Cassandra\u63d0\u4f9bGit\u5bf9\u8c61\u6301\u4e45\u6027\uff0cApache Cassandra\u662f\u4e00\u4e2a\u6df7\u5408\u6570\u636e\u5b58\u50a8\u533a\uff0c\u4f7f\u7528Dynamo\u98ce\u683c\u7684\u5206\u5e03\u548cBigTable\u5217\u65cf\u6570\u636e\u6a21\u578b\u8bed\u4e49\u3002</li> <li>jgit_hbase\uff0c\u5b83\u5141\u8bb8\u5bf9\u5b58\u50a8\u5728HBase\uff08\u5206\u5e03\u5f0f\u952e\u503c\u6570\u636e\u5b58\u50a8\u533a\uff09\u4e2d\u7684Git\u5bf9\u8c61\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\u3002</li> <li>libgit2-backends\uff0c\u8fd9\u662f\u4ecelibgit2\u52aa\u529b\u4e3a\u591a\u4e2a\u6d41\u884c\u7684\u6570\u636e\u5b58\u50a8\u521b\u5efaGit\u5bf9\u8c61\u6570\u636e\u5e93\u540e\u7aef\u800c\u4ea7\u751f\u7684\uff0c\u4f8b\u5982Memcached\uff0cRedis\uff0cSQLite\u548cMySQL\u3002</li> </ul> <p>\u6240\u6709\u8fd9\u4e9b\u5f00\u6e90\u9879\u76ee\u90fd\u72ec\u7acb\u4e8eGit\u6838\u5fc3\u9879\u76ee\u8fdb\u884c\u7ef4\u62a4\u3002</p> <p>\u5982\u60a8\u6240\u89c1\uff0c\u4eca\u5929\u6709\u5f88\u591a\u79cd\u65b9\u6cd5\u53ef\u4ee5\u4f7f\u7528Git\u683c\u5f0f\u3002</p> <p>Git\u7684\u9762\u8c8c\u4e0d\u518d\u4ec5\u4ec5\u662fGit Core\u9879\u76ee\u7684\u5de5\u5177\u5305\u547d\u4ee4\u884c\u754c\u9762;\u800c\u662f\u5b58\u50a8\u5e93\u683c\u5f0f\u548c\u534f\u8bae\u5728\u5b58\u50a8\u5e93\u4e4b\u95f4\u5171\u4eab\u3002</p> <p>\u5728\u64b0\u5199\u672c\u6587\u65f6\uff0c\u6839\u636e\u4ed6\u4eec\u7684\u5f00\u53d1\u4eba\u5458\u7684\u8bf4\u6cd5\uff0c\u5927\u591a\u6570\u8fd9\u4e9b\u9879\u76ee\u8fd8\u6ca1\u6709\u8fbe\u5230\u7a33\u5b9a\u7248\u672c\uff0c\u56e0\u6b64\u8be5\u9886\u57df\u7684\u5de5\u4f5c\u4ecd\u7136\u9700\u8981\u5b8c\u6210\uff0c\u4f46Git\u7684\u672a\u6765\u4f3c\u4e4e\u5f88\u5149\u660e\u3002</p>"},{"location":"2019-03-21-Git%E6%9E%B6%E6%9E%84/#_13","title":"\u5f97\u5230\u7684\u6559\u8bad","text":"<p>\u5728\u8f6f\u4ef6\u4e2d\uff0c\u6bcf\u4e2a\u8bbe\u8ba1\u51b3\u7b56\u6700\u7ec8\u90fd\u662f\u4e00\u79cd\u6743\u8861\u3002\u4f5c\u4e3aGit\u7684\u7248\u672c\u63a7\u5236\u7684\u5f3a\u5927\u7528\u6237\uff0c\u4ee5\u53ca\u56f4\u7ed5Git\u5bf9\u8c61\u6570\u636e\u5e93\u6a21\u578b\u5f00\u53d1\u8f6f\u4ef6\u7684\u4eba\uff0c\u6211\u5bf9Git\u76ee\u524d\u7684\u5f62\u5f0f\u975e\u5e38\u559c\u7231\u3002\u56e0\u6b64\uff0c\u8fd9\u4e9b\u7ecf\u9a8c\u6559\u8bad\u66f4\u591a\u5730\u53cd\u6620\u4e86\u7531\u4e8e\u8bbe\u8ba1\u51b3\u7b56\u548cGit\u6838\u5fc3\u5f00\u53d1\u4eba\u5458\u5173\u6ce8\u7126\u70b9\u800c\u5f15\u8d77\u7684\u5173\u4e8eGit\u7684\u5e38\u89c1\u53cd\u590d\u62b1\u6028\u3002</p> <p>\u8bc4\u4f30Git\u7684\u5f00\u53d1\u4eba\u5458\u548c\u7ecf\u7406\u6700\u5e38\u89c1\u7684\u62b1\u6028\u4e4b\u4e00\u5c31\u662f\u7f3a\u4e4f\u4e0e\u5176\u4ed6VCS\u5de5\u5177\u76f8\u540c\u7684IDE\u96c6\u6210\u3002 Git\u7684\u5de5\u5177\u5305\u8bbe\u8ba1\u4f7f\u5176\u6bd4\u5c06\u5176\u4ed6\u73b0\u4ee3VCS\u5de5\u5177\u96c6\u6210\u5230IDE\u548c\u76f8\u5173\u5de5\u5177\u4e2d\u66f4\u5177\u6311\u6218\u6027\u3002</p> <p>\u5728Git\u7684\u65e9\u671f\u5386\u53f2\u4e2d\uff0c\u4e00\u4e9b\u547d\u4ee4\u662f\u4f5c\u4e3ashell\u811a\u672c\u5b9e\u73b0\u7684\u3002\u8fd9\u4e9bshell\u811a\u672c\u547d\u4ee4\u5b9e\u73b0\u4f7fGit\u4e0d\u90a3\u4e48\u4fbf\u643a\uff0c\u5c24\u5176\u662f\u5bf9Windows\u3002\u6211\u786e\u4fe1Git\u6838\u5fc3\u5f00\u53d1\u4eba\u5458\u5e76\u6ca1\u6709\u56e0\u6b64\u800c\u5931\u7720\uff0c\u4f46\u7531\u4e8eGit\u5f00\u53d1\u521d\u671f\u666e\u904d\u5b58\u5728\u7684\u53ef\u79fb\u690d\u6027\u95ee\u9898\uff0c\u5b83\u5bf9\u5927\u578b\u7ec4\u7ec7\u4e2dGit\u7684\u91c7\u7528\u4ea7\u751f\u4e86\u8d1f\u9762\u5f71\u54cd\u3002\u4eca\u5929\uff0c\u4e00\u4e2a\u540d\u4e3aGit for Windows\u7684\u9879\u76ee\u5df2\u7531\u5fd7\u613f\u8005\u542f\u52a8\uff0c\u4ee5\u786e\u4fdd\u65b0\u7248\u672c\u7684Git\u53ca\u65f6\u79fb\u690d\u5230Windows\u3002</p> <p>\u4f7f\u7528\u5927\u91cf\u7ba1\u9053\u547d\u4ee4\u56f4\u7ed5\u5de5\u5177\u5305\u8bbe\u8ba1\u8bbe\u8ba1Git\u7684\u95f4\u63a5\u540e\u679c\u662f\u65b0\u7528\u6237\u5f88\u5feb\u5c31\u4f1a\u4e22\u5931;\u4ece\u6df7\u6dc6\u6240\u6709\u53ef\u7528\u7684\u5b50\u547d\u4ee4\u5230\u65e0\u6cd5\u7406\u89e3\u9519\u8bef\u6d88\u606f\uff0c\u56e0\u4e3a\u4f4e\u7ea7\u522b\u7684\u7ba1\u9053\u4efb\u52a1\u5931\u8d25\uff0c\u65b0\u7528\u6237\u6709\u5f88\u591a\u5730\u65b9\u8bef\u5165\u6b67\u9014\u3002\u8fd9\u4f7f\u5f97\u4e00\u4e9b\u5f00\u53d1\u56e2\u961f\u66f4\u96be\u4ee5\u91c7\u7528Git\u3002</p> <p>\u5373\u4f7f\u6709\u5173\u4e8eGit\u7684\u8fd9\u4e9b\u62b1\u6028\uff0c\u6211\u5bf9Git Core\u9879\u76ee\u7684\u672a\u6765\u53d1\u5c55\u7684\u53ef\u80fd\u6027\u4ee5\u53ca\u4ece\u5b83\u542f\u52a8\u7684\u6240\u6709\u76f8\u5173\u5f00\u6e90\u9879\u76ee\u611f\u5230\u5174\u594b\u3002</p>"},{"location":"2019-04-19-class-visualizer%E2%80%94%E2%80%94%E4%B8%80%E4%B8%AA%E6%9F%A5%E7%9C%8B%E7%B1%BB%E5%85%B3%E7%B3%BB%E7%9A%84%E5%9B%BE%E5%BD%A2%E5%8C%96%E5%B7%A5%E5%85%B7/","title":"2019 04 19 class visualizer\u2014\u2014\u4e00\u4e2a\u67e5\u770b\u7c7b\u5173\u7cfb\u7684\u56fe\u5f62\u5316\u5de5\u5177","text":"<p>\u672c\u4eba\u4f7f\u7528\u7684<code>IntelliJ IDEA Community Edition</code>\u6ca1\u6709<code>Class Diagram</code>\u529f\u80fd\uff0c\u5728\u901b<code>stackoverflow</code>\u65f6\uff0c\u53d1\u73b0\u4e86\u5de5\u5177Class Visualizer\uff0c\u901a\u8fc7\u52a0\u8f7dJar\u5305\u7684\u5f62\u5f0f\u7ed8\u5236\u7c7b\u5173\u7cfb\u56fe\u8868\uff0c\u5728\u9605\u8bfb\u5f00\u6e90\u9879\u76ee\u6e90\u4ee3\u7801\u65f6\u80fd\u63d0\u4f9b\u5e2e\u52a9\uff0c\u4e0b\u56fe\u662f<code>io.netty.channel.Channel</code>\u7684\u5173\u7cfb\u56fe\uff1a</p> <p></p> <p>\u4e0b\u56fe\u662f\u5176\u7c7b\u56fe\uff1a</p> <p></p> <p>\u771f\u9999\ud83d\ude0b</p> <p>\u53c2\u8003\uff1a</p> <ul> <li>Class diagrams - Help | IntelliJ IDEA - JetBrains</li> <li>Sketch It! - Plugins | JetBrains</li> <li>Application to generate Java class hierarchy diagram</li> </ul>"},{"location":"2019-04-19-%E6%A0%91%E8%8E%93%E6%B4%BE%E7%94%B5%E6%BA%90%E6%9C%80%E5%A4%A7%E5%8C%96/","title":"2019 04 19 \u6811\u8393\u6d3e\u7535\u6e90\u6700\u5927\u5316","text":"<p>\u5728\u5c06<code>\u65e0\u7535\u6e90</code>\u7684USB\u79fb\u52a8\u786c\u76d8\u8fde\u63a5\u5728\u6811\u8393\u6d3e\u4e0a\u65f6\uff0c\u4f1a\u53d1\u73b0\u65e0\u6cd5\u6b63\u5e38\u9a71\u52a8\uff0c\u5728\u79fb\u52a8\u786c\u76d8\u65e0\u6545\u969c\u7684\u524d\u63d0\u4e0b\u662f\u6811\u8393\u6d3e<code>\u9ed8\u8ba4\u6ca1\u6709\u5141\u8bb8USB\u7535\u6d41\u6700\u5927</code>\uff0c\u7ecf\u8fc7\u8c37\u6b4c\ud83e\uddb4\uff0c\u627e\u5230\u5982\u4e0b\u89e3\u51b3\u529e\u6cd5\uff1a</p> <p>\u5728\u6587\u4ef6<code>/boot/config.txt</code>\u4e2d\u6dfb\u52a0\uff1a</p> <pre><code>max_usb_current=1\n</code></pre> <p>\u91cd\u542f\u5373\u53ef\u3002</p> <p>\u53c2\u8003\uff1a</p> <ul> <li>https://www.raspberrypi.org/forums/viewtopic.php?t=105502</li> </ul>"},{"location":"2019-04-20-%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%AD%89%E7%BA%A7%E6%8F%90%E4%BA%A4%E8%AF%BB%E4%B8%8E%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%E7%9A%84%E5%8C%BA%E5%88%AB/","title":"2019 04 20 \u4e8b\u52a1\u9694\u79bb\u7b49\u7ea7\u63d0\u4ea4\u8bfb\u4e0e\u53ef\u91cd\u590d\u8bfb\u7684\u533a\u522b","text":"<p>\u7ffb\u8bd1\u81eaDifferences between READ-COMMITTED and REPEATABLE-READ transaction isolation levels</p> <p>\u4f5c\u4e3a<code>Percona</code>\u7684\u8bb2\u5e08\uff0c\u6211\u6709\u65f6\u4f1a\u88ab\u95ee\u53ca<code>\u5df2\u63d0\u4ea4\u8bfb</code>\u548c<code>\u53ef\u91cd\u590d\u8bfb</code>\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u4e4b\u95f4\u7684\u533a\u522b\uff0c\u5b83\u4eec\u5b58\u5728\u4e00\u4e9b\u5dee\u5f02\uff0c\u4f46\u90fd\u4e0e<code>\u9501\u5b9a</code>\u6709\u5173\u3002</p>"},{"location":"2019-04-20-%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%AD%89%E7%BA%A7%E6%8F%90%E4%BA%A4%E8%AF%BB%E4%B8%8E%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%E7%9A%84%E5%8C%BA%E5%88%AB/#_1","title":"\u989d\u5916\u9501\u5b9a (\u975e\u95f4\u9699\u9501\u5b9a)","text":"<p>\u8bf7\u8bb0\u4f4f\uff0c<code>InnoDB</code>\u5b9e\u9645\u4e0a\u9501\u5b9a\u4e86\u7d22\u5f15\u6761\u76ee\uff08index entries\uff09\uff0c\u800c\u4e0d\u662f\u884c\uff08rows\uff09\uff0c\u8fd9\u5f88\u91cd\u8981\u3002\u5728\u6267\u884c\u8bed\u53e5\u671f\u95f4\uff0cInnoDB\u5fc5\u987b\u9501\u5b9a\u5b83\u904d\u5386\u7684\u7d22\u5f15\u4e2d\u7684\u6bcf\u4e2a\u6761\u76ee\uff0c\u4ee5\u67e5\u627e\u5b83\u6b63\u5728\u4fee\u6539\u7684\u884c\u3002\u4ed6\u5fc5\u987b\u8fd9\u6837\u505a\u4ee5\u9632\u6b62\u6b7b\u9501\u5e76\u4fdd\u6301\u9694\u79bb\u7ea7\u522b\u3002</p> <p>\u82e5\u6267\u884c\u4e00\u53e5<code>\u672a\u88ab</code>\u826f\u597d\u7d22\u5f15\u7684<code>UPDATE</code>\u8bed\u53e5\uff0c\u5219\u4f1a\u9501\u5b9a\u5f88\u591a\u884c\uff1a</p> <pre><code>update employees set store_id = 0 where store_id = 1;\n---TRANSACTION 1EAB04, ACTIVE 7 sec\n-- 633 lock struct(s), &lt;strong&gt;heap size 96696&lt;/strong&gt;, 218786 row lock(s), undo log entries 1\n-- MySQL thread id 4, OS thread handle 0x7f8dfc35d700, query id 47 localhost root\n-- show engine innodb status\n</code></pre> <p>\u5728<code>employee</code>\u8868\u4e2d\uff0c\u5217<code>store_id</code>\u6ca1\u6709\u88ab\u7d22\u5f15\u3002\u8bf7\u6ce8\u610f\uff0cUPDATE\u5df2\u7ecf\u5b8c\u6210\u8fd0\u884c\uff08\u6211\u4eec\u73b0\u5728\u6b63\u5728\u8fd0\u884cSHOW ENGINE ...\uff09\u4f46\u662f\u6211\u4eec\u6301\u6709<code>218786</code>\u4e2a\u884c\u9501\u5e76\u4e14\u53ea\u6709\u4e00\u4e2a\u64a4\u9500\u6761\u76ee\uff08undo entry\uff09\u3002\u8fd9\u610f\u5473\u7740\u53ea\u6709\u4e00\u884c\u88ab\u66f4\u6539\uff0c\u4f46\u6211\u4eec\u4ecd\u7136\u6301\u6709\u989d\u5916\u7684\u9501\u3002\u5806\u5927\u5c0f\u8868\u793a\u5df2\u4e3a\u9501\u5206\u914d\u7684\u5185\u5b58\u91cf\u3002</p> <ul> <li> <p>\u5728<code>\u53ef\u91cd\u590d\u8bfb</code>\u4e2d\uff0c\u5728\u4e8b\u52a1\u671f\u95f4\u4fdd\u6301\u7684\u6bcf\u4e2a\u9501\u90fd\u5728\u4e8b\u52a1\u671f\u95f4\u4fdd\u6301\u3002\uff08In REPEATABLE READ <code>every lock</code> acquired during a transaction <code>is held</code> for the duration of the transaction.\uff09</p> </li> <li> <p>\u5728<code>\u5df2\u63d0\u4ea4\u8bfb</code>\u4e2d\uff0c\u4e0e\u626b\u63cf\u4e0d\u5339\u914d\u7684\u9501\u4f1a\u5728<code>\u8bed\u53e5\u5b8c\u6210</code>\u540e\u88ab\u91ca\u653e\u3002</p> </li> </ul> <p>\u4e0b\u9762\u662f\u5728<code>\u5df2\u63d0\u4ea4\u8bfb</code>\u4e0b\u7684UPDATE\u8bed\u53e5\u6267\u884c\uff1a</p> <pre><code>---TRANSACTION 1EAB06, ACTIVE 11 sec\n-- 631 lock struct(s), &lt;strong&gt;heap size 96696&lt;/strong&gt;, 1 row lock(s), undo log entries 1\n-- MySQL thread id 4, OS thread handle 0x7f8dfc35d700, query id 62 localhost root\n-- show engine innodb status\n</code></pre> <p>\u60a8\u4f1a\u6ce8\u610f\u5230\u5806\u5927\u5c0f\u662f\u76f8\u540c\u7684\uff0c\u4f46\u73b0\u5728\u53ea\u6301\u6709\u4e00\u4e2a\u9501\u3002\u5728\u6240\u6709\u4e8b\u7269\u9694\u79bb\u7ea7\u522b\u4e2d\uff0cInnoDB\u4f1a\u5bf9\u626b\u63cf\u7684\u6bcf\u4e2a\u7d22\u5f15\u9501\u5b9a\u3002\u7ea7\u522b\u4e4b\u95f4\u7684\u5dee\u5f02\u662f\uff0c\u4e00\u65e6\u8bed\u53e5\u5728<code>\u5df2\u63d0\u4ea4\u8bfb</code>\u6a21\u5f0f\u4e0b\u5b8c\u6210\uff0c\u5c31\u4f1a\u9488\u5bf9\u626b\u63cf\u4e0d\u5339\u914d\u7684\u6761\u76ee\u91ca\u653e\u9501\u3002\u8bf7\u6ce8\u610f\uff0cInnoDB\u5728\u91ca\u653e\u9501\u4e4b\u540e<code>\u4e0d\u4f1a</code>\u7acb\u5373\u91ca\u653e\u5806\u5185\u5b58\uff0c\u56e0\u6b64\u5806\u5927\u5c0f\u4e0e\u53ef\u91cd\u590d\u8bfb\u7684\u5806\u5927\u5c0f\u76f8\u540c\uff0c\u4f46\u4fdd\u6301\u7684\u9501\u6570\u91cf\u8f83\u5c11\uff08\u4ec5\u4ec5\u4e00\u4e2a\uff09\u3002</p> <p>\u8fd9\u610f\u5473\u7740\u5728\u5df2\u63d0\u4ea4\u8bfb\u4e2d\uff0c\u4e00\u65e6UPDATE\u8bed\u53e5\u5b8c\u6210\uff0c\u5176\u4ed6\u4e8b\u52a1\u53ef\u4ee5\u81ea\u7531\u66f4\u65b0\u4ed6\u4eec\u5728\u53ef\u91cd\u590d\u8bfb\u4e2d\u65e0\u6cd5\u66f4\u65b0\u7684\u884c\u3002</p>"},{"location":"2019-04-20-%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%AD%89%E7%BA%A7%E6%8F%90%E4%BA%A4%E8%AF%BB%E4%B8%8E%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%E7%9A%84%E5%8C%BA%E5%88%AB/#_2","title":"\u4e00\u81f4\u8bfb\u89c6\u56fe","text":"<p>\u53ef\u91cd\u590d\u8bfb\u4e2d\uff0c\u5728\u4e8b\u52a1\u5f00\u59cb\u65f6\u521b\u5efa\u4e86\u201c\u8bfb\u53d6\u89c6\u56fe\uff08read view\uff09\u201d\uff08trx_no\u6ca1\u6709\u770b\u5230trx_id &gt;= ABC\uff0c\u770b\u5230&lt; ABB\uff09\uff0c\u5e76\u4e14\u6b64\u8bfb\u53d6\u89c6\u56fe\uff08Oracle\u672f\u8bed\u4e2d\u7684consistent snapshot\uff09\u5728\u4e8b\u52a1\u7684\u6301\u7eed\u65f6\u95f4\u5185\u4fdd\u6301\u6253\u5f00\u72b6\u6001\u3002\u540c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff0c\u51cc\u66685\u70b9\u6267\u884cSELECT\u8bed\u53e5\uff0c\u4e0e\u5728\u4e0b\u53485\u70b9\u6267\u884c\u7684\u7ed3\u679c\u96c6\u76f8\u540c\u3002\u8fd9\u79f0\u4e3aMVCC\uff08\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236\uff09\uff0c\u5b83\u4f7f\u7528\u884c\u7248\u672c\u63a7\u5236\uff08row versioning\uff09\u548c\u64a4\u9500\u4fe1\u606f\uff08undo information\uff09\u6765\u5b8c\u6210\u3002</p> <p>\u5728\u53ef\u91cd\u590d\u8bfb\u4e2d\uff0cInnoDB\u8fd8\u672a\u8303\u56f4\u626b\u63cf\u521b\u5efa\u95f4\u9699\u9501\uff08gap locking\uff09\uff1a</p> <pre><code>select * from some_table where id &gt; 100 FOR UPDATE\uff1b\n</code></pre> <p>\u4e0a\u9762\u8fd9\u6761\u4f1a\u521b\u5efa\u4e00\u4e2a\u95f4\u9699\u9501\uff0c\u4ee5\u963b\u6b62\u4efb\u4f55<code>id &gt; 100</code>\u7684\u884c\u63d2\u5165\uff0c\u76f4\u81f3\u4e8b\u52a1\u56de\u6eda\u6216\u63d0\u4ea4\u3002</p> <p>\u5728\u540c\u4e00\u4e8b\u52a1\u4e2d\uff0c\u82e5<code>SELECT ... FOR UPDATE</code>\u5728\u51cc\u66685\u70b9\u8fd0\u884c\uff0cUPDATE\u5728\u4e0b\u53485\u70b9\u8fd0\u884c\uff08<code>UPDATE some_table</code>\uff0c\u5176\u4e2d<code>id &gt; 100</code>\uff09\u5219UPDATE\u5c06\u6539\u53d8SELECT FOR UPDATE\u5728\u51cc\u66685\u70b9\u9501\u5b9a\u7684\u76f8\u540c\u884c\u3002\u4e0d\u53ef\u80fd\u66f4\u6539\u5176\u4ed6\u884c\uff0c\u56e0\u4e3a\u5728<code>100\u4e4b\u540e\u7684\u95f4\u9699</code>\u5148\u524d\u5df2\u88ab\u9501\u5b9a\u3002</p>"},{"location":"2019-04-20-%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%AD%89%E7%BA%A7%E6%8F%90%E4%BA%A4%E8%AF%BB%E4%B8%8E%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%E7%9A%84%E5%8C%BA%E5%88%AB/#_3","title":"\u4e0d\u53ef\u91cd\u590d\u8bfb\uff08\u5df2\u63d0\u4ea4\u8bfb\uff09","text":"<p>\u5df2\u63d0\u4ea4\u8bfb\u4e2d\uff0c\u5728\u6bcf\u4e2a\u8bed\u53e5\u7684\u5f00\u5934\u521b\u5efa\u4e00\u4e2a\u8bfb\u53d6\u89c6\u56fe\u3002\u8fd9\u610f\u5473\u7740\u5728\u540c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff0c\u51cc\u66685\u70b9\u4e0e\u4e0b\u53485\u70b9\u6267\u884c\u7684\u76f8\u540c\u7684SELECT\u8bed\u53e5\u7ed3\u679c\u96c6\u6709\u53ef\u80fd\u662f\u4e0d\u540c\u7684\u3002\u8fd9\u662f\u56e0\u4e3a\u5728\u5df2\u63d0\u4ea4\u8bfb\u4e2d\uff0c\u4e8b\u52a1\u7684\u8bfb\u53d6\u89c6\u56fe<code>\u53ea\u4f1a\u5728\u8bed\u53e5\u6267\u884c\u671f\u95f4</code>\u6301\u7eed\uff0c\u56e0\u6b64\uff0c\u8fde\u7eed\u6267\u884c\u7684\u76f8\u540c\u7684\u8bed\u53e5\u53ef\u80fd\u4f1a\u663e\u793a\u4e0d\u540c\u7ed3\u679c\u3002</p> <p>\u8fd9\u79f0\u4e3a<code>\u5e7b\u884c\uff08phantom row\uff09</code>\u95ee\u9898\u3002</p> <p>\u6b64\u5916\uff0c\u5df2\u63d0\u4ea4\u8bfb\u4e2d\uff0c\u6c38\u8fdc\u4e0d\u4f1a\u521b\u5efa\u95f4\u9699\u9501\u3002\u7531\u4e8e\u6ca1\u6709\u95f4\u9699\u9501\u5b9a\uff0c\u4e0a\u9762\u7684\u5b9e\u4f8bSELECT ... FOR UPDATE\u4e0d\u4f1a\u8bfb\u4e4b\u5176\u4ed6\u4e8b\u52a1\u5c06\u65b0\u884c\u63d2\u5165\u3002\u56e0\u6b64\uff0c\u4f7f\u7528SELECT ... FOR UPDATE\u9501\u5b9a\u884c\uff08\u5373\"where id &gt; 100\"\uff09\u5e76\u968f\u540e\u4f7f\u7528\"where id &gt; 100\"\uff08\u5373\u4f7f\u5728\u7edf\u4e00\u4e8b\u52a1\u4e2d\uff09\u66f4\u65b0\u884c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u66f4\u65b0\u7684\u884c\u6bd4<code>\u5148\u524d\u9501\u5b9a</code>\u7684\u884c\u66f4\u591a\u3002\u8fd9\u662f\u56e0\u4e3a\u5728\u8bed\u53e5\u4e4b\u95f4\u7684\u8868\u4e2d\u53ef\u80fd\u63d2\u5165\u4e86\u65b0\u884c\uff0c\u56e0\u4e3a\u6ca1\u6709\u4e3aSELECT ... FOR UPDATE\u521b\u5efa\u95f4\u9699\u9501\u3002</p>"},{"location":"2019-04-26-MySQL%E4%B8%AD%E7%9A%84%E5%B9%B6%E3%80%81%E5%B7%AE%E3%80%81%E4%BA%A4%E5%92%8C%E9%99%A4%E8%BF%90%E7%AE%97/","title":"2019 04 26 MySQL\u4e2d\u7684\u5e76\u3001\u5dee\u3001\u4ea4\u548c\u9664\u8fd0\u7b97","text":"<p>\u7ffb\u8bd1\u81eaUnion, Difference, Intersection, and Division in MySQL</p>"},{"location":"2019-04-26-MySQL%E4%B8%AD%E7%9A%84%E5%B9%B6%E3%80%81%E5%B7%AE%E3%80%81%E4%BA%A4%E5%92%8C%E9%99%A4%E8%BF%90%E7%AE%97/#_1","title":"\u6784\u5efa\u6570\u636e\u5e93","text":"<pre><code>-- \u521b\u5efaa\u548cb\u8868\nCREATE TABLE a (x INT, y VARCHAR(5));\nCREATE TABLE b (x INT, y VARCHAR(5));\n-- \u63d2\u5165\u6570\u636e\u5230a\u8868\nINSERT INTO a(x,y) VALUES(1,'A');\nINSERT INTO a(x,y) VALUES(2,'B');\nINSERT INTO a(x,y) VALUES(3,'C');\nINSERT INTO a(x,y) VALUES(4,'D');\n-- \u63d2\u5165\u6570\u636e\u5230b\u8868\nINSERT INTO b(x,y) VALUES(1,'A');\nINSERT INTO b(x,y) VALUES(3,'C');\n\nSELECT * FROM a;\n+------+------+\n| x    | y    |\n+------+------+\n|    1 | A    |\n|    2 | B    |\n|    3 | C    |\n|    4 | D    |\n+------+------+\n\nSELECT * FROM b;\n+------+------+\n| x    | y    |\n+------+------+\n|    1 | A    |\n|    3 | C    |\n+------+------+\n</code></pre>"},{"location":"2019-04-26-MySQL%E4%B8%AD%E7%9A%84%E5%B9%B6%E3%80%81%E5%B7%AE%E3%80%81%E4%BA%A4%E5%92%8C%E9%99%A4%E8%BF%90%E7%AE%97/#union","title":"\u5e76\u96c6(Union)","text":"<pre><code>SELECT * FROM a UNION SELECT * FROM b;\n+------+------+\n| x | y |\n+------+------+\n| 1 | A |\n| 2 | B |\n| 3 | C |\n| 4 | D |\n+------+------+\n\nSELECT * FROM a UNION ALL SELECT * FROM b;\n+------+------+\n| x | y |\n+------+------+\n| 1 | A |\n| 2 | B |\n| 3 | C |\n| 4 | D |\n| 1 | A |\n| 3 | C |\n+------+------+\n</code></pre>"},{"location":"2019-04-26-MySQL%E4%B8%AD%E7%9A%84%E5%B9%B6%E3%80%81%E5%B7%AE%E3%80%81%E4%BA%A4%E5%92%8C%E9%99%A4%E8%BF%90%E7%AE%97/#difference","title":"\u5dee\u96c6(Difference)","text":"<pre><code>SELECT * FROM a WHERE (x,y) NOT IN (SELECT * FROM b);\n+------+------+\n| x | y |\n+------+------+\n| 2 | B |\n| 4 | D |\n+------+------+\n\nSELECT * FROM a\nWHERE NOT EXISTS (SELECT * FROM b WHERE b.x = a.x AND b.y = a.y);\n+------+------+\n| x | y |\n+------+------+\n| 2 | B |\n| 4 | D |\n+------+------+\n\n-- \u6700\u9ad8\u6548\u7684\u65b9\u5f0f\nSELECT DISTINCT a.x AS x, a.y AS y\nFROM a LEFT OUTER JOIN b USING (x, y) WHERE b.x IS NULL;\n+------+------+\n| x | y |\n+------+------+\n| 2 | B |\n| 4 | D |\n+------+------+\n</code></pre>"},{"location":"2019-04-26-MySQL%E4%B8%AD%E7%9A%84%E5%B9%B6%E3%80%81%E5%B7%AE%E3%80%81%E4%BA%A4%E5%92%8C%E9%99%A4%E8%BF%90%E7%AE%97/#intersection","title":"\u4ea4\u96c6(Intersection)","text":"<pre><code>SELECT * FROM a WHERE (x,y) IN (SELECT * FROM b)\n+------+------+\n| x | y |\n+------+------+\n| 1 | A |\n| 3 | C |\n+------+------+\n\nSELECT * FROM a\nWHERE EXISTS (SELECT * FROM b WHERE b.x=a.x AND b.y = a.y);\n+------+------+\n| x | y |\n+------+------+\n| 1 | A |\n| 3 | C |\n+------+------+\n\n-- \u6700\u9ad8\u6548\u7684\u65b9\u5f0f\nSELECT DISTINCT a.x AS x, a.y AS y\nFROM a INNER JOIN b USING (x,y);\n+------+------+\n| x | y |\n+------+------+\n| 1 | A |\n| 3 | C |\n+------+------+\n</code></pre>"},{"location":"2019-04-26-MySQL%E4%B8%AD%E7%9A%84%E5%B9%B6%E3%80%81%E5%B7%AE%E3%80%81%E4%BA%A4%E5%92%8C%E9%99%A4%E8%BF%90%E7%AE%97/#_2","title":"\u6784\u5efa\u6570\u636e\u5e93","text":"<pre><code>-- \u521b\u5efac\u548cd\u8868\nCREATE TABLE c (x INT, y VARCHAR(5));\nCREATE TABLE d (x INT);\n-- \u63d2\u5165\u6570\u636e\u5230c\u8868\nINSERT INTO c(x,y) VALUES(1,'A');\nINSERT INTO c(x,y) VALUES(2,'A');\nINSERT INTO c(x,y) VALUES(3,'A');\nINSERT INTO c(x,y) VALUES(1,'B');\nINSERT INTO c(x,y) VALUES(2,'B');\nINSERT INTO c(x,y) VALUES(3,'C');\nINSERT INTO c(x,y) VALUES(3,'D');\n-- \u63d2\u5165\u6570\u636e\u5230d\u8868\nINSERT INTO d(x) VALUES(1);\nINSERT INTO d(x) VALUES(2);\nINSERT INTO d(x) VALUES(3);\n</code></pre>"},{"location":"2019-04-26-MySQL%E4%B8%AD%E7%9A%84%E5%B9%B6%E3%80%81%E5%B7%AE%E3%80%81%E4%BA%A4%E5%92%8C%E9%99%A4%E8%BF%90%E7%AE%97/#division","title":"\u9664\u6cd5(Division)","text":"<pre><code>SELECT DISTINCT c1.y AS y\nFROM c c1\nWHERE NOT EXISTS\n(SELECT d.x FROM d\nWHERE d.x NOT IN (SELECT c2.x FROM c c2 WHERE c2.y = c1.y));\n+------+\n| y |\n+------+\n| A |\n+------+\n\nSELECT DISTINCT c1.y AS y\nFROM c c1\nWHERE NOT EXISTS\n(SELECT * FROM d\nWHERE NOT EXISTS (SELECT * FROM c c2 WHERE c2.y = c1.y AND c2.x = d.x));\n+------+\n| y |\n+------+\n| A |\n+------+\n</code></pre> <p>\u4e0d\u8d77\u4f5c\u7528\u7684SQL\uff1a</p> <pre><code>-- does not work;\nSELECT DISTINCT c1.y AS y\nFROM c c1\nWHERE NOT EXISTS\n(SELECT d.x FROM d LEFT OUTER JOIN c c2 USING (x)\nWHERE c2.y = c1.y AND c2.x IS NULL );\n+------+\n| y |\n+------+\n| A |\n| B |\n| C |\n| D |\n+------+\n-- does not work;\nSELECT DISTINCT c1.y AS y\nFROM c c1\nWHERE NOT EXISTS\n(SELECT * FROM d LEFT OUTER JOIN c c2\nON (d.x = c2.x) WHERE c2.y = c1.y AND c2.x IS NULL );\n+------+\n| y |\n+------+\n| A |\n| B |\n| C |\n| D |\n+------+\n-- does not work;\nSELECT DISTINCT c1.y AS y\nFROM c c1\nWHERE NOT EXISTS\n(SELECT * FROM d LEFT OUTER JOIN c c2\nON (d.x = c2.x AND c2.y = c1.y AND c2.x IS NULL) );\nERROR 1054 (42S22): Unknown column 'c1.y' in 'on clause'\n</code></pre>"},{"location":"2019-04-26-MySQL%E4%B8%AD%E7%9A%84%E5%B9%B6%E3%80%81%E5%B7%AE%E3%80%81%E4%BA%A4%E5%92%8C%E9%99%A4%E8%BF%90%E7%AE%97/#_3","title":"\u53c2\u8003","text":"<ul> <li>\u6df1\u5165\u8cc7\u6599\u5eab\u4e4b\u7f8e\u5b78</li> </ul>"},{"location":"2019-05-01-%E5%8F%AF%E6%89%A9%E5%B1%95%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%EF%BC%9Aepoll%E4%B8%8Ekqueue/","title":"2019 05 01 \u53ef\u6269\u5c55\u7684\u4e8b\u4ef6\u591a\u8def\u590d\u7528\uff1aepoll\u4e0ekqueue","text":"<p>\u7ffb\u8bd1\u81eaScalable Event Multiplexing: epoll vs. kqueue</p> <p>\u6211\u6bd4<code>BSD</code>\u66f4\u559c\u6b22<code>Linux</code>\uff0c\u4f46\u6211\u786e\u5b9e\u60f3\u5728Linux\u4e2d\u4f7f\u7528BSD\u7684<code>kqueue</code>\u529f\u80fd\u3002</p>"},{"location":"2019-05-01-%E5%8F%AF%E6%89%A9%E5%B1%95%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%EF%BC%9Aepoll%E4%B8%8Ekqueue/#event-multiplexing","title":"\u4ec0\u4e48\u662f\u4e8b\u4ef6\u591a\u8def\u590d\u7528\uff08event multiplexing\uff09","text":"<p>\u5047\u8bbe\u60a8\u6709\u4e00\u4e2a\u7b80\u5355\u7684Web\u670d\u52a1\u5668\uff0c\u5e76\u4e14\u5f53\u524d\u6709\u4e24\u4e2a\u6253\u5f00\u7684\u8fde\u63a5\uff08\u5957\u63a5\u5b57\uff09\u3002\u5f53\u670d\u52a1\u5668\u4ece\u4efb\u4e00\u8fde\u63a5\u6536\u5230HTTP\u8bf7\u6c42\u65f6\uff0c\u5b83\u5e94\u8be5\u5411\u5ba2\u6237\u7aef\u53d1\u9001HTTP\u54cd\u5e94\u3002\u4f46\u662f\u4f60\u4e0d\u77e5\u9053\u4e24\u4e2a\u5ba2\u6237\u7aef\u4e2d\u7684\u54ea\u4e00\u4e2a\u4f1a\u5148\u53d1\u9001\u6d88\u606f\uff0c\u4f55\u65f6\u53d1\u9001\u6d88\u606f\u3002<code>BSD Socket API</code>\u7684\u963b\u585e\u884c\u4e3a\u610f\u5473\u7740\u5982\u679c\u5728\u4e00\u4e2a\u8fde\u63a5\u4e0a\u8c03\u7528<code>recv()</code>\uff0c\u60a8\u5c06\u65e0\u6cd5\u54cd\u5e94\u53e6\u4e00\u4e2a\u8fde\u63a5\u4e0a\u7684\u8bf7\u6c42\u3002\u8fd9\u662f\u60a8\u9700\u8981I/O\u591a\u8def\u590d\u7528\uff08I/O multiplexing\uff09\u7684\u5730\u65b9\u3002</p> <p>I/O\u590d\u7528\u7684\u4e00\u79cd\u7b80\u5355\u65b9\u6cd5\u662f\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u63d0\u4f9b\u4e00\u4e2a\u8fdb\u7a0b/\u7ebf\u7a0b\uff0c\u4ee5\u4fbf\u5728\u4e00\u4e2a\u8fde\u63a5\u4e2d\u963b\u585e\u4e0d\u4f1a\u5f71\u54cd\u5176\u4ed6\u8fde\u63a5\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u60a8\u53ef\u4ee5\u6709\u6548\u5730\u5c06\u6240\u6709\u6bdb\u8338\u8338\u7684\u8c03\u5ea6/\u591a\u8def\u590d\u7528\u95ee\u9898\u59d4\u6258\u7ed9OS\u5185\u6838\u3002\u8fd9\u79cd\u591a\u7ebf\u7a0b\u67b6\u6784\u5e26\u6765\uff08\u53ef\u4ee5\u8bf4\uff09\u9ad8\u6210\u672c\u3002\u7ef4\u62a4\u5927\u91cf\u7ebf\u7a0b\u5bf9\u4e8e\u5185\u6838\u6765\u8bf4\u5e76\u975e\u6613\u4e8b\u3002\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u8bbe\u7f6e\u5355\u72ec\u7684\u5806\u6808\u4f1a\u589e\u52a0\u5185\u5b58\u5360\u7528\uff0c\u4ece\u800c\u964d\u4f4eCPU<code>\u7f13\u5b58\u5c40\u90e8\u6027\uff08cache locality\uff09</code>\u3002</p> <p>\u5982\u4f55\u5728\u6ca1\u6709\u7ebf\u7a0b\u8fde\u63a5\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0I / O\u590d\u7528\uff1f\u60a8\u53ef\u4ee5\u4f7f\u7528\u975e\u963b\u585e\u5957\u63a5\u5b57\u64cd\u4f5c\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u6267\u884c\u7e41\u5fd9\u7b49\u5f85\u8f6e\u8be2\uff0c\u4f46\u8fd9\u592a\u6d6a\u8d39\u4e86\u3002\u6211\u4eec\u9700\u8981\u77e5\u9053\u7684\u662f\u54ea\u4e2a\u5957\u63a5\u5b57\u51c6\u5907\u597d\u4e86\u3002\u56e0\u6b64\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u5728\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u548c\u5185\u6838\u4e4b\u95f4\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5355\u72ec\u7684\u901a\u9053\uff0c\u6b64\u901a\u9053\u4f1a\u5728\u60a8\u7684\u67d0\u4e9b\u5957\u63a5\u5b57\u51c6\u5907\u5c31\u7eea\u65f6\u901a\u77e5\u3002\u8fd9\u5c31\u662f<code>select()/poll()</code>\u7684\u5de5\u4f5c\u539f\u7406\uff0c\u57fa\u4e8e<code>\u5c31\u7eea\u6a21\u578b\uff08readiness model\uff09</code>\u3002</p>"},{"location":"2019-05-01-%E5%8F%AF%E6%89%A9%E5%B1%95%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%EF%BC%9Aepoll%E4%B8%8Ekqueue/#select","title":"\u56de\u987e\uff1aselect()","text":"<p>select()\u548cpoll()\u5728\u5b83\u4eec\u7684\u5de5\u4f5c\u65b9\u5f0f\u4e0a\u975e\u5e38\u76f8\u4f3c\u3002\u8ba9\u6211\u5feb\u901f\u56de\u987e\u4e00\u4e0bselect()\u7684\u6837\u5b50\u3002</p> <pre><code>select(int nfds, fd_set *r, fd_set *w, fd_set *e, struct timeval *timeout)\n</code></pre> <p>\u4f7f\u7528<code>select()</code>\uff0c\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u63d0\u4f9b\u4e09\u4e2a\u5174\u8da3\u96c6\uff08interest sets\uff09r\uff0cw\u548ce\u3002\u6bcf\u4e2a\u96c6\u90fd\u8868\u793a\u4e3a\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u4f4d\u56fe\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u5bf9\u4ece\u6587\u4ef6\u63cf\u8ff0\u7b266\u4e2d\u8bfb\u53d6\u611f\u5174\u8da3\uff0c\u5219\u5c06<code>r</code>\u7684\u7b2c\u516d\u4f4d\u8bbe\u7f6e\u4e3a<code>1</code>\u3002\u8fd9\u4e2a\u8c03\u7528\u662f\u963b\u585e\u7684\uff0c\u76f4\u5230\u611f\u5174\u8da3\u96c6\u4e2d\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u51c6\u5907\u5c31\u7eea\uff0c\u8fd9\u6837\u60a8\u5c31\u53ef\u4ee5\u5bf9\u8fd9\u4e9b\u6587\u4ef6\u63cf\u8ff0\u7b26\u6267\u884c\u6ca1\u6709\u963b\u585e\u7684\u64cd\u4f5c\u3002\u8fd4\u56de\u540e\uff0c\u5185\u6838\u5c06\u8986\u76d6\u4f4d\u56fe\u4ee5\u6307\u5b9a\u54ea\u4e9b\u6587\u4ef6\u63cf\u8ff0\u7b26\u5df2\u51c6\u5907\u5c31\u7eea\u3002</p> <p>\u5728\u53ef\u6269\u5c55\u6027\u65b9\u9762\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u56db\u4e2a\u95ee\u9898\uff1a</p> <ol> <li>\u8fd9\u4e9b\u4f4d\u56fe\u7684\u5927\u5c0f\u662f\u56fa\u5b9a\u7684\uff08<code>FD_SETSIZE</code>\uff0c\u901a\u5e38\u4e3a<code>1024</code>\uff09\u3002\u4f46\u662f\uff0c\u6709\u4e00\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u9650\u5236\u3002</li> <li>\u7531\u4e8e\u4f4d\u56fe\u88ab\u5185\u6838\u8986\u76d6\uff0c\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u5e94\u8be5\u4e3a\u6bcf\u4e2a\u8c03\u7528\u91cd\u65b0\u586b\u5145\u5174\u8da3\u96c6\u3002</li> <li>\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u548c\u5185\u6838\u5e94\u626b\u63cf\u6bcf\u4e2a\u8c03\u7528\u7684\u6574\u4e2a\u4f4d\u56fe\uff0c\u4ee5\u786e\u5b9a\u54ea\u4e9b\u6587\u4ef6\u63cf\u8ff0\u7b26\u5c5e\u4e8e\u5174\u8da3\u96c6\u548c\u7ed3\u679c\u96c6\u3002\u8fd9\u5bf9\u4e8e\u7ed3\u679c\u96c6\u6765\u8bf4\u5c24\u5176\u4f4e\u6548\uff0c\u56e0\u4e3a\u5b83\u4eec\u53ef\u80fd\u975e\u5e38\u7a00\u758f\uff08\u5373\uff0c\u5728\u7ed9\u5b9a\u65f6\u95f4\u53ea\u6709\u5c11\u6570\u6587\u4ef6\u63cf\u8ff0\u7b26\u51c6\u5907\u597d\uff09\u3002</li> <li>\u5185\u6838\u5e94\u8fed\u4ee3\u6574\u4e2a\u5174\u8da3\u96c6\uff0c\u4ee5\u627e\u51fa\u54ea\u4e9b\u6587\u4ef6\u63cf\u8ff0\u7b26\u5df2\u51c6\u5907\u597d\uff0c\u518d\u6b21\u9488\u5bf9\u6bcf\u4e2a\u8c03\u7528\u3002\u5982\u679c\u5b83\u4eec\u90fd\u6ca1\u6709\u51c6\u5907\u5c31\u7eea\uff0c\u5219\u5185\u6838\u518d\u6b21\u8fed\u4ee3\u4ee5\u4e3a\u6bcf\u4e2a\u5957\u63a5\u5b57\u6ce8\u518c\u5185\u90e8\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u3002</li> </ol>"},{"location":"2019-05-01-%E5%8F%AF%E6%89%A9%E5%B1%95%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%EF%BC%9Aepoll%E4%B8%8Ekqueue/#poll","title":"\u56de\u987e\uff1apoll()","text":"<p>poll()\u65e8\u5728\u89e3\u51b3\u5176\u4e2d\u7684\u4e00\u4e9b\u95ee\u9898\u3002</p> <pre><code>poll(struct pollfd *fds, int nfds, int timeout)\n\nstruct pollfd {\nint fd;\nshort events;\nshort revents;\n}\n</code></pre> <p><code>poll()</code>\u4e0d\u4f9d\u8d56\u4e8e\u4f4d\u56fe\uff0c\u800c\u662f\u4f9d\u8d56\u4e8e\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\u7ec4\uff08\u56e0\u6b64\u89e3\u51b3\u4e86\u95ee\u9898\uff031\uff09\u3002\u901a\u8fc7\u4e3a\u611f\u5174\u8da3\uff08\u4e8b\u4ef6\uff09\u548c\u7ed3\u679c\uff08revents\uff09\u63d0\u4f9b\u5355\u72ec\u7684\u5b57\u6bb5\uff0c\u5982\u679c\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u6b63\u786e\u7ef4\u62a4\u5e76\u91cd\u65b0\u4f7f\u7528\u8be5\u6570\u7ec4\uff0c\u5219\u95ee\u9898\uff032\u4e5f\u4f1a\u5f97\u5230\u89e3\u51b3\u3002\u5982\u679c\u8f6e\u8be2\u5206\u79bb\u6570\u7ec4\u800c\u4e0d\u662f\u5b57\u6bb5\uff0c\u95ee\u9898\uff033\u53ef\u80fd\u5df2\u7ecf\u4fee\u590d\u3002\u6700\u540e\u4e00\u4e2a\u95ee\u9898\u662f\u56fa\u6709\u7684\uff0c\u4e0d\u53ef\u907f\u514d\u7684\uff0c\u56e0\u4e3aselect()\u548cpoll()\u90fd\u662f\u65e0\u72b6\u6001\u7684\uff1b\u5185\u6838\u4e0d\u4f1a\u5728\u5185\u90e8\u7ef4\u62a4\u5174\u8da3\u96c6\u3002</p>"},{"location":"2019-05-01-%E5%8F%AF%E6%89%A9%E5%B1%95%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%EF%BC%9Aepoll%E4%B8%8Ekqueue/#_1","title":"\u4e3a\u4ec0\u4e48\u53ef\u6269\u5c55\u6027\u5f88\u91cd\u8981","text":"<p>\u5982\u679c\u60a8\u7684\u7f51\u7edc\u670d\u52a1\u5668\u9700\u8981\u7ef4\u6301\u76f8\u5bf9\u8f83\u5c11\u7684\u8fde\u63a5\u6570\uff08\u4f8b\u5982\uff0c\u51e0\u767e\u4e2a\uff09\u5e76\u4e14\u8fde\u63a5\u901f\u7387\u5f88\u6162\uff08\u518d\u6b21\uff0c\u6bcf\u79d2100\u4e2a\u8fde\u63a5\uff09\uff0c\u5219select()\u6216poll()\u5c31\u8db3\u591f\u4e86\u3002\u4e5f\u8bb8\u4f60\u751a\u81f3\u4e0d\u9700\u8981\u6253\u6270\u4e8b\u4ef6\u9a71\u52a8\u7684\u7f16\u7a0b;\u575a\u6301\u4f7f\u7528\u591a\u8fdb\u7a0b/\u7ebf\u7a0b\u67b6\u6784\u3002\u5982\u679c\u6027\u80fd\u4e0d\u662f\u60a8\u7684\u9996\u8981\u8003\u8651\u56e0\u7d20\uff0c\u90a3\u4e48\u7f16\u7a0b\u7684\u7b80\u6613\u6027\u548c\u7075\u6d3b\u6027\u5c31\u662f\u6700\u91cd\u8981\u7684\u3002 <code>Apache Web</code>\u670d\u52a1\u5668\u5c31\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\u3002</p> <p>\u4f46\u662f\uff0c\u5982\u679c\u60a8\u7684\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f\u662f\u7f51\u7edc\u5bc6\u96c6\u578b\u7684\uff08\u4f8b\u5982\uff0c1000\u4e2a\u5e76\u53d1\u8fde\u63a5\u548c/\u6216\u9ad8\u8fde\u63a5\u901f\u7387\uff09\uff0c\u60a8\u5e94\u8be5\u5bf9\u6027\u80fd\u975e\u5e38\u8ba4\u771f\u3002\u8fd9\u79cd\u60c5\u51b5\u901a\u5e38\u88ab\u79f0\u4e3ac10k\u95ee\u9898\u3002\u4f7f\u7528select()\u6216poll()\uff0c\u60a8\u7684\u7f51\u7edc\u670d\u52a1\u5668\u51e0\u4e4e\u4e0d\u4f1a\u6267\u884c\u4efb\u4f55\u6709\u7528\u7684\u64cd\u4f5c\uff0c\u4f46\u4f1a\u5728\u5982\u6b64\u9ad8\u7684\u8d1f\u8f7d\u4e0b\u6d6a\u8d39\u5b9d\u8d35\u7684CPU\u5468\u671f\u3002</p> <p>\u5047\u8bbe\u670910000\u4e2a\u5e76\u53d1\u8fde\u63a5\u3002\u901a\u5e38\uff0c\u53ea\u6709\u5c11\u6570\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08\u4f8b\u598210\u4e2a\uff09\u53ef\u4ee5\u8bfb\u53d6\u3002\u5bf9\u4e8e\u6bcf\u4e2aselect()/poll()\u8c03\u7528\uff0c\u65e0\u7406\u7531\u5730\u590d\u5236\u548c\u626b\u63cf\u5269\u4f59\u76849990\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p> <p>\u5982\u524d\u6240\u8ff0\uff0c\u8fd9\u4e2a\u95ee\u9898\u6765\u81ea\u4e8e\u90a3\u4e9bselect()/poll()\u63a5\u53e3\u662f\u65e0\u72b6\u6001\u7684\u3002 Banga\u7b49\u4eba\u5728<code>USENIX ATC 1999</code>\u4e0a\u53d1\u8868\u7684\u8bba\u6587\u63d0\u51fa\u4e86\u4e00\u4e2a\u65b0\u89c2\u70b9\uff1a\u6709\u72b6\u6001\u7684\u5174\u8da3\u96c6\u3002\u5185\u6838\u4e0d\u662f\u4e3a\u6bcf\u4e2a\u7cfb\u7edf\u8c03\u7528\u63d0\u4f9b\u6574\u4e2a\u5174\u8da3\u96c6\uff0c\u800c\u662f\u5728\u5185\u90e8\u7ef4\u62a4\u5174\u8da3\u96c6\u3002\u5728<code>decalre_interest()</code>\u8c03\u7528\u65f6\uff0c\u5185\u6838\u4f1a\u9010\u6b65\u66f4\u65b0\u5174\u8da3\u96c6\u3002\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7<code>get_next_event()</code>\u4ece\u5185\u6838\u8c03\u5ea6\u65b0\u4e8b\u4ef6\u3002</p> <p>\u53d7\u7814\u7a76\u7ed3\u679c\u7684\u542f\u53d1\uff0cLinux\u548cFreeBSD\u5206\u522b\u63d0\u51fa\u4e86\u4ed6\u4eec\u81ea\u5df1\u7684\u5b9e\u73b0\uff0cepoll\u548ckqueue\u3002\u8fd9\u610f\u5473\u7740\u7f3a\u4e4f\u53ef\u79fb\u690d\u6027\uff0c\u56e0\u4e3a\u57fa\u4e8eepoll\u7684\u5e94\u7528\u7a0b\u5e8f\u65e0\u6cd5\u5728FreeBSD\u4e0a\u8fd0\u884c\u3002\u4ee4\u4eba\u9057\u61be\u7684\u662f\uff0ckqueue\u5728\u6280\u672f\u4e0a\u4f18\u4e8eepoll\uff0c\u56e0\u6b64\u6ca1\u6709\u5145\u5206\u7406\u7531\u8bc1\u660eepoll\u7684\u5b58\u5728\u3002</p>"},{"location":"2019-05-01-%E5%8F%AF%E6%89%A9%E5%B1%95%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%EF%BC%9Aepoll%E4%B8%8Ekqueue/#linuxepoll","title":"Linux\u4e2d\u7684epoll","text":"<p>epoll\u63a5\u53e3\u5305\u542b\u4e09\u4e2a\u7cfb\u7edf\u8c03\u7528\uff1a</p> <pre><code>int epoll_create(int size);\nint epoll_ctl(int epfd, int op, int fd, struct epoll_event *event);\nint epoll_wait(int epfd, struct epoll_event *events, int maxevents, int timeout);\n</code></pre> <p><code>epoll_ctl()</code>\u548c<code>epoll_wait()</code>\u57fa\u672c\u4e0a\u5206\u522b\u5bf9\u5e94\u4e8e\u4e0a\u9762\u7684<code>decalre_interest()</code>\u548c<code>get_next_event()</code>\u3002<code>epoll_create()</code>\u521b\u5efa\u4e00\u4e2a\u4e0a\u4e0b\u6587\u4f5c\u4e3a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u800c\u4e0a\u9762\u63d0\u5230\u7684\u6587\u4ef6\u9690\u542b\u5730\u5047\u8bbe\u6bcf\u4e2a\u8fdb\u7a0b\u4e0a\u4e0b\u6587\u3002\u5728\u5185\u90e8\uff0cLinux\u5185\u6838\u4e2d\u7684epoll\u5b9e\u73b0\u4e0eselect()/poll()\u5b9e\u73b0\u6ca1\u6709\u592a\u5927\u533a\u522b\u3002\u552f\u4e00\u7684\u533a\u522b\u662f\u5b83\u662f\u5426\u6709\u72b6\u6001\u3002\u8fd9\u662f\u56e0\u4e3a\u5b83\u4eec\u7684\u8bbe\u8ba1\u76ee\u6807\u5b8c\u5168\u76f8\u540c\uff08\u5957\u63a5\u5b57/\u7ba1\u9053\u7684\u4e8b\u4ef6\u591a\u8def\u590d\u7528\uff09\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Linux\u6e90\u4ee3\u7801\u6811\u4e2d\u7684<code>fs/select.c</code>\uff08\u7528\u4e8eselect\u548cpoll\uff09\u548c<code>fs/eventpoll.c</code>\uff08\u7528\u4e8eepoll\uff09\u3002</p> <p>\u4f60\u4e5f\u53ef\u4ee5\u5728epoll\u7684\u65e9\u671f\u7248\u672c\u4e2d\u627e\u5230Linus Torvalds\u7684\u4e00\u4e9b\u521d\u6b65\u60f3\u6cd5\u3002</p>"},{"location":"2019-05-01-%E5%8F%AF%E6%89%A9%E5%B1%95%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%EF%BC%9Aepoll%E4%B8%8Ekqueue/#freebsdkqueue","title":"FreeBSD\u4e2d\u7684kqueue","text":"<p>\u4e0eepoll\u4e00\u6837\uff0ckqueue\u4e5f\u652f\u6301\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u591a\u4e2a\u4e0a\u4e0b\u6587\uff08\u5174\u8da3\u96c6\uff09\u3002 <code>kqueue()</code>\u6267\u884c\u4e0e<code>epoll_create()</code>\u76f8\u540c\u7684\u64cd\u4f5c\u3002\u4f46\u662f\uff0c<code>kevent()</code>\u8c03\u7528\u4f7f\u7528<code>kevent()</code>\u96c6\u6210\u4e86<code>epoll_ctl()</code>\uff08\u8c03\u6574\u5174\u8da3\u96c6\uff09\u548c<code>epoll_wait()</code>\uff08\u68c0\u7d22\u4e8b\u4ef6\uff09\u7684\u89d2\u8272\u3002</p> <pre><code>int kqueue(void);\nint kevent(int kq, const struct kevent *changelist, int nchanges, struct kevent *eventlist, int nevents, const struct timespec *timeout);\n</code></pre> <p>\u4ece\u7f16\u7a0b\u7684\u7b80\u6613\u6027\u6765\u770b\uff0c\u5b9e\u9645\u4e0akqueue\u6bd4epoll\u590d\u6742\u4e00\u70b9\u3002\u8fd9\u662f\u56e0\u4e3akqueue\u4ee5\u66f4\u62bd\u8c61\u7684\u65b9\u5f0f\u8bbe\u8ba1\uff0c\u4ee5\u5b9e\u73b0\u901a\u7528\u6027\u3002\u8ba9\u6211\u4eec\u770b\u4e00\u4e0b<code>struct kevent</code>\u7684\u5916\u89c2\u3002</p> <pre><code>struct kevent {\nuintptr_t       ident;          /* identifier for this event */\nint16_t         filter;         /* filter for event */\nuint16_t        flags;          /* general flags */\nuint32_t        fflags;         /* filter-specific flags */\nintptr_t        data;           /* filter-specific data */\nvoid            *udata;         /* opaque user data identifier */\n};\n</code></pre> <p>\u867d\u7136\u8fd9\u4e9b\u5b57\u6bb5\u7684\u8be6\u7ec6\u4fe1\u606f\u8d85\u51fa\u4e86\u672c\u6587\u7684\u8303\u56f4\uff0c\u4f46\u60a8\u53ef\u80fd\u5df2\u7ecf\u6ce8\u610f\u5230\u6ca1\u6709\u660e\u786e\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5b57\u6bb5\u3002\u8fd9\u662f\u56e0\u4e3akqueue\u4e0d\u4ec5\u4ec5\u88ab\u8bbe\u8ba1\u4e3a\u7528\u4e8e\u5957\u63a5\u5b57\u4e8b\u4ef6\u591a\u8def\u590d\u7528\u7684select()/poll()\u7684\u66ff\u4ee3\uff0c\u800c\u662f\u4f5c\u4e3a\u5404\u79cd\u7c7b\u578b\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e8b\u4ef6\u7684\u4e00\u822c\u673a\u5236\u3002</p> <p><code>filter</code>\u5b57\u6bb5\u6307\u5b9a\u5185\u6838\u4e8b\u4ef6\u7684\u7c7b\u578b\u3002\u5982\u679c\u5b83\u662f<code>EVFILT_READ</code>\u6216<code>EVFILT_WRITE</code>\uff0c\u5219kqueue\u7684\u5de5\u4f5c\u65b9\u5f0f\u7c7b\u4f3c\u4e8eepoll\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c<code>ident</code>\u5b57\u6bb5\u8868\u793a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002<code>ident</code>\u5b57\u6bb5\u53ef\u4ee5\u8868\u793a\u5176\u4ed6\u7c7b\u578b\u7684\u6807\u8bc6\u7b26\uff0c\u4f8b\u5982<code>\u8fdb\u7a0bID</code>\u548c\u4fe1\u53f7\u7f16\u53f7\uff0c\u8fd9\u53d6\u51b3\u4e8e\u8fc7\u6ee4\u5668\u7c7b\u578b\u3002\u8be6\u7ec6\u4fe1\u606f\u53ef\u4ee5\u5728\u624b\u518c\u9875\u6216\u8bba\u6587\u4e2d\u627e\u5230\u3002</p>"},{"location":"2019-05-01-%E5%8F%AF%E6%89%A9%E5%B1%95%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%EF%BC%9Aepoll%E4%B8%8Ekqueue/#epollkqueue","title":"epoll\u548ckqueue\u7684\u6bd4\u8f83","text":""},{"location":"2019-05-01-%E5%8F%AF%E6%89%A9%E5%B1%95%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%EF%BC%9Aepoll%E4%B8%8Ekqueue/#_2","title":"\u6027\u80fd","text":"<p>\u5728\u6027\u80fd\u65b9\u9762\uff0cepoll\u8bbe\u8ba1\u6709\u4e00\u4e2a\u7f3a\u70b9\uff1b\u5b83\u4e0d\u652f\u6301\u5355\u4e2a\u7cfb\u7edf\u8c03\u7528\u4e2d\u7684\u5174\u8da3\u96c6\u7684\u591a\u4e2a\u66f4\u65b0\u3002\u5f53\u60a8\u6709100\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u6765\u66f4\u65b0\u5176\u5728\u5174\u8da3\u96c6\u4e2d\u7684\u72b6\u6001\u65f6\uff0c\u60a8\u5fc5\u987b\u8fdb\u884c100\u6b21<code>epoll_ctl()</code>\u8c03\u7528\u3002\u5982\u6587\u7ae0\u6240\u8ff0\uff0c\u8fc7\u5ea6\u7cfb\u7edf\u8c03\u7528\u5bfc\u81f4\u7684\u6027\u80fd\u4e0b\u964d\u975e\u5e38\u663e\u7740\u3002\u6211\u731c\u8fd9\u662fBanga\u7b49\u4eba\u539f\u521b\u4f5c\u54c1\u7684\u9057\u4ea7\uff0c\u56e0\u4e3a<code>declare_interest()</code>\u4e5f\u53ea\u652f\u6301\u6bcf\u6b21\u8c03\u7528\u7684\u4e00\u6b21\u66f4\u65b0\u3002\u76f8\u53cd\uff0c\u60a8\u53ef\u4ee5\u5728\u5355\u4e2a<code>kevent()</code>\u8c03\u7528\u4e2d\u6307\u5b9a\u591a\u4e2a\u5174\u8da3\u66f4\u65b0\u3002</p>"},{"location":"2019-05-01-%E5%8F%AF%E6%89%A9%E5%B1%95%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%EF%BC%9Aepoll%E4%B8%8Ekqueue/#_3","title":"\u975e\u6587\u4ef6\u652f\u6301","text":"<p>\u5728\u6211\u770b\u6765\uff0c\u53e6\u4e00\u4e2a\u66f4\u91cd\u8981\u7684\u95ee\u9898\u662fepoll\u7684\u8303\u56f4\u6709\u9650\u3002\u56e0\u4e3a\u5b83\u65e8\u5728\u63d0\u9ad8select()/poll()\u7684\u6027\u80fd\uff0c\u4f46\u4ec5\u6b64\u800c\u5df2\uff0cepoll\u4ec5\u9002\u7528\u4e8e\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u8fd9\u6709\u4ec0\u4e48\u95ee\u9898\uff1f</p> <p>\u7ecf\u5e38\u5f15\u7528\u201c\u5728Unix\u4e2d\uff0c\u4e00\u5207\u90fd\u662f\u6587\u4ef6\u201d\u3002\u8fd9\u5927\u591a\u662f\u771f\u7684\uff0c\u4f46\u5e76\u975e\u603b\u662f\u5982\u6b64\u3002\u4f8b\u5982\uff0c\u8ba1\u65f6\u5668\u4e0d\u662f\u6587\u4ef6\u3002\u4fe1\u53f7\u4e0d\u662f\u6587\u4ef6\u3002\u4fe1\u53f7\u91cf\u4e0d\u662f\u6587\u4ef6\u3002\u8fdb\u7a0b\u4e0d\u662f\u6587\u4ef6\u3002\uff08\u5728Linux\u4e2d\uff0c\uff09\u7f51\u7edc\u8bbe\u5907\u4e0d\u662f\u6587\u4ef6\u3002\u7c7bUNIX\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u6709\u8bb8\u591a\u4e0d\u662f\u6587\u4ef6\u7684\u4e1c\u897f\u3002\u60a8\u4e0d\u80fd\u4f7f\u7528<code>select()/ poll()/epoll()</code>\u6765\u590d\u5236\u90a3\u4e9b\u201c\u4e8b\u7269\u201d\u3002\u9664\u5957\u63a5\u5b57\u5916\uff0c\u5178\u578b\u7684\u7f51\u7edc\u670d\u52a1\u5668\u8fd8\u7ba1\u7406\u5404\u79cd\u7c7b\u578b\u7684\u8d44\u6e90\u3002\u60a8\u53ef\u80fd\u5e0c\u671b\u4f7f\u7528\u5355\u4e00\uff0c\u7edf\u4e00\u7684\u754c\u9762\u76d1\u63a7\u5b83\u4eec\uff0c\u4f46\u60a8\u4e0d\u80fd\u3002\u8981\u89e3\u51b3\u6b64\u95ee\u9898\uff0cLinux\u652f\u6301\u8bb8\u591a\u8865\u5145\u7cfb\u7edf\u8c03\u7528\uff0c\u4f8b\u5982<code>signalfd()</code>\uff0c<code>eventfd()</code>\u548c<code>timerfd_create()</code>\uff0c\u5b83\u4eec\u5c06\u975e\u6587\u4ef6\u8d44\u6e90\u8f6c\u6362\u4e3a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4ee5\u4fbf\u60a8\u53ef\u4ee5\u5c06\u5b83\u4eec\u4e0e<code>epoll()</code>\u590d\u7528\u3002\u4f46\u8fd9\u770b\u8d77\u6765\u5e76\u4e0d\u4f18\u96c5......\u4f60\u771f\u7684\u60f3\u8981\u4e3a\u6bcf\u79cd\u7c7b\u578b\u7684\u8d44\u6e90\u8fdb\u884c\u4e13\u95e8\u7684\u7cfb\u7edf\u8c03\u7528\u5417\uff1f</p> <p>\u5728<code>kqueue</code>\u4e2d\uff0c\u901a\u7528\u7684<code>struct kevent</code>\u7ed3\u6784\u652f\u6301\u5404\u79cd\u975e\u6587\u4ef6\u4e8b\u4ef6\u3002\u4f8b\u5982\uff0c\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5728\u5b50\u8fdb\u7a0b\u9000\u51fa\u65f6\u6536\u5230\u901a\u77e5\uff08\u4f7f\u7528<code>filter = EVFILT_PROC</code>\uff0c<code>ident = pid</code>\u548c<code>fflags = NOTE_EXIT</code>\uff09\u3002\u5373\u4f7f\u5f53\u524d\u5185\u6838\u7248\u672c\u4e0d\u652f\u6301\u67d0\u4e9b\u8d44\u6e90\u6216\u4e8b\u4ef6\u7c7b\u578b\uff0c\u4e5f\u4f1a\u5728\u672a\u6765\u7684\u5185\u6838\u7248\u672c\u4e2d\u5bf9\u5176\u8fdb\u884c\u6269\u5c55\uff0c\u800c\u4e0d\u4f1a\u5bf9API\u8fdb\u884c\u4efb\u4f55\u66f4\u6539\u3002</p>"},{"location":"2019-05-01-%E5%8F%AF%E6%89%A9%E5%B1%95%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%EF%BC%9Aepoll%E4%B8%8Ekqueue/#_4","title":"\u78c1\u76d8\u6587\u4ef6\u652f\u6301","text":"<p>\u6700\u540e\u4e00\u4e2a\u95ee\u9898\u662fepoll\u751a\u81f3\u4e0d\u652f\u6301\u6240\u6709\u7c7b\u578b\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26; <code>select()/poll()/epoll()</code>\u4e0d\u9002\u7528\u4e8e\u5e38\u89c4\uff08\u78c1\u76d8\uff09\u6587\u4ef6\u3002\u8fd9\u662f\u56e0\u4e3aepoll\u5bf9\u51c6\u5907\u6a21\u578b\u6709\u5f88\u5f3a\u7684\u5047\u8bbe\uff1b\u76d1\u89c6\u5957\u63a5\u5b57\u7684\u51c6\u5907\u60c5\u51b5\uff0c\u4ee5\u4fbf\u5957\u63a5\u5b57\u4e0a\u7684\u540e\u7eedIO\u8c03\u7528\u4e0d\u4f1a\u963b\u585e\u3002\u4f46\u662f\uff0c\u78c1\u76d8\u6587\u4ef6\u4e0d\u9002\u5408\u6b64\u6a21\u578b\uff0c\u56e0\u4e3a\u5b83\u4eec\u603b\u662f\u51c6\u5907\u5c31\u7eea\u3002</p> <p>\u5f53\u6570\u636e\u672a\u7f13\u5b58\u5728\u5185\u5b58\u4e2d\u65f6\u78c1\u76d8I/O\u963b\u585e\uff0c\u800c\u4e0d\u662f\u56e0\u4e3a\u5ba2\u6237\u7aef\u6ca1\u6709\u53d1\u9001\u6d88\u606f\u3002\u5bf9\u4e8e\u78c1\u76d8\u6587\u4ef6\uff0c\u5b8c\u6210\u901a\u77e5\u6a21\u578b\uff08completion notification model\uff09\u9002\u5408\u3002\u5728\u6b64\u6a21\u578b\u4e2d\uff0c\u60a8\u53ea\u9700\u5bf9\u78c1\u76d8\u6587\u4ef6\u53d1\u51faI/O\u64cd\u4f5c\uff0c\u5e76\u5728\u5b8c\u6210\u540e\u6536\u5230\u901a\u77e5\u3002kqueue\u652f\u6301\u4f7f\u7528<code>EVFILT_AIO</code>\u8fc7\u6ee4\u5668\u7c7b\u578b\u7684\u6b64\u65b9\u6cd5\uff0c\u4ee5\u53ca<code>POSIX AIO</code>\u51fd\u6570\uff0c\u4f8b\u5982<code>aio_read()</code>\u3002\u5728Linux\u4e2d\uff0c\u60a8\u5e94\u8be5\u7b80\u5355\u5730\u7948\u7977\u78c1\u76d8\u8bbf\u95ee\u4e0d\u4f1a\u4ee5\u9ad8\u7f13\u5b58\u547d\u4e2d\u7387\u963b\u585e\uff08\u5728\u8bb8\u591a\u7f51\u7edc\u670d\u52a1\u5668\u4e2d\u975e\u5e38\u5e38\u89c1\uff09\uff0c\u6216\u8005\u5177\u6709\u5355\u72ec\u7684\u7ebf\u7a0b\u4ee5\u4fbf\u78c1\u76d8I/O\u963b\u585e\u4e0d\u4f1a\u5f71\u54cd\u7f51\u7edc\u5957\u63a5\u5b57\u5904\u7406\uff08\u4f8b\u5982\uff0cFLASH\u4f53\u7cfb\u7ed3\u6784\uff09 \uff09\u3002</p> <p>\u5728\u6211\u4eec\u4e4b\u524d\u7684MegaPipe\u8bba\u6587\u4e2d\uff0c\u6211\u4eec\u63d0\u51fa\u4e86\u4e00\u4e2a\u65b0\u7684\u7f16\u7a0b\u63a5\u53e3\uff0c\u5b83\u5b8c\u5168\u57fa\u4e8e\u5b8c\u6210\u901a\u77e5\u6a21\u578b\uff0c\u9002\u7528\u4e8e\u78c1\u76d8\u548c\u975e\u78c1\u76d8\u6587\u4ef6\u3002</p>"},{"location":"2019-05-05-%E5%85%B3%E4%BA%8EJava%E8%AF%AD%E8%A8%80%E7%9A%84finally%E8%AF%AD%E5%8F%A5/","title":"2019 05 05 \u5173\u4e8eJava\u8bed\u8a00\u7684finally\u8bed\u53e5","text":""},{"location":"2019-05-05-%E5%85%B3%E4%BA%8EJava%E8%AF%AD%E8%A8%80%E7%9A%84finally%E8%AF%AD%E5%8F%A5/#_1","title":"\u662f\u5426\u4e00\u5b9a\u6267\u884c\u3001\u6267\u884c\u65f6\u673a","text":"<p>\u4e00\u5207\u8981\u4ece\u8fd9\u9053\u9898\u76ee\u8bf4\u8d77\uff1a</p> <p>Java\u8bed\u8a00\u4e2d\u7684<code>finally</code>\u8bed\u53e5\uff08\u5757\uff09\u4e00\u5b9a\u4f1a\u88ab\u6267\u884c\u5417\uff1f\u662f\u5728<code>try</code>\u8bed\u53e5\u8fd4\u56de\u4e4b\u524d\u8fd8\u662f\u4e4b\u540e\u6267\u884c\uff1f</p> <p>\u7531\u4e8e\u5bf9\u8fd9\u4e2a\u95ee\u9898\u7684\u4e00\u77e5\u534a\u89e3\uff0c\u5f53\u65f6\u53ea\u56de\u7b54\u4e86\u524d\u534a\u4e2a\u95ee\u9898<code>\u662f\u7684\uff0c\u4e00\u5b9a\u4f1a\u6267\u884c</code>\uff0c\u6ca1\u6709\u56de\u7b54\u540e\u534a\u4e2a\u95ee\u9898\uff1b\u7b14\u8bd5\u7ed3\u675f\u540e\u67e5\u8d44\u6599...\u624d\u53d1\u73b0\u4e8b\u60c5\u6ca1\u90a3\u4e48\u7b80\u5355\ud83e\udd2f</p> <p>\u8bda\u7136\uff0c\u6211\u7684\u56de\u7b54\u662f\u9519\u8bef\u7684\uff0c\u4ee5\u4e0b\u4e24\u79cd\u60c5\u51b5\u7684finally\u8bed\u53e5\u4e0d\u4f1a\u88ab\u6267\u884c\uff1a</p> <ol> <li><code>try</code>\u8bed\u53e5\u6ca1\u6709\u88ab\u6267\u884c\uff1b\u4e5f\u8bf4\u660e\u4e86finally\u8bed\u53e5\u88ab\u6267\u884c\u7684<code>\u5fc5\u8981\u975e\u5145\u5206</code>\u6761\u4ef6\u662f<code>\u5bf9\u5e94try\u8bed\u53e5\u88ab\u6267\u884c</code></li> <li><code>try</code>\u8bed\u53e5\u4e2d\u6709<code>\u505c\u6b62JVM</code>\u7684\u8bed\u53e5\uff1b</li> </ol> <p>\u540e\u534a\u4e2a\u95ee\u9898\u7684\u7b54\u6848\u662f<code>\u4e4b\u524d</code>\uff0c\u5373\u5728<code>try</code>\u8bed\u53e5<code>\u8fd4\u56de</code>\u4e4b\u524d\u6267\u884c\uff0c\u53ef\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u6765\u8bf4\u660e\uff1a</p> <pre><code>jshell&gt; String test1() {\n   ...&gt;     System.out.println(\"return statement\");\n   ...&gt;\n   ...&gt;     return \"after return\";\n   ...&gt; }\n|  created method test1()\n\njshell&gt; String test2() {\n   ...&gt;     try {\n   ...&gt;         System.out.println(\"try block\");\n   ...&gt;\n   ...&gt;         return test1();\n   ...&gt;     } finally {\n   ...&gt;         System.out.println(\"finally block\");\n   ...&gt;     }\n   ...&gt; }\n|  created method test2()\n\njshell&gt; test2()\ntry block\nreturn statement\nfinally block\n$1 ==&gt; \"after return\"\n</code></pre> <p>\u66f4\u8be6\u7ec6\u5730\u8bf4\u660e\uff1a\u6267\u884creturn\u8bed\u53e5\u4e4b\u540e\uff0c\u518d\u6267\u884c<code>finally\u8bed\u53e5</code>\uff0c\u518d\u8fd4\u56de\u8c03\u7528\u8005\uff1b</p>"},{"location":"2019-05-05-%E5%85%B3%E4%BA%8EJava%E8%AF%AD%E8%A8%80%E7%9A%84finally%E8%AF%AD%E5%8F%A5/#_2","title":"\u6267\u884c\u7684\u5f71\u54cd","text":""},{"location":"2019-05-05-%E5%85%B3%E4%BA%8EJava%E8%AF%AD%E8%A8%80%E7%9A%84finally%E8%AF%AD%E5%8F%A5/#finallyreturn","title":"finally\u8bed\u53e5\u4e2d\u7684return\u8bed\u53e5","text":"<pre><code>jshell&gt; int test() {\n   ...&gt;     int b = 20;\n   ...&gt;     try {\n   ...&gt;         System.out.println(\"try block\");\n   ...&gt; \n   ...&gt;         return b += 80;\n   ...&gt;     } catch (Exception e) {\n   ...&gt; \n   ...&gt;         System.out.println(\"catch block\");\n   ...&gt;     } finally {\n   ...&gt; \n   ...&gt;         System.out.println(\"finally block\");\n   ...&gt; \n   ...&gt;         if (b &gt; 25) {\n   ...&gt;             System.out.println(\"b&gt;25, b = \" + b);\n   ...&gt;         }\n   ...&gt; \n   ...&gt;         return 200;\n   ...&gt;     }\n   ...&gt; }\n|  modified method test()\n\njshell&gt; test()\ntry block\nfinally block\nb&gt;25, b = 100\n$2 ==&gt; 200\n</code></pre> <p>\u8bf4\u660efinally\u7684return\u8bed\u53e5\u7684\u503c\u88ab\u8fd4\u56de\u7ed9\u8c03\u7528\u8005\uff0c\u5373finally\u5757\u4e2d\u7684return\u8bed\u53e5\u4f1a\u8986\u76d6try\u5757\u4e2d\u7684return\u8fd4\u56de\uff1b</p>"},{"location":"2019-05-05-%E5%85%B3%E4%BA%8EJava%E8%AF%AD%E8%A8%80%E7%9A%84finally%E8%AF%AD%E5%8F%A5/#finallytry","title":"finally\u8bed\u53e5\u4e2d\u5bf9try\u8bed\u53e5\u8fd4\u56de\u503c\u7684\u4fee\u6539","text":"<p>\u8fd9\u91cc\u8981\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\uff0c\u8fd4\u56de\u503c\u662f<code>\u57fa\u672c\u7c7b\u578b</code>\u8fd8\u662f<code>\u5f15\u7528\u7c7b\u578b</code>\uff1a</p> <ol> <li>\u82e5\u662f\u57fa\u672c\u7c7b\u578b\uff0c\u4fee\u6539\u65e0\u6548\uff1b</li> <li>\u82e5\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u4e5f\u8981\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\uff1a</li> <li>\u82e5\u662f\u4fee\u6539\u5f15\u7528\uff0c\u5219\u65e0\u6548\uff1b</li> <li>\u82e5\u662f\u4fee\u6539\u88ab\u5f15\u7528\u7684\u5bf9\u8c61\u7684\u5185\u5bb9\uff0c\u5219\u6709\u6548\uff1b</li> </ol> <p>\u901a\u8fc7\u4e24\u4e2a\u4f8b\u5b50\u6765\u6f14\u793a\uff1a</p>"},{"location":"2019-05-05-%E5%85%B3%E4%BA%8EJava%E8%AF%AD%E8%A8%80%E7%9A%84finally%E8%AF%AD%E5%8F%A5/#_3","title":"\u57fa\u672c\u7c7b\u578b","text":"<pre><code>jshell&gt; int test() {\n   ...&gt;     int b = 20;\n   ...&gt; \n   ...&gt;     try {\n   ...&gt;         System.out.println(\"try block\");\n   ...&gt; \n   ...&gt;         return b += 80;\n   ...&gt;     } catch (Exception e) {\n   ...&gt;         System.out.println(\"catch block\");\n   ...&gt;     } finally {\n   ...&gt;         System.out.println(\"finally block\");\n   ...&gt; \n   ...&gt;         if (b &gt; 25) {\n   ...&gt;             System.out.println(\"b&gt;25, b = \" + b);\n   ...&gt;         }\n   ...&gt; \n   ...&gt;         b = 150;\n   ...&gt;     }\n   ...&gt; \n   ...&gt;     return 2000;\n   ...&gt; }\n|  modified method test()\n\njshell&gt; test()\ntry block\nfinally block\nb&gt;25, b = 100\n$3 ==&gt; 100\n</code></pre> <p>\u8ba9\u6211\u4eec\u6765\u63a2\u7a76\u4e00\u4e0b\u8fd9\u4e2a\u4f8b\u5b50\u7684\u5b57\u8282\u7801\uff1a</p> <p>\u622a\u56fe\u81eajclasslib\u5de5\u5177</p> <p></p> <ul> <li><code>6-8</code>\u884c\uff0c\u5c06\u672c\u5730\u53d8\u91cf\u6570\u7ec4\uff08local variable array\uff09\u7684\u7b2c<code>0</code>\u4e2a\u503c\uff08\u537320\uff09\u52a080\uff0c\u5e76\u88ab\u538b\u5165\u64cd\u4f5c\u6570\u6808\uff0c\u4fdd\u5b58\u5728\u7b2c<code>1</code>\u4e2aint\u503c\u4e2d</li> <li><code>19-22</code>\u884c\uff0c\u5c06<code>150</code>\u538b\u5165\u64cd\u4f5c\u6570\u6808\uff0c\u4fdd\u5b58\u5728<code>\u672c\u5730\u53d8\u91cf\u6570\u7ec4\u7684\u7b2c0\u4e2a\u503c</code>\u4e2d\uff0c\u5c06<code>\u672c\u5730\u53d8\u91cf\u6570\u7ec4\u7684\u7b2c1\u4e2a\u503c</code>\u5373\uff08100\uff09\u538b\u5165\u64cd\u4f5c\u6570\u6808\uff0c\u8fd4\u56de</li> </ul> <p>\u6545\u800c\u8bed\u53e5<code>b = 150;</code>\u5e76\u6ca1\u6709\u5f71\u54cd\u5230\u8fd4\u56de\u503c\uff1b</p>"},{"location":"2019-05-05-%E5%85%B3%E4%BA%8EJava%E8%AF%AD%E8%A8%80%E7%9A%84finally%E8%AF%AD%E5%8F%A5/#_4","title":"\u5f15\u7528\u7c7b\u578b","text":"<pre><code>jshell&gt; Map&lt;String, String&gt; test() {\n   ...&gt;     Map&lt;String, String&gt; map = new HashMap&lt;String, String&gt;();\n   ...&gt;     map.put(\"KEY\", \"INIT\");\n   ...&gt;     try {\n   ...&gt;         map.put(\"KEY\", \"TRY\");\n   ...&gt;         return map;\n   ...&gt;     } catch (Exception e) {\n   ...&gt;         map.put(\"KEY\", \"CATCH\");\n   ...&gt;     } finally {\n   ...&gt;         map.put(\"KEY\", \"FINALLY\");\n   ...&gt;         map = null;\n   ...&gt;     }\n   ...&gt;     return map;\n   ...&gt; }\n|  replaced method test()\n\njshell&gt; test()\n$4 ==&gt; {KEY=FINALLY}\n</code></pre> <p>\u8fd9\u4e2a\u4f8b\u5b50\u7684\u5b57\u8282\u7801\u5982\u56fe\uff1a</p> <p></p> <p>\u4e0e\u4e0a\u540c\u7406\u3002</p>"},{"location":"2019-05-05-%E5%85%B3%E4%BA%8EJava%E8%AF%AD%E8%A8%80%E7%9A%84finally%E8%AF%AD%E5%8F%A5/#_5","title":"\u53c2\u8003","text":"<ol> <li>istore_n</li> <li>Java finally\u8bed\u53e5\u5230\u5e95\u662f\u5728return\u4e4b\u524d\u8fd8\u662f\u4e4b\u540e\u6267\u884c\uff1f</li> </ol>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/","title":"2019 05 09 \u4e00\u4e2a\u6210\u529f\u7684Git\u5206\u652f\u6a21\u578b","text":"<p>\u7ffb\u8bd1\u81eaA successful Git branching model</p> <p>\u8fd9\u7bc7\u6587\u7ae0\u4ecb\u7ecd\u4e86\u4e00\u79cd\u5f00\u53d1\u6a21\u578b\uff0c\u9002\u7528\u4e8e\u5de5\u4f5c\u6216\u79c1\u4eba\u9879\u76ee\uff0c\u53ea\u8ba8\u8bba\u5206\u652f\u7b56\u7565\u548c\u53d1\u5e03\u7ba1\u7406\uff0c\u4e0d\u4f1a\u8ba8\u8bba\u4efb\u4f55\u9879\u76ee\u7684\u7ec6\u8282\u3002</p> <p></p>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/#git","title":"\u4e3a\u4f55\u662fGit\uff1f","text":"<p>\u4f60\u53ef\u4ee5\u5728\u8fd9\u7bc7\u6587\u7ae0\u4e0a\u67e5\u770b\u5173\u4e8eGit\u4e0e<code>\u96c6\u4e2d\u5f0f\u6e90\u4ee3\u7801\u63a7\u5236\u7cfb\u7edf\uff08centralized source code control systems\uff09</code>\u76f8\u6bd4\u8f83\u7684\u4f18\u7f3a\u70b9\uff0c\u8ba8\u8bba\u6bd4\u8f83\u6fc0\u70c8\u3002\u4f5c\u4e3a\u4e00\u4e2a\u5f00\u53d1\u8005\uff0c\u6211\u66f4\u559c\u6b22Git\uff0c\u800c\u4e0d\u662f\u5176\u4ed6\u7684\u6240\u6709\u5de5\u5177\u3002Git\u6539\u53d8\u4e86\u5f00\u53d1\u8005\u5bf9\u4e8e\u5408\u5e76\u4e0e\u5206\u652f\u7684\u601d\u8003\u65b9\u5f0f\u3002\u4ece\u6211\u4e4b\u524d\u6240\u5728\u7684\u7ecf\u5178\u7684<code>CVS/Subversion</code>\u4e16\u754c\u6765\u770b\uff0c\u5408\u5e76/\u5206\u652f\u4e00\u76f4\u88ab\u89c6\u4e3a\u53ef\u6015\u7684\u4e8b\u60c5\uff0c\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u5c31\u4f1a\u505a\u4e00\u6b21\uff0c\u8981\u5c0f\u5fc3\u5408\u5e76\u51b2\u7a81\uff0c\u5b83\u4eec\u4f1a\u5403\u4e86\u4f60\u3002</p> <p>\u4f46\u5728Git\u7684\u4e16\u754c\u91cc\uff0c\u8fd9\u4e9b\u52a8\u4f5c\u6781\u5176\u5ec9\u4ef7\u548c\u7b80\u5355\uff0c\u800c\u4e14\u5b83\u4eec\u88ab\u89c6\u4e3a<code>\u65e5\u5e38\u5de5\u4f5c\u6d41</code>\u7684\u6838\u5fc3\u90e8\u5206\u3002\u5728<code>CVS/Subversion</code>\u7684\u4e66\u4e2d\uff0c\u9996\u6b21\u4ecb\u7ecd\u5206\u652f\u4e0e\u5408\u5e76\u662f\u5728\u6700\u540e\u4e00\u7ae0\uff08\u5bf9\u4e8e\u9ad8\u7ea7\u7528\u6237\uff09\uff0c\u7136\u800cGit\u7684\u4e66\u4e2d\u662f\u5728\u7b2c\u4e09\u7ae0\uff08\u57fa\u7840\uff09\u3002</p> <p>\u7531\u4e8e\u5176\u5929\u751f\u7684<code>\u7b80\u5355\u6027</code>\u548c<code>\u91cd\u590d\u6027</code>\uff0c\u5206\u652f\u548c\u5408\u5e76\u4e0d\u518d\u662f\u4e00\u4ef6\u4ee4\u4eba\u5bb3\u6015\u7684\u4e8b\u60c5\u3002\u7248\u672c\u63a7\u5236\u5de5\u5177\u5e94\u8be5\u6bd4\u5176\u4ed6\u4efb\u4f55\u4e1c\u897f\u66f4\u6709\u52a9\u4e8e\u5206\u652f/\u5408\u5e76\u3002</p> <p>\u5173\u4e8e\u5de5\u5177\u5df2\u7ecf\u8c08\u5f97\u8db3\u591f\u4e86\uff0c\u8ba9\u6211\u4eec\u8fdb\u5165\u5f00\u53d1\u6a21\u578b\u7684\u8ba8\u8bba\u3002\u6211\u5c06\u4ecb\u7ecd\u7684\u6a21\u578b\u57fa\u672c\u4e0a\u53ea\u662f\u6bcf\u4e2a\u56e2\u961f\u5f00\u53d1\u6210\u5458\u5fc5\u987b\u9075\u5faa\u7684\u4e00\u7ec4\u7a0b\u5e8f\u624d\u80fd\u8fdb\u5165\u88ab\u7ba1\u7406\u7684\u8f6f\u4ef6\u5f00\u53d1\u8fc7\u7a0b\u3002</p>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/#_1","title":"\u5206\u6563\u4f46\u96c6\u4e2d","text":"<p>\u4e00\u4e2a\u4e2d\u5fc3\u7684\u771f\u5b9e\u7684\u4ed3\u5e93\uff0c\u662f\u6211\u4eec\u7528\u6765\u4e0e\u5f53\u524d<code>\u5206\u652f\u6a21\u578b</code>\u534f\u4f5c\u7684\u3002\u6ce8\uff1a\u8fd9\u4e2a\u4ed3\u5e93\u4ec5\u4ec5\u88ab<code>\u89c6\u4e3a</code>\u4e2d\u5fc3\u7684\u4e00\u4e2a\uff0c\u6211\u4eec\u6240\u7528\u7528\u6237\u5c06\u5176\u79f0\u4f5c<code>origin</code>\u3002</p> <p></p> <p>\u6bcf\u4e2a\u5f00\u53d1\u8005\u4eceorigin\u62c9\u53d6\uff08pull\uff09\u548c\u63a8\u9001\uff08push\uff09\u3002\u4f46\u662f\u9664\u4e86\u96c6\u4e2d\u5730\u63a8\u9001\u62c9\u53d6\u7684\u5173\u7cfb\uff0c\u6bcf\u4e2a\u5f00\u53d1\u4e2d\u4e5f\u4f1a\u4ece\u5176\u4ed6\u540c\u4e8b\u62c9\u53d6\u53d8\u66f4\u6765\u7ec4\u6210<code>\u5b50\u56e2\u961f</code>\uff0c\u4f8b\u5982\u8fd9\u5728\u5c06\u5de5\u4f5c\u8fdb\u5ea6\u6c38\u4e45\u63a8\u9001\u5230origin\u4e4b\u524d\uff0c\u4e24\u4e2a\u6216\u66f4\u591a\u5f00\u53d1\u8005\u534f\u4f5c\u5f00\u53d1\u4e00\u4e2a\u65b0\u7684\u529f\u80fd\u5f88\u6709\u7528\u3002\u5728\u4e0a\u56fe\u4e2d\uff0c\u6709\u4e09\u4e2a\u5b50\u56e2\u961f\uff0c\u5206\u522b\u662falice\u548cbob\u3001alice\u548cdavid\u3001david\u548cclair\u3002</p> <p>\u4ece\u6280\u672f\u4e0a\u8bb2\uff0c\u8fd9\u610f\u5473\u7740Alice\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u4e3a<code>bob</code>\u7684<code>\u8fdc\u7a0b\uff08remote\uff09</code>\uff0c\u6307\u5411Bob\u7684\u4ed3\u5e93\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002</p>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/#_2","title":"\u4e3b\u8981\u5206\u652f","text":"<p>\u5728\u6838\u5fc3\u90e8\u5206\uff0c\u8fd9\u4e2a\u5f00\u53d1\u6a21\u578b\u6781\u5927\u7a0b\u5ea6\u4e0a\u53d7\u4e0b\u9762\u7684\u6a21\u578b\u542f\u53d1\u3002\u4e2d\u592e\u4ed3\u5e93\u542b\u6709\u4e86\u4e24\u4e2a\u5177\u6709\u65e0\u9650\u751f\u547d\u65f6\u95f4\u7684\u5206\u652f\uff1a</p> <ul> <li>master</li> <li>develop</li> </ul> <p>origin\u7684<code>master</code>\u5206\u652f\u5e94\u8be5\u5bf9\u4e8e\u6240\u6709Git\u7528\u6237\u90fd\u5f88\u719f\u6089\u3002\u4e0emaster\u5e73\u884c\u5730\uff0c\u8fd8\u5b58\u5728\u4e00\u4e2a\u79f0\u4e3a<code>develop</code>\u7684\u5206\u652f\u3002</p> <p>\u6211\u4eec\u79f0<code>origin/master</code>\u662f\u4e3b\u8981\u7684\u5206\u652f\uff0c\u56e0\u4e3a\u5176HEAD\u7684\u6e90\u4ee3\u7801\u603b\u662f\u5728<code>\u751f\u4ea7\u5c31\u7eea\u72b6\u6001</code>\u3002</p> <p>\u6211\u4eec\u79f0<code>origin/develop</code>\u662f\u4e3b\u8981\u7684\u5206\u652f\uff0c\u56e0\u4e3a\u5176HEAD\u7684\u6e90\u4ee3\u7801\u603b\u662f\u5728\u4e0b\u4e00\u4e2a\u53d1\u5e03\u7248\u672c\u7684\u6700\u65b0\u4ea4\u4ed8\u7684\u5f00\u53d1\u53d8\u66f4\u3002\u6709\u65f6\u4e5f\u88ab\u79f0\u4f5c<code>\u96c6\u6210\u5206\u652f</code>\uff0c\u662f\u6240\u6709<code>\u81ea\u52a8\u591c\u95f4\u6784\u5efa</code>\u7684\u6765\u6e90\u3002</p> <p>\u5f53<code>develop</code>\u5206\u652f\u7684\u6e90\u4ee3\u7801\u8fbe\u5230\u7a33\u5b9a\u5e76\u4e14\u53d1\u5e03\u5c31\u7eea\u7684\u72b6\u6001\u65f6\uff0c\u6240\u6709\u7684\u53d8\u66f4\u5e94\u8be5\u88ab\u5408\u5e76\u56de\u5230<code>master</code>\uff0c\u5e76\u88ab\u6807\u8bb0\u4e0a\u4e00\u4e2a\u53d1\u5e03\u7f16\u53f7\u3002\u540e\u9762\u6211\u4eec\u4f1a\u8ba8\u8bba\u5b9e\u73b0\u7ec6\u8282\u3002</p> <p>\u56e0\u6b64\u3002\u6bcf\u6b21\u5c06\u53d8\u66f4\u5408\u5e76\u56de<code>master</code>\u65f6\uff0c\u6839\u636e\u5b9a\u4e49\uff0c\u8fd9\u662fi\u4e00\u4e2a\u65b0\u7684\u751f\u4ea7\u7248\u672c\uff0c\u5bf9\u6b64\u5e94\u8be5\u975e\u5e38\u4e25\u683c\u3002\u53ef\u4ee5\u4f7f\u7528Git\u94a9\u5b50\u811a\u672c\u5728\u6bcf\u6b21\u6709<code>master</code>\u63d0\u4ea4\u65f6\u81ea\u52a8\u6784\u5efa\u548c\u63a8\u51fa\u8f6f\u4ef6\u5230\u6211\u4eec\u7684\u751f\u4ea7\u670d\u52a1\u5668\u3002</p>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/#_3","title":"\u652f\u6301\u5206\u652f","text":"<p>\u5728\u4e3b\u5206\u652f<code>master</code>\u548c<code>develop</code>\u4e4b\u540e\uff0c\u6211\u4eec\u7684\u5f00\u53d1\u6a21\u578b\u8fd8\u4f1a\u7528\u5230\u4e00\u7cfb\u5217<code>\u652f\u6301\u5206\u652f</code>\u6765\u7528\u4e8e\u56e2\u961f\u6210\u5458\u4e4b\u95f4\u7684\u5e73\u884c\u5f00\u53d1\uff0c\u4f7f\u8ddf\u8e2a\u529f\u80fd\u3001\u51c6\u5907\u751f\u4ea7\u53d1\u5e03\u548c\u5feb\u901f\u4fee\u590d\u751f\u4ea7\u73af\u5883\u95ee\u9898\u7b49\u3002\u4e0e\u4e3b\u5206\u652f\u4e0d\u540c\uff0c\u8fd9\u4e9b\u5206\u652f\u901a\u5e38\u7684\u751f\u547d\u5468\u671f\u7684\u6709\u9650\u7684\uff0c\u56e0\u4e3a\u5b83\u4eec\u6700\u540e\u4f1a\u88ab\u5220\u9664\u3002</p> <p>\u6211\u4eec\u7528\u5230\u7684\u4e0d\u540c\u79cd\u7c7b\u7684\u5206\u652f\u662f\uff1a</p> <ul> <li><code>Feature</code>\u5206\u652f</li> <li><code>Release</code>\u5206\u652f</li> <li><code>Hotfix</code>\u5206\u652f</li> </ul> <p>\u8fd9\u4e9b\u5206\u652f\u7684\u6ca1\u4e00\u4e2a\u90fd\u6709\u7279\u5b9a\u7684\u76ee\u7684\uff0c\u5e76\u4e14\u5fc5\u987b\u9075\u5b88\u5173\u4e8e\u54ea\u4e9b\u5206\u652f\u5fc5\u987b\u662f\u5b83\u4eec\u7684<code>\u5408\u5e76\u76ee\u6807</code>\u7684\u4e25\u683c\u89c4\u5219\u3002\u6211\u4eec\u4e0b\u9762\u5f00\u59cb\u8ba8\u8bba\u5b83\u4eec\u3002</p> <p>\u4ece\u6280\u672f\u89d2\u5ea6\u6765\u770b\uff0c\u8fd9\u4e9b\u5206\u652f<code>\u4e0d\u662f</code>\u7279\u6b8a\u7684\uff0c\u5206\u652f\u7c7b\u578b\u53d6\u51b3\u4e0e\u6211\u4eec\u5982\u4f55\u4f7f\u7528\u5b83\u4eec\uff0c\u5b83\u4eec\u662f\u666e\u901a\u7684Git\u5206\u652f\u3002</p>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/#feature","title":"Feature\u5206\u652f","text":"<p>\u53ef\u4ee5\u4ece<code>develop</code>\u5206\u652f\u521b\u5efa\uff0c\u53ef\u4ee5\u5408\u5e76\u5230<code>develop</code>\uff0c\u5206\u652f\u547d\u540d\u60ef\u4f8b\uff1a\u9664\u4e86<code>master</code>\u3001<code>develop</code>\u3001<code>release-*</code>\u6216\u8005<code>hotfix-*</code>\u4e4b\u5916\u7684\u540d\u79f0\u3002</p> <p></p> <p><code>Feature</code>\u5206\u652f\uff08\u6216\u8005\u6709\u65f6\u88ab\u79f0\u4f5cTopic\u5206\u652f\uff09\u901a\u5e38\u5907\u7528\u505a\u5f00\u53d1\u8fd1\u671f\u6216\u8005\u8fdc\u671f\u65b0\u7684\u7279\u5f81\u3002\u5f53\u5f00\u59cb\u5f00\u53d1\u4e00\u4e2a\u7279\u5f81\u65f6\uff0c\u53ef\u80fd\u8fd8\u4e0d\u77e5\u9053\u6b64\u7279\u5f81\u5c06\u4f1a\u5408\u5e76\u5230\u54ea\u4e00\u4e2a\u53d1\u5e03\u3002\u4e00\u4e2afeature\u5206\u652f\u7684\u672c\u8d28\u662f\u5728\u5176\u5bf9\u5e94\u7279\u5f81\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u5b58\u5728\uff0c\u4f46\u6700\u7ec8\u4f1a\u88ab\u5408\u5e76\u56dedevelop\uff08\u786e\u5b9a\u5730\u5c06\u8be5\u7279\u5f81\u6dfb\u52a0\u5230\u8fd1\u671f\u7684\u53d1\u5e03\u4e2d\uff09\u6216\u8005\u88ab\u5ffd\u7565\uff08\u6bd4\u5982\u4e00\u4e2a\u4ee4\u4eba\u5931\u671b\u7684\u5b9e\u9a8c\u7684\u60c5\u51b5\uff09\u3002</p>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/#feature_1","title":"\u521b\u5efa\u4e00\u4e2afeature\u5206\u652f","text":"<p>\u5f53\u5f00\u59cb\u4e00\u4e2a\u65b0\u7279\u5f81\u65f6\uff0c\u4ece<code>develop</code>\u5206\u652f\u521b\u5efa\uff1a</p> <pre><code>$ git checkout -b myfeature develop\nSwitched to a new branch \"myfeature\"\n</code></pre>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/#featuredevelop","title":"\u5c06\u4e00\u4e2a\u5b8c\u6210\u7684feature\u52a0\u5165\u5230develop","text":"<pre><code>$ git checkout develop\nSwitched to branch 'develop'\n$ git merge --no-ff myfeature\nUpdating ea1b82a..05e9557\n(Summary of changes)\n$ git branch -d myfeature\nDeleted branch myfeature (was 05e9557).\n$ git push origin develop\n</code></pre> <p><code>--no-ff</code>\u6807\u5fd7\u4f7f\u5408\u5e76\u59cb\u7ec8\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u63d0\u4ea4\u5bf9\u8c61\uff0c\u5373\u4f7f\u53ef\u4ee5\u4f7f\u7528<code>\u5feb\u8fdb\uff08fast-forward\uff09</code>\u6267\u884c\u5408\u5e76\u3002\u8fd9\u6837\u907f\u514d\u4e86\u4e22\u5931\u6709\u5173feature\u5206\u652f\u5386\u53f2\u5b58\u5728\u7684\u4fe1\u606f\uff0c\u5e76\u5c06\u6240\u6709\u4e00\u8d77\u6dfb\u52a0\u529f\u80fd\u7684\u63d0\u4ea4\u7ec4\u5408\u5728\u4e00\u8d77\u3002\u5bf9\u6bd4\uff1a</p> <p></p> <p>\u5728\u53f3\u8fb9\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0d\u80fd\u4eceGit\u5386\u53f2\u4e2d\u770b\u5230\u90a3\u4e9b\u63d0\u4ea4\u5bf9\u8c61\u4e00\u8d77\u5b9e\u73b0\u4e86\u4e00\u4e2a\u529f\u80fd\u2014\u2014\u53ea\u80fd\u8bfb\u53d6\u65e5\u5fd7\u6d88\u606f\u3002\u56de\u6eda\u6574\u4e2afeature\uff08\u4e5f\u5c31\u662f\u4e00\u7ec4\u63d0\u4ea4\uff09\u5219\u662f\u4ee4\u4eba\u5934\u75bc\u7684\uff0c\u4f46\u82e5\u4f7f\u7528\u4e86<code>--no-ff</code>\u6807\u5fd7\uff0c\u4e00\u5207\u5c06\u4f1a\u53d8\u5f97\u7b80\u5355\u3002</p> <p>\u662f\u7684\uff0c\u5b83\u4f1a\u521b\u5efa\u4e00\u4e9b\uff08\u7a7a\u767d\u7684\uff09\u63d0\u4ea4\u5bf9\u8c61\uff0c\u4f46\u662f\u6536\u76ca\u8fdc\u5927\u4e8e\u6210\u672c\u3002</p>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/#release","title":"Release\u5206\u652f","text":"<p>\u4ece<code>develop</code>\u5206\u652f\u521b\u5efa\uff0c\u5fc5\u987b\u5408\u5e76\u56de<code>develop</code>\u548c<code>master</code>\uff0c\u5206\u652f\u547d\u540d\u60ef\u4f8b<code>release-*</code></p> <p><code>Release</code>\u5206\u652f\u652f\u6301\u4e86\u4e00\u4e2a\u65b0\u7684\u751f\u4ea7\u53d1\u5e03\u7684\u51c6\u5907\u3002\u5b83\u4eec\u5141\u8bb8\u6700\u540e\u4e00\u523b\u7684\u4fee\u6539\u3002\u6b64\u5916\uff0c\u5b83\u4eec\u5141\u8bb8\u6b21\u8981\u7684BUG\u4fee\u590d\u548c\u4e3a\u4e00\u6b21\u53d1\u5e03\u7684\u5143\u6570\u636e\u51c6\u5907\u5de5\u4f5c\uff08\u7248\u672c\u53f7\u3001\u6784\u5efa\u65e5\u671f\u7b49\u7b49\uff09\u3002\u901a\u8fc7\u5728release\u5206\u652f\u4e0a\u5b8c\u6210\u6240\u6709\u8fd9\u4e9b\u5de5\u4f5c\uff0cdevelop\u5206\u652f\u5c06\u4f1a\u662f\u5e72\u51c0\u7684\u4ee5\u63a5\u53d7\u4e0b\u4e00\u4e2a\u5927\u53d1\u5e03\u7684feature\u3002</p> <p>\u4ecedevelop\u5206\u652f\u521b\u5efa\u4e00\u4e2a\u65b0\u7684release\u5206\u652f\u7684\u5173\u952e\u65f6\u523b\u662fdevelop\u5206\u652f\uff08\u5f88\u5927\u7a0b\u5ea6\u4e0a\uff09\u662f\u65b0\u7684\u53d1\u5e03\u7684\u671f\u671b\u72b6\u6001\u3002\u81f3\u5c11\u6240\u6709\u9488\u5bf9\u8981\u6784\u5efa\u6309\u7684\u53d1\u5e03\u7684\u529f\u80fd\u6b64\u65f6\u5df2\u7ecf\u88ab\u5408\u5e76\u5230develop\u5206\u652f\u3002\u9488\u5bf9\u672a\u6765\u53d1\u5e03\u7684\u6240\u6709feature\u53ef\u80fd\u4e0d\u4f1a\uff0c\u5b83\u4eec\u5fc5\u987b\u7b49\u5230\u5b83\u4eec\u5bf9\u5e94\u7684release\u88ab\u521b\u5efa\u3002</p> <p>\u6b63\u662f\u5728\u4e00\u4e2arelease\u5206\u652f\u5f00\u59cb\u65f6\uff0c\u5373\u5c06\u53d1\u5e03\u7684\u53d1\u5e03\u5c06\u88ab\u5206\u914d\u4e00\u4e2a\u7248\u672c\u53f7\uff0c\u800c\u4e0d\u662f\u4e4b\u524d\u4efb\u4f55\u65f6\u95f4\u3002\u76f4\u5230release\u5206\u652f\u5f00\u59cb\u65f6\uff0cdevelop\u5206\u652f\u662f<code>\u4e0b\u4e00\u4e2a\u53d1\u5e03</code>\u7684\u53d8\u66f4\uff0c\u4f46\u662f\u5176\u7248\u672c\u53f7\u662f0.3\u6216\u662f1.0\u624d\u80fd\u786e\u5b9a\u3002</p>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/#release_1","title":"\u521b\u5efa\u4e00\u4e2arelease\u5206\u652f","text":"<p><code>Release</code>\u5206\u652f\u4ece<code>develop</code>\u5206\u652f\u521b\u5efa\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u7248\u672c<code>1.1.5</code>\u662f\u5f53\u524d\u751f\u4ea7\u53d1\u5e03\uff0c\u800c\u4e14\u6211\u4eec\u6709\u4e00\u4e2a\u5373\u5c06\u5230\u6765\u7684\u5927\u53d1\u5e03\u3002develop\u5206\u652f\u7684\u72b6\u6001\u5df2\u7ecf\u4e3a\u4e0b\u4e00\u4e2a\u53d1\u5e03\u51c6\u5907\u597d\u4e86\uff0c\u6211\u4eec\u5df2\u7ecf\u786e\u5b9a\u8fd9\u5c06\u662f\u7248\u672c<code>1.2</code>\uff08\u800c\u4e0d\u662f1.1.6\u62162.0\uff09\u3002\u6240\u4ee5\u6211\u4eec\u521b\u5efa\u8fd9\u4e2arelease\u5206\u652f\uff0c\u5e76\u4e14\u540d\u4e3a\u53cd\u6620\u8fd9\u4e2a\u65b0\u7248\u672c\u53f7\uff1a</p> <pre><code>$ git checkout -b release-1.2 develop\nSwitched to a new branch \"release-1.2\"\n$ ./bump-version.sh 1.2\nFiles modified successfully, version bumped to 1.2.\n$ git commit -a -m \"Bumped version number to 1.2\"\n[release-1.2 74d9424] Bumped version number to 1.2\n1 files changed, 1 insertions(+), 1 deletions(-)\n</code></pre> <p>\u5728\u521b\u5efa\u65b0\u5206\u652f\u5e76\u5207\u6362\u5230\u5b83\u540e\uff0c\u6211\u4eec\u4f1a\u4fee\u6539\u7248\u672c\u53f7\u3002\u8fd9\u91cc\uff0c<code>bump-version.sh</code>\u662f\u4e00\u4e2a\u865a\u6784\u7684shell\u811a\u672c\uff0c\u5b83\u53ef\u4ee5\u66f4\u6539\u5de5\u4f5c\u526f\u672c\u4e2d\u7684\u67d0\u4e9b\u6587\u4ef6\u4ee5\u53cd\u6620\u65b0\u7248\u672c\u3002 \uff08\u8fd9\u5f53\u7136\u53ef\u4ee5\u662f\u624b\u52a8\u66f4\u6539 - \u5173\u952e\u662f<code>\u67d0\u4e9b</code>\u6587\u4ef6\u4f1a\u53d1\u751f\u53d8\u5316\u3002\uff09\u7136\u540e\uff0c\u63d0\u4ea4\u4e86\u6709\u95ee\u9898\u7684\u7248\u672c\u53f7\u3002</p> <p>\u8fd9\u4e2a\u65b0\u7684\u5206\u652f\u53ef\u80fd\u5b58\u5728\u4e00\u6bb5\u65f6\u95f4\uff0c\u76f4\u5230\u53d1\u5e03\u53ef\u80fd\u80af\u5b9a\u63a8\u51fa(rolled out)\u3002\u5728\u6b64\u671f\u95f4\uff0c\u53ef\u4ee5\u5728\u6b64\u5206\u652f\u4e2d\u5e94\u7528\u9519\u8bef\u4fee\u590d\uff08\u800c\u4e0d\u662f\u5728<code>develop</code>\u5206\u652f\u4e0a\uff09\u3002\u4e25\u7981\u5728\u6b64\u5904\u6dfb\u52a0\u5927\u578b\u65b0\u529f\u80fd\u3002\u5b83\u4eec\u5fc5\u987b\u5408\u5e76\u5230<code>develop</code>\uff0c\u56e0\u6b64\uff0c\u7b49\u5f85\u4e0b\u4e00\u4e2a\u5927\u7684\u53d1\u5e03\u3002</p>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/#release_2","title":"\u5b8c\u6210\u4e00\u4e2arelease\u5206\u652f","text":"<p>\u5f53\u53d1\u5e03\u5206\u652f\u7684\u72b6\u6001\u51c6\u5907\u597d\u6210\u4e3a\u771f\u6b63\u7684\u53d1\u5e03\u65f6\uff0c\u9700\u8981\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\u3002\u9996\u5148\uff0c\u5c06<code>release</code>\u5408\u5e76\u5230<code>master</code>\uff08\u56e0\u4e3amaster\u4e0a\u7684\u6bcf\u4e2a\u63d0\u4ea4\u90fd\u662f\u5b9a\u4e49\u7684\u65b0\u7248\u672c\uff0c\u8bf7\u8bb0\u4f4f\uff09\u3002\u63a5\u4e0b\u6765\uff0c\u5fc5\u987b\u6807\u8bb0<code>master</code>\u4e0a\u7684\u63d0\u4ea4\u4ee5\u4fbf\u5c06\u6765\u53c2\u8003\u6b64\u5386\u53f2\u7248\u672c\u3002\u6700\u540e\uff0c\u5728<code>release</code>\u5206\u652f\u4e0a\u8fdb\u884c\u7684\u66f4\u6539\u9700\u8981\u5408\u5e76\u56de\u5230<code>develop</code>\u4e2d\uff0c\u4ee5\u4fbf\u5c06\u6765\u7684\u7248\u672c\u4e5f\u5305\u542b\u8fd9\u4e9b\u9519\u8bef\u4fee\u590d\u3002</p> <p>\u524d\u4e24\u4e2a\u6b65\u9aa4\uff1a</p> <pre><code>$ git checkout master\nSwitched to branch 'master'\n$ git merge --no-ff release-1.2\nMerge made by recursive.\n(Summary of changes)\n$ git tag -a 1.2\n</code></pre> <p>\u8be5release\u73b0\u5df2\u5b8c\u6210\uff0c\u5e76\u6807\u8bb0\u4ee5\u4f9b\u5c06\u6765\u53c2\u8003\u3002</p> <p>\u66f4\u65b0\uff1a\u60a8\u53ef\u80fd\u8fd8\u60f3\u4f7f\u7528<code>-s</code>\u6216<code>-u &lt;key&gt;</code>\u6807\u5fd7\u4ee5\u52a0\u5bc6\u65b9\u5f0f\u5bf9\u6807\u8bb0\u8fdb\u884c\u7b7e\u540d\u3002</p> <p>\u4e3a\u4e86\u4fdd\u6301<code>release</code>\u5206\u652f\u4e2d\u6240\u505a\u7684\u66f4\u6539\uff0c\u6211\u4eec\u9700\u8981\u5c06\u8fd9\u4e9b\u66f4\u6539\u5408\u5e76\u5230<code>develop</code>\u4e2d\uff1a</p> <pre><code>$ git checkout develop\nSwitched to branch 'develop'\n$ git merge --no-ff release-1.2\nMerge made by recursive.\n(Summary of changes)\n</code></pre> <p>\u8fd9\u4e00\u6b65\u5f88\u53ef\u80fd\u5bfc\u81f4\u5408\u5e76\u51b2\u7a81\uff08\u53ef\u80fd\u56e0\u4e3a\u6211\u4eec\u5df2\u7ecf\u66f4\u6539\u4e86\u7248\u672c\u53f7\uff09\u3002\u5982\u679c\u662f\u8fd9\u6837\uff0c\u8bf7\u4fee\u590d\u5e76\u63d0\u4ea4\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u4e86\uff0c\u5e76\u4e14\u53ef\u80fd\u4f1a\u5220\u9664<code>release</code>\u5206\u652f\uff0c\u56e0\u4e3a\u6211\u4eec\u4e0d\u518d\u9700\u8981\u5b83\u4e86\uff1a</p> <pre><code>$ git branch -d release-1.2\nDeleted branch release-1.2 (was ff452fe).\n</code></pre>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/#hotfix","title":"Hotfix\u5206\u652f","text":"<p>\u4ece<code>master</code>\u5206\u652f\u521b\u5efa\uff0c\u5fc5\u987b\u5408\u5e76\u56de<code>develop</code>\u548c<code>master</code>\uff0c\u5206\u652f\u547d\u540d\u60ef\u4f8b<code>htofix-*</code></p> <p></p> <p><code>Hotfix</code>\u5206\u652f\u975e\u5e38\u50cf<code>release</code>\u5206\u652f\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e5f\u662f\u4e3a\u4e86\u51c6\u5907\u65b0\u7684\u751f\u4ea7\u7248\u672c\uff0c\u5c3d\u7ba1\u662f<code>\u8ba1\u5212\u5916</code>\u7684\u3002\u5b83\u4eec\u6e90\u4e8e\u5fc5\u987b\u7acb\u5373\u91c7\u53d6\u5b9e\u9645\u751f\u4ea7\u7248\u672c\u7684<code>\u4e0d\u826f\u72b6\u6001</code>\u3002\u5f53\u5fc5\u987b\u7acb\u5373\u89e3\u51b3\u751f\u4ea7\u7248\u672c\u4e2d\u7684\u4e25\u91cd\u9519\u8bef\u65f6\uff0c\u53ef\u4ee5\u4ece\u6807\u8bb0\u751f\u4ea7\u7248\u672c\u7684<code>master</code>\u5206\u652f\u4e0a\u7684\u76f8\u5e94\u6807\u8bb0\u5206\u652f\u4fee\u8865\u7a0b\u5e8f\u5206\u652f\u3002</p> <p>\u5b9e\u8d28\u662f\u56e2\u961f\u6210\u5458\uff08\u5728<code>develop</code>\u5206\u652f\uff09\u7684\u5de5\u4f5c\u53ef\u4ee5\u7ee7\u7eed\uff0c\u800c\u53e6\u4e00\u4e2a\u4eba\u6b63\u5728\u51c6\u5907\u4fee\u590d\u751f\u4ea7\u73af\u5883\u95ee\u9898\u3002</p>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/#hotfix_1","title":"\u521b\u5efahotfix\u5206\u652f","text":"<p>\u4ece<code>master</code>\u5206\u652f\u521b\u5efa<code>hotfix</code>\u5206\u652f\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u7248\u672c<code>1.2</code>\u662f\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u751f\u4ea7\u7248\u672c\uff0c\u5e76\u4e14\u7531\u4e8e\u4e25\u91cd\u7684\u9519\u8bef\u800c\u5bfc\u81f4\u9ebb\u70e6\u3002\u4f46\u662f\u53d1\u5c55\u7684\u53d8\u5316\u8fd8\u4e0d\u7a33\u5b9a\u3002\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5206\u652f<code>hotfix</code>\u5206\u652f\u5e76\u5f00\u59cb\u4fee\u590d\u95ee\u9898\uff1a</p> <pre><code>$ git checkout -b hotfix-1.2.1 master\nSwitched to a new branch \"hotfix-1.2.1\"\n$ ./bump-version.sh 1.2.1\nFiles modified successfully, version bumped to 1.2.1.\n$ git commit -a -m \"Bumped version number to 1.2.1\"\n[hotfix-1.2.1 41e61bb] Bumped version number to 1.2.1\n1 files changed, 1 insertions(+), 1 deletions(-)\n</code></pre> <p>\u5206\u652f\u540e\u4e0d\u8981\u5fd8\u8bb0\u589e\u52a0\u7248\u672c\u53f7\uff01</p> <p>\u7136\u540e\uff0c\u4fee\u590d\u9519\u8bef\u5e76\u5728\u4e00\u4e2a\u6216\u591a\u4e2a\u5355\u72ec\u7684\u63d0\u4ea4\u4e2d\u63d0\u4ea4\u4fee\u590d\uff1a</p> <pre><code>$ git commit -m \"Fixed severe production problem\"\n[hotfix-1.2.1 abbe5d6] Fixed severe production problem\n5 files changed, 32 insertions(+), 17 deletions(-)\n</code></pre>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/#hotfix_2","title":"\u7ed3\u675f\u4e00\u4e2ahotfix\u5206\u652f","text":"<p>\u5b8c\u6210\u540e\uff0c<code>hotfix</code>\u9700\u8981\u5408\u5e76\u56de<code>master</code>\uff0c\u4f46\u4e5f\u9700\u8981\u5408\u5e76\u56de<code>develop</code>\uff0c\u4ee5\u4fdd\u8bc1<code>\u5bf9\u9519\u8bef\u7684\u4fee\u590d</code>\u4e5f\u5305\u542b\u5728\u4e0b\u4e00\u4e2a\u7248\u672c\u4e2d\u3002\u8fd9\u4e0e\u53d1\u5e03\u5206\u652f\u7684\u5b8c\u6210\u65b9\u5f0f\u5b8c\u5168\u76f8\u4f3c\u3002</p> <p>\u9996\u5148\uff0c\u66f4\u65b0master\u5e76\u6807\u8bb0\u53d1\u5e03\uff1a</p> <pre><code>$ git checkout master\nSwitched to branch 'master'\n$ git merge --no-ff hotfix-1.2.1\nMerge made by recursive.\n(Summary of changes)\n$ git tag -a 1.2.1\n</code></pre> <p>\u66f4\u65b0\uff1a\u60a8\u53ef\u80fd\u8fd8\u60f3\u4f7f\u7528<code>-s</code>\u6216<code>-u &lt;key&gt;</code>\u6807\u5fd7\u4ee5\u52a0\u5bc6\u65b9\u5f0f\u5bf9\u6807\u8bb0\u8fdb\u884c\u7b7e\u540d\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u5728<code>develop</code>\u4e2d\u5305\u542bbug\u4fee\u590d\uff1a</p> <pre><code>$ git checkout develop\nSwitched to branch 'develop'\n$ git merge --no-ff hotfix-1.2.1\nMerge made by recursive.\n(Summary of changes)\n</code></pre> <p>\u6b64\u5904\u89c4\u5219\u7684\u4e00\u4e2a\u4f8b\u5916\u662f\uff0c\u5f53<code>release</code>\u5206\u652f\u5f53\u524d\u5b58\u5728\u65f6\uff0c\u9700\u8981\u5c06<code>hitfix</code>\u66f4\u6539\u5408\u5e76\u5230\u8be5<code>release</code>\u5206\u652f\u4e2d\uff0c\u800c\u4e0d\u662f<code>develop</code>\u3002\u5728<code>release</code>\u5206\u652f\u5b8c\u6210\u65f6\uff0c\u5c06<code>hotfix</code>\u53cd\u5411\u5408\u5e76\u5230<code>release</code>\u5206\u652f\u4e2d\u6700\u7ec8\u5c06\u5bfc\u81f4<code>hotfix</code>\u5408\u5e76\u5230<code>develop</code>\u4e2d\u3002\uff08\u5982\u679c\u7acb\u5373\u5f00\u53d1\u5de5\u4f5c\u9700\u8981\u8fd9\u4e2a\u9519\u8bef\u4fee\u590d\uff0c\u5e76\u4e14\u4e0d\u80fd\u7b49\u5f85\u53d1\u5e03\u5206\u652f\u5b8c\u6210\uff0c\u60a8\u53ef\u4ee5\u5b89\u5168\u5730\u5c06<code>hotfix</code>\u5408\u5e76\u5230<code>hotfix</code>\u4e2d\u3002\uff09</p> <p>\u6700\u540e\uff0c\u5220\u9664\u8fd9\u4e2a\u5206\u652f\uff1a</p> <pre><code>$ git branch -d hotfix-1.2.1\nDeleted branch hotfix-1.2.1 (was abbe5d6).\n</code></pre>"},{"location":"2019-05-09-%E4%B8%80%E4%B8%AA%E6%88%90%E5%8A%9F%E7%9A%84Git%E5%88%86%E6%94%AF%E6%A8%A1%E5%9E%8B/#_4","title":"\u603b\u7ed3","text":"<p>\u867d\u7136\u8fd9\u4e2a\u5206\u652f\u6a21\u578b\u5e76\u6ca1\u6709\u4ec0\u4e48\u4ee4\u4eba\u9707\u60ca\u7684\u65b0\u529f\u80fd\uff0c\u4f46\u8fd9\u7bc7\u6587\u7ae0\u5f00\u5934\u7684<code>\u5206\u652f\u56fe</code>\u5728\u6211\u4eec\u7684\u9879\u76ee\u4e2d\u975e\u5e38\u6709\u7528\u3002\u5b83\u5f62\u6210\u4e86\u4e00\u4e2a\u6613\u4e8e\u7406\u89e3\u7684\u4f18\u96c5\u5fc3\u7406\u6a21\u578b\uff0c\u5e76\u5e2e\u52a9\u56e2\u961f\u6210\u5458\u5f62\u6210\u5bf9\u5206\u652f\u548c\u53d1\u5e03\u8fc7\u7a0b\u7684<code>\u5171\u540c\u7406\u89e3</code>\u3002\u6b64\u5904\u63d0\u4f9b\u4e86\u8be5\u56fe\u7684\u9ad8\u8d28\u91cfPDF\u7248\u672c\uff0c\u60a8\u53ef\u4ee5\u628a\u5b83\u6302\u5728\u5899\u4e0a\uff0c\u4ee5\u4fbf\u968f\u65f6\u53c2\u8003\u3002</p>"},{"location":"2019-05-11-%E3%80%8C%E5%8B%BE%E5%8B%BE%E3%80%8D%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E8%B0%B7%E6%AD%8C%E7%9A%84%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/","title":"2019 05 11 \u300c\u52fe\u52fe\u300d\u4e00\u4e2a\u57fa\u4e8e\u8c37\u6b4c\u7684\u641c\u7d22\u5de5\u5177","text":""},{"location":"2019-05-11-%E3%80%8C%E5%8B%BE%E5%8B%BE%E3%80%8D%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E8%B0%B7%E6%AD%8C%E7%9A%84%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/#_1","title":"\u662f\u4ec0\u4e48","text":"<p>\u300c\u52fe\u52fe\u300d\u662f\u4e00\u4e2a\u641c\u7d22\u5de5\u5177\uff0c\u641c\u7d22\u7ed3\u679c\u57fa\u4e8e\u8c37\u6b4c\uff0c\u81f4\u529b\u4e8e\u300c\u5b89\u5168\u548c\u7b80\u6d01\u300d\u7684\u641c\u7d22\u4f53\u9a8c\u3002</p>"},{"location":"2019-05-11-%E3%80%8C%E5%8B%BE%E5%8B%BE%E3%80%8D%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E8%B0%B7%E6%AD%8C%E7%9A%84%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/#_2","title":"\u5b89\u5168","text":"<ul> <li> <p>\u300c\u52fe\u52fe\u300d\u662f\u4e00\u4e2a\u5728<code>\u7528\u6237</code>\u4e0e<code>\u8c37\u6b4c</code>\u4e4b\u95f4\u7684\u4ee3\u7406\uff0c\u8c37\u6b4c\u65e0\u6cd5\u5f97\u77e5\u7528\u6237\u7684\u9690\u79c1\uff08\u5982UserAgent\u3001Cookie\u7b49\uff09\uff0c\u4e5f\u65e0\u6cd5<code>\u8ddf\u8e2a\u7528\u6237\u7684\u7ed3\u679c\u70b9\u51fb</code></p> </li> <li> <p>\u90e8\u7f72\u7b80\u5355\uff0c\u57fa\u4e8e<code>JDK 11</code>\uff0c\u4ec5\u9700\u4e00\u53f0\u5904\u4e8e<code>\u53ef\u4ee5\u8bbf\u95ee\u8c37\u6b4c\u7684\u7f51\u7edc</code>\u7684\u4e3b\u673a\u5373\u53ef</p> </li> </ul>"},{"location":"2019-05-11-%E3%80%8C%E5%8B%BE%E5%8B%BE%E3%80%8D%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E8%B0%B7%E6%AD%8C%E7%9A%84%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/#_3","title":"\u7b80\u6d01","text":"<ul> <li>~~\u7cbe\u7b80~~\uff08\u4e11\u964b\uff09\u5230\u6781\u81f4\u7684Web\u524d\u7aef</li> <li>\u63d0\u4f9bWeb API\uff0c\u8f7b\u677e\u5730\u81ea\u5b9a\u4e49\u641c\u7d22\u524d\u7aef</li> </ul>"},{"location":"2019-05-11-%E3%80%8C%E5%8B%BE%E5%8B%BE%E3%80%8D%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E8%B0%B7%E6%AD%8C%E7%9A%84%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/#_4","title":"\u5982\u4f55\u4f7f\u7528","text":"<p>\u672c\u7a0b\u5e8f\u901a\u8fc7<code>\u7f51\u9875</code>\u3001<code>\u547d\u4ee4\u884c</code>\u548c<code>Web API</code>\u4e09\u79cd\u65b9\u5f0f\u63d0\u4f9b\u670d\u52a1\u3002</p>"},{"location":"2019-05-11-%E3%80%8C%E5%8B%BE%E5%8B%BE%E3%80%8D%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E8%B0%B7%E6%AD%8C%E7%9A%84%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/#_5","title":"\u7f51\u9875","text":"<p>\u53ef\u8bbf\u95ee\u5b9e\u4f8b\u4f53\u9a8c</p> <p>\u9996\u9875\u622a\u56fe\uff1a</p> <p></p> <p>\u641c\u7d22\u9875\u9762\u622a\u56fe\uff1a</p> <p></p>"},{"location":"2019-05-11-%E3%80%8C%E5%8B%BE%E5%8B%BE%E3%80%8D%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E8%B0%B7%E6%AD%8C%E7%9A%84%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/#_6","title":"\u547d\u4ee4\u884c","text":"<p>\u8bf7\u5230Release\u9875\u9762\u4e0b\u8f7d\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u5e76\u91cd\u547d\u540d\u4e3a<code>gogo-cli</code>\uff0c\u653e\u7f6e\u5230<code>PATH</code>\u8def\u5f84\u4e0b</p> <pre><code>$ gogo-cli github 1\n</code></pre> <p>\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"2019-05-11-%E3%80%8C%E5%8B%BE%E5%8B%BE%E3%80%8D%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E8%B0%B7%E6%AD%8C%E7%9A%84%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/#web-api","title":"Web API","text":""},{"location":"2019-05-11-%E3%80%8C%E5%8B%BE%E5%8B%BE%E3%80%8D%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E8%B0%B7%E6%AD%8C%E7%9A%84%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/#_7","title":"\u641c\u7d22","text":"<pre><code>$ curl -X GET -k \"https://176.122.157.231:5000/api/search?q=github&amp;p=1\"\n{\n\"key\": \"github\",\n  \"page\": 1,\n  \"amount\": 223000000,\n  \"elapsed\": 0.43,\n  \"entries\": [\n{\n\"name\": \"The world's leading software development platform \u00b7 GitHub\",\n      \"url\": \"https://github.com/\",\n      \"desc\": \"GitHub brings together the world's largest community of developers to discover, share, and build better software. From open source projects to private team ...\"\n}\n],\n  \"error\": null\n}\n</code></pre>"},{"location":"2019-05-11-%E3%80%8C%E5%8B%BE%E5%8B%BE%E3%80%8D%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E8%B0%B7%E6%AD%8C%E7%9A%84%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/#_8","title":"\u5173\u952e\u8bcd\u63d0\u793a","text":"<pre><code>$ curl -X GET -k \"https://176.122.157.231:5000/api/lint?q=github\"\n{\n\"key\": \"github\",\n  \"lints\": [\n\"github\",\n    \"github&lt;b&gt; desktop&lt;/b&gt;\",\n    \"github&lt;b&gt; stock&lt;/b&gt;\",\n    \"github&lt;b&gt; microsoft&lt;/b&gt;\",\n    \"github&lt;b&gt; pages&lt;/b&gt;\",\n    \"github&lt;b&gt; api&lt;/b&gt;\",\n    \"github&lt;b&gt; tutorial&lt;/b&gt;\",\n    \"github&lt;b&gt; login&lt;/b&gt;\",\n    \"github&lt;b&gt; markdown&lt;/b&gt;\",\n    \"github&lt;b&gt; gist&lt;/b&gt;\"\n],\n  \"error\": null\n}\n</code></pre>"},{"location":"2019-05-11-%E3%80%8C%E5%8B%BE%E5%8B%BE%E3%80%8D%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E8%B0%B7%E6%AD%8C%E7%9A%84%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/#_9","title":"\u5f00\u53d1\u8ba1\u5212","text":"<ul> <li>\u540e\u7aef\u5b9e\u73b0\u7ec6\u8282\u6587\u6863</li> <li>\u53ef\u914d\u7f6e\u7684\u7f13\u5b58\uff1a\u5185\u5b58\u4e0eRedis</li> </ul>"},{"location":"2019-05-11-%E3%80%8C%E5%8B%BE%E5%8B%BE%E3%80%8D%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E8%B0%B7%E6%AD%8C%E7%9A%84%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/#_10","title":"\u6846\u67b6","text":"<p>\u7ad9\u5728\u5de8\u4eba\u7684\u80a9\u8180\u4e0a</p> <ul> <li>Netty</li> <li>Jsoup</li> <li>SpringBoot</li> </ul>"},{"location":"2019-05-16-Golang%E5%88%9D%E4%BD%93%E9%AA%8C%E4%B9%8B%E8%A7%A3%E7%BB%84JSON%E5%B9%B6%E5%86%99%E5%85%A5MySQL/","title":"2019 05 16 Golang\u521d\u4f53\u9a8c\u4e4b\u89e3\u7ec4JSON\u5e76\u5199\u5165MySQL","text":"<p>\u95f2\u8bdd\u5c11\u53d9\uff0c\u501f\u52a9chinese-poetry\u9879\u76ee\u7684\u6570\u636e\uff0c\u7528\u4ee5\u4e0bGo\u4ee3\u7801\u5b9e\u73b0\u8bfb\u53d6\u90e8\u5206JSON\u6587\u4ef6\u5e76\u5199\u5165MySQL\u6570\u636e\u5e93\uff0c\u9996\u5148\u521b\u5efa\u6570\u636e\u5e93\uff1a</p> <pre><code>CREATE DATABASE `chinese-poetry` CHARACTER SET 'utf8mb4';\n</code></pre>"},{"location":"2019-05-16-Golang%E5%88%9D%E4%BD%93%E9%AA%8C%E4%B9%8B%E8%A7%A3%E7%BB%84JSON%E5%B9%B6%E5%86%99%E5%85%A5MySQL/#_1","title":"\u8bd7\u8868","text":"<pre><code>CREATE TABLE `poet` (\n`id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n`dynasty`varchar(11) DEFAULT NULL,\n`author` text DEFAULT NULL,\n`paragraph` text DEFAULT NULL,\n`strains` text DEFAULT NULL,\n`title` text DEFAULT NULL,\nPRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n</code></pre>"},{"location":"2019-05-16-Golang%E5%88%9D%E4%BD%93%E9%AA%8C%E4%B9%8B%E8%A7%A3%E7%BB%84JSON%E5%B9%B6%E5%86%99%E5%85%A5MySQL/#_2","title":"\u8bcd\u8868","text":"<pre><code>CREATE TABLE `ci` (\n`id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n`dynasty`varchar(11) DEFAULT NULL,\n`author` text DEFAULT NULL,\n`paragraph` text DEFAULT NULL,\n`rhythmic` text DEFAULT NULL,\nPRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n</code></pre>"},{"location":"2019-05-16-Golang%E5%88%9D%E4%BD%93%E9%AA%8C%E4%B9%8B%E8%A7%A3%E7%BB%84JSON%E5%B9%B6%E5%86%99%E5%85%A5MySQL/#_3","title":"\u8bd7\u7ecf\u8868","text":"<pre><code>CREATE TABLE `shijing` (\n`id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n`title` text DEFAULT NULL,\n`chapter` text DEFAULT NULL,\n`section`varchar(11) DEFAULT NULL,\n`content` text DEFAULT NULL,\nPRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n</code></pre> <p>\u7136\u540e\u9700\u8981\u5b89\u88c5\u4f9d\u8d56\u5e93\uff1a</p> <pre><code>$ go get -u github.com/jinzhu/gorm\n$ go get -u github.com/go-sql-driver/mysql\n</code></pre> <p>\u63a5\u4e0b\u6765\u5c31\u662f\u4ee3\u7801\u90e8\u5206\uff0c\u53ef\u4ee5\u67e5\u770bchinese-poetry\u9879\u76ee\u4e2d\u7684main.go\uff1a</p> <pre><code>package main\n\nimport (\n\"encoding/json\"\n\"io/ioutil\"\n\"log\"\n\"os\"\n\"path/filepath\"\n\"regexp\"\n\"strings\"\n\n\"github.com/jinzhu/gorm\"\n_ \"github.com/jinzhu/gorm/dialects/mysql\"\n)\n\n// PoetInJSON \u8bd7\ntype PoetInJSON struct {\nAuthor     string   `json:\"author\"`\nParagraphs []string `json:\"paragraphs\"`\nStrains    []string `json:\"strains\"`\nTitle      string   `json:\"title\"`\n}\n\n// CiInJSON \u8bcd\ntype CiInJSON struct {\nAuthor     string   `json:\"author\"`\nParagraphs []string `json:\"paragraphs\"`\nRhythmic   string   `json:\"rhythmic\"`\n}\n\n// ShiJingInJSON \u8bd7\u7ecf\ntype ShiJingInJSON struct {\nTitle   string   `json:\"title\"`\nChapter string   `json:\"chapter\"`\nSection string   `json:\"section\"`\nContent []string `json:\"content\"`\n}\n\nfunc main() {\n// \u6253\u5f00\u6570\u636e\u5e93\u8fde\u63a5\ndb, _ := gorm.Open(\"mysql\", \"app:123456@tcp(localhost:3306)/chinese-poetry?charset=utf8mb4&amp;parseTime=True&amp;loc=Local\")\n// \u63d2\u5165\u8bd7\n// err := InsertPoet(db)\n// if err != nil {\n//  panic(err)\n// }\n//\u63d2\u5165\u8bcd\n// err := InsertCi(db)\n// if err != nil {\n//  panic(err)\n// }\n//\u63d2\u5165\u8bd7\u7ecfInsertShijing\nerr := InsertShijing(db)\nif err != nil {\npanic(err)\n}\ndefer db.Close()\n}\n\n// InsertPoet \u8bfb\u53d6\u8bd7\u5e76INSERT\u5230\u6570\u636e\u5e93\nfunc InsertPoet(db *gorm.DB) error {\ntx := db.Begin()\ndefer func() {\nif r := recover(); r != nil {\ntx.Rollback()\n}\n}()\n\nif err := tx.Error; err != nil {\nreturn err\n}\n\n//\u904d\u5386\u6587\u4ef6\u5939\nfiles, err := ioutil.ReadDir(filepath.Join(\"..\", \"shi\"))\nif err != nil {\nlog.Fatal(err)\npanic(err)\n}\n//\u6b63\u5219\u6a21\u5f0f\nvalidPattern := regexp.MustCompile(`^poet\\.(.+?)\\.[0-9]+\\.json`)\nfor _, file := range files {\n//\u82e5\u5339\u914d\nif validPattern.MatchString(file.Name()) {\n//\u6355\u83b7\u671d\u4ee3\ndynasty := validPattern.FindStringSubmatch(file.Name())[1]\n//\u8bfb\u53d6\u6587\u4ef6\njsonFile, err := os.Open(filepath.Join(\"..\", \"shi\", file.Name()))\nif err != nil {\nlog.Panic(err)\npanic(err)\n}\nbyteValue, _ := ioutil.ReadAll(jsonFile)\ndefer jsonFile.Close()\n\n//\u89e3\u7ec4\nvar poets []PoetInJSON\nerr1 := json.Unmarshal(byteValue, &amp;poets)\nif err1 != nil {\npanic(err1)\n}\n\n//\u904d\u5386\nfor _, poet := range poets {\n//\u6267\u884cINSERT\nif err := tx.Exec(\"INSERT INTO `poet` (`author`,`paragraph`,`strains`,`title`,`dynasty`) VALUES (?,?,?,?,?)\", poet.Author, strings.Join(poet.Paragraphs, \"\"), strings.Join(poet.Strains, \"\"), poet.Title, dynasty).Error; err != nil {\nlog.Panicf(\"%s, %s\", poet, err)\n//\u56de\u6eda\ntx.Rollback()\nreturn err\n}\n}\n}\n}\n\nreturn tx.Commit().Error\n}\n\n// InsertCi \u8bfb\u53d6\u8bcd\u5e76INSERT\u5230\u6570\u636e\u5e93\nfunc InsertCi(db *gorm.DB) error {\ntx := db.Begin()\ndefer func() {\nif r := recover(); r != nil {\ntx.Rollback()\n}\n}()\n\nif err := tx.Error; err != nil {\nreturn err\n}\n\n//\u904d\u5386\u6587\u4ef6\u5939\nfiles, err := ioutil.ReadDir(filepath.Join(\"..\", \"ci\"))\nif err != nil {\nlog.Fatal(err)\npanic(err)\n}\n//\u6b63\u5219\u6a21\u5f0f\nvalidPattern := regexp.MustCompile(`^ci\\.song\\.[0-9]+\\.json`)\nfor _, file := range files {\n//\u82e5\u5339\u914d\nif validPattern.MatchString(file.Name()) {\ndynasty := \"song\"\n//\u8bfb\u53d6\u6587\u4ef6\njsonFile, err := os.Open(filepath.Join(\"..\", \"ci\", file.Name()))\nif err != nil {\nlog.Panic(err)\npanic(err)\n}\nbyteValue, _ := ioutil.ReadAll(jsonFile)\ndefer jsonFile.Close()\n\n//\u89e3\u7ec4\nvar cis []CiInJSON\nerr1 := json.Unmarshal(byteValue, &amp;cis)\nif err1 != nil {\npanic(err1)\n}\n\n//\u904d\u5386\nfor _, ci := range cis {\n//\u6267\u884cINSERT\nif err := tx.Exec(\"INSERT INTO `ci` (`author`,`paragraph`,`rhythmic`,`dynasty`) VALUES (?,?,?,?)\", ci.Author, strings.Join(ci.Paragraphs, \"\"), ci.Rhythmic, dynasty).Error; err != nil {\nlog.Panicf(\"%s, %s\", ci, err)\n//\u56de\u6eda\ntx.Rollback()\nreturn err\n}\n}\n}\n}\n\nreturn tx.Commit().Error\n}\n\n// InsertShijing \u8bfb\u53d6\u8bd7\u7ecf\u5e76INSERT\u5230\u6570\u636e\u5e93\nfunc InsertShijing(db *gorm.DB) error {\ntx := db.Begin()\ndefer func() {\nif r := recover(); r != nil {\ntx.Rollback()\n}\n}()\n\nif err := tx.Error; err != nil {\nreturn err\n}\n\n//\u8bfb\u53d6\u6587\u4ef6\njsonFile, err := os.Open(filepath.Join(\"..\", \"shijing\", \"shijing.json\"))\nif err != nil {\nlog.Panic(err)\npanic(err)\n}\nbyteValue, _ := ioutil.ReadAll(jsonFile)\ndefer jsonFile.Close()\n\n//\u89e3\u7ec4\nvar shijings []ShiJingInJSON\nerr1 := json.Unmarshal(byteValue, &amp;shijings)\nif err1 != nil {\npanic(err1)\n}\n\n//\u904d\u5386\nfor _, shijing := range shijings {\n//\u6267\u884cINSERT\nif err := tx.Exec(\"INSERT INTO `shijing` (`title`,`chapter`,`section`,`content`) VALUES (?,?,?,?)\", shijing.Title, shijing.Chapter, shijing.Section, strings.Join(shijing.Content, \"\")).Error; err != nil {\nlog.Panicf(\"%s, %s\", shijing, err)\n//\u56de\u6eda\ntx.Rollback()\nreturn err\n}\n}\n\nreturn tx.Commit().Error\n}\n</code></pre>"},{"location":"2019-05-16-Golang%E5%88%9D%E4%BD%93%E9%AA%8C%E4%B9%8B%E8%A7%A3%E7%BB%84JSON%E5%B9%B6%E5%86%99%E5%85%A5MySQL/#_4","title":"\u53c2\u8003","text":"<ul> <li>https://mholt.github.io/json-to-go/</li> <li>https://mariadb.com/kb/en/library/auto_increment/</li> <li>https://play.golang.org/</li> <li>https://stackoverflow.com/questions/30483652/how-to-get-capturing-group-functionality-in-golang-regular-expressions</li> <li>https://regexr.com/</li> <li>https://golang.org/pkg/regexp/</li> <li>https://golang.org/pkg/path/filepath/</li> <li>https://flaviocopes.com/go-list-files/</li> <li>https://gobyexample.com/string-functions</li> <li>https://stackoverflow.com/questions/38867692/parse-json-array-in-golang</li> <li>https://blog.golang.org/json-and-go</li> </ul>"},{"location":"2019-05-17-%E4%B8%80%E4%B8%AAShell%E7%AE%A1%E9%81%93%E7%9A%84%E9%A2%98%E7%9B%AE/","title":"2019 05 17 \u4e00\u4e2aShell\u7ba1\u9053\u7684\u9898\u76ee","text":"<p>\u6709\u5982\u4e0b<code>a\u6587\u4ef6</code>\u548c<code>b\u6587\u4ef6</code>\uff0c\u8bf7\u4f7f\u7528shell\u7ba1\u9053\u547d\u4ee4\u5b9e\u73b0\u6839\u636e<code>a\u6587\u4ef6</code>\u4e2d<code>17:20~17:35</code>\u671f\u95f4<code>doValidate</code>\u7684<code>traceId</code>\u627e\u5bfb<code>b\u6587\u4ef6</code>\u4e2d\u5bf9\u5e94\u7684\u65e5\u5fd7\u4fe1\u606f\uff1a</p> <pre><code>$ cat a\n2019-03-04 17:20:16 doValidate [traceId12]\n2019-03-04 17:21:17 doValidate [traceId13]\n2019-03-04 17:35:16 doValidate [traceId13]\n2019-03-04 18:20:16 doValidate [traceId14]\n2019-03-04 19:20:16 doValidate [traceId14]\n$ cat b\n2019-03-04 17:20:17 xxxxxx2    [traceId12]\n2019-03-04 17:21:18 xxxx22dd   [traceId13]\n2019-03-04 17:35:18 xxxx22dd   [traceId13]\n2019-03-04 18:20:17 xxxxed     [traceId14]\n2019-03-04 19:20:17 xxxsdsdfs  [traceId14]\n</code></pre> <p>\u7b54\u6848\uff1a</p> <pre><code>$ sed -n '/2019-03-04 17:20:*/,/2019-03-04 17:35:*/p' a|grep doValidate|awk  '{print $4}'|uniq| xargs -I '{}' grep -F '{}' b\n2019-03-04 17:20:17 xxxxxx2    [traceId12]\n2019-03-04 17:21:18 xxxx22dd   [traceId13]\n2019-03-04 17:35:18 xxxx22dd   [traceId13]\n</code></pre>"},{"location":"2019-05-17-%E4%B8%80%E4%B8%AAShell%E7%AE%A1%E9%81%93%E7%9A%84%E9%A2%98%E7%9B%AE/#_1","title":"\u53c2\u8003","text":"<ul> <li>BASH Programming - Introduction HOW-TO: Pipes</li> <li>Make xargs execute the command once for each line of input - Stack Overflow</li> </ul>"},{"location":"2019-05-20-CentOS%207%20%E7%9A%84%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E6%97%A5%E5%BF%97%E7%9A%84%E5%AF%B9%E7%85%A7/","title":"2019 05 20 CentOS 7 \u7684\u542f\u52a8\u8fc7\u7a0b\u548c\u65e5\u5fd7\u7684\u5bf9\u7167","text":"<ol> <li><code>BIOS</code>\u9636\u6bb5\uff1a\u63a5\u901a\u7535\u6e90\uff0cBIOS\u6267\u884c<code>\u5f00\u673a\u81ea\u68c0</code>\uff0c\u521d\u59cb\u5316\u7cfb\u7edf\u786c\u4ef6\u7ec4\u4ef6\uff0c\u4ece\u52a0\u8f7d\u7684\u78c1\u76d8\u4e2d\u67e5\u627e<code>MBR</code>\u3002\u5982\u679c\u627e\u5230\uff0c\u8bfb\u53d6MBR\u5e76\u52a0\u8f7d\u5176\u4e2d\u7684\u5f15\u5bfc\u7a0b\u5e8f\u5230\u5185\u5b58\u3002</li> <li><code>MBR</code>\u9636\u6bb5\uff1a\u5f15\u5bfc\u7a0b\u5e8f\u6839\u636eMBR\u8bb0\u5f55\uff0c\u53d1\u73b0<code>\u53ef\u542f\u52a8\u7684\u8bbe\u5907</code>\uff0c\u52a0\u8f7d<code>GRUB2</code>\u5f15\u5bfc\u914d\u7f6e\uff0c\u5e76\u5c06\u63a7\u5236\u6743\u8f6c\u4ea4\u7ed9<code>GRUB2</code>\u3002</li> <li><code>GRUB2</code>\u9636\u6bb5\uff1aGRUB2\u5c06<code>\u538b\u7f29\u7684\u5185\u6838\u955c\u50cf\u6587\u4ef6vmlinuz</code>\u52a0\u8f7d\u5230\u5185\u5b58\uff0c\u5c06<code>\u9a71\u52a8initramfs</code>\u89e3\u538b\u5230\u4e00\u4e2a<code>\u4e34\u65f6\u7684\u57fa\u4e8e\u5185\u5b58\u7684\u6587\u4ef6\u7cfb\u7edftmpfs</code>\u3002\u540c\u65f6\u5c06\u63a7\u5236\u6743\u8f6c\u4ea4\u7ed9\u5185\u6838\u3002\uff08\u5907\u6ce8\uff1a\u63a7\u5236\u53f0\u8f93\u51fa\u65e5\u5fd7\u4e2d\u4e0d\u4f1a\u5305\u542b\u524d\u9762\u8fd9\u4e09\u4e2a\u8fc7\u7a0b\uff0c\u56e0\u4e3a\u5728\u5185\u6838\u6a21\u5757\u52a0\u8f7d\u524d\uff0c\u7ec8\u7aef\u7b49\u8bbe\u5907\u5c1a\u4e0d\u80fd\u88ab\u5185\u6838\u8c03\u7528\uff0c\u65e0\u6cd5\u8bb0\u5f55\u5176\u4fe1\u606f\u3002\uff09</li> <li>\u5185\u6838\u9636\u6bb5\uff1a\u5185\u6838\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edftmpfs\uff0c\u901a\u8fc7\u5176\u4e2d\u7684\u4e00\u4e9b\u5fc5\u987b\u7684\u5757\u8bbe\u5907\u9a71\u52a8\u6a21\u5757\uff0c\u521d\u59cb\u5316\u786c\u4ef6\uff0c\u8bbf\u95ee\u771f\u5b9e\u7684\u6839\u6587\u4ef6\u7cfb\u7edf\u3002\u5e76\u4ee5\u8fdb\u7a0b\u53f7<code>1</code>\u542f\u52a8<code>systemd</code>\u8fdb\u7a0b\u3002  \u4e0a\u56fe\u4e2d\u7684<code>probing EDD</code>\u7684\u8fc7\u7a0b\u53ef\u4ee5\u7406\u89e3\u4e3a\u5185\u6838\u8bc6\u522b\u8bbe\u5907\u7684\u8fc7\u7a0b\u3002\u7d27\u63a5\u7740\u63a5\u6536\u6765\u81ea BIOS \u7684\u5185\u5b58\u6620\u5c04\u62a5\u544a\u7b49\uff0c\u5185\u6838\u5f00\u59cb\u5de5\u4f5c\uff0c\u542f\u52a8\u7cfb\u7edf\u3002\u8be5\u65e5\u5fd7\u4f1a\u540c\u6b65\u8bb0\u5f55\u5230\u7cfb\u7edf\u7684<code>/var/log/dmesg</code>\u4e2d\u3002</li> <li>Systemd \u5c06 temfs \u6587\u4ef6\u7cfb\u7edf\u6302\u8f7d\u5728/sysroot\uff0c\u6309\u7167initd\u8bbe\u7f6e\u542f\u52a8\u7cfb\u7edf\u670d\u52a1  dmesg\u5e76\u4e0d\u4f1a\u8bb0\u5f55\u6240\u6709\u8f93\u51fa\u5230\u63a7\u5236\u53f0\u7684\u4fe1\u606f\uff0c\u6bd4\u5982\u4e0a\u56fe\u4e2d\u7684\u6302\u8f7d/sysroot\u7684\u8fc7\u7a0b\u548c\u4e0b\u9762\u5207\u6362\u6839\u6587\u4ef6\u7cfb\u7edf/\u7684\u8fc7\u7a0b\u3002\u5728\u8fd9\u79cd\u65f6\u5019\uff0c\u5982\u679c\u542f\u52a8\u6709\u95ee\u9898\uff0c\u63a7\u5236\u53f0\u65e5\u5fd7\u80fd\u6bd4\u8f83\u6e05\u695a\u5730\u8bb0\u5f55\u7cfb\u7edf\u5df2\u7ecf\u542f\u52a8\u5230\u54ea\u4e2a\u9636\u6bb5\u3002</li> <li>\u5185\u6838\u6839\u6587\u4ef6\u7cfb\u7edf\u4ece initramfs/sysroot \u5207\u6362\u5230 /  \u5982\u679c\u6839\u6587\u4ef6\u7cfb\u7edf\u6709\u95ee\u9898\uff0c\u6216\u8005\u5176\u4ed6\u7684\u6587\u4ef6\u7cfb\u7edf\u6587\u4ef6\uff0c\u7ecf\u5e38\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u4f1a\u88ab\u5361\u4f4f\u3002\u9700\u8981\u7528\u6237\u63a5\u5165\u624b\u52a8\u4fee\u590d\u6587\u4ef6\u7cfb\u7edf\u7b49\u3002</li> <li>Systemd \u6839\u636e\u7cfb\u7edf\u9ed8\u8ba4\u542f\u52a8\u7ea7\u522b\uff0c\u81ea\u52a8\u89e3\u51b3\u670d\u52a1\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u5e76\u542f\u52a8\u670d\u52a1\u3002\u5b8c\u6210\u540e\uff0c\u767b\u5f55\u754c\u9762\u5f39\u51fa\u3002</li> </ol>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/","title":"2019 05 22 \u7f13\u5b58\u7a7f\u900f\u3001\u7f13\u5b58\u51fb\u7a7f\u4e0e\u7f13\u5b58\u96ea\u5d29","text":"<p>\u7ffb\u8bd1\u81ea3 major problems and solutions in the cache world</p> <p>\u5f53\u524d\u7684IO\u8bbe\u5907\u8fdc\u8fdc\u4e0d\u80fd\u6ee1\u8db3\u4e92\u8054\u7f51\u5e94\u7528\u7a0b\u5e8f\u7684\u5927\u91cf\u8bfb\u5199\u8bf7\u6c42\u3002\u7136\u540e\u6709\u4e00\u4e2a\u7f13\u5b58\uff0c\u4f7f\u7528\u5185\u5b58\u7684\u9ad8\u901f\u8bfb\u5199\u6027\u80fd\u6765\u5e94\u5bf9\u5927\u91cf\u7684\u67e5\u8be2\u8bf7\u6c42\u3002\u4f46\u662f\uff0c\u5185\u5b58\u8d44\u6e90\u975e\u5e38\u5b9d\u8d35\uff0c\u5c06\u5168\u90e8\u6570\u636e\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u663e\u7136\u662f\u4e0d\u5207\u5b9e\u9645\u7684\u3002\u56e0\u6b64\uff0c\u5f53\u524d\u5185\u5b58\u548cIO\u7684\u7ec4\u5408\uff0c\u5185\u5b58\u53ea\u5b58\u50a8\u70ed\u70b9\u6570\u636e\uff0c\u800cIO\u8bbe\u5907\u5b58\u50a8\u5168\u90e8\u6570\u636e\u3002\u7f13\u5b58\u7684\u8bbe\u8ba1\u5305\u542b\u5f88\u591a\u6280\u5de7\uff0c\u4e0d\u6b63\u786e\u7684\u8bbe\u8ba1\u4f1a\u5bfc\u81f4\u4e25\u91cd\u7684\u540e\u679c\u3002</p>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#1-cache-penetration","title":"1 \u7f13\u5b58\u7a7f\u900f\uff08Cache penetration\uff09","text":"<p>\u5728\u5927\u591a\u6570\u4e92\u8054\u7f51\u5e94\u7528\u7a0b\u5e8f\u4e2d\uff1a</p> <ol> <li>\u5f53\u4e1a\u52a1\u7cfb\u7edf\u53d1\u8d77\u67d0\u4e2a\u67e5\u8be2\u8bf7\u6c42\u65f6\uff0c\u5b83\u9996\u5148\u786e\u5b9a\u6570\u636e\u662f\u5426\u5b58\u5728\u4e8e\u7f13\u5b58\u4e2d;</li> <li>\u5982\u679c\u6709\u7f13\u5b58\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\u6570\u636e;</li> <li>\u5982\u679c\u7f13\u5b58\u4e0d\u5b58\u5728\uff0c\u8bf7\u518d\u6b21\u67e5\u8be2\u6570\u636e\u5e93\u5e76\u8fd4\u56de\u6570\u636e\u3002</li> </ol> <p>\u5728\u7406\u89e3\u4e86\u4e0a\u8ff0\u8fc7\u7a0b\u4e4b\u540e\uff0c\u6211\u4eec\u6765\u8c08\u8c08\u7f13\u5b58\u7a7f\u900f\u3002</p>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#11","title":"1.1 \u662f\u4ec0\u4e48","text":"<p>\u5f53\u4e1a\u52a1\u7cfb\u7edf\u53d1\u8d77\u67e5\u8be2\u65f6\uff0c\u6839\u636e\u4e0a\u9762\u7684\u8fc7\u7a0b\uff0c\u67e5\u8be2\u5c06\u9996\u5148\u8fdb\u5165\u7f13\u5b58\uff0c\u56e0\u4e3a\u7f13\u5b58\u4e0d\u5b58\u5728\uff0c\u7136\u540e\u8f6c\u5230\u6570\u636e\u5e93\u8fdb\u884c\u67e5\u8be2\u3002\u7531\u4e8e\u6570\u636e\u6839\u672c\u4e0d\u5b58\u5728\uff0c\u56e0\u6b64\u6570\u636e\u5e93\u4e5f\u8fd4\u56de<code>null</code>\u3002\u8fd9\u662f\u7f13\u5b58\u7a7f\u900f\u3002</p> <p>\u603b\u7ed3\u4e00\u4e0b\uff1a\u4e1a\u52a1\u7cfb\u7edf\u8bbf\u95ee\u6839\u672c\u4e0d\u5b58\u5728\u7684\u6570\u636e\u79f0\u4e3a\u7f13\u5b58\u7a7f\u900f\u3002</p>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#12","title":"1.2 \u5371\u9669\u662f\u4ec0\u4e48","text":"<p>\u5982\u679c\u67e5\u8be2\u8bf7\u6c42\u4e2d\u4e0d\u5b58\u5728\u5927\u91cf\u6570\u636e\uff0c\u90a3\u4e48\u8fd9\u4e9b\u5927\u91cf\u8bf7\u6c42\u5c06\u843d\u5165\u6570\u636e\u5e93\uff0c\u6570\u636e\u5e93\u538b\u529b\u5c06\u6025\u5267\u589e\u52a0\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4\u7cfb\u7edf\u5d29\u6e83\u3002 \uff08\u4f60\u5fc5\u987b\u77e5\u9053\u5f53\u524d\u4e1a\u52a1\u7cfb\u7edf\u4e2d\u6700\u8106\u5f31\u7684\u662fIO\uff0c\u6709\u70b9\u5b83\u4f1a\u5728\u538b\u529b\u4e0b\u5d29\u6e83\uff0c\u6240\u4ee5\u6211\u4eec\u5fc5\u987b\u60f3\u529e\u6cd5\u4fdd\u62a4\u5b83\uff09\u3002</p>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#13","title":"1.3 \u4e3a\u4ec0\u4e48\u4f1a\u53d1\u751f","text":"<ol> <li>\u6076\u610f\u653b\u51fb\u6545\u610f\u521b\u5efa\u5927\u91cf\u4e0d\u5b58\u5728\u7684\u6570\u636e\u6765\u8bf7\u6c42\u6211\u4eec\u7684\u670d\u52a1\u3002\u7531\u4e8e\u7f13\u5b58\u4e2d\u4e0d\u5b58\u5728\u8fd9\u4e9b\u6570\u636e\uff0c\u56e0\u6b64\u5927\u91cf\u8bf7\u6c42\u4f1a\u8fdb\u5165\u6570\u636e\u5e93\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4\u6570\u636e\u5e93\u5d29\u6e83\u3002</li> <li>\u4ee3\u7801\u903b\u8f91\u9519\u8bef\u3002\u8fd9\u662f\u7a0b\u5e8f\u5458\u7684\u9505\uff0c\u65e0\u8bdd\u53ef\u8bf4\uff0c\u5fc5\u987b\u5728\u5f00\u53d1\u4e2d\u907f\u514d\uff01</li> </ol>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#14","title":"1.4 \u5982\u4f55\u907f\u514d","text":"<p>\u4ee5\u4e0b\u662f\u9632\u6b62\u7684\u4e24\u79cd\u65b9\u6cd5\uff1a</p>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#141","title":"1.4.1 \u7f13\u5b58\u7a7a\u6570\u636e","text":"<p>\u7f13\u5b58\u7a7f\u900f\u7684\u539f\u56e0\u662f\u7f13\u5b58\u4e2d\u6ca1\u6709\u7528\u4e8e\u5b58\u50a8\u8fd9\u4e9b\u7a7a\u6570\u636e\u7684\u5bc6\u94a5\uff0c\u5bfc\u81f4\u6240\u6709\u8fd9\u4e9b\u8bf7\u6c42\u90fd\u5230\u8fbe\u6570\u636e\u5e93\u3002</p> <p>\u7136\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u7a0d\u5fae\u4fee\u6539\u4e1a\u52a1\u7cfb\u7edf\u7684\u4ee3\u7801\uff0c\u5e76\u5c06\u5177\u6709\u7a7a\u6570\u636e\u5e93\u67e5\u8be2\u7ed3\u679c\u7684\u5bc6\u94a5\u5b58\u50a8\u5728\u7f13\u5b58\u4e2d\u3002\u5f53\u518d\u6b21\u53d1\u751f\u5bf9\u5bc6\u94a5\u7684\u67e5\u8be2\u8bf7\u6c42\u65f6\uff0c\u7f13\u5b58\u76f4\u63a5\u8fd4\u56de<code>null</code>\u800c\u4e0d\u67e5\u8be2\u6570\u636e\u5e93\u3002</p>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#142-bloomfilter","title":"1.4.2 \u5e03\u9686\u8fc7\u6ee4\u5668\uff08BloomFilter\uff09","text":"<p>\u5b83\u9700\u8981\u5728\u7f13\u5b58\u4e4b\u524d\u6dfb\u52a0\u4e00\u4e2a\u5c4f\u969c\uff0c\u5b83\u5b58\u50a8\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u5b58\u5728\u7684\u6240\u6709key\u3002</p> <p>\u5f53\u4e1a\u52a1\u7cfb\u7edf\u6709\u67e5\u8be2\u8bf7\u6c42\u65f6\uff0c\u9996\u5148\u8f6c\u5230BloomFilter\u4ee5\u68c0\u67e5key\u662f\u5426\u5b58\u5728\u3002</p> <ul> <li>\u5982\u679c\u5b83\u4e0d\u5b58\u5728\uff0c\u5219\u8868\u793a\u6570\u636e\u5e93\u4e2d\u4e0d\u5b58\u5728\u6570\u636e\uff0c\u56e0\u6b64\u4e0d\u5e94\u68c0\u67e5\u7f13\u5b58\uff0c\u5e76\u76f4\u63a5\u8fd4\u56de<code>null</code>\u3002</li> <li>\u5982\u679c\u5b58\u5728\uff0c\u7ee7\u7eed\u6267\u884c\u540e\u7eed\u8fc7\u7a0b\uff0c\u9996\u5148\u67e5\u8be2\u7f13\u5b58\uff0c\u5982\u679c\u6ca1\u6709\u7f13\u5b58\uff0c\u5219\u67e5\u8be2\u6570\u636e\u5e93\u3002</li> </ul>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#143","title":"1.4.3 \u6bd4\u8f83\u4e24\u79cd\u65b9\u6848","text":"<p>\u8fd9\u4e24\u79cd\u89e3\u51b3\u65b9\u6848\u90fd\u53ef\u4ee5\u89e3\u51b3\uff0c\u4f46\u4f7f\u7528\u573a\u666f\u4e0d\u540c\u3002</p> <p>\u5bf9\u4e8e\u67d0\u4e9b\u6076\u610f\u653b\u51fb\uff0c\u67e5\u8be2\u7684key\u901a\u5e38\u4e0d\u540c\uff0c\u800c\u6570\u636e\u7a83\u8d3c\u66f4\u591a\u3002\u6b64\u65f6\uff0c\u7b2c\u4e00\u4e2a\u65b9\u6848\u592a\u591a\u4e86\u3002\u56e0\u4e3a\u5b83\u9700\u8981\u5b58\u50a8\u6240\u6709\u7a7a\u6570\u636e\u7684key\uff0c\u5e76\u4e14\u8fd9\u4e9b\u6076\u610f\u653b\u51fb\u7684\u5bc6\u94a5\u901a\u5e38\u662f\u4e0d\u540c\u7684\uff0c\u5e76\u4e14\u76f8\u540c\u7684\u5bc6\u94a5\u901a\u5e38\u53ea\u88ab\u8bf7\u6c42\u4e00\u6b21\u3002\u56e0\u6b64\uff0c\u5373\u4f7f\u7f13\u5b58\u4e86\u8fd9\u4e9b\u7a7a\u6570\u636e\u7684\u5bc6\u94a5\uff0c\u7531\u4e8e\u4e0d\u518d\u4f7f\u7528\u7b2c\u4e8c\u6b21\uff0c\u56e0\u6b64\u65e0\u6cd5\u5b9e\u73b0\u4fdd\u62a4\u6570\u636e\u5e93\u7684\u4f5c\u7528\u3002</p> <p>\u56e0\u6b64\uff0c\u5bf9\u4e8e\u7a7a\u6570\u636e\u7684key\u4e0d\u540c\u5e76\u4e14key\u91cd\u590d\u8bf7\u6c42\u7684\u6982\u7387\u4f4e\u7684\u60c5\u51b5\uff0c\u5e94\u8be5\u9009\u62e9\u7b2c\u4e8c\u65b9\u6848\u3002\u5bf9\u4e8e\u7a7a\u6570\u636e\u7684key\u6570\u91cf\u6709\u9650\u4e14\u5bc6\u94a5\u91cd\u590d\u8bf7\u6c42\u7684\u6982\u7387\u5f88\u9ad8\u7684\u60c5\u51b5\uff0c\u5e94\u9009\u62e9\u7b2c\u4e00\u79cd\u65b9\u6848\u3002</p>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#2-cache-breakdown","title":"2 \u7f13\u5b58\u51fb\u7a7f\uff08Cache breakdown\uff09","text":"<p>\u53c8\u79f0\u4e3a\u70ed\u70b9\u6570\u636e\u96c6\u5931\u6548\uff08Hotspot data set is invalid\uff09</p>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#21","title":"2.1 \u662f\u4ec0\u4e48","text":"<p>\u6211\u4eec\u901a\u5e38\u4e3a\u7f13\u5b58\u8bbe\u7f6e\u4e00\u4e2a\u5230\u671f\u65f6\u95f4\u3002\u5230\u671f\u65f6\u95f4\u540e\uff0c\u6570\u636e\u5e93\u5c06\u88ab\u7f13\u5b58\u76f4\u63a5\u5220\u9664\uff0c\u4ece\u800c\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u4fdd\u8bc1\u6570\u636e\u7684\u5b9e\u65f6\u6027\u3002</p> <p>\u4f46\u662f\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u8bf7\u6c42\u975e\u5e38\u9ad8\u7684\u70ed\u70b9\u6570\u636e\uff08hotspot data\uff09\uff0c\u4e00\u65e6\u6709\u6548\u65f6\u95f4\u8fc7\u53bb\uff0c\u6b64\u65f6\u5c06\u6709\u5927\u91cf\u8bf7\u6c42\u843d\u5728\u6570\u636e\u5e93\u4e0a\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4\u6570\u636e\u5e93\u5d29\u6e83\u3002\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <p>\u5982\u679c\u70ed\u70b9\u6570\u636e\u5931\u8d25\uff0c\u90a3\u4e48\u5f53\u518d\u6b21\u6709\u6570\u636e\u67e5\u8be2\u8bf7\u6c42<code>[req-1]</code>\u65f6\uff0c\u5b83\u5c06\u8f6c\u5230\u6570\u636e\u5e93\u67e5\u8be2\u3002\u4f46\u662f\uff0c\u4ece\u8bf7\u6c42\u53d1\u9001\u5230\u6570\u636e\u5e93\u5230\u6570\u636e\u66f4\u65b0\u5230\u7f13\u5b58\u7684\u65f6\u95f4\uff0c\u7531\u4e8e\u6570\u636e\u4ecd\u7136\u4e0d\u5728\u7f13\u5b58\u4e2d\uff0c\u56e0\u6b64\u5728\u6b64\u671f\u95f4\u5230\u8fbe\u7684\u67e5\u8be2\u8bf7\u6c42\u5c06\u843d\u5728\u6570\u636e\u5e93\u4e0a\uff0c\u8fd9\u5c06\u5bfc\u81f4\u6570\u636e\u5e93\u5de8\u5927\u7684\u538b\u529b\u3002\u6b64\u5916\uff0c\u5f53\u5b8c\u6210\u8fd9\u4e9b\u8bf7\u6c42\u67e5\u8be2\u65f6\uff0c\u91cd\u590d\u66f4\u65b0\u7f13\u5b58\u3002</p>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#22","title":"2.2 \u5982\u4f55\u907f\u514d","text":""},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#221-mutex","title":"2.2.1 \u4e92\u65a5\uff08Mutex\uff09","text":"<p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7f13\u5b58\u9644\u5e26\u7684\u9501\u5b9a\u673a\u5236\u3002\u542f\u52a8\u7b2c\u4e00\u4e2a\u6570\u636e\u5e93\u67e5\u8be2\u8bf7\u6c42\u65f6\uff0c\u5c06\u9501\u5b9a\u7f13\u5b58\u4e2d\u7684\u6570\u636e\uff1b\u6b64\u65f6\uff0c\u5230\u8fbe\u7f13\u5b58\u7684\u5176\u4ed6\u67e5\u8be2\u8bf7\u6c42\u5c06\u65e0\u6cd5\u67e5\u8be2\u8be5\u5b57\u6bb5\uff0c\u56e0\u6b64\u5c06\u88ab\u963b\u585e\u7b49\u5f85\uff1b\u8bf7\u6c42\u5b8c\u6210\u6570\u636e\u5e93\u67e5\u8be2\u5e76\u7f13\u5b58\u6570\u636e\u66f4\u65b0\u503c\u540e\uff0c\u9501\u5b9a\u88ab\u91ca\u653e\uff1b\u6b64\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u4ece\u7f13\u5b58\u4e2d\u68c0\u7d22\u5176\u4ed6\u963b\u6b62\u7684\u67e5\u8be2\u8bf7\u6c42\u3002</p> <p>\u5f53\u70ed\u70b9\u6570\u636e\u5931\u8d25\u65f6\uff0c\u53ea\u6709\u7b2c\u4e00\u4e2a\u6570\u636e\u5e93\u67e5\u8be2\u8bf7\u6c42\u88ab\u53d1\u9001\u5230\u6570\u636e\u5e93\uff0c\u5e76\u4e14\u6240\u6709\u5176\u4ed6\u67e5\u8be2\u8bf7\u6c42\u90fd\u88ab\u963b\u6b62\uff0c\u4ece\u800c\u4fdd\u62a4\u6570\u636e\u5e93\u3002\u4f46\u662f\uff0c\u7531\u4e8e\u4f7f\u7528\u4e86\u4e92\u65a5\u9501\uff0c\u5176\u4ed6\u8bf7\u6c42\u5c06\u963b\u6b62\u7b49\u5f85\uff0c\u7cfb\u7edf\u541e\u5410\u91cf\u5c06\u4e0b\u964d\u3002\u8fd9\u9700\u8981\u4e0e\u5b9e\u9645\u7684\u4e1a\u52a1\u8003\u8651\u76f8\u7ed3\u5408\u624d\u80fd\u5b9e\u73b0\u8fd9\u4e00\u70b9\u3002</p> <p>\u4e92\u65a5\u9501\u53ef\u4ee5\u907f\u514d\u56e0\u70ed\u70b9\u6570\u636e\u5931\u8d25\u800c\u5bfc\u81f4\u6570\u636e\u5e93\u635f\u574f\u7684\u95ee\u9898\u3002\u5728\u5b9e\u9645\u4e1a\u52a1\u4e2d\uff0c\u901a\u5e38\u5b58\u5728\u4e00\u6279\u70ed\u70b9\u6570\u636e\u540c\u65f6\u5931\u8d25\u7684\u573a\u666f\u3002\u90a3\u4e48\u5982\u4f55\u9632\u6b62\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u6570\u636e\u5e93\u8d85\u8d1f\u8377\uff1f</p>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#222","title":"2.2.2 \u8bbe\u7f6e\u4e0d\u540c\u7684\u5230\u671f\u65f6\u95f4","text":"<p>\u5f53\u6211\u4eec\u5c06\u8fd9\u4e9b\u6570\u636e\u5b58\u50a8\u5728\u7f13\u5b58\u4e2d\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u9519\u5f00\u7f13\u5b58\u5230\u671f\u65f6\u95f4\u3002\u8fd9\u53ef\u4ee5\u907f\u514d\u540c\u65f6\u53d1\u751f\u6545\u969c\u3002\u4f8b\u5982\uff0c\u5728\u57fa\u51c6\u65f6\u95f4\u6dfb\u52a0/\u51cf\u53bb\u968f\u673a\u6570\u4ee5\u9519\u5f00\u8fd9\u4e9b\u7f13\u5b58\u7684\u5230\u671f\u65f6\u95f4\u3002</p>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#3-cahce-avalanche","title":"3 \u7f13\u5b58\u96ea\u5d29\uff08Cahce avalanche\uff09","text":""},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#31","title":"3.1 \u662f\u4ec0\u4e48","text":"<p>\u4ece\u4e0a\u9762\u53ef\u4ee5\u770b\u51fa\uff0c\u7f13\u5b58\u5b9e\u9645\u4e0a\u8d77\u5230\u4e86\u4fdd\u62a4\u6570\u636e\u5e93\u7684\u4f5c\u7528\u3002\u5b83\u6709\u52a9\u4e8e\u6570\u636e\u5e93\u627f\u53d7\u5927\u91cf\u67e5\u8be2\u8bf7\u6c42\uff0c\u4ece\u800c\u907f\u514d\u6613\u53d7\u653b\u51fb\u7684\u6570\u636e\u5e93\u3002</p> <p>\u5982\u679c\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u7f13\u5b58\u51fa\u73b0\u6545\u969c\uff0c\u90a3\u4e48\u6700\u521d\u88ab\u7f13\u5b58\u963b\u6b62\u7684\u5927\u91cf\u67e5\u8be2\u8bf7\u6c42\u5c06\u50cf\u75af\u72d7\u4e00\u6837\u6d8c\u5411\u6570\u636e\u5e93\u3002\u6b64\u65f6\uff0c\u5982\u679c\u6570\u636e\u5e93\u65e0\u6cd5\u627f\u53d7\u8fd9\u79cd\u5de8\u5927\u7684\u538b\u529b\uff0c\u5b83\u5c31\u4f1a\u5d29\u6e83\u3002\u8fd9\u662f\u7f13\u5b58\u96ea\u5d29\u3002</p>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#32","title":"3.2 \u5982\u4f55\u907f\u514d","text":""},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#321","title":"3.2.1 \u7f13\u5b58\u96c6\u7fa4\u786e\u4fdd\u9ad8\u53ef\u7528","text":"<p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u53d1\u751f\u96ea\u5d29\u4e4b\u524d\uff0c\u91c7\u53d6\u9884\u9632\u63aa\u65bd\u4ee5\u9632\u6b62\u96ea\u5d29\u7684\u53d1\u751f\u3002</p>"},{"location":"2019-05-22-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9/#322","title":"3.2.2 \u7194\u65ad\u5668","text":"<p>Hystrix\u662f\u4e00\u79cd\u5f00\u6e90\u7684\u201c\u6297\u96ea\u5d29\u5de5\u5177\u201d\uff0c\u964d\u7ea7\uff08downgrade\uff09\u548c\u9650\u6d41\uff08current limit\uff09\u6765\u51cf\u5c11\u96ea\u5d29\u540e\u7684\u635f\u8017\u3002</p> <p>Hystrix\u662f\u4e00\u4e2a\u4f7f\u7528\u547d\u4ee4\u6a21\u5f0f\uff08command pattern\uff09\u7684Java\u7c7b\u5e93\uff0c\u6bcf\u4e2a\u670d\u52a1\u5904\u7406\u8bf7\u6c42\u90fd\u6709\u81ea\u5df1\u7684\u5904\u7406\u5668\u3002\u6240\u6709\u8bf7\u6c42\u90fd\u901a\u8fc7\u5404\u81ea\u7684\u5904\u7406\u5668\u3002\u5904\u7406\u5668\u8bb0\u5f55\u5f53\u524d\u670d\u52a1\u7684\u8bf7\u6c42\u5931\u8d25\u7387\u3002\u4e00\u65e6\u53d1\u73b0\u5f53\u524d\u670d\u52a1\u7684\u6545\u969c\u7387\u8fbe\u5230\u9884\u8bbe\u503c\uff0c\u5c06\u62d2\u7edd\u6240\u6709\u540e\u7eed\u670d\u52a1\u8bf7\u6c42\u5e76\u8fd4\u56de\u9ed8\u8ba4\u7ed3\u679c\u3002\u8fd9\u5c31\u662f\u6240\u8c13\u7684\u4fdd\u9669\u4e1d\uff0c\u5373\u7194\u65ad\u5668\u3002\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u540e\uff0cHystrix\u5c06\u91ca\u653e\u90e8\u5206\u670d\u52a1\u8bf7\u6c42\uff0c\u5e76\u518d\u6b21\u8ba1\u7b97\u5176\u8bf7\u6c42\u5931\u8d25\u7387\u3002\u5982\u679c\u8bf7\u6c42\u5931\u8d25\u7387\u6b64\u65f6\u6ee1\u8db3\u9884\u8bbe\u503c\uff0c\u5219\u6d41\u91cf\u9650\u5236\u5f00\u5173\u5b8c\u5168\u6253\u5f00\uff1b\u5982\u679c\u8bf7\u6c42\u5931\u8d25\u7387\u4ecd\u7136\u5f88\u9ad8\uff0c\u5219\u62d2\u7edd\u6240\u6709\u670d\u52a1\u8bf7\u6c42\uff0c\u662f\u4e3a\u9650\u6d41\u3002Hystrix\u5c06\u9ed8\u8ba4\u7ed3\u679c\u76f4\u63a5\u8fd4\u56de\u7ed9\u90a3\u4e9b\u88ab\u62d2\u7edd\u7684\u8bf7\u6c42\uff0c\u662f\u4e3a\u964d\u7ea7\u3002</p>"},{"location":"2019-05-27-Golang%E7%9A%84%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91/","title":"2019 05 27 Golang\u7684\u4ea4\u53c9\u7f16\u8bd1","text":"<pre><code>GOOS=${OS[$i]} \\\nGOARCH=${ARCH[$i]} \\\ngo build -o $EXECUTABLE\n</code></pre> <p>\u5408\u6cd5\u7684$GOOS\u548c$GOARCH\u7ec4\u5408\u4e3a\uff1a</p> <pre><code>$GOOS   $GOARCH\nandroid arm\ndarwin  386\ndarwin  amd64\ndarwin  arm\ndarwin  arm64\ndragonfly   amd64\nfreebsd 386\nfreebsd amd64\nfreebsd arm\nlinux   386\nlinux   amd64\nlinux   arm\nlinux   arm64\nlinux   ppc64\nlinux   ppc64le\nlinux   mips\nlinux   mipsle\nlinux   mips64\nlinux   mips64le\nlinux   s390x\nnetbsd  386\nnetbsd  amd64\nnetbsd  arm\nopenbsd 386\nopenbsd amd64\nopenbsd arm\nplan9   386\nplan9   amd64\nsolaris amd64\nwindows 386\nwindows amd64\n</code></pre>"},{"location":"2019-05-27-Golang%E7%9A%84%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91/#_1","title":"\u53c2\u8003","text":"<ul> <li>Optional environment variables</li> </ul>"},{"location":"2019-05-27-MySQL%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%B9%B6%E6%8F%92%E5%85%A5/","title":"2019 05 27 MySQL\u67e5\u8be2\u6570\u636e\u5e76\u63d2\u5165","text":"<p>\u67e5\u8be2user\u8868\u4e2d\u7684type\u4e0d\u4e3a1\u7684\u6570\u636e\u5e76\u63d2\u5165employee\u8868\uff1a</p> <pre><code>-- \u67e5\u8be2\u5b57\u6bb5\u5217\u8868\u7684\u5b57\u7b26\u4e32\nselect GROUP_CONCAT(COLUMN_NAME SEPARATOR ',') from `information_schema`.`COLUMNS` WHERE TABLE_NAME = 'employee';\n\n-- \u67e5\u8be2\u5e76\u63d2\u5165\ninsert into employee(id,mobile,school_id,school_limit,nick_name,sex,picture_url,type,active,contact_mobile,password,salt,token,old_access_token_md5,forum_vest,forum_nickname,forum_head_portrait_url,status,create_time,update_time,delete_time) select id,mobile,school_id,school_limit,nick_name,sex,picture_url,type,active,contact_mobile,password,salt,token,old_access_token_md5,forum_vest,forum_nickname,forum_head_portrait_url,status,create_time,update_time,delete_time from user\nwhere type != 1;\n</code></pre>"},{"location":"2019-05-27-%E5%AF%B9%E7%A7%B0%E4%B8%8E%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/","title":"2019 05 27 \u5bf9\u79f0\u4e0e\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5","text":"<p>\u5c0d\u7a31\u5bc6\u9470\u6f14\u7b97\u6cd5\uff08\u82f1\u8bed\uff1aSymmetric-key algorithm\uff09\u53c8\u7a31\u70ba\u5c0d\u7a31\u52a0\u5bc6\u3001\u79c1\u9470\u52a0\u5bc6\u3001\u5171\u4eab\u5bc6\u9470\u52a0\u5bc6\uff0c\u662f\u5bc6\u78bc\u5b78\u4e2d\u7684\u4e00\u985e\u52a0\u5bc6\u6f14\u7b97\u6cd5\u3002\u9019\u985e\u6f14\u7b97\u6cd5\u5728\u52a0\u5bc6\u548c\u89e3\u5bc6\u6642\u4f7f\u7528\u76f8\u540c\u7684\u5bc6\u9470\uff0c\u6216\u662f\u4f7f\u7528\u5169\u500b\u53ef\u4ee5\u7c21\u55ae\u5730\u76f8\u4e92\u63a8\u7b97\u7684\u5bc6\u9470\u3002\u4e8b\u5b9e\u4e0a\uff0c\u9019\u7d44\u5bc6\u9470\u6210\u70ba\u5728\u5169\u500b\u6216\u591a\u500b\u6210\u54e1\u9593\u7684\u5171\u540c\u7955\u5bc6\uff0c\u4ee5\u4fbf\u7dad\u6301\u5c08\u5c6c\u7684\u901a\u8a0a\u806f\u7e6b\u3002\u8207\u516c\u5f00\u5bc6\u94a5\u52a0\u5bc6\u76f8\u6bd4\uff0c\u8981\u6c42\u96d9\u65b9\u53d6\u5f97\u76f8\u540c\u7684\u5bc6\u9470\u662f\u5c0d\u7a31\u5bc6\u9470\u52a0\u5bc6\u7684\u4e3b\u8981\u7f3a\u9ede\u4e4b\u4e00[2]\u3002</p> <p>\u5e38\u89c1\u7684\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u6709DES\u30013DES\u3001AES\u3001Blowfish\u3001IDEA\u3001RC5\u3001RC6\u3002</p> <p>\u5bf9\u79f0\u52a0\u5bc6\u7684\u901f\u5ea6\u6bd4\u516c\u94a5\u52a0\u5bc6\u5feb\u5f88\u591a\uff0c\u5728\u5f88\u591a\u573a\u5408\u90fd\u9700\u8981\u5bf9\u79f0\u52a0\u5bc6\u3002</p> <p>\u516c\u5f00\u5bc6\u94a5\u5bc6\u7801\u5b66\uff08\u82f1\u8bed\uff1aPublic-key cryptography\uff0c\u4e5f\u79f0\u975e\u5c0d\u7a31\u5f0f\u5bc6\u78bc\u5b78\uff09\u662f\u5bc6\u78bc\u5b78\u7684\u4e00\u7a2e\u6f14\u7b97\u6cd5\uff0c\u5b83\u9700\u8981\u5169\u500b\u5bc6\u94a5\uff0c\u4e00\u500b\u662f\u516c\u958b\u5bc6\u9470\uff0c\u53e6\u4e00\u500b\u662f\u79c1\u6709\u5bc6\u9470\uff1b\u4e00\u500b\u7528\u4f5c\u52a0\u5bc6\uff0c\u53e6\u4e00\u500b\u5247\u7528\u4f5c\u89e3\u5bc6\u3002\u4f7f\u7528\u5176\u4e2d\u4e00\u500b\u5bc6\u94a5\u628a\u660e\u6587\u52a0\u5bc6\u540e\u6240\u5f97\u7684\u5bc6\u6587\uff0c\u53ea\u80fd\u7528\u76f8\u5c0d\u61c9\u7684\u53e6\u4e00\u500b\u5bc6\u94a5\u624d\u80fd\u89e3\u5bc6\u5f97\u5230\u539f\u672c\u7684\u660e\u6587\uff1b\u751a\u81f3\u9023\u6700\u521d\u7528\u4f86\u52a0\u5bc6\u7684\u5bc6\u9470\u4e5f\u4e0d\u80fd\u7528\u4f5c\u89e3\u5bc6\u3002\u7531\u65bc\u52a0\u5bc6\u548c\u89e3\u5bc6\u9700\u8981\u5169\u500b\u4e0d\u540c\u7684\u5bc6\u9470\uff0c\u6545\u88ab\u7a31\u70ba\u975e\u5c0d\u7a31\u52a0\u5bc6\uff1b\u4e0d\u540c\u65bc\u52a0\u5bc6\u548c\u89e3\u5bc6\u90fd\u4f7f\u7528\u540c\u4e00\u500b\u5bc6\u9470\u7684\u5c0d\u7a31\u52a0\u5bc6\u3002\u96d6\u7136\u5169\u500b\u5bc6\u9470\u5728\u6570\u5b66\u4e0a\u76f8\u5173\uff0c\u4f46\u5982\u679c\u77e5\u9053\u4e86\u5176\u4e2d\u4e00\u4e2a\uff0c\u5e76\u4e0d\u80fd\u6191\u6b64\u8ba1\u7b97\u51fa\u53e6\u5916\u4e00\u4e2a\uff1b\u56e0\u6b64\u5176\u4e2d\u4e00\u4e2a\u53ef\u4ee5\u516c\u5f00\uff0c\u79f0\u4e3a\u516c\u94a5\uff0c\u4efb\u610f\u5411\u5916\u767c\u4f48\uff1b\u4e0d\u516c\u5f00\u7684\u5bc6\u94a5\u4e3a\u79c1\u94a5\uff0c\u5fc5\u9808\u7531\u7528\u6236\u81ea\u884c\u56b4\u683c\u79d8\u5bc6\u4fdd\u7ba1\uff0c\u7d55\u4e0d\u900f\u904e\u4efb\u4f55\u9014\u5f91\u5411\u4efb\u4f55\u4eba\u63d0\u4f9b\uff0c\u4e5f\u4e0d\u6703\u900f\u9732\u7d66\u88ab\u4fe1\u4efb\u7684\u8981\u901a\u8a0a\u7684\u53e6\u4e00\u65b9\u3002</p> <p>\u57fa\u65bc\u516c\u958b\u5bc6\u9470\u52a0\u5bc6\u7684\u7279\u6027\uff0c\u5b83\u9084\u63d0\u4f9b\u6578\u4f4d\u7c3d\u7ae0\u7684\u529f\u80fd\uff0c\u4f7f\u96fb\u5b50\u6587\u4ef6\u53ef\u4ee5\u5f97\u5230\u5982\u540c\u5728\u7d19\u672c\u6587\u4ef6\u4e0a\u89aa\u7b46\u7c3d\u7f72\u7684\u6548\u679c\u3002</p> <p>\u516c\u958b\u91d1\u9470\u57fa\u790e\u5efa\u8a2d\u900f\u904e\u4fe1\u4efb\u6570\u5b57\u8bc1\u4e66\u8ba4\u8bc1\u673a\u6784\u7684\u6839\u8bc1\u4e66\u3001\u53ca\u5176\u4f7f\u7528\u516c\u5f00\u5bc6\u94a5\u52a0\u5bc6\u4f5c\u6578\u4f4d\u7c3d\u7ae0\u6838\u767c\u7684\u516c\u958b\u91d1\u9470\u8a8d\u8b49\uff0c\u5f62\u6210\u4fe1\u4efb\u93c8\u67b6\u69cb\uff0c\u5df2\u5728TLS\u5be6\u73fe\u4e26\u5728\u4e07\u7ef4\u7f51\u7684HTTP\u4ee5HTTPS\u3001\u5728\u7535\u5b50\u90ae\u4ef6\u7684SMTP\u4ee5STARTTLS\u5f15\u5165\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\uff0c\u4fe1\u4efb\u7db2\u7d61\u5247\u63a1\u7528\u53bb\u4e2d\u5fc3\u5316\u7684\u6982\u5ff5\uff0c\u53d6\u4ee3\u4e86\u4f9d\u8cf4\u6578\u5b57\u8b49\u66f8\u8a8d\u8b49\u6a5f\u69cb\u7684\u516c\u9470\u57fa\u790e\u8a2d\u65bd\uff0c\u56e0\u70ba\u6bcf\u4e00\u5f35\u96fb\u5b50\u8b49\u66f8\u5728\u4fe1\u4efb\u93c8\u4e2d\u6700\u7d42\u53ea\u7531\u4e00\u500b\u6839\u8b49\u66f8\u6388\u6b0a\u4fe1\u4efb\uff0c\u4fe1\u4efb\u7db2\u7d61\u7684\u516c\u9470\u5247\u53ef\u4ee5\u7d2f\u7a4d\u591a\u500b\u7528\u6236\u7684\u4fe1\u4efb\u3002PGP\u5c31\u662f\u5176\u4e2d\u4e00\u500b\u4f8b\u5b50\u3002</p> <p>\u5e38\u89c1\u7684\u516c\u94a5\u52a0\u5bc6\u7b97\u6cd5\u6709\uff1aRSA\u3001ElGamal\u3001\u80cc\u5305\u7b97\u6cd5\u3001Rabin\uff08RSA\u7684\u7279\u4f8b\uff09\u3001\u8fea\u83f2\uff0d\u8d6b\u5c14\u66fc\u5bc6\u94a5\u4ea4\u6362\u534f\u8bae\u4e2d\u7684\u516c\u94a5\u52a0\u5bc6\u7b97\u6cd5\u3001\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u7b97\u6cd5\uff08\u82f1\u8bed\uff1aElliptic Curve Cryptography, ECC\uff09\u3002\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u662fRSA\u7b97\u6cd5\uff08\u7531\u53d1\u660e\u8005Rivest\u3001Shmir\u548cAdleman\u59d3\u6c0f\u9996\u5b57\u6bcd\u7f29\u5199\u800c\u6765\uff09\u662f\u8457\u540d\u7684\u516c\u5f00\u79d8\u94a5\u52a0\u5bc6\u7b97\u6cd5\uff0cElGamal\u662f\u53e6\u4e00\u79cd\u5e38\u7528\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u3002</p>"},{"location":"2019-06-03-%E5%9C%A8Ubuntu%E4%B8%8A%E4%BD%BF%E7%94%A8Hurricane%20Electric%E7%9A%84IPv6%E9%9A%A7%E9%81%93/","title":"2019 06 03 \u5728Ubuntu\u4e0a\u4f7f\u7528Hurricane Electric\u7684IPv6\u96a7\u9053","text":"<p>\u5f53\u6211\u4eec\u7684\u4e3b\u673a\u6ca1\u6709\u5168\u5c40IPv6\u5730\u5740\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>IPv6\u96a7\u9053</code>\u4e3a\u4e3b\u673a\u63d0\u4f9bIPv6\u5730\u5740\uff1b\u4e0b\u9762\uff0c\u6211\u4eec\u6765\u5c1d\u8bd5\u4e00\u4e0b\u5728Ubuntu\u4f7f\u7528Hurricane Electric\u63d0\u4f9b\u7684\u96a7\u9053\u670d\u52a1\u3002</p>"},{"location":"2019-06-03-%E5%9C%A8Ubuntu%E4%B8%8A%E4%BD%BF%E7%94%A8Hurricane%20Electric%E7%9A%84IPv6%E9%9A%A7%E9%81%93/#_1","title":"\u521b\u5efa\u96a7\u9053","text":"<p>\u767b\u5f55Hurricane Electric Free IPv6 Tunnel Broker\uff0c\u70b9\u51fb<code>Create Regular Tunnel</code>\uff1a</p> <p></p> <p>\u5728<code>IPv4 Endpoint (Your side)</code>\u8f93\u5165\u60a8\u7684\u4e3b\u673a\u7684IPv4\u5730\u5740\uff0c\u4f8b\u5982\uff1a</p> <p></p> <p>\u5728<code>Available Tunnel Servers</code>\u4e2d\u9009\u62e9\u4e00\u53f0\u53ef\u7528\u7684\u96a7\u9053\u670d\u52a1\u5668\uff1a</p> <p></p> <p>\u6b64\u5904\u9009\u62e9\u4e86\u4e00\u53f0\u4f4d\u4e8e\u52a0\u62ff\u5927\ud83c\udde8\ud83c\udde6\u591a\u4f26\u591a\u7684\u4e00\u53f0\u670d\u52a1\u5668\uff1b\u70b9\u51fb\u9875\u9762\u5e95\u90e8\u7684<code>Create Tunnel</code>\uff1a</p> <p></p> <p>\u5f85\u521b\u5efa\u5b8c\u6210\uff0c\u8df3\u8f6c\u81f3<code>Tunnel Details</code>\u9875\u9762\uff1a</p> <p></p>"},{"location":"2019-06-03-%E5%9C%A8Ubuntu%E4%B8%8A%E4%BD%BF%E7%94%A8Hurricane%20Electric%E7%9A%84IPv6%E9%9A%A7%E9%81%93/#_2","title":"\u914d\u7f6e\u670d\u52a1\u5668","text":"<p>\u70b9\u51fb<code>Example Configurations</code>\uff0c\u9009\u62e9<code>Debian/Ubuntu</code>\uff0c\u4f1a\u7ed9\u51fa\u914d\u7f6e\u5185\u5bb9\uff0c\u5982\u56fe\uff1a</p> <p></p> <p>\u7f16\u8f91<code>/etc/network/interfaces</code>\uff0c\u590d\u5236\u7c98\u8d34\u914d\u7f6e\u5185\u5bb9\uff1a</p> <pre><code>auto he-ipv6\niface he-ipv6 inet6 v4tunnel\n        address {Placeholder}\n        netmask 64\n        endpoint {Placeholder}\n        local {Placeholder}\n        ttl 255\n        gateway {Placeholder}\n</code></pre> <p>\u6ce8\uff1a\u8fd9\u91cc\u7684\u914d\u7f6e\u5185\u5bb9\u5df2\u505a\u8131\u654f\u5904\u7406\ud83d\udc39\uff0c\u8bf7\u4e0d\u8981\u76f4\u63a5\u590d\u5236\u7c98\u8d34</p> <p>\u7136\u540e\uff0c\u6211\u4eec\u9700\u8981\u542f\u7528IPv6\uff0c\u7f16\u8f91<code>/etc/sysctl.conf</code>\uff0c\u8bbe\u7f6e\u5982\u4e0b\u4e09\u9879\uff1a</p> <pre><code>net.ipv6.conf.all.disable_ipv6=0\nnet.ipv6.conf.default.disable_ipv6=0\nnet.ipv6.conf.lo.disable_ipv6=0\n</code></pre> <p>\u91cd\u542f\u4e3b\u673a\uff0c\u5f85\u91cd\u542f\u5b8c\u6210\u5373\u53ef\u3002</p>"},{"location":"2019-06-03-%E5%9C%A8Ubuntu%E4%B8%8A%E4%BD%BF%E7%94%A8Hurricane%20Electric%E7%9A%84IPv6%E9%9A%A7%E9%81%93/#_3","title":"\u53c2\u8003","text":"<ul> <li>IPv6 Tunnel Broker</li> <li>Tunneled IPv6</li> <li>\u963f\u91cc\u4e91 Ubuntu \u652f\u6301 IPv6 \u7684\u5b8c\u6574\u6b65\u9aa4</li> </ul>"},{"location":"2019-06-03-%E5%9F%BA%E4%BA%8ENginx%E7%9A%84%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/","title":"2019 06 03 \u57fa\u4e8eNginx\u7684\u53cd\u5411\u4ee3\u7406","text":"<p>\u914d\u7f6e\u6587\u4ef6\u5982\u4e0b\uff1a</p> <pre><code>user  www;\nworker_processes  1;\n\npid        logs/nginx.pid;\n\nevents {\n    worker_connections  1024;\n    use epoll;\n}\n\nhttp {\n\n    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                      '$status $body_bytes_sent \"$http_referer\" '\n                      '\"$http_user_agent\" \"$google\"';\n\n    access_log  logs/access.log  main;\n\n    access_log off;\n    include       mime.types;\n    default_type  application/octet-stream;\n    client_max_body_size 5M;\n    client_body_buffer_size 256K;\n    types_hash_max_size 2048;\n\n    #\u8bbe\u5b9aDNS\n    resolver [2001:4860:4860::8888] [2001:4860:4860::8844];\n    sendfile        on;\n    tcp_nopush     on;\n    keepalive_timeout  65;\n    gzip  on;\n    proxy_connect_timeout    5;\n    proxy_read_timeout       60;\n    proxy_send_timeout       5;\n    proxy_buffer_size        16k;\n    proxy_buffers            4 64k;\n    proxy_busy_buffers_size 128k;\n    #proxy_temp_file_write_size 128k;\n    #proxy_temp_path   /var/nginx_cache/temp;\n    #\u8bbe\u5b9a\u7f13\u5b58\u7684\u8def\u5f84\u548c\u5176\u4ed6\u53c2\u6570\uff0chttp://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_cache_path\n    #proxy_cache_path  /var/nginx_cache/cache levels=1:2 keys_zone=one:16m inactive=1d max_size=512m;\n\n    #\u8bbe\u5b9a\u590d\u7528SSL\u4f1a\u8bdd\n    proxy_ssl_session_reuse on;\n    proxy_redirect off;\n    proxy_ssl_server_name on;\n    #\u7f13\u5b58key\u89c4\u5219\uff0c\u7528\u4e8e\u81ea\u52a8\u6e05\u9664\u7f13\u5b58\n    proxy_cache_key $scheme://$host$request_uri;\n    #\u7f13\u5b58\u533a\u540d\u79f0\uff0c\u8bbe\u5b9a\u4e8eproxy_cache_path\n    #proxy_cache one;\n    #200 304\u72b6\u6001\u7f13\u5b583\u5c0f\u65f6\n    proxy_cache_valid 200 304 10m;\n    #301\u72b6\u6001\u7f13\u5b583\u5929\n    proxy_cache_valid 301 3d;\n    #\u5176\u4ed6\u72b6\u6001\u7f13\u5b58\uff08\u5982502 404\uff091\u5206\u949f\n    proxy_cache_valid any 0s;\n    #\u5f53\u540e\u7aef\u51fa\u73b0\u9519\u8bef\u3001\u8d85\u65f6\u3001502\u72b6\u6001\u65f6\u542f\u7528\u8fc7\u671f\u7f13\u5b58\n    proxy_cache_use_stale invalid_header error timeout http_502;\n\n    ssl_session_timeout 5m;\n    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:AES128+EECDH:AES128+EDH:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n    ssl_prefer_server_ciphers on;\n    ssl_dhparam /etc/ssl/certs/dhparam.pem;\n    ssl_session_cache shared:SSL:10m;\n    add_header Strict-Transport-Security max-age=63072000;\n    add_header X-Frame-Options DENY;\n    add_header X-Content-Type-Options nosniff;\n\n    # \u52fe\u52fe\n    upstream gogo {\n        server 127.0.0.1:4999;\n    }\n\n    server {\n        listen 5000 ssl;\n        server_name 176.122.157.73;\n\n        ssl_certificate cert/176.122.157.73.crt;\n        ssl_certificate_key cert/176.122.157.73.key;\n\n        location / {\n                proxy_pass http://gogo;\n                #proxy_pass https://176.122.157.73:5001;\n        }\n    }\n\n\n    #\u684c\u9762\u7248\u4e2d\u6587\u7ef4\u57fa\n    server {\n    listen 3457 ssl;\n    server_name 176.122.157.73;\n\n        ssl_certificate cert/176.122.157.73.crt;\n        ssl_certificate_key cert/176.122.157.73.key;\n\n        location / {\n                #proxy_cache one;\n                proxy_pass https://zh.wikipedia.org; \n                proxy_buffering off;\n                proxy_cookie_domain zh.wikipedia.org $server_name:$server_port;\n                proxy_redirect https://zh.wikipedia.org/ /;\n                proxy_redirect https://zh.m.wikipedia.org/ https://$server_name:3458/;\n                proxy_set_header X-Real_IP $remote_addr;\n                proxy_set_header User-Agent $http_user_agent;\n                proxy_set_header Accept-Encoding \"\";\n                proxy_set_header referer \"https://zh.wikipedia.org$request_uri\";\n\n                #\u66ff\u6362\u624b\u673a\u7248\u89c6\u56fe\u4e3a\u4ee3\u7406\n                subs_filter zh.m.wikipedia.org $server_name:3458 g;\n                subs_filter zh.wikipedia.org $server_name:$server_port g;\n                subs_filter en.m.wikipedia.org $server_name:5005 g;\n                subs_filter en.wikipedia.org $server_name:5004 g;\n        }\n\n        location https://zh.m.wikipedia.org/ {\n                rewrite ^/(.*) https://$server_name:3458/$1 permanent;\n        }\n    }\n\n    #\u79fb\u52a8\u7248\u4e2d\u6587\u7ef4\u57fa\n    server {\n        listen 3458 ssl;\n        server_name 176.122.157.73;\n\n        ssl_certificate cert/176.122.157.73.crt;\n        ssl_certificate_key cert/176.122.157.73.key;\n\n        location / {\n            #proxy_cache one;\n            proxy_pass https://zh.m.wikipedia.org;\n            proxy_buffering off;\n            proxy_redirect https://zh.m.wikipedia.org/ /;\n            proxy_cookie_domain zh.m.wikipedia.org $server_name:$server_port;\n\n            proxy_set_header X-Real_IP $remote_addr;\n            proxy_set_header User-Agent $http_user_agent;\n            proxy_set_header Accept-Encoding \"\";\n            proxy_set_header referer https://zh.m.wikipedia.org$request_uri;\n\n                #\u66ff\u6362\u684c\u9762\u7248\u89c6\u56fe\u4e3a\u4ee3\u7406\n            subs_filter zh.wikipedia.org $server_name:3457 g;\n            subs_filter zh.m.wikipedia.org $server_name:$server_port g;\n            subs_filter en.m.wikipedia.org $server_name:5005 g;\n            subs_filter en.wikipedia.org $server_name:5004 g;\n        }\n    }\n\n    #\u8c37\u6b4c\u641c\u7d22\n    server {\n        listen 5001 ssl;\n        server_name 176.122.157.73;\n\n        set $google \"\";\n        rewrite_by_lua '\n                        local googles = {\n                                \"www.google.is\",\n                                \"www.google.dk\",\n                                \"www.google.no\",\n                                \"www.google.se\",\n                                \"www.google.fi\",\n                                \"www.google.ee\",\n                                \"www.google.lv\",\n                                \"www.google.lt\",\n                                \"www.google.ie\",\n                                \"www.google.co.uk\",\n                                \"www.google.gg\",\n                                \"www.google.je\",\n                                \"www.google.im\",\n                                \"www.google.fr\",\n                                \"www.google.nl\",\n                                \"www.google.be\",\n                                \"www.google.lu\",\n                                \"www.google.de\",\n                                \"www.google.at\",\n                                \"www.google.ch\",\n                                \"www.google.li\",\n                                \"www.google.pt\",\n                                \"www.google.es\",\n                                \"www.google.com.gi\",\n                                \"www.google.ad\",\n                                \"www.google.it\",\n                                \"www.google.com.mt\",\n                                \"www.google.sm\",\n                                \"www.google.gr\",\n                                \"www.google.ru\",\n                                \"www.google.com.by\",\n                                \"www.google.com.ua\",\n                                \"www.google.pl\",\n                                \"www.google.cz\",\n                                \"www.google.sk\",\n                                \"www.google.hu\",\n                                \"www.google.si\",\n                                \"www.google.hr\",\n                                \"www.google.ba\",\n                                \"www.google.me\",\n                                \"www.google.rs\",\n                                \"www.google.mk\",\n                                \"www.google.bg\",\n                                \"www.google.ro\",\n                                \"www.google.md\",\n                                \"www.google.mn\",\n                                \"www.google.co.kr\",\n                                \"www.google.co.jp\",\n                                \"www.google.com.vn\",\n                                \"www.google.la\",\n                                \"www.google.com.kh\",\n                                \"www.google.co.th\",\n                                \"www.google.com.my\",\n                                \"www.google.com.sg\",\n                                \"www.google.com.bn\",\n                                \"www.google.com.ph\",\n                                \"www.google.co.id\",\n                                \"www.google.kz\",\n                                \"www.google.kg\",\n                                \"www.google.com.tj\",\n                                \"www.google.co.uz\",\n                                \"www.google.tm\",\n                                \"www.google.com.af\",\n                                \"www.google.com.pk\",\n                                \"www.google.com.np\",\n                                \"www.google.co.in\",\n                                \"www.google.com.bd\",\n                                \"www.google.lk\",\n                                \"www.google.mv\",\n                                \"www.google.com.kw\",\n                                \"www.google.com.sa\",\n                                \"www.google.com.bh\",\n                                \"www.google.ae\",\n                                \"www.google.com.om\",\n                                \"www.google.jo\",\n                                \"www.google.co.il\",\n                                \"www.google.com.lb\",\n                                \"www.google.com.tr\",\n                                \"www.google.az\",\n                                \"www.google.am\",\n                                \"www.google.co.ls\",\n                                \"www.google.com.eg\",\n                                \"www.google.com.ly\",\n                                \"www.google.dz\",\n                                \"www.google.co.ma\",\n                                \"www.google.sn\",\n                                \"www.google.gm\",\n                                \"www.google.ml\",\n                                \"www.google.bf\",\n                                \"www.google.com.sl\",\n                                \"www.google.ci\",\n                                \"www.google.com.gh\",\n                                \"www.google.tg\",\n                                \"www.google.bj\",\n                                \"www.google.ne\",\n                                \"www.google.com.ng\",\n                                \"www.google.sh\",\n                                \"www.google.cm\",\n                                \"www.google.td\",\n                                \"www.google.cf\",\n                                \"www.google.ga\",\n                                \"www.google.cg\",\n                                \"www.google.cd\",\n                                \"www.google.it.ao\",\n                                \"www.google.com.et\",\n                                \"www.google.dj\",\n                                \"www.google.co.ke\",\n                                \"www.google.co.ug\",\n                                \"www.google.co.tz\",\n                                \"www.google.rw\",\n                                \"www.google.bi\",\n                                \"www.google.mw\",\n                                \"www.google.co.mz\",\n                                \"www.google.mg\",\n                                \"www.google.sc\",\n                                \"www.google.mu\",\n                                \"www.google.co.zm\",\n                                \"www.google.co.zw\",\n                                \"www.google.co.bw\",\n                                \"www.google.com.na\",\n                                \"www.google.co.za\",\n                                \"www.google.com.au\",\n                                \"www.google.com.nf\",\n                                \"www.google.co.nz\",\n                                \"www.google.com.sb\",\n                                \"www.google.com.fj\",\n                                \"www.google.fm\",\n                                \"www.google.ki\",\n                                \"www.google.nr\",\n                                \"www.google.tk\",\n                                \"www.google.ws\",\n                                \"www.google.as\",\n                                \"www.google.to\",\n                                \"www.google.nu\",\n                                \"www.google.co.ck\",\n                                \"www.google.com.do\",\n                                \"www.google.tt\",\n                                \"www.google.com.co\",\n                                \"www.google.com.ec\",\n                                \"www.google.co.ve\",\n                                \"www.google.gy\",\n                                \"www.google.com.pe\",\n                                \"www.google.com.bo\",\n                                \"www.google.com.py\",\n                                \"www.google.com.br\",\n                                \"www.google.com.uy\",\n                                \"www.google.com.ar\",\n                                \"www.google.cl\",\n                                \"www.google.gl\",\n                                \"www.google.ca\",\n                                \"www.google.com\",\n                                \"www.google.com.mx\",\n                                \"www.google.com.gt\",\n                                \"www.google.com.bz\",\n                                \"www.google.com.sv\",\n                                \"www.google.hn\",\n                                \"www.google.com.ni\",\n                                \"www.google.co.cr\",\n                                \"www.google.com.pa\",\n                                \"www.google.bs\",\n                                \"www.google.com.cu\",\n                                \"www.google.com.jm\",\n                                \"www.google.ht\"}\n                        ngx.var.google = googles[ math.random( #googles )]';\n\n        ssl_certificate cert/176.122.157.73.crt;\n        ssl_certificate_key cert/176.122.157.73.key;\n\n        location / {\n            #\u4ee3\u7406\u8bbe\u7f6e\n            proxy_cookie_domain $google $server_name;\n            proxy_pass https://$google;\n            proxy_ssl_name $google;\n            #\u8bbe\u5b9a\u8f6c\u53d1\u540e\u7aef\u670d\u52a1\u5668\u7684header\n            proxy_set_header Host $google;\n            proxy_set_header User-Agent $http_user_agent;\n            #proxy_set_header User-Agent \"Mozilla/5.0 (compatible; MSIE 10.0; Windows Phone 8.0; Trident/6.0; IEMobile/10.0; ARM; Touch; NOKIA; Lumia 920)\";\n            proxy_set_header Referer https://$google;\n            proxy_set_header X-Real_IP $remote_addr;\n            proxy_set_header Accept-Encoding \"\";\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto https;\n            #\u91cd\u5b9a\u5411\n            proxy_redirect https://$google Https://$server_name:$server_port;\n            #\u8bbe\u5b9a\u8bed\u8a00\u4e3a\u5927\u9646\u4e2d\u6587\n            proxy_set_header Accept-Language \"zh-CN\";\n            proxy_set_header referer https://$google$request_uri;\n            #\u53bb\u9664\u8ddf\u8e2a\n            subs_filter ping=\\\"(.+?)\\\" '' ir;\n            subs_filter oncontextmenu=\\\"google.ctpacw.cm\\(this\\)\\\" '' ir;\n            subs_filter onmousedown=\\\"(.+?)\\\" '' ir;\n\n            #\u53bb\u9664\u5b9a\u4f4d\u6d88\u606f\n            subs_filter \"&lt;div class=\\\"smiUbb(.*?)&lt;\\/div&gt;\" '' ir;\n            #\u66ff\u6362\u4e2d\u6587\u7ef4\u57fa\u4e3a\u4ee3\u7406\n            subs_filter zh.wikipedia.org $server_name:3457 g;\n            subs_filter zh.m.wikipedia.org $server_name:3458 g;\n            subs_filter en.m.wikipedia.org $server_name:5005 g;\n            subs_filter en.wikipedia.org $server_name:5004 g;\n            #\u66ff\u6362Logo\u94fe\u63a5\n            subs_filter $google $server_name:$server_port g;\n            subs_filter www.google.com $server_name:$server_port g;\n            #\u66ff\u6362\u6587\u4ef6\u7c7b\u578b\n            subs_filter_types text/css text/xml text/javascript;\n        }\n    }\n\n    #\u684c\u9762\u7248\u82f1\u6587\u7ef4\u57fa\n    server {\n        listen 5004 ssl;\n        server_name 176.122.157.73;\n        ssl_certificate cert/176.122.157.73.crt;\n        ssl_certificate_key cert/176.122.157.73.key;\n        location / {\n                #proxy_cache one;\n                proxy_pass https://en.wikipedia.org;\n                proxy_buffering off;\n                proxy_cookie_domain en.wikipedia.org $server_name:$server_port;\n                proxy_redirect https://en.wikipedia.org/ /;\n                proxy_redirect https://en.m.wikipedia.org/ https://$server_name:5005/;\n                proxy_set_header X-Real_IP $remote_addr;\n                proxy_set_header User-Agent $http_user_agent;\n                proxy_set_header Accept-Encoding \"\";\n                proxy_set_header referer \"https://en.wikipedia.org$request_uri\";\n                #\u66ff\u6362\u624b\u673a\u7248\u89c6\u56fe\u4e3a\u4ee3\u7406\n                subs_filter en.m.wikipedia.org $server_name:5005 g;\n                subs_filter en.wikipedia.org $server_name:$server_port g;\n                subs_filter zh.wikipedia.org $server_name:3457 g;\n                subs_filter zh.m.wikipedia.org $server_name:3458 g;\n        }\n        location https://en.m.wikipedia.org/ {\n                rewrite ^/(.*) https://$server_name:5005/$1 permanent;\n        }\n    }\n\n    #\u79fb\u52a8\u7248\u82f1\u6587\u7ef4\u57fa\n    server {\n        listen 5005 ssl;\n        server_name 176.122.157.73;\n        ssl_certificate cert/176.122.157.73.crt;\n        ssl_certificate_key cert/176.122.157.73.key;\n\n        location / {\n            #proxy_cache one;\n            proxy_pass https://en.m.wikipedia.org;\n            proxy_buffering off;\n            proxy_redirect https://en.m.wikipedia.org/ /;\n            proxy_cookie_domain en.m.wikipedia.org $server_name:$server_port;\n            proxy_set_header X-Real_IP $remote_addr;\n            proxy_set_header User-Agent $http_user_agent;\n            proxy_set_header Accept-Encoding \"\";\n            proxy_set_header referer https://en.m.wikipedia.org$request_uri;\n            #\u66ff\u6362\u684c\u9762\u7248\u89c6\u56fe\u4e3a\u4ee3\u7406\n            subs_filter en.wikipedia.org $server_name:5004 g;\n            subs_filter en.m.wikipedia.org $server_name:$server_port g;\n            subs_filter zh.wikipedia.org $server_name:3457 g;\n            subs_filter zh.m.wikipedia.org $server_name:3458 g;\n        }\n    }\n\n    # v2ray\n    server {\n        listen 53514 ssl;\n        server_name 176.122.157.73;\n        ssl_ciphers HIGH:!aNULL:!MD5;\n        ssl_certificate cert/176.122.157.73.crt;\n        ssl_certificate_key cert/176.122.157.73.key;\n\n        location /9a00db84-636e-4653-b763-e0271e167b41 {\n            proxy_redirect off;\n            proxy_pass http://127.0.0.1:53513;\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection \"upgrade\";\n            proxy_set_header Host $http_host;\n\n            # Show realip in v2ray access.log\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header Host $host;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        }\n    }\n}\n</code></pre>"},{"location":"2019-06-04-MySQL%E9%9A%8F%E6%9C%BA%E6%9F%A5%E8%AF%A2%E4%B8%80%E6%9D%A1%E8%AE%B0%E5%BD%95/","title":"2019 06 04 MySQL\u968f\u673a\u67e5\u8be2\u4e00\u6761\u8bb0\u5f55","text":""},{"location":"2019-06-04-MySQL%E9%9A%8F%E6%9C%BA%E6%9F%A5%E8%AF%A2%E4%B8%80%E6%9D%A1%E8%AE%B0%E5%BD%95/#_1","title":"\u8868\u7ed3\u6784","text":"<pre><code>CREATE TABLE `poet` (\n`id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n`dynasty` varchar(11) DEFAULT NULL,\n`author` text DEFAULT NULL,\n`paragraph` text DEFAULT NULL,\n`strains` text DEFAULT NULL,\n`title` text DEFAULT NULL,\nPRIMARY KEY (`id`),\nKEY `poet_title` (`title`(10)) USING BTREE,\nKEY `poet_dynasty` (`dynasty`) USING HASH,\nKEY `poet_author` (`author`(10)) USING BTREE\n) ENGINE=InnoDB AUTO_INCREMENT=311862 DEFAULT CHARSET=utf8mb4;\n</code></pre>"},{"location":"2019-06-04-MySQL%E9%9A%8F%E6%9C%BA%E6%9F%A5%E8%AF%A2%E4%B8%80%E6%9D%A1%E8%AE%B0%E5%BD%95/#_2","title":"\u67e5\u8be2\u8bed\u53e5","text":"<pre><code>SELECT r1.title,\nr1.author,\nr1.paragraph\nFROM poet AS r1\nJOIN\n(SELECT CEIL(RAND() *\n(SELECT MAX(id)\nFROM poet)) AS id) AS r2\nWHERE r1.id &gt;= r2.id\nORDER BY r1.id ASC\nLIMIT 1;\n</code></pre> <p>\u7ed3\u679c\u6837\u4f8b\uff1a</p> <pre><code>*************************** 1. row ***************************\n    title: \u96dc\u8a60\u4e0b \u6797\u79bd\n   author: \u6d2a\u9002\nparagraph: \u8499\u6f64\u78a7\u5343\u9846\uff0c\u8fce\u66e6\u7d05\u534a\u9830\u3002\u95b1\u53e4\u61a9\u9d5d\u6c60\uff0c\u727d\u9023\u9752\u674e\u5e16\u3002\n1 row in set (0.001 sec)\n</code></pre> <p>\u82e5\u8981\u67e5\u8be2\u968f\u673a\u7684\u4e00\u6761<code>author</code>\u4e3a<code>\u674e\u767d</code>\u7684\u8bb0\u5f55\uff0c\u6b64\u5904\u4f7f\u7528\u5b58\u50a8\u8fc7\u7a0b\u6765\u5b9e\u73b0\uff1a</p> <pre><code>DELIMITER $\n\nCREATE DEFINER=`app`@`%` PROCEDURE `random_poet_of_libai`( )\nBEGIN\nSET @_rand_index := CEIL( RAND( ) * ( SELECT COUNT( * ) FROM poet WHERE author = '\u674e\u767d' ) );\nPREPARE stmt FROM 'SELECT title, author, paragraph FROM poet WHERE author = \\'\u674e\u767d\\' LIMIT ?, 1;';\nEXECUTE stmt USING @_rand_index;\nDEALLOCATE PREPARE stmt;\nEND\n\nDELIMITER ;\n\nCALL random_poet_of_libai();\n</code></pre> <p>\u7ed3\u679c\u6837\u4f8b\uff1a</p> <pre><code>*************************** 1. row ***************************\n    title: \u96dc\u66f2\u6b4c\u8fad \u9cf4\u96c1\u884c\n   author: \u674e\u767d\nparagraph: \u80e1\u96c1\u9cf4\uff0c\u8fad\u71d5\u5c71\uff0c\u6628\u767c\u59d4\u7fbd\u671d\u5ea6\u95dc\u3002\u4e00\u4e00\u929c\u8606\u679d\uff0c\u5357\u98db\u6563\u843d\u5929\u5730\u9593\u3002\u9023\u884c\u63a5\u7ffc\u5f80\u5fa9\u9084\uff0c\u5ba2\u5c45\u7159\u6ce2\u5bc4\u6e58\u5433\u3002\u51cc\u971c\u89f8\u96ea\u6bdb\u9ad4\u67af\uff0c\u754f\u9022\u77f0\u7e73\u9a5a\u76f8\u547c\u3002\n1 row in set (0.008 sec)\n</code></pre>"},{"location":"2019-06-04-MySQL%E9%9A%8F%E6%9C%BA%E6%9F%A5%E8%AF%A2%E4%B8%80%E6%9D%A1%E8%AE%B0%E5%BD%95/#_3","title":"\u53c2\u8003","text":"<ul> <li>MySQL select 10 random rows from 600K rows fast</li> <li>Using variable in a LIMIT clause in MySQL</li> </ul>"},{"location":"2019-06-15-%E5%9F%BA%E4%BA%8EWine%E4%BD%BF%E7%94%A8QQ%E8%BD%BB%E8%81%8A%E7%89%88/","title":"2019 06 15 \u57fa\u4e8eWine\u4f7f\u7528QQ\u8f7b\u804a\u7248","text":"<p>wine\u662f\u7528\u4e8e\u5728\u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u8fd0\u884cWindows\u5e94\u7528\u7a0b\u5e8f\u7684\u5f00\u6e90\u8f6f\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u5b83\u6765\u5728Linux\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u4f7f\u7528QQ\u8f7b\u804a\u7248\u5ba2\u6237\u7aef\uff0c\u6ee1\u8db3\u65e5\u5e38\u7684\u901a\u4fe1\u9700\u6c42\u3002\u5f53\u7136\uff0c\u4f60\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5fae\u4fe1\u7b49\u5ba2\u6237\u7aef\uff0c\u64cd\u4f5c\u6d41\u7a0b\u4e0e\u672c\u6587\u6240\u8ff0\u5927\u540c\u5c0f\u5f02\u3002</p>"},{"location":"2019-06-15-%E5%9F%BA%E4%BA%8EWine%E4%BD%BF%E7%94%A8QQ%E8%BD%BB%E8%81%8A%E7%89%88/#wine","title":"\u5b89\u88c5wine","text":"<p>\u6267\u884c\u547d\u4ee4\uff1a</p> <pre><code># \u5b89\u88c5wine\u548cwinetrick\uff0c\u6211\u4eec\u7528\u540e\u8005\u6765\u5b89\u88c5\u4e00\u4e9b\u4f9d\u8d56\u5e93\nsudo pacman -S wine winetrick\n# \u8bbe\u7f6e\u73af\u5883\u53d8\u91cfWINEARCH\u4e3awin32\necho \"\\nexport WINEARCH=win32\" &gt;&gt; ~/.profile &amp;&amp; source ~/.profile\n# \u5b89\u88c5\u4f9d\u8d56\u5e93\uff0c\u6b64\u6b65\u9aa4\u9700\u8981\u4e0b\u8f7d\u4e00\u4e9b\u6587\u4ef6\uff0c\u60a8\u53ef\u4ee5\u8bbe\u7f6ehttp_proxy\u548chttps_proxy\u6765\u4f7f\u7528\u4ee3\u7406\uff0c\u8fbe\u5230\u52a0\u901f\u7684\u76ee\u7684\nwinetricks msxml3 gdiplus riched20 riched30 ie6 vcrun6 vcrun2005sp1 vcrun6sp6\n# \u8ffd\u52a0\u914d\u7f6e\u5230~/.wine/drive_c/windows/win.ini\necho \"\\n[Desktop]\nmenufontsize=13\nmessagefontsize=13\nstatusfontsize=13\nIconTitleSize=13\" &gt;&gt; ~/.wine/drive_c/windows/win.ini\n</code></pre> <p>\u521b\u5efa\u6587\u4ef6<code>font.reg</code>\uff1a</p> <pre><code>REGEDIT4\n[HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\FontSubstitutes]\n\"Arial\"=\"simsun\"\n\"Arial CE,238\"=\"simsun\"\n\"Arial CYR,204\"=\"simsun\"\n\"Arial Greek,161\"=\"simsun\"\n\"Arial TUR,162\"=\"simsun\"\n\"Courier New\"=\"simsun\"\n\"Courier New CE,238\"=\"simsun\"\n\"Courier New CYR,204\"=\"simsun\"\n\"Courier New Greek,161\"=\"simsun\"\n\"Courier New TUR,162\"=\"simsun\"\n\"FixedSys\"=\"simsun\"\n\"Helv\"=\"simsun\"\n\"Helvetica\"=\"simsun\"\n\"MS Sans Serif\"=\"simsun\"\n\"MS Shell Dlg\"=\"simsun\"\n\"MS Shell Dlg 2\"=\"simsun\"\n\"System\"=\"simsun\"\n\"Tahoma\"=\"simsun\"\n\"Times\"=\"simsun\"\n\"Times New Roman CE,238\"=\"simsun\"\n\"Times New Roman CYR,204\"=\"simsun\"\n\"Times New Roman Greek,161\"=\"simsun\"\n\"Times New Roman TUR,162\"=\"simsun\"\n\"Tms Rmn\"=\"simsun\"\n</code></pre> <p>\u6839\u636e\u8be5\u6587\u4ef6\u4fee\u6539\u6ce8\u518c\u8868\uff0c\u6267\u884c\uff1a</p> <pre><code>regedit font.reg\n</code></pre> <p>\u5c06<code>Windows</code>\u64cd\u4f5c\u7cfb\u7edf\u7684<code>C:\\Windows\\Fonts</code>\u4e0b\u7684\u6587\u4ef6\u590d\u5236\u5230<code>~/.wine/drive_c/windows/Fonts/</code>\u4e2d\uff0c(\u6b64\u6b65\u9aa4\u65e0\u547d\u4ee4\u63d0\u793a)\u3002</p> <p>\u6267\u884c<code>winecfg</code>\uff1b\u9009\u62e9<code>Applications</code>\uff0c\u5c06wine\u7684Windows\u7248\u672c\u4fee\u6539\u4e3a<code>Windows 10</code>\uff0c\u5982\u56fe\uff1a</p> <p></p> <p>\u9009\u62e9<code>Libraries</code>\uff0c\u5728<code>New override for library</code>\u4e2d\u8f93\u5165<code>ntoskrnl.exe</code>\uff0c\u70b9\u51fb<code>Add</code>\uff0c\u5728<code>Existing overrides</code>\u4e2d\u9009\u62e9<code>ntoskrnl.exe</code>\uff0c\u70b9\u51fb<code>Edit</code>\uff0c\u9009\u62e9<code>Disable</code>\uff0c\u70b9\u51fb\u5c0f\u7a97\u53e3\u7684<code>OK</code>\uff0c\u5982\u56fe\uff1a</p> <p> </p> <p>\u5bf9<code>txplatform.exe</code>\u6267\u884c\u540c\u6837\u7684\u64cd\u4f5c\u540e\uff0c\u70b9\u51fb<code>OK</code>\uff0c\u4fdd\u5b58\u4fee\u6539\uff0c\u5982\u540c\uff1a</p> <p></p>"},{"location":"2019-06-15-%E5%9F%BA%E4%BA%8EWine%E4%BD%BF%E7%94%A8QQ%E8%BD%BB%E8%81%8A%E7%89%88/#qq","title":"\u5b89\u88c5QQ\u8f7b\u804a\u7248","text":"<pre><code># \u4e0b\u8f7dQQ\u8f7b\u804a\u72487.9\u5b89\u88c5\u5305\ncurl -O -L http://dldir1.qq.com/qqfile/qq/QQ7.9Light/14308/QQ7.9Light.exe\n# \u6267\u884c\u5b89\u88c5\u5305\uff0c\u5b89\u88c5QQ\nwine QQ7.9Light.exe\n</code></pre> <p>\u521b\u5efa\u542f\u52a8\u5668\u6587\u4ef6<code>~/.local/share/applications/QQ.desktop</code>\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>[Desktop Entry]\nName=QQ\u8f7b\u804a\u7248\nType=Application\nExec=env LC_ALL=zh_CN.UTF-8 WINEPREFIX=\"/home/{\u60a8\u7684\u7528\u6237\u540d}/.wine\" wine \"/home/{\u60a8\u7684\u7528\u6237\u540d}/.wine/drive_c/Program Files/Tencent/QQLite/Bin/QQ.exe\"\n</code></pre> <p>\u8bf7\u5c06<code>{\u60a8\u7684\u7528\u6237\u540d}</code>\u4fee\u6539\u4e3a\u60a8\u7684\u7528\u6237\u540d\uff0c\u56e0\u4e3a\u542f\u52a8\u5668\u4e2d\u4e0d\u652f\u6301<code>~</code>\u8868\u793a\u5bb6\u76ee\u5f55</p> <p>\u60a8\u73b0\u5728\u53ef\u4ee5\u5728\u542f\u52a8\u5668\u4e2d\u542f\u52a8<code>QQ\u8f7b\u804a\u7248</code>\uff0c\u5982\u56fe\uff1a</p> <p></p> <p>\u4e5f\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u542f\u52a8\uff1a</p> <pre><code>wine ~/.wine/drive_c/Program\\ Files/Tencent/QQLite/Bin/QQ.exe\n</code></pre>"},{"location":"2019-06-15-%E5%9F%BA%E4%BA%8EWine%E4%BD%BF%E7%94%A8QQ%E8%BD%BB%E8%81%8A%E7%89%88/#_1","title":"\u7c98\u8d34\u677f\u4e0d\u540c\u6b65","text":"<p>\u82e5\u51fa\u73b0wine\u7684\u7c98\u8d34\u677f\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u7684\u7c98\u8d34\u677f\u4e0d\u540c\u6b65\uff0c\u5219\u7f16\u8f91\u5982\u4e0b\u6ce8\u518c\u8868\u6587\u4ef6<code>UsePrimarySelection.reg</code>\uff0c\u5185\u5bb9\uff1a</p> <pre><code>REGEDIT4\n[HKEY_CURRENT_USER\\Software\\Wine\\X11 Driver]\n\"UsePrimarySelection\"=\"Y\"\n</code></pre> <p>\u6839\u636e\u8be5\u6587\u4ef6\u4fee\u6539\u6ce8\u518c\u8868\uff0c\u6267\u884c\uff1a</p> <pre><code>regedit UsePrimarySelection.reg\n</code></pre> <p>\u91cd\u542f\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5373\u53ef\u751f\u6548\u3002</p> <p>\u6ce8\uff1a\u4f7f\u6ce8\u518c\u8868\u5728\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u65f6\u751f\u6548\u7684\u65b9\u6cd5\uff0c\u4e0d\u5fc5\u987b\u662f\u91cd\u542f\u64cd\u4f5c\u7cfb\u7edf\uff0c\u8fd9\u4e2a\u5148\u4e0d\u6df1\u7a76\u3002</p>"},{"location":"2019-06-15-%E5%9F%BA%E4%BA%8EWine%E4%BD%BF%E7%94%A8QQ%E8%BD%BB%E8%81%8A%E7%89%88/#_2","title":"\u53c2\u8003","text":"<ul> <li>\u542f\u52a8\u5668\u548c\u83dc\u5355</li> <li>QQ\u5404\u7248\u672c\u4e0b\u8f7d\u5730\u5740</li> <li>wine\u4e2d\u8f6f\u4ef6\u4e2d\u6587\u4e71\u7801\u51fa\u73b0\u65b9\u6846\u95ee\u9898\u89e3\u51b3\u65b9\u6848</li> <li>[Bug 31216] Cut and paste: gnome terminal overrides Wine clipboard?</li> <li>Desktop entries</li> </ul>"},{"location":"2019-06-23-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/","title":"2019 06 23 \u5982\u4f55\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501","text":"<p>\u7ffb\u8bd1\u81eaHow to do distributed locking</p> <p>\u4f5c\u4e3a\u672c\u4e66\u7684\u4e00\u90e8\u5206\uff0c\u6211\u5728Redis\u53d1\u73b0\u4e86\u4e00\u79cd\u540d\u4e3aRedlock\u7684\u7b97\u6cd5\uff0c\u8be5\u7b97\u6cd5\u58f0\u79f0\u5728Redis\u4e0a\u5b9e\u73b0\u5bb9\u9519\u5206\u5e03\u5f0f\u9501\uff08\u6216\u8005\u66f4\u786e\u5207\u5730\u8bf4\uff0c\u79df\u7528[1]\uff09\uff0c\u5e76\u4e14\u9875\u9762\u8981\u6c42\u6765\u81ea\u5206\u5e03\u5f0f\u7cfb\u7edf\u5730\u4eba\u7684\u53cd\u9988\u3002\u8fd9\u4e2a\u7b97\u6cd5\u672c\u80fd\u5728\u6211\u7684\u8111\u6d77\u91cc\u5f15\u53d1\u4e86\u4e00\u4e9b\u8b66\u949f\uff0c\u6240\u4ee5\u6211\u82b1\u4e86\u4e9b\u65f6\u95f4\u601d\u8003\u5b83\uff0c\u5e76\u5199\u4e0b\u8fd9\u4e9b\u7b14\u8bb0\u3002</p> <p>\u7531\u4e8e\u5df2\u7ecf\u6709\u8d85\u8fc710\u4e2a\u72ec\u7acb\u7684Redlock\u5b9e\u73b0\uff0c\u6211\u4eec\u4e0d\u77e5\u9053\u8c01\u5df2\u7ecf\u4f9d\u8d56\u8fd9\u4e2a\u7b97\u6cd5\uff0c\u6211\u8ba4\u4e3a\u503c\u5f97\u516c\u5f00\u5206\u4eab\u6211\u7684\u7b14\u8bb0\u3002\u6211\u4e0d\u4f1a\u6d89\u53caRedis\u7684\u5176\u4ed6\u65b9\u9762\uff0c\u5176\u4e2d\u4e00\u4e9b\u5df2\u7ecf\u5728\u5176\u4ed6\u5730\u65b9\u88ab\u8bc4\u8bba\u8fc7\u3002</p> <p>\u5728\u6211\u8be6\u7ec6\u4ecb\u7ecdRedlock\u4e4b\u524d\uff0c\u8bf7\u5141\u8bb8\u6211\u8bf4\u6211\u975e\u5e38\u559c\u6b22Redis\uff0c\u8fc7\u53bb\u6211\u5df2\u6210\u529f\u5c06\u5b83\u7528\u4e8e\u751f\u4ea7\u4e2d\u3002\u6211\u8ba4\u4e3a\u5b83\u975e\u5e38\u9002\u5408\u60a8\u5e0c\u671b\u5728\u670d\u52a1\u5668\u4e4b\u95f4\u5171\u4eab\u4e00\u4e9b<code>\u77ac\u6001\uff0c\u8fd1\u4f3c\uff0c\u5feb\u901f\u53d8\u5316</code>\u7684\u6570\u636e\u7684\u60c5\u51b5\uff0c\u4ee5\u53ca\u5982\u679c\u60a8\u56e0\u67d0\u79cd\u539f\u56e0\u5076\u5c14\u4e22\u5931\u6570\u636e\u5e76\u4e0d\u662f\u4ec0\u4e48\u5927\u4e0d\u4e86\u7684\u5730\u65b9\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u597d\u7684\u7528\u4f8b\u662f\u7ef4\u62a4\u6bcf\u4e2aIP\u5730\u5740\u7684\u8bf7\u6c42\u8ba1\u6570\u5668\uff08\u7528\u4e8e\u901f\u7387\u9650\u5236\uff09\u548c\u6bcf\u4e2a\u7528\u6237ID\u7684\u4e0d\u540cIP\u5730\u5740\u96c6\uff08\u7528\u4e8e\u6ee5\u7528\u68c0\u6d4b\uff09\u3002</p> <p>\u7136\u800c\uff0cRedis\u5df2\u7ecf\u9010\u6e10\u8fdb\u5165\u6570\u636e\u7ba1\u7406\u9886\u57df\uff0c\u8fd9\u4e9b\u9886\u57df\u5177\u6709\u66f4\u5f3a\u7684\u4e00\u81f4\u6027\u548c\u8010\u7528\u6027\u9884\u671f - \u8fd9\u8ba9\u6211\u62c5\u5fc3\uff0c\u56e0\u4e3a\u8fd9\u4e0d\u662fRedis\u7684\u8bbe\u8ba1\u76ee\u6807\u3002 \u53ef\u4ee5\u8bf4\uff0c\u5206\u5e03\u5f0f\u9501\u5b9a\u662f\u5176\u4e2d\u4e00\u4e2a\u9886\u57df\u3002 \u8ba9\u6211\u4eec\u66f4\u8be6\u7ec6\u5730\u7814\u7a76\u5b83\u3002\u53ef\u4ee5\u8bf4\uff0c\u5206\u5e03\u5f0f\u9501\u5b9a\u662f\u5176\u4e2d\u4e00\u4e2a\u9886\u57df\u3002 \u8ba9\u6211\u4eec\u66f4\u8be6\u7ec6\u5730\u7814\u7a76\u5b83\u3002</p>"},{"location":"2019-06-23-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/#_1","title":"\u4f60\u5c06\u9501\u5b9a\u7528\u4e8e\u4f55\u5904","text":"<p>\u9501\u5b9a\u7684\u76ee\u7684\u662f\u786e\u4fdd\u5728\u53ef\u80fd\u5c1d\u8bd5\u6267\u884c\u76f8\u540c\u5de5\u4f5c\u7684\u591a\u4e2a\u8282\u70b9\u4e2d\uff0c\u53ea\u6709\u4e00\u4e2a\u5b9e\u9645\u6267\u884c\u5b83\uff08\u81f3\u5c11\u4e00\u6b21\u53ea\u6267\u884c\u4e00\u6b21\uff09\u3002\u8fd9\u9879\u5de5\u4f5c\u53ef\u80fd\u662f\u5c06\u4e00\u4e9b\u6570\u636e\u5199\u5165\u5171\u4eab\u5b58\u50a8\u7cfb\u7edf\uff0c\u6267\u884c\u67d0\u4e9b\u8ba1\u7b97\uff0c\u8c03\u7528\u67d0\u4e9b\u5916\u90e8API\u7b49\u3002 \u5728\u8f83\u9ad8\u7684\u5c42\u6b21\u4e0a\uff0c\u6709\u4e24\u4e2a\u539f\u56e0\u53ef\u80fd\u5bfc\u81f4\u60a8\u5728\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\u4e2d\u9700\u8981\u9501\u5b9a\uff1a\u6548\u7387\u6216\u6b63\u786e\u6027\u3002\u4e3a\u4e86\u533a\u5206\u8fd9\u4e9b\u60c5\u51b5\uff0c\u60a8\u53ef\u4ee5\u8be2\u95ee\u5982\u679c\u9501\u5b9a\u5931\u8d25\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1a</p> <ul> <li> <p>\u6548\u7387\uff1a\u9501\u5b9a\u53ef\u4ee5\u907f\u514d\u4e0d\u5fc5\u8981\u5730\u6267\u884c\u76f8\u540c\u7684\u5de5\u4f5c\u4e24\u6b21\uff08\u4f8b\u5982\uff0c\u4e00\u4e9b\u6602\u8d35\u7684\u8ba1\u7b97\uff09\u3002 \u5982\u679c\u9501\u5b9a\u5931\u8d25\u5e76\u4e14\u4e24\u4e2a\u8282\u70b9\u6700\u7ec8\u5b8c\u6210\u76f8\u540c\u7684\u5de5\u4f5c\uff0c\u7ed3\u679c\u662f\u6210\u672c\u7565\u6709\u589e\u52a0\uff08\u6700\u7ec8\u4e3aAWS\u652f\u4ed8\u7684\u8d39\u7528\u6bd4\u60a8\u539f\u672c\u8981\u591a5\u7f8e\u5206\uff09\u6216\u7a0d\u6709\u4e0d\u4fbf\uff08\u4f8b\u5982\u7528\u6237\u6700\u7ec8\uff09 \u4e24\u6b21\u6536\u5230\u76f8\u540c\u7684\u7535\u5b50\u90ae\u4ef6\u901a\u77e5\uff09\u3002</p> </li> <li> <p>\u6b63\u786e\u6027\uff1a\u91c7\u53d6\u9501\u5b9a\u53ef\u9632\u6b62\u5e76\u53d1\u8fdb\u7a0b\u8e29\u5230\u5f7c\u6b64\u7684\u811a\u8dbe\u5e76\u5f04\u4e71\u7cfb\u7edf\u72b6\u6001\u3002 \u5982\u679c\u9501\u5b9a\u5931\u8d25\u5e76\u4e14\u4e24\u4e2a\u8282\u70b9\u540c\u65f6\u5904\u7406\u540c\u4e00\u6761\u6570\u636e\uff0c\u5219\u7ed3\u679c\u662f\u6587\u4ef6\u635f\u574f\uff0c\u6570\u636e\u4e22\u5931\uff0c\u6c38\u4e45\u6027\u4e0d\u4e00\u81f4\uff0c\u7ed9\u4e88\u60a3\u8005\u7684\u836f\u7269\u5242\u91cf\u9519\u8bef\u6216\u5176\u4ed6\u4e00\u4e9b\u4e25\u91cd\u95ee\u9898\u3002</p> </li> </ul> <p>\u4e24\u8005\u90fd\u662f\u60f3\u8981\u9501\u5b9a\u7684\u6709\u6548\u6848\u4f8b\uff0c\u4f46\u662f\u4f60\u9700\u8981\u975e\u5e38\u6e05\u695a\u4f60\u8981\u5904\u7406\u7684\u4e24\u4e2a\u4e2d\u7684\u54ea\u4e00\u4e2a\u3002</p> <p>\u6211\u5c06\u4e89\u8fa9\u8bf4\uff0c\u5982\u679c\u60a8\u4ec5\u4ec5\u4e3a\u4e86\u63d0\u9ad8\u6548\u7387\u800c\u4f7f\u7528\u9501\uff0c\u5219\u4e0d\u5fc5\u627f\u62c5Redlock\u7684\u6210\u672c\u548c\u590d\u6742\u6027\uff0c\u8fd0\u884c5\u53f0Redis\u670d\u52a1\u5668\u5e76\u68c0\u67e5\u5927\u591a\u6570\u9501\u4ee5\u83b7\u53d6\u9501\u3002 \u60a8\u6700\u597d\u53ea\u4f7f\u7528\u4e00\u4e2aRedis\u5b9e\u4f8b\uff0c\u53ef\u80fd\u5728\u4e3b\u8981\u5d29\u6e83\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u5f02\u6b65\u590d\u5236\u5230\u8f85\u52a9\u5b9e\u4f8b\u3002</p> <p>\u5982\u679c\u60a8\u4f7f\u7528\u5355\u4e2aRedis\u5b9e\u4f8b\uff0c\u5f53\u7136\u5982\u679cRedis\u8282\u70b9\u4e0a\u7684\u7535\u6e90\u7a81\u7136\u65ad\u7535\u6216\u8005\u51fa\u73b0\u5176\u4ed6\u95ee\u9898\uff0c\u60a8\u5c06\u4e22\u5f03\u4e00\u4e9b\u9501\u3002 \u4f46\u662f\u5982\u679c\u4f60\u53ea\u662f\u4f7f\u7528\u9501\u4f5c\u4e3a\u6548\u7387\u4f18\u5316\uff0c\u5e76\u4e14\u5d29\u6e83\u4e0d\u4f1a\u7ecf\u5e38\u53d1\u751f\uff0c\u90a3\u6ca1\u4ec0\u4e48\u5927\u4e0d\u4e86\u7684\u3002 \u8fd9\u4e2a\u201c\u6ca1\u4ec0\u4e48\u5927\u4e0d\u4e86\u7684\u201d\u60c5\u666f\u662fRedis\u95ea\u8000\u7684\u5730\u65b9\u3002 \u81f3\u5c11\u5982\u679c\u60a8\u4f9d\u8d56\u4e8e\u5355\u4e2aRedis\u5b9e\u4f8b\uff0c\u90a3\u4e48\u6bcf\u4e2a\u770b\u7cfb\u7edf\u7684\u4eba\u90fd\u5f88\u6e05\u695a\u9501\u662f\u8fd1\u4f3c\u7684\uff0c\u5e76\u4e14\u4ec5\u7528\u4e8e\u975e\u5173\u952e\u76ee\u7684\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\uff0c\u5177\u67095\u4e2a\u526f\u672c\u548c\u591a\u6570\u8868\u51b3\u6743\u7684Redlock\u7b97\u6cd5\u4e4d\u4e00\u770b\uff0c\u597d\u50cf\u5b83\u9002\u7528\u4e8e\u9501\u5b9a\u5bf9\u6b63\u786e\u6027\u5f88\u91cd\u8981\u7684\u60c5\u51b5\u3002 \u6211\u5c06\u5728\u4ee5\u4e0b\u5404\u8282\u4e2d\u8bba\u8bc1\u5b83\u4e0d\u9002\u5408\u8fd9\u4e2a\u76ee\u7684\u3002 \u5bf9\u4e8e\u672c\u6587\u7684\u5176\u4f59\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u5047\u8bbe\u60a8\u7684\u9501\u5bf9\u4e8e\u6b63\u786e\u6027\u5f88\u91cd\u8981\uff0c\u5e76\u4e14\u5982\u679c\u4e24\u4e2a\u4e0d\u540c\u7684\u8282\u70b9\u540c\u65f6\u8ba4\u4e3a\u5b83\u4eec\u6301\u6709\u76f8\u540c\u7684\u9501\uff0c\u90a3\u4e48\u8fd9\u662f\u4e00\u4e2a\u4e25\u91cd\u7684\u9519\u8bef\u3002</p>"},{"location":"2019-06-23-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/#_2","title":"\u4f7f\u7528\u9501\u4fdd\u62a4\u8d44\u6e90","text":"<p>\u8ba9\u6211\u4eec\u6682\u65f6\u6401\u7f6eRedlock\u7684\u7ec6\u8282\uff0c\u5e76\u8ba8\u8bba\u5982\u4f55\u4f7f\u7528\u5206\u5e03\u5f0f\u9501\uff08\u4e0e\u6240\u4f7f\u7528\u7684\u7279\u5b9a\u9501\u5b9a\u7b97\u6cd5\u65e0\u5173\uff09\u3002 \u91cd\u8981\u7684\u662f\u8981\u8bb0\u4f4f\uff0c\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u9501\u4e0d\u50cf\u591a\u7ebf\u7a0b\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u4e92\u65a5\u9501\u3002 \u8fd9\u662f\u4e00\u4e2a\u66f4\u590d\u6742\u7684\u91ce\u517d\uff0c\u56e0\u4e3a\u4e0d\u540c\u7684\u8282\u70b9\u548c\u7f51\u7edc\u90fd\u53ef\u4ee5\u4ee5\u5404\u79cd\u65b9\u5f0f\u72ec\u7acb\u5730\u5931\u8d25\u3002</p> <p>\u4f8b\u5982\uff0c\u5047\u8bbe\u60a8\u6709\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\uff0c\u5176\u4e2d\u5ba2\u6237\u7aef\u9700\u8981\u66f4\u65b0\u5171\u4eab\u5b58\u50a8\u4e2d\u7684\u6587\u4ef6\uff08\u4f8b\u5982HDFS\u6216S3\uff09\u3002 \u5ba2\u6237\u7aef\u9996\u5148\u83b7\u53d6\u9501\uff0c\u7136\u540e\u8bfb\u53d6\u6587\u4ef6\uff0c\u8fdb\u884c\u4e00\u4e9b\u66f4\u6539\uff0c\u5c06\u4fee\u6539\u540e\u7684\u6587\u4ef6\u5199\u56de\uff0c\u6700\u540e\u91ca\u653e\u9501\u3002 \u8be5\u9501\u9632\u6b62\u4e24\u4e2a\u5ba2\u6237\u7aef\u540c\u65f6\u6267\u884c\u6b64\u8bfb - \u4fee\u6539 - \u5199\u5468\u671f\uff0c\u8fd9\u5c06\u5bfc\u81f4\u66f4\u65b0\u4e22\u5931\u3002 \u4ee3\u7801\u53ef\u80fd\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>// THIS CODE IS BROKEN\nfunction writeData(filename, data) {\nvar lock = lockService.acquireLock(filename);\nif (!lock) {\nthrow 'Failed to acquire lock';\n}\n\ntry {\nvar file = storage.readFile(filename);\nvar updated = updateContents(file, data);\nstorage.writeFile(filename, updated);\n} finally {\nlock.release();\n}\n}\n</code></pre> <p>\u4e0d\u5e78\u7684\u662f\uff0c\u5373\u4f7f\u60a8\u62e5\u6709\u5b8c\u7f8e\u7684\u9501\u5b9a\u670d\u52a1\uff0c\u4e0a\u9762\u7684\u4ee3\u7801\u4e5f\u4f1a\u88ab\u7834\u574f\u3002 \u4e0b\u56fe\u663e\u793a\u4e86\u5982\u4f55\u6700\u7ec8\u5904\u7406\u635f\u574f\u7684\u6570\u636e\uff1a</p> <p></p> <p>\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u83b7\u53d6\u9501\u7684\u5ba2\u6237\u7aef\u5728\u6301\u6709\u9501\u7684\u540c\u65f6\u6682\u505c\u4e00\u6bb5\u65f6\u95f4 - \u4f8b\u5982\uff0c\u56e0\u4e3a\u5783\u573e\u6536\u96c6\u5668\uff08GC\uff09\u542f\u52a8\u3002\u9501\u5177\u6709\u8d85\u65f6\uff08\u5373\u5b83\u662f\u79df\u7ea6\uff09\uff0c\u8fd9\u662f \u603b\u662f\u4e00\u4e2a\u597d\u4e3b\u610f\uff08\u5426\u5219\u4e00\u4e2a\u5d29\u6e83\u7684\u5ba2\u6237\u7aef\u53ef\u80fd\u4f1a\u6c38\u8fdc\u6301\u6709\u4e00\u4e2a\u9501\uff0c\u6c38\u8fdc\u4e0d\u4f1a\u91ca\u653e\u5b83\uff09\u3002 \u4f46\u662f\uff0c\u5982\u679cGC\u6682\u505c\u6301\u7eed\u65f6\u95f4\u8d85\u8fc7\u79df\u7ea6\u5230\u671f\u65f6\u95f4\uff0c\u5e76\u4e14\u5ba2\u6237\u7aef\u6ca1\u6709\u610f\u8bc6\u5230\u5b83\u5df2\u7ecf\u8fc7\u671f\uff0c\u5219\u53ef\u80fd\u4f1a\u7ee7\u7eed\u8fdb\u884c\u5e76\u8fdb\u884c\u4e00\u4e9b\u4e0d\u5b89\u5168\u7684\u66f4\u6539\u3002</p> <p>\u8fd9\u4e2a\u9519\u8bef\u4e0d\u662f\u7406\u8bba\u4e0a\u7684\uff1aHBase\u66fe\u7ecf\u6709\u8fc7\u8fd9\u4e2a\u95ee\u9898[3,4]\u3002 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0cGC\u6682\u505c\u975e\u5e38\u77ed\u6682\uff0c\u4f46\u201c\u505c\u6b62\u4e16\u754c\u201d\u7684GC\u6682\u505c\u6709\u65f6\u4f1a\u6301\u7eed\u51e0\u5206\u949f[5]  - \u80af\u5b9a\u8db3\u591f\u957f\u7684\u65f6\u95f4\u8ba9\u79df\u7ea6\u5230\u671f\u3002 \u5373\u4f7f\u662f\u6240\u8c13\u7684\u201c\u5e76\u53d1\u201d\u5783\u573e\u6536\u96c6\u5668\uff0c\u5982HotSpot JVM\u7684CMS\u4e5f\u65e0\u6cd5\u4e0e\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u5e76\u884c\u8fd0\u884c - \u5373\u4f7f\u4ed6\u4eec\u9700\u8981\u4e0d\u65f6\u5730\u505c\u6b62\u8fd9\u4e2a\u4e16\u754c[6]\u3002</p> <p>\u5728\u5199\u56de\u5b58\u50a8\u4e4b\u524d\uff0c\u901a\u8fc7\u5728\u9501\u5b9a\u5230\u671f\u65f6\u63d2\u5165\u68c0\u67e5\u6765\u89e3\u51b3\u6b64\u95ee\u9898\u3002 \u8bf7\u8bb0\u4f4f\uff0cGC\u53ef\u4ee5\u5728<code>\u4efb\u4f55\u65f6\u5019</code>\u6682\u505c\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\uff0c\u5305\u62ec\u5bf9\u60a8\u6765\u8bf4\u6700\u4e0d\u65b9\u4fbf\u7684\u70b9\uff08\u5728\u6700\u540e\u4e00\u6b21\u68c0\u67e5\u548c\u5199\u5165\u64cd\u4f5c\u4e4b\u95f4\uff09\u3002</p> <p>\u5982\u679c\u60a8\u611f\u5230\u81ea\u9e23\u5f97\u610f\uff0c\u56e0\u4e3a\u60a8\u7684\u7f16\u7a0b\u8bed\u8a00\u8fd0\u884c\u65f6\u6ca1\u6709\u957f\u65f6\u95f4\u7684GC\u6682\u505c\uff0c\u90a3\u4e48\u60a8\u7684\u8fdb\u7a0b\u53ef\u80fd\u4f1a\u6682\u505c\u7684\u539f\u56e0\u8fd8\u6709\u5f88\u591a\u3002 \u4e5f\u8bb8\u60a8\u7684\u8fdb\u7a0b\u5c1d\u8bd5\u8bfb\u53d6\u5c1a\u672a\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u7684\u5730\u5740\uff0c\u56e0\u6b64\u5b83\u4f1a\u51fa\u73b0\u9875\u9762\u9519\u8bef\u5e76\u6682\u505c\uff0c\u76f4\u5230\u4ece\u78c1\u76d8\u52a0\u8f7d\u9875\u9762\u4e3a\u6b62\u3002 \u4e5f\u8bb8\u60a8\u7684\u78c1\u76d8\u5b9e\u9645\u4e0a\u662fEBS\uff0c\u56e0\u6b64\u65e0\u610f\u4e2d\u8bfb\u53d6\u53d8\u91cf\u4f1a\u53d8\u6210\u4e9a\u9a6c\u900a\u62e5\u585e\u7f51\u7edc\u4e0a\u7684\u540c\u6b65\u7f51\u7edc\u8bf7\u6c42\u3002 \u4e5f\u8bb8\u6709\u8bb8\u591a\u5176\u4ed6\u8fdb\u7a0b\u4e89\u7528CPU\uff0c\u5e76\u4e14\u60a8\u5728\u8c03\u5ea6\u7a0b\u5e8f\u6811\u4e2d\u9047\u5230\u4e86\u4e00\u4e2a\u9ed1\u8272\u8282\u70b9\u3002 \u4e5f\u8bb8\u6709\u4eba\u4e0d\u5c0f\u5fc3\u5c06<code>SIGSTOP</code>\u53d1\u9001\u7ed9\u4e86\u8fd9\u4e2a\u8fc7\u7a0b\u3002 \u968f\u4f60\u3002 \u60a8\u7684\u6d41\u7a0b\u5c06\u6682\u505c\u3002</p> <p>\u5982\u679c\u60a8\u4ecd\u7136\u4e0d\u76f8\u4fe1\u8fc7\u7a0b\u6682\u505c\uff0c\u8bf7\u8003\u8651\u5728\u5230\u8fbe\u5b58\u50a8\u670d\u52a1\u4e4b\u524d\uff0c\u6587\u4ef6\u5199\u5165\u8bf7\u6c42\u53ef\u80fd\u4f1a\u5728\u7f51\u7edc\u4e2d\u5ef6\u8fdf\u3002 \u8bf8\u5982\u4ee5\u592a\u7f51\u548cIP\u4e4b\u7c7b\u7684\u5206\u7ec4\u7f51\u7edc\u53ef\u80fd\u4f1a\u4efb\u610f\u5ef6\u8fdf\u6570\u636e\u5305\uff0c\u5e76\u4e14\u5b83\u4eec\u4f1a[7]\uff1a\u5728GitHub\u7684\u4e00\u4e2a\u7740\u540d\u4e8b\u6545\u4e2d\uff0c\u6570\u636e\u5305\u5728\u7f51\u7edc\u4e2d\u5ef6\u8fdf\u4e86\u5927\u7ea690\u79d2[8]\u3002 \u8fd9\u610f\u5473\u7740\u5e94\u7528\u7a0b\u5e8f\u8fdb\u7a0b\u53ef\u4ee5\u53d1\u9001\u5199\u5165\u8bf7\u6c42\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u79df\u7ea6\u5df2\u7ecf\u8fc7\u671f\u7684\u4e00\u5206\u949f\u540e\u5230\u8fbe\u5b58\u50a8\u670d\u52a1\u5668\u3002</p> <p>\u5373\u4f7f\u5728\u7ba1\u7406\u826f\u597d\u7684\u7f51\u7edc\u4e2d\uff0c\u4e5f\u4f1a\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\u3002 \u60a8\u6839\u672c\u65e0\u6cd5\u5bf9\u65f6\u5e8f\u505a\u51fa\u4efb\u4f55\u5047\u8bbe\uff0c\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u4e0a\u9762\u7684\u4ee3\u7801\u6839\u672c\u4e0d\u5b89\u5168\uff0c\u65e0\u8bba\u60a8\u4f7f\u7528\u4ec0\u4e48\u9501\u670d\u52a1\u3002</p>"},{"location":"2019-06-23-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/#_3","title":"\u4f7f\u7528\u56f4\u680f\u4f7f\u9501\u5b89\u5168","text":"<p>\u89e3\u51b3\u6b64\u95ee\u9898\u7684\u65b9\u6cd5\u5b9e\u9645\u4e0a\u975e\u5e38\u7b80\u5355\uff1a\u60a8\u9700\u8981\u5728\u5b58\u50a8\u670d\u52a1\u7684\u6bcf\u4e2a\u5199\u5165\u8bf7\u6c42\u4e2d\u5305\u542b\u4e00\u4e2a\u9632\u62a4\u6807\u8bb0\u3002 \u5728\u6b64\u4e0a\u4e0b\u6587\u4e2d\uff0c\u9632\u62a4\u4ee4\u724c\u53ea\u662f\u6bcf\u6b21\u5ba2\u6237\u7aef\u83b7\u53d6\u9501\u5b9a\u65f6\u589e\u52a0\uff08\u4f8b\u5982\uff0c\u7531\u9501\u5b9a\u670d\u52a1\u9012\u589e\uff09\u7684\u6570\u5b57\u3002 \u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u5ba2\u6237\u7aef1\u83b7\u53d6\u79df\u7ea6\u5e76\u83b7\u5f9733\u7684\u4ee4\u724c\uff0c\u4f46\u968f\u540e\u5b83\u4f1a\u8fdb\u5165\u957f\u65f6\u95f4\u505c\u987f\u5e76\u4e14\u79df\u7ea6\u5230\u671f\u3002 \u5ba2\u6237\u7aef2\u83b7\u53d6\u79df\u7ea6\uff0c\u83b7\u5f9734\u7684\u4ee4\u724c\uff08\u6570\u91cf\u603b\u662f\u589e\u52a0\uff09\uff0c\u7136\u540e\u5c06\u5176\u5199\u5165\u53d1\u9001\u5230\u5b58\u50a8\u670d\u52a1\uff0c\u5305\u62ec\u4ee4\u724c34.\u7a0d\u540e\uff0c\u5ba2\u6237\u7aef1\u6062\u590d\u751f\u547d\u5e76\u5c06\u5176\u5199\u5165\u53d1\u9001\u5230\u5b58\u50a8\u670d\u52a1 \u4f46\u662f\uff0c\u5b58\u50a8\u670d\u52a1\u5668\u4f1a\u8bb0\u4f4f\u5b83\u5df2\u7ecf\u5904\u7406\u4e86\u5177\u6709\u66f4\u9ad8\u4ee4\u724c\u53f7\u7684\u5199\u5165\uff0834\uff09\uff0c\u56e0\u6b64\u5b83\u62d2\u7edd\u5e26\u6709\u4ee4\u724c33\u7684\u8bf7\u6c42\u3002</p> <p>\u8bf7\u6ce8\u610f\uff0c\u8fd9\u8981\u6c42\u5b58\u50a8\u670d\u52a1\u5668\u5728\u68c0\u67e5\u4ee4\u724c\u65f6\u8d77\u4e3b\u52a8\u4f5c\u7528\uff0c\u5e76\u62d2\u7edd\u4ee4\u724c\u53cd\u5411\u7684\u4efb\u4f55\u5199\u5165\u3002 \u4f46\u662f\uff0c\u4e00\u65e6\u4f60\u77e5\u9053\u4e86\u8fd9\u4e2a\u8bc0\u7a8d\uff0c\u8fd9\u5e76\u4e0d\u662f\u7279\u522b\u96be\u3002 \u5e76\u4e14\u53ea\u8981\u9501\u5b9a\u670d\u52a1\u751f\u6210\u4e25\u683c\u5355\u8c03\u589e\u52a0\u7684\u4ee4\u724c\uff0c\u8fd9\u5c31\u4f7f\u9501\u5b9a\u5b89\u5168\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u60a8\u4f7f\u7528ZooKeeper\u4f5c\u4e3a\u9501\u5b9a\u670d\u52a1\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528zxid\u6216znode\u7248\u672c\u53f7\u4f5c\u4e3a\u9632\u62a4\u4ee4\u724c\uff0c\u5e76\u4e14\u60a8\u5904\u4e8e\u826f\u597d\u72b6\u6001[3]\u3002</p> <p>\u7136\u800c\uff0c\u8fd9\u5bfc\u81f4\u6211\u4eec\u9047\u5230Redlock\u7684\u7b2c\u4e00\u4e2a\u5927\u95ee\u9898\uff1a\u5b83\u6ca1\u6709\u4efb\u4f55\u751f\u6210\u9632\u62a4\u4ee4\u724c\u7684\u5de5\u5177\u3002 \u6bcf\u6b21\u5ba2\u6237\u7aef\u83b7\u53d6\u9501\u5b9a\u65f6\uff0c\u8be5\u7b97\u6cd5\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u4fdd\u8bc1\u589e\u52a0\u7684\u6570\u5b57\u3002 \u8fd9\u610f\u5473\u7740\u5373\u4f7f\u7b97\u6cd5\u5b8c\u7f8e\u65e0\u7f3a\uff0c\u4e5f\u4e0d\u4f1a\u5b89\u5168\u4f7f\u7528\uff0c\u56e0\u4e3a\u5728\u4e00\u4e2a\u5ba2\u6237\u7aef\u6682\u505c\u6216\u5176\u6570\u636e\u5305\u88ab\u5ef6\u8fdf\u7684\u60c5\u51b5\u4e0b\uff0c\u60a8\u65e0\u6cd5\u963b\u6b62\u5ba2\u6237\u7aef\u4e4b\u95f4\u7684\u7ade\u4e89\u6761\u4ef6\u3002</p> <p>\u5bf9\u6211\u6765\u8bf4\uff0c\u5982\u4f55\u66f4\u6539Redlock\u7b97\u6cd5\u4ee5\u5f00\u59cb\u751f\u6210fencing\u4ee4\u724c\u5e76\u4e0d\u660e\u663e\u3002 \u5b83\u4f7f\u7528\u7684\u552f\u4e00\u968f\u673a\u503c\u4e0d\u80fd\u63d0\u4f9b\u6240\u9700\u7684\u5355\u8c03\u6027\u3002 \u7b80\u5355\u5730\u5c06\u8ba1\u6570\u5668\u4fdd\u7559\u5728\u4e00\u4e2aRedis\u8282\u70b9\u4e0a\u662f\u4e0d\u591f\u7684\uff0c\u56e0\u4e3a\u8be5\u8282\u70b9\u53ef\u80fd\u4f1a\u5931\u8d25\u3002 \u5c06\u8ba1\u6570\u5668\u4fdd\u7559\u5728\u51e0\u4e2a\u8282\u70b9\u4e0a\u610f\u5473\u7740\u5b83\u4eec\u4f1a\u4e0d\u540c\u6b65\u3002 \u60a8\u53ef\u80fd\u9700\u8981\u4e00\u4e2a\u4e00\u81f4\u7684\u7b97\u6cd5\u6765\u751f\u6210\u9632\u62a4\u4ee4\u724c\u3002 \uff08\u5982\u679c\u53ea\u662f\u589e\u52a0\u4e00\u4e2a\u8ba1\u6570\u5668\u5f88\u7b80\u5355\u3002\uff09</p>"},{"location":"2019-06-23-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/#_4","title":"\u5229\u7528\u65f6\u95f4\u89e3\u51b3\u5171\u8bc6","text":"<p>Redlock\u65e0\u6cd5\u751f\u6210\u9632\u62a4\u4ee4\u724c\u8fd9\u4e00\u4e8b\u5b9e\u5e94\u8be5\u5df2\u7ecf\u8db3\u4ee5\u6210\u4e3a\u5728\u6b63\u786e\u6027\u53d6\u51b3\u4e8e\u9501\u5b9a\u7684\u60c5\u51b5\u4e0b\u4e0d\u4f7f\u7528\u5b83\u7684\u7406\u7531\u3002 \u4f46\u8fd8\u6709\u4e00\u4e9b\u503c\u5f97\u8ba8\u8bba\u7684\u95ee\u9898\u3002</p> <p>\u5728\u5b66\u672f\u6587\u732e\u4e2d\uff0c\u8fd9\u79cd\u7b97\u6cd5\u6700\u5b9e\u7528\u7684\u7cfb\u7edf\u6a21\u578b\u662f\u5177\u6709\u4e0d\u53ef\u9760\u6545\u969c\u68c0\u6d4b\u5668\u7684\u5f02\u6b65\u6a21\u578b[9]\u3002 \u7b80\u5355\u6765\u8bf4\uff0c\u8fd9\u610f\u5473\u7740\u7b97\u6cd5\u4e0d\u4f1a\u5bf9\u65f6\u5e8f\u505a\u51fa\u4efb\u4f55\u5047\u8bbe\uff1a\u8fdb\u7a0b\u53ef\u80fd\u6682\u505c\u4efb\u610f\u957f\u5ea6\u7684\u65f6\u95f4\uff0c\u6570\u636e\u5305\u53ef\u80fd\u5728\u7f51\u7edc\u4e2d\u88ab\u4efb\u610f\u5ef6\u8fdf\uff0c\u65f6\u949f\u53ef\u80fd\u662f\u4efb\u610f\u9519\u8bef\u7684 - \u7136\u800c\u7b97\u6cd5\u4ecd\u7136\u53ef\u4ee5\u6b63\u786e\u6267\u884c \u4e8b\u60c5\u3002 \u9274\u4e8e\u6211\u4eec\u4e0a\u9762\u8ba8\u8bba\u7684\u5185\u5bb9\uff0c\u8fd9\u4e9b\u90fd\u662f\u975e\u5e38\u5408\u7406\u7684\u5047\u8bbe\u3002</p> <p>\u7b97\u6cd5\u53ef\u4ee5\u4f7f\u7528\u65f6\u949f\u7684\u552f\u4e00\u76ee\u7684\u662f\u751f\u6210\u8d85\u65f6\uff0c\u4ee5\u907f\u514d\u5728\u8282\u70b9\u5173\u95ed\u65f6\u6c38\u8fdc\u7b49\u5f85\u3002 \u4f46\u662f\u8d85\u65f6\u4e0d\u5fc5\u662f\u51c6\u786e\u7684\uff1a\u4ec5\u4ec5\u56e0\u4e3a\u8bf7\u6c42\u8d85\u65f6\uff0c\u8fd9\u5e76\u4e0d\u610f\u5473\u7740\u53e6\u4e00\u4e2a\u8282\u70b9\u80af\u5b9a\u662f\u5173\u95ed\u7684 - \u5b83\u4e5f\u53ef\u80fd\u662f\u56e0\u4e3a\u7f51\u7edc\u4e2d\u5b58\u5728\u5927\u7684\u5ef6\u8fdf\uff0c\u6216\u8005\u60a8\u7684\u672c\u5730\u65f6\u949f \u662f\u9519\u7684\u3002 \u5f53\u7528\u4f5c\u6545\u969c\u68c0\u6d4b\u5668\u65f6\uff0c\u8d85\u65f6\u53ea\u662f\u731c\u6d4b\u51fa\u73b0\u4e86\u95ee\u9898\u3002 \uff08\u5982\u679c\u53ef\u4ee5\u7684\u8bdd\uff0c\u5206\u5e03\u5f0f\u7b97\u6cd5\u5c06\u5b8c\u5168\u6ca1\u6709\u65f6\u949f\uff0c\u4f46\u968f\u540e\u534f\u5546\u53d8\u5f97\u4e0d\u53ef\u80fd[10]\u3002\u83b7\u53d6\u9501\u5b9a\u5c31\u50cf\u662f\u6bd4\u8f83\u548c\u8bbe\u7f6e\u64cd\u4f5c\uff0c\u8fd9\u9700\u8981\u5171\u8bc6[11]\u3002\uff09</p> <p>\u8bf7\u6ce8\u610f\uff0cRedis\u4f7f\u7528<code>gettimeofday</code>\u800c\u4e0d\u662f\u5355\u8c03\u65f6\u949f\u6765\u786e\u5b9a\u5bc6\u94a5\u7684\u5230\u671f\u65f6\u95f4\u3002 gettimeofday\u7684\u624b\u518c\u9875\u660e\u786e\u8868\u793a\u5b83\u8fd4\u56de\u7684\u65f6\u95f4\u4f1a\u53d7\u5236\u4e8e\u7cfb\u7edf\u65f6\u95f4\u7684\u4e0d\u8fde\u7eed\u8df3\u8dc3 - \u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u53ef\u80fd\u4f1a\u7a81\u7136\u5411\u524d\u8df3\u51e0\u5206\u949f\uff0c\u751a\u81f3\u53ef\u80fd\u4f1a\u8df3\u56de\u65f6\u95f4\uff08\u4f8b\u5982\uff0c\u5982\u679c\u65f6\u949f\u7531NTP\u6b65\u8fdb\uff0c\u56e0\u4e3a \u5b83\u4e0eNTP\u670d\u52a1\u5668\u7684\u533a\u522b\u592a\u5927\uff0c\u6216\u8005\u5982\u679c\u65f6\u949f\u7531\u7ba1\u7406\u5458\u624b\u52a8\u8c03\u6574\uff09\u3002 \u56e0\u6b64\uff0c\u5982\u679c\u7cfb\u7edf\u65f6\u949f\u505a\u4e86\u5947\u602a\u7684\u4e8b\u60c5\uff0c\u5f88\u5bb9\u6613\u53d1\u751fRedis\u4e2d\u7684\u5bc6\u94a5\u5230\u671f\u6bd4\u9884\u671f\u5feb\u5f97\u591a\u6216\u6162\u5f97\u591a\u3002</p> <p>\u5bf9\u4e8e\u5f02\u6b65\u6a21\u578b\u4e2d\u7684\u7b97\u6cd5\uff0c\u8fd9\u4e0d\u662f\u4e00\u4e2a\u5927\u95ee\u9898\uff1a\u8fd9\u4e9b\u7b97\u6cd5\u901a\u5e38\u786e\u4fdd\u5176\u5b89\u5168\u5c5e\u6027\u59cb\u7ec8\u4fdd\u6301\u4e0d\u53d8\uff0c\u800c\u4e0d\u505a\u4efb\u4f55\u65f6\u5e8f\u5047\u8bbe[12]\u3002 \u53ea\u6709\u6d3b\u52a8\u5c5e\u6027\u53d6\u51b3\u4e8e\u8d85\u65f6\u6216\u5176\u4ed6\u4e00\u4e9b\u6545\u969c\u68c0\u6d4b\u5668\u3002 \u7b80\u5355\u6765\u8bf4\uff0c\u8fd9\u610f\u5473\u7740\u5373\u4f7f\u7cfb\u7edf\u4e2d\u7684\u65f6\u95f4\u5230\u5904\u90fd\u662f\uff08\u8fdb\u7a0b\u6682\u505c\uff0c\u7f51\u7edc\u5ef6\u8fdf\uff0c\u65f6\u949f\u5411\u524d\u548c\u5411\u540e\u8df3\u8dc3\uff09\uff0c\u7b97\u6cd5\u7684\u6027\u80fd\u53ef\u80fd\u4f1a\u4e0b\u964d\uff0c\u4f46\u7b97\u6cd5\u6c38\u8fdc\u4e0d\u4f1a\u6210\u4e3a \u9519\u8bef\u7684\u51b3\u5b9a\u3002</p> <p>\u4f46\u662f\uff0cRedlock\u4e0d\u662f\u8fd9\u6837\u7684\u3002 \u5b83\u7684\u5b89\u5168\u6027\u53d6\u51b3\u4e8e\u8bb8\u591a\u65f6\u5e8f\u5047\u8bbe\uff1a\u5b83\u5047\u8bbe\u6240\u6709Redis\u8282\u70b9\u5728\u5230\u671f\u4e4b\u524d\u4fdd\u6301\u5bc6\u94a5\u5927\u7ea6\u5408\u9002\u7684\u65f6\u95f4\u957f\u5ea6; \u4e0e\u5230\u671f\u65f6\u95f4\u76f8\u6bd4\uff0c\u7f51\u7edc\u5ef6\u8fdf\u8f83\u5c0f; \u5e76\u4e14\u8be5\u8fc7\u7a0b\u6682\u505c\u6bd4\u5230\u671f\u6301\u7eed\u65f6\u95f4\u77ed\u5f97\u591a\u3002</p>"},{"location":"2019-06-23-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/#redlock","title":"\u7528\u7cdf\u7cd5\u7684\u65f6\u95f4\u6253\u7834Redlock","text":"<p>\u8ba9\u6211\u4eec\u770b\u4e00\u4e9b\u4f8b\u5b50\u6765\u8bc1\u660eRedlock\u5bf9\u65f6\u5e8f\u5047\u8bbe\u7684\u4f9d\u8d56\u3002 \u5047\u8bbe\u7cfb\u7edf\u6709\u4e94\u4e2aRedis\u8282\u70b9\uff08A\uff0cB\uff0cC\uff0cD\u548cE\uff09\u548c\u4e24\u4e2a\u5ba2\u6237\u7aef\uff081\u548c2\uff09\u3002 \u5982\u679c\u5176\u4e2d\u4e00\u4e2aRedis\u8282\u70b9\u4e0a\u7684\u65f6\u949f\u8df3\u8f6c\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f</p> <ol> <li>\u5ba2\u6237\u7aef1\u83b7\u53d6\u8282\u70b9A\uff0cB\uff0cC\u4e0a\u7684\u9501\u5b9a\u3002\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\uff0c\u65e0\u6cd5\u8bbf\u95eeD\u548cE.</li> <li>\u8282\u70b9C\u4e0a\u7684\u65f6\u949f\u5411\u524d\u8df3\u8dc3\uff0c\u5bfc\u81f4\u9501\u5b9a\u5230\u671f\u3002</li> <li>\u5ba2\u6237\u7aef2\u83b7\u53d6\u8282\u70b9C\uff0cD\uff0cE\u4e0a\u7684\u9501\u5b9a\u3002\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\uff0c\u65e0\u6cd5\u8bbf\u95eeA\u548cB.</li> <li>\u5ba2\u62371\u548c2\u73b0\u5728\u90fd\u8ba4\u4e3a\u4ed6\u4eec\u6301\u6709\u9501\u3002</li> </ol> <p>\u5982\u679cC\u5728\u5c06\u9501\u6301\u4e45\u4fdd\u5b58\u5230\u78c1\u76d8\u4e4b\u524d\u5d29\u6e83\u5e76\u4e14\u7acb\u5373\u91cd\u65b0\u542f\u52a8\uff0c\u5219\u53ef\u80fd\u53d1\u751f\u7c7b\u4f3c\u7684\u95ee\u9898\u3002 \u51fa\u4e8e\u8fd9\u4e2a\u539f\u56e0\uff0cRedlock\u6587\u6863\u5efa\u8bae\u81f3\u5c11\u5ef6\u8fdf\u5d29\u6e83\u8282\u70b9\u7684\u91cd\u542f\uff0c\u4ee5\u83b7\u5f97\u6700\u957f\u5bff\u547d\u9501\u7684\u751f\u5b58\u65f6\u95f4\u3002 \u4f46\u662f\u8fd9\u79cd\u91cd\u542f\u5ef6\u8fdf\u518d\u6b21\u4f9d\u8d56\u4e8e\u5408\u7406\u51c6\u786e\u7684\u65f6\u95f4\u6d4b\u91cf\uff0c\u5e76\u4e14\u5982\u679c\u65f6\u949f\u8df3\u8dc3\u5219\u4f1a\u5931\u8d25\u3002</p> <p>\u597d\u5427\uff0c\u4e5f\u8bb8\u4f60\u8ba4\u4e3a\u65f6\u949f\u8df3\u8f6c\u662f\u4e0d\u73b0\u5b9e\u7684\uff0c\u56e0\u4e3a\u4f60\u975e\u5e38\u6709\u4fe1\u5fc3\u6b63\u786e\u914d\u7f6eNTP\u53ea\u80fd\u8f6c\u6362\u65f6\u949f\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8ba9\u6211\u4eec\u770b\u4e00\u4e2a\u8fdb\u7a0b\u6682\u505c\u5982\u4f55\u5bfc\u81f4\u7b97\u6cd5\u5931\u8d25\u7684\u793a\u4f8b\uff1a</p> <ol> <li>\u5ba2\u6237\u7aef1\u8bf7\u6c42\u9501\u5b9a\u8282\u70b9A\uff0cB\uff0cC\uff0cD\uff0cE\u3002</li> <li>\u867d\u7136\u5bf9\u5ba2\u6237\u7aef1\u7684\u54cd\u5e94\u6b63\u5728\u8fdb\u884c\u4e2d\uff0c\u4f46\u5ba2\u6237\u7aef1\u8fdb\u5165\u4e86<code>STW</code>\u7684GC\u3002</li> <li>\u9501\u5b9a\u5728\u6240\u6709Redis\u8282\u70b9\u4e0a\u8fc7\u671f\u3002</li> <li>\u5ba2\u6237\u7aef2\u83b7\u53d6\u8282\u70b9A\uff0cB\uff0cC\uff0cD\uff0cE\u4e0a\u7684\u9501\u3002</li> <li>\u5ba2\u6237\u7aef1\u5b8c\u6210GC\uff0c\u5e76\u4eceRedis\u8282\u70b9\u63a5\u6536\u54cd\u5e94\uff0c\u6307\u793a\u5b83\u5df2\u6210\u529f\u83b7\u53d6\u9501\uff08\u5b83\u4eec\u5728\u8fdb\u7a0b\u6682\u505c\u65f6\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef1\u7684\u5185\u6838\u7f51\u7edc\u7f13\u51b2\u533a\u4e2d\uff09\u3002</li> <li>\u5ba2\u62371\u548c2\u73b0\u5728\u90fd\u8ba4\u4e3a\u4ed6\u4eec\u6301\u6709\u9501\u3002</li> </ol> <p>\u8bf7\u6ce8\u610f\uff0c\u5373\u4f7fRedis\u662f\u7528C\u8bed\u8a00\u7f16\u5199\u7684\uff0c\u56e0\u6b64\u6ca1\u6709GC\uff0c\u4f46\u8fd9\u5bf9\u6211\u4eec\u6ca1\u6709\u5e2e\u52a9\uff1a\u5ba2\u6237\u7aef\u53ef\u80fd\u9047\u5230GC\u6682\u505c\u7684\u4efb\u4f55\u7cfb\u7edf\u90fd\u5b58\u5728\u6b64\u95ee\u9898\u3002 \u60a8\u53ea\u80fd\u5728\u5ba2\u6237\u7aef2\u83b7\u53d6\u9501\u5b9a\u540e\u963b\u6b62\u5ba2\u6237\u7aef1\u5728\u9501\u5b9a\u4e0b\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\uff0c\u4f8b\u5982\u4f7f\u7528\u4e0a\u9762\u7684\u9632\u62a4\u65b9\u6cd5\uff0c\u4ece\u800c\u4f7f\u6b64\u5b89\u5168\u3002</p> <p>\u957f\u7f51\u7edc\u5ef6\u8fdf\u53ef\u4ee5\u4ea7\u751f\u4e0e\u8fdb\u7a0b\u6682\u505c\u76f8\u540c\u7684\u6548\u679c\u3002 \u5b83\u53ef\u80fd\u53d6\u51b3\u4e8e\u60a8\u7684TCP\u7528\u6237\u8d85\u65f6 - \u5982\u679c\u60a8\u4f7f\u8d85\u65f6\u663e\u7740\u77ed\u4e8eRedis TTL\uff0c\u53ef\u80fd\u4f1a\u5ffd\u7565\u5ef6\u8fdf\u7684\u7f51\u7edc\u6570\u636e\u5305\uff0c\u4f46\u6211\u4eec\u5fc5\u987b\u8be6\u7ec6\u67e5\u770bTCP\u5b9e\u73b0\u4ee5\u786e\u4fdd\u3002 \u6b64\u5916\uff0c\u968f\u7740\u8d85\u65f6\uff0c\u6211\u4eec\u53c8\u56de\u5230\u4e86\u65f6\u95f4\u6d4b\u91cf\u7684\u51c6\u786e\u6027\uff01</p>"},{"location":"2019-06-23-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/#redlock_1","title":"Redlock\u7684\u540c\u6b65\u5047\u8bbe","text":"<p>\u8fd9\u4e9b\u793a\u4f8b\u663e\u793a\u53ea\u6709\u5728\u60a8\u91c7\u7528\u540c\u6b65\u7cfb\u7edf\u6a21\u578b\u65f6Redlock\u624d\u80fd\u6b63\u5e38\u5de5\u4f5c - \u5373\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\u7684\u7cfb\u7edf\uff1a</p> <ul> <li>\u6709\u9650\u7684\u7f51\u7edc\u5ef6\u8fdf\uff08\u60a8\u53ef\u4ee5\u4fdd\u8bc1\u6570\u636e\u5305\u603b\u662f\u5728\u4e00\u4e9b\u4fdd\u8bc1\u7684\u6700\u5927\u5ef6\u8fdf\u5185\u5230\u8fbe\uff09\uff0c</li> <li>\u6709\u9650\u7684\u8fc7\u7a0b\u6682\u505c\uff08\u6362\u53e5\u8bdd\u8bf4\uff0c\u786c\u5b9e\u65f6\u7ea6\u675f\uff0c\u901a\u5e38\u53ea\u80fd\u5728\u6c7d\u8f66\u5b89\u5168\u6c14\u56ca\u7cfb\u7edf\u4e2d\u627e\u5230\uff09\uff0c\u4ee5\u53ca</li> <li>\u6709\u9650\u7684\u65f6\u949f\u9519\u8bef\uff08\u4ea4\u53c9\u4f60\u7684\u624b\u6307\u4f60\u6ca1\u6709\u4ece\u574f\u7684NTP\u670d\u52a1\u5668\u5f97\u5230\u4f60\u7684\u65f6\u95f4\uff09\u3002</li> </ul> <p>\u8bf7\u6ce8\u610f\uff0c\u540c\u6b65\u6a21\u578b\u5e76\u4e0d\u610f\u5473\u7740\u5b8c\u5168\u540c\u6b65\u7684\u65f6\u949f\uff1a\u5b83\u610f\u5473\u7740\u60a8\u5047\u8bbe\u5df2\u77e5\u7684\uff0c\u56fa\u5b9a\u7684\u7f51\u7edc\u5ef6\u8fdf\u4e0a\u9650\uff0c\u6682\u505c\u548c\u65f6\u949f\u6f02\u79fb[12]\u3002 Redlock\u5047\u8bbe\u5ef6\u8fdf\uff0c\u6682\u505c\u548c\u6f02\u79fb\u76f8\u5bf9\u4e8e\u9501\u7684\u751f\u5b58\u65f6\u95f4\u90fd\u5f88\u5c0f; \u5982\u679c\u65f6\u95f4\u95ee\u9898\u53d8\u5f97\u4e0e\u751f\u5b58\u65f6\u95f4\u4e00\u6837\u5927\uff0c\u5219\u7b97\u6cd5\u5931\u8d25\u3002</p> <p>\u5728\u6027\u80fd\u76f8\u5f53\u826f\u597d\u7684\u6570\u636e\u4e2d\u5fc3\u73af\u5883\u4e2d\uff0c\u65f6\u5e8f\u5047\u8bbe\u5c06\u5728\u5927\u591a\u6570\u65f6\u95f4\u5185\u5f97\u5230\u6ee1\u8db3 - \u8fd9\u88ab\u79f0\u4e3a\u90e8\u5206\u540c\u6b65\u7cfb\u7edf[12]\u3002 \u4f46\u8fd9\u8fd8\u591f\u597d\u5417\uff1f \u4e00\u65e6\u8fd9\u4e9b\u65f6\u95f4\u5047\u8bbe\u88ab\u6253\u7834\uff0cRedlock\u53ef\u80fd\u4f1a\u8fdd\u53cd\u5176\u5b89\u5168\u5c5e\u6027\uff0c\u4f8b\u5982\uff0c \u5728\u53e6\u4e00\u4e2a\u5ba2\u6237\u5230\u671f\u4e4b\u524d\u5411\u4e00\u4e2a\u5ba2\u6237\u6388\u4e88\u79df\u7ea6\u3002 \u5982\u679c\u4f60\u4f9d\u8d56\u4e8e\u9501\u5b9a\u7684\u6b63\u786e\u6027\uff0c\u201c\u5927\u90e8\u5206\u65f6\u95f4\u201d\u662f\u4e0d\u591f\u7684 - \u4f60\u9700\u8981\u5b83<code>\u59cb\u7ec8</code>\u662f\u6b63\u786e\u7684\u3002</p> <p>\u6709\u5927\u91cf\u8bc1\u636e\u8868\u660e\uff0c\u5bf9\u4e8e\u5927\u591a\u6570\u5b9e\u9645\u7cfb\u7edf\u73af\u5883\uff0c\u5047\u8bbe\u540c\u6b65\u7cfb\u7edf\u6a21\u578b\u662f\u4e0d\u5b89\u5168\u7684[7,8]\u3002 \u4f7f\u752890\u79d2\u7684\u6570\u636e\u5305\u5ef6\u8fdf\u63d0\u9192\u81ea\u5df1GitHub\u4e8b\u4ef6\u3002 Redlock\u4e0d\u592a\u53ef\u80fd\u5728Jepsen\u6d4b\u8bd5\u4e2d\u5b58\u6d3b\u4e0b\u6765\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\uff0c\u4e3a\u90e8\u5206\u540c\u6b65\u7cfb\u7edf\u6a21\u578b\uff08\u6216\u5177\u6709\u6545\u969c\u68c0\u6d4b\u5668\u7684\u5f02\u6b65\u6a21\u578b\uff09\u8bbe\u8ba1\u7684\u4e00\u81f4\u6027\u7b97\u6cd5\u5b9e\u9645\u4e0a\u6709\u673a\u4f1a\u5de5\u4f5c\u3002 Raft\uff0cViewstamped Replication\uff0cZab\u548cPaxos\u90fd\u5c5e\u4e8e\u8fd9\u4e00\u7c7b\u3002 \u8fd9\u6837\u7684\u7b97\u6cd5\u5fc5\u987b\u653e\u5f03\u6240\u6709\u65f6\u5e8f\u5047\u8bbe\u3002 \u8fd9\u5f88\u96be\uff1a\u5047\u8bbe\u7f51\u7edc\uff0c\u6d41\u7a0b\u548c\u65f6\u949f\u6bd4\u5b9e\u9645\u66f4\u53ef\u9760\uff0c\u8fd9\u662f\u5f88\u8bf1\u4eba\u7684\u3002 \u4f46\u662f\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u6df7\u4e71\u73b0\u5b9e\u4e2d\uff0c\u4f60\u5fc5\u987b\u975e\u5e38\u5c0f\u5fc3\u4f60\u7684\u5047\u8bbe\u3002</p>"},{"location":"2019-06-23-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/#_5","title":"\u603b\u7ed3","text":"<p>\u6211\u8ba4\u4e3aRedlock\u7b97\u6cd5\u662f\u4e00\u4e2a\u7cdf\u7cd5\u7684\u9009\u62e9\uff0c\u56e0\u4e3a\u5b83\u201c\u65e2\u4e0d\u662f\u9c7c\u4e5f\u4e0d\u662f\u9e21\u201d\uff1a\u5b83\u5bf9\u4e8e\u6548\u7387\u4f18\u5316\u9501\u662f\u4e0d\u5fc5\u8981\u7684\u91cd\u91cf\u7ea7\u548c\u6602\u8d35\u7684\uff0c\u4f46\u662f\u5bf9\u4e8e\u6b63\u786e\u6027\u53d6\u51b3\u4e8e\u9501\u7684\u60c5\u51b5\u5b83\u5e76\u4e0d\u8db3\u591f\u5b89\u5168\u3002</p> <p>\u7279\u522b\u662f\uff0c\u8be5\u7b97\u6cd5\u5bf9\u65f6\u5e8f\u548c\u7cfb\u7edf\u65f6\u949f\u505a\u51fa\u4e86\u5371\u9669\u7684\u5047\u8bbe\uff08\u57fa\u672c\u4e0a\u5047\u8bbe\u4e00\u4e2a\u540c\u6b65\u7cfb\u7edf\u5177\u6709\u6709\u754c\u7f51\u7edc\u5ef6\u8fdf\u548c\u6709\u9650\u7684\u64cd\u4f5c\u6267\u884c\u65f6\u95f4\uff09\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u8fd9\u4e9b\u5047\u8bbe\uff0c\u5b83\u5c31\u8fdd\u53cd\u4e86\u5b89\u5168\u5c5e\u6027\u3002 \u6b64\u5916\uff0c\u5b83\u7f3a\u4e4f\u7528\u4e8e\u751f\u6210\u9632\u62a4\u4ee4\u724c\u7684\u8bbe\u65bd\uff08\u5176\u4fdd\u62a4\u7cfb\u7edf\u514d\u53d7\u7f51\u7edc\u4e2d\u7684\u957f\u65f6\u95f4\u5ef6\u8fdf\u6216\u6682\u505c\u7684\u8fc7\u7a0b\uff09\u3002</p> <p>\u5982\u679c\u60a8\u53ea\u9700\u8981\u5c3d\u529b\u800c\u4e3a\uff08\u4ec5\u4f5c\u4e3a\u6548\u7387\u4f18\u5316\uff0c\u800c\u4e0d\u662f\u6b63\u786e\u6027\uff09\uff0c\u6211\u5efa\u8bae\u575a\u6301\u4f7f\u7528Redis\u7684\u7b80\u5355\u5355\u8282\u70b9\u9501\u5b9a\u7b97\u6cd5\uff08\u6761\u4ef6\u96c6 - \u5982\u679c\u4e0d\u5b58\u5728\u5219\u83b7\u5f97\u9501\u5b9a\uff0c atomic delete-if-value-matches\u4ee5\u91ca\u653e\u9501\u5b9a\uff0c\u5e76\u5728\u60a8\u7684\u4ee3\u7801\u4e2d\u975e\u5e38\u6e05\u695a\u5730\u8bb0\u5f55\u9501\u53ea\u662f\u8fd1\u4f3c\u7684\uff0c\u6709\u65f6\u53ef\u80fd\u4f1a\u5931\u8d25\u3002 \u4e0d\u8981\u8d39\u5fc3\u8bbe\u7f6e\u4e94\u4e2aRedis\u8282\u70b9\u7684\u96c6\u7fa4\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\uff0c\u5982\u679c\u60a8\u9700\u8981\u9501\u5b9a\u6b63\u786e\uff0c\u8bf7\u4e0d\u8981\u4f7f\u7528Redlock\u3002 \u76f8\u53cd\uff0c\u8bf7\u4f7f\u7528\u9002\u5f53\u7684\u5171\u8bc6\u7cfb\u7edf\uff0c\u5982ZooKeeper\uff0c\u53ef\u80fd\u901a\u8fc7\u5b9e\u65bd\u9501\u5b9a\u7684Curator\u914d\u65b9\u4e4b\u4e00\u3002 \uff08\u81f3\u5c11\uff0c\u4f7f\u7528\u5177\u6709\u5408\u7406\u4e8b\u52a1\u4fdd\u8bc1\u7684\u6570\u636e\u5e93\u3002\uff09\u5e76\u4e14\u8bf7\u5728\u9501\u5b9a\u4e0b\u7684\u6240\u6709\u8d44\u6e90\u8bbf\u95ee\u4e0a\u5f3a\u5236\u4f7f\u7528fencing\u4ee4\u724c\u3002</p> <p>\u6b63\u5982\u6211\u5728\u5f00\u59cb\u65f6\u6240\u8bf4\u7684\uff0c\u5982\u679c\u4f60\u6b63\u786e\u4f7f\u7528\u5b83\uff0cRedis\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u5de5\u5177\u3002 \u4ee5\u4e0a\u90fd\u6ca1\u6709\u51cf\u5c11Redis\u7528\u4e8e\u5176\u9884\u671f\u76ee\u7684\u7684\u6709\u7528\u6027\u3002 Salvatore\u591a\u5e74\u6765\u4e00\u76f4\u81f4\u529b\u4e8e\u8be5\u9879\u76ee\uff0c\u5176\u6210\u529f\u5f53\u4e4b\u65e0\u6127\u3002 \u4f46\u662f\u6bcf\u79cd\u5de5\u5177\u90fd\u6709\u5c40\u9650\u6027\uff0c\u4e86\u89e3\u5b83\u4eec\u5e76\u8fdb\u884c\u76f8\u5e94\u7684\u89c4\u5212\u975e\u5e38\u91cd\u8981\u3002</p> <p>\u5982\u679c\u60a8\u60f3\u4e86\u89e3\u66f4\u591a\u4fe1\u606f\uff0c\u6211\u4f1a\u5728\u672c\u4e66\u7684\u7b2c8\u7ae0\u548c\u7b2c9\u7ae0\u4e2d\u66f4\u8be6\u7ec6\u5730\u89e3\u91ca\u8fd9\u4e2a\u4e3b\u9898\uff0c\u73b0\u5728\u53ef\u4ee5\u5728O'Reilly\u7684\u65e9\u671f\u7248\u672c\u4e2d\u627e\u5230\u3002 \uff08\u4e0a\u56fe\u6765\u81ea\u6211\u7684\u4e66\u3002\uff09\u4e3a\u4e86\u5b66\u4e60\u5982\u4f55\u4f7f\u7528ZooKeeper\uff0c\u6211\u63a8\u8350Junqueira\u548cReed\u7684\u4e66[3]\u3002 \u4e3a\u4e86\u66f4\u597d\u5730\u4ecb\u7ecd\u5206\u5e03\u5f0f\u7cfb\u7edf\u7406\u8bba\uff0c\u6211\u63a8\u8350\u4e86Cachin\uff0cGuerraoui\u548cRodrigues\u7684\u6559\u79d1\u4e66[13]\u3002</p> <p>\u611f\u8c22Kyle Kingsbury\uff0cCamille Fournier\uff0cFlavio Junqueira\u548cSalvatore Sanfilippo\u5ba1\u9605\u672c\u6587\u7684\u8349\u7a3f\u3002 \u5f53\u7136\uff0c\u4efb\u4f55\u9519\u8bef\u90fd\u662f\u6211\u7684\u3002</p> <p>2016\u5e742\u67089\u65e5\u66f4\u65b0\uff1aRedlock\u7684\u539f\u4f5c\u8005Salvatore\u53d1\u8868\u4e86\u5bf9\u672c\u6587\u7684\u53cd\u9a73\uff08\u53e6\u89c1HN\u8ba8\u8bba\uff09\u3002 \u4ed6\u63d0\u51fa\u4e86\u4e00\u4e9b\u597d\u7684\u89c2\u70b9\uff0c\u4f46\u6211\u575a\u6301\u6211\u7684\u7ed3\u8bba\u3002 \u5982\u679c\u6211\u6709\u65f6\u95f4\uff0c\u6211\u53ef\u4ee5\u5728\u540e\u7eed\u5e16\u5b50\u4e2d\u8be6\u7ec6\u8bf4\u660e\uff0c\u4f46\u8bf7\u5f62\u6210\u60a8\u81ea\u5df1\u7684\u610f\u89c1 - \u8bf7\u53c2\u8003\u4e0b\u9762\u7684\u53c2\u8003\u8d44\u6599\uff0c\u5176\u4e2d\u8bb8\u591a\u5df2\u83b7\u5f97\u4e25\u683c\u7684\u5b66\u672f\u540c\u884c\u8bc4\u5ba1\uff08\u4e0e\u6211\u4eec\u7684\u4efb\u4f55\u535a\u5ba2\u6587\u7ae0\u4e0d\u540c\uff09\u3002</p>"},{"location":"2019-06-23-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/#_6","title":"\u53c2\u8003","text":"<ol> <li> <p>Cary G Gray and David R Cheriton: \u201cLeases: An Efficient Fault-Tolerant Mechanism for Distributed File Cache Consistency,\u201d at 12th ACM Symposium on Operating Systems Principles (SOSP), December 1989. doi:10.1145/74850.74870</p> </li> <li> <p>Mike Burrows: \u201cThe Chubby lock service for loosely-coupled distributed systems,\u201d at 7th USENIX Symposium on Operating System Design and Implementation (OSDI), November 2006.</p> </li> <li> <p>Flavio P Junqueira and Benjamin Reed: ZooKeeper: Distributed Process Coordination. O\u2019Reilly Media, November 2013. ISBN: 978-1-4493-6130-3</p> </li> <li> <p>Enis S\u00f6ztutar: \u201cHBase and HDFS: Understanding filesystem usage in HBase,\u201d at HBaseCon, June 2013.</p> </li> <li> <p>Todd Lipcon: \u201cAvoiding Full GCs in Apache HBase with MemStore-Local Allocation Buffers: Part 1,\u201d blog.cloudera.com, 24 February 2011.</p> </li> <li> <p>Martin Thompson: \u201cJava Garbage Collection Distilled,\u201d mechanical-sympathy.blogspot.co.uk, 16 July 2013.</p> </li> <li> <p>Peter Bailis and Kyle Kingsbury: \u201cThe Network is Reliable,\u201d ACM Queue, volume 12, number 7, July 2014. doi:10.1145/2639988.2639988</p> </li> <li> <p>Mark Imbriaco: \u201cDowntime last Saturday,\u201d github.com, 26 December 2012.</p> </li> <li> <p>Tushar Deepak Chandra and Sam Toueg: \u201cUnreliable Failure Detectors for Reliable Distributed Systems,\u201d Journal of the ACM, volume 43, number 2, pages 225\u2013267, March 1996. doi:10.1145/226643.226647</p> </li> <li> <p>Michael J Fischer, Nancy Lynch, and Michael S Paterson: \u201cImpossibility of Distributed Consensus with One Faulty Process,\u201d Journal of the ACM, volume 32, number 2, pages 374\u2013382, April 1985. doi:10.1145/3149.214121</p> </li> <li> <p>Maurice P Herlihy: \u201cWait-Free Synchronization,\u201d ACM Transactions on Programming Languages and Systems, volume 13, number 1, pages 124\u2013149, January 1991. doi:10.1145/114005.102808</p> </li> <li> <p>Cynthia Dwork, Nancy Lynch, and Larry Stockmeyer: \u201cConsensus in the Presence of Partial Synchrony,\u201d Journal of the ACM, volume 35, number 2, pages 288\u2013323, April 1988. doi:10.1145/42282.42283</p> </li> <li> <p>Christian Cachin, Rachid Guerraoui, and Lu\u00eds Rodrigues: Introduction to Reliable and Secure Distributed Programming, Second Edition. Springer, February 2011. ISBN: 978-3-642-15259-7, doi:10.1007/978-3-642-15260-3</p> </li> </ol> <p>\u52a0\u5165\u5173\u4e8eHacker News\u7684\u8fd9\u7bc7\u6587\u7ae0\u7684\u8ba8\u8bba\u3002</p>"},{"location":"2019-07-01-%F0%9F%90%9A%E5%88%9D%E8%AF%86%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8/","title":"2019 07 01 \ud83d\udc1a\u521d\u8bc6\u5e03\u9686\u8fc7\u6ee4\u5668","text":"<p>\u7ef4\u57fa\u767e\u79d1\uff1a\u5e03\u9686\u8fc7\u6ee4\u5668\uff08\u82f1\u8bed\uff1aBloom Filter\uff09\u662f1970\u5e74\u7531\u5e03\u9686\u63d0\u51fa\u7684\u3002\u5b83\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u5f88\u957f\u7684\u4e8c\u8fdb\u5236\u5411\u91cf\u548c\u4e00\u7cfb\u5217\u968f\u673a\u6620\u5c04\u51fd\u6570\u3002\u5e03\u9686\u8fc7\u6ee4\u5668\u53ef\u4ee5\u7528\u4e8e\u68c0\u7d22\u4e00\u4e2a\u5143\u7d20\u662f\u5426\u5728\u4e00\u4e2a\u96c6\u5408\u4e2d\u3002\u5b83\u7684\u4f18\u70b9\u662f\u7a7a\u95f4\u6548\u7387\u548c\u67e5\u8be2\u65f6\u95f4\u90fd\u8fdc\u8fdc\u8d85\u8fc7\u4e00\u822c\u7684\u7b97\u6cd5\uff0c\u7f3a\u70b9\u662f\u6709\u4e00\u5b9a\u7684\u8bef\u8bc6\u522b\u7387\u548c\u5220\u9664\u56f0\u96be\u3002</p> <p>\u672c\u6587\u7ffb\u8bd1\u81eaProbabilistic Data structures: Bloom filter</p> <p>\u5982\u679c\u60a8\u6709\u4e00\u4e2a\u73bb\u7483\u4fdd\u62a4\u7684\u4e66\u67b6\uff0c\u8fd9\u5c06\u4fdd\u62a4\u60a8\u7684\u4e66\u7c4d\u514d\u53d7\u7070\u5c18\u548c\u6606\u866b\u7684\u4fb5\u5bb3\uff0c\u4f46\u5728\u60a8\u9700\u8981\u65f6\uff0c\u60a8\u5c06\u82b1\u8d39\u66f4\u591a\u65f6\u95f4\u6765\u9605\u8bfb\u4e66\u7c4d\u3002\u56e0\u4e3a\u4f60\u9996\u5148\u9700\u8981\u6ed1\u52a8\u6216\u6253\u5f00\u73bb\u7483\u7136\u540e\u624d\u80fd\u62ff\u5230\u4e66\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u5982\u679c\u5b83\u662f\u4e00\u4e2a\u5f00\u653e\u7684\u4e66\u67b6\uff0c\u8fd9\u5c06\u4f7f\u60a8\u66f4\u5feb\u5730\u8bbf\u95ee\uff0c\u4f46\u60a8\u5c06\u5931\u53bb\u4fdd\u62a4\u3002\u540c\u6837\uff0c\u5982\u679c\u60a8\u6309\u7167\u5176\u59d3\u540d\u7684\u5b57\u5178\u987a\u5e8f\u7ec4\u7ec7\u56fe\u4e66\uff0c\u5982\u679c\u60a8\u77e5\u9053\u56fe\u4e66\u7684\u540d\u79f0\uff0c\u5219\u53ef\u4ee5\u8f7b\u677e\u641c\u7d22\u56fe\u4e66\u3002\u4f46\u662f\uff0c\u5982\u679c\u4f60\u7684\u4e66\u67b6\u4e0a\u6709\u4e0d\u540c\u5927\u5c0f\u7684\u76d2\u5b50\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u5b83\u4eec\u7684\u5927\u5c0f\u6765\u6574\u7406\u4f60\u7684\u4e66\u7c4d\uff0c\u5b83\u770b\u8d77\u6765\u4e0d\u9519\uff0c\u4f46\u662f\u4f60\u80fd\u8d76\u7d27\u627e\u5230\u4e00\u672c\u4e66\u5417\uff1f\u6211\u4e0d\u8fd9\u4e48\u8ba4\u4e3a\u3002</p> <p>\u6570\u636e\u7ed3\u6784\u548c\u4e66\u67b6\u4e00\u6837\uff0c\u60a8\u53ef\u4ee5\u5728\u5176\u4e2d\u7ec4\u7ec7\u6570\u636e\u3002\u4e0d\u540c\u7684\u6570\u636e\u7ed3\u6784\u5c06\u4e3a\u60a8\u63d0\u4f9b\u4e0d\u540c\u7684\u8bbe\u65bd\u548c\u597d\u5904\u3002\u8981\u6b63\u786e\u4f7f\u7528\u6570\u636e\u7ed3\u6784\u7684\u529f\u80fd\u548c\u53ef\u8bbf\u95ee\u6027\uff0c\u60a8\u9700\u8981\u77e5\u9053\u4f7f\u7528\u6570\u636e\u7ed3\u6784\u7684\u6743\u8861\u3002</p> <p>\u5f53\u4e3b\u6d41\u6570\u636e\u7ed3\u6784\u5982List\uff0cMap\uff0cSet\uff0cTree\u7b49\u7b49\u4e3b\u8981\u7528\u4e8e\u5b9e\u73b0\u5173\u4e8e\u6570\u636e\u662f\u5426\u5b58\u5728\u7684\u67d0\u4e9b\u7ed3\u679c\u65f6\uff0c\u53ef\u80fd\u4f34\u968f\u7740\u5b83\u4eec\u7684\u51fa\u73b0\u6b21\u6570\u7b49\uff0c\u6982\u7387\u6570\u636e\u7ed3\u6784\uff08Probabilistic Data structures\uff09\u5c06\u4e3a\u60a8\u63d0\u4f9b\u5185\u5b58\u6548\u7387\u66f4\u5feb\u7684\u7ed3\u679c\u662f\u63d0\u4f9b<code>\u53ef\u80fd\u7684</code>\u7ed3\u679c\u800c\u4e0d\u662f<code>\u67d0\u4e2a</code>\u7ed3\u679c\u3002\u73b0\u5728\u4f7f\u7528\u8fd9\u6837\u7684\u6570\u636e\u7ed3\u6784\u53ef\u80fd\u770b\u8d77\u6765\u4e0d\u592a\u76f4\u89c2\uff0c\u4f46\u6211\u4f1a\u5728\u672c\u6587\u4e2d\u8bd5\u56fe\u8bf4\u670d\u8fd9\u4e9b\u7c7b\u578b\u7684\u6570\u636e\u7ed3\u6784\u5177\u6709\u7279\u5b9a\u7684\u7528\u4f8b\uff0c\u5e76\u4e14\u60a8\u53ef\u80fd\u4f1a\u53d1\u73b0\u5b83\u4eec\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u5f88\u6709\u7528\u3002</p> <p>\u5728\u8fd9\u7bc7\u6587\u7ae0\u4e2d\uff0c\u6211\u5c06\u8ba8\u8bba\u4e00\u79cd\u79f0\u4e3a\u201c\u5e03\u9686\u8fc7\u6ee4\u5668\u201d\u7684\u6700\u6d41\u884c\u7684\u6982\u7387\u6570\u636e\u7ed3\u6784\u3002</p>"},{"location":"2019-07-01-%F0%9F%90%9A%E5%88%9D%E8%AF%86%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8/#_1","title":"\u5e03\u9686\u8fc7\u6ee4\u5668","text":"<p>\u4f60\u77e5\u9053\u54c8\u5e0c\u8868\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u5417\uff1f\u5728\u7b80\u5355\u6570\u7ec4\u6216\u5217\u8868\u4e2d\u63d2\u5165\u65b0\u6570\u636e\u65f6\uff0c\u5c06\u63d2\u5165\u6b64\u6570\u636e\u7684\u7d22\u5f15\u4e0d\u662f\u4ece\u8981\u63d2\u5165\u7684\u503c\u786e\u5b9a\u7684\u3002\u8fd9\u610f\u5473\u7740'key(index)'\u548c'value(data)'\u4e4b\u95f4\u6ca1\u6709\u76f4\u63a5\u5173\u7cfb\u3002\u56e0\u6b64\uff0c\u5982\u679c\u9700\u8981\u5728\u6570\u7ec4\u4e2d\u641c\u7d22\u503c\uff0c\u5219\u5fc5\u987b\u5728\u6240\u6709\u7d22\u5f15\u4e2d\u8fdb\u884c\u641c\u7d22\u3002\u73b0\u5728\uff0c\u5728\u54c8\u5e0c\u8868\u4e2d\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u6563\u5217<code>\u503c</code>\u6765\u786e\u5b9a<code>\u952e</code>\u6216<code>\u7d22\u5f15</code>\u3002\u7136\u540e\u5c06\u6b64\u503c\u653e\u5728\u5217\u8868\u4e2d\u7684\u8be5\u7d22\u5f15\u4e2d\u3002\u8fd9\u610f\u5473\u7740<code>key</code>\u662f\u6839\u636e<code>value</code>\u786e\u5b9a\u7684\uff0c\u6bcf\u6b21\u4f60\u9700\u8981\u68c0\u67e5\u5217\u8868\u4e2d\u662f\u5426\u5b58\u5728\u8be5\u503c\u65f6\uff0c\u53ea\u9700\u5bf9\u503c\u8fdb\u884c\u6563\u5217\u5e76\u641c\u7d22\u8be5\u952e\u5373\u53ef\u3002\u5b83\u975e\u5e38\u5feb\uff0c\u5e76\u4e14\u9700\u8981\u4ee5<code>\u5927O\u8868\u793a\u6cd5</code>\u8fdb\u884c<code>O(1)</code>\u641c\u7d22\u65f6\u95f4\u3002</p> <p></p> <p>\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u8003\u8651\u4e00\u4e0b\u4f60\u6709\u4e00\u4e2a\u5e9e\u5927\u7684\u5f31\u5bc6\u7801\u5217\u8868\uff0c\u5b83\u5b58\u50a8\u5728\u4e00\u4e9b\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u3002\u7531\u4e8e\u5c3a\u5bf8\u7684\u539f\u56e0\uff0c\u65e0\u6cd5\u5728\u5185\u5b58\u4e2d\u4e00\u6b21\u52a0\u8f7d\u5b83\u4eec\u3002\u6bcf\u6b21\u7528\u6237\u8f93\u5165\u4ed6/\u5979\u7684\u5bc6\u7801\u65f6\uff0c\u4f60\u60f3\u68c0\u67e5\u5b83\u662f\u5426\u662f\u5f31\u5bc6\u7801\u4e4b\u4e00\uff0c\u5982\u679c\u662f\uff0c\u4f60\u60f3\u7ed9\u4ed6/\u5979\u4e00\u4e2a\u8b66\u544a\uff0c\u628a\u5b83\u6539\u6210\u66f4\u5f3a\u7684\u5bc6\u7801\u3002\u4f60\u80fd\u505a\u4ec0\u4e48\uff1f\u7531\u4e8e\u60a8\u5df2\u7ecf\u62e5\u6709\u5f31\u5bc6\u7801\u5217\u8868\uff0c\u60a8\u53ef\u4ee5\u5c06\u5b83\u4eec\u5b58\u50a8\u5728\u54c8\u5e0c\u8868\u6216\u7c7b\u4f3c\u7684\u4e1c\u897f\u4e2d\uff0c\u5e76\u4e14\u6bcf\u6b21\u8981\u5339\u914d\u65f6\uff0c\u5982\u679c\u7ed9\u5b9a\u7684\u5bc6\u7801\u6709\u4efb\u4f55\u5339\u914d\uff0c\u60a8\u53ef\u4ee5\u68c0\u67e5\u5b83\u3002\u5339\u914d\u53ef\u80fd\u5f88\u5feb\uff0c\u4f46\u5728\u78c1\u76d8\u4e0a\u6216\u901a\u8fc7\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684\u7f51\u7edc\u8fdb\u884c\u641c\u7d22\u7684\u6210\u672c\u4f1a\u4f7f\u5176\u53d8\u6162\u3002\u4e0d\u8981\u5fd8\u8bb0\uff0c\u60a8\u9700\u8981\u4e3a\u6bcf\u4e2a\u7528\u6237\u63d0\u4f9b\u7684\u6bcf\u4e2a\u5bc6\u7801\u6267\u884c\u6b64\u64cd\u4f5c\u3002\u6211\u4eec\u5982\u4f55\u964d\u4f4e\u6210\u672c\uff1f</p> <p>\u597d\u5427\uff0cBloom\u8fc7\u6ee4\u5668\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u3002\u600e\u4e48\u6837\uff1f\u5728\u89e3\u91ca\u5e03\u9686\u8fc7\u6ee4\u5668\u7684\u5de5\u4f5c\u539f\u7406\u540e\uff0c\u6211\u5c06\u56de\u7b54\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>\u6839\u636e\u5b9a\u4e49\uff0cBloom\u8fc7\u6ee4\u5668\u53ef\u4ee5\u68c0\u67e5\u503c\u662f\u201c\u53ef\u80fd\u5728\u96c6\u5408\u4e2d\u201d\u8fd8\u662f\u201c\u7edd\u5bf9\u4e0d\u5728\u96c6\u5408\u4e2d\u201d\u3002 \u53ef\u80fd\u548c\u7edd\u5bf9\u4e0d\u4e4b\u95f4\u7684\u7ec6\u5fae\u5dee\u522b\u5728\u8fd9\u91cc\u975e\u5e38\u91cd\u8981\u3002\u8fd9\u4e2a\u201c\u53ef\u80fd\u5728\u96c6\u5408\u4e2d\u201d\u6b63\u662f\u5b83\u88ab\u79f0\u4e3a\u6982\u7387\u7684\u539f\u56e0\u3002\u4f7f\u7528\u667a\u80fd\u8bcd\u8bed\u610f\u5473\u7740\u53ef\u80fd\u5b58\u5728\u8bef\u62a5\uff08false positive\uff09\uff08\u53ef\u80fd\u5b58\u5728\u9519\u8bef\u5730\u8ba4\u4e3a\u8be5\u5143\u7d20\u662f\u9633\u6027\u7684\u60c5\u51b5\uff09\u4f46\u662f\u5047\u9634\u6027\u662f\u4e0d\u53ef\u80fd\u7684\u3002\u4e0d\u8981\u6025\u8e81\uff0c\u6211\u4eec\u5f88\u5feb\u5c31\u4f1a\u89e3\u91ca\u5b83\u7a76\u7adf\u610f\u5473\u7740\u4ec0\u4e48\u3002</p> <p>\u5e03\u9686\u8fc7\u6ee4\u5668\u57fa\u672c\u4e0a\u7531\u957f\u5ea6\u4e3am\u7684\u4f4d\u5411\u91cf\u6216\u4f4d\u5217\u8868\uff08\u4ec5\u5305\u542b0\u62161\u4f4d\u503c\u7684\u5217\u8868\uff09\u7ec4\u6210\uff0c\u6700\u521d\u6240\u6709\u503c\u90fd\u8bbe\u7f6e\u4e3a0\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p> <p>\u8981\u5c06\u9879\u6dfb\u52a0\u5230bloom\u8fc7\u6ee4\u5668\uff0c\u6211\u4eec\u5c06\u5176\u63d0\u4f9b\u7ed9<code>k</code>\u4e2a\u4e0d\u540c\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u5e76\u5728\u7ed3\u679c\u4f4d\u7f6e\u5c06\u8fd9\u4e9b\u4f4d\u8bbe\u7f6e\u4e3a1\u3002\u5982\u60a8\u6240\u89c1\uff0c\u5728\u54c8\u5e0c\u8868\u4e2d\u6211\u4eec\u5c06\u4f7f\u7528\u5355\u4e2a\u54c8\u5e0c\u51fd\u6570\uff0c\u56e0\u6b64\u53ea\u83b7\u5f97\u4e00\u4e2a\u7d22\u5f15\u4f5c\u4e3a\u8f93\u51fa\u3002\u4f46\u662f\u5728<code>\u5e03\u9686\u8fc7\u6ee4\u5668</code>\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u591a\u4e2a\u54c8\u5e0c\u51fd\u6570\uff0c\u8fd9\u5c06\u4e3a\u6211\u4eec\u63d0\u4f9b\u591a\u4e2a\u7d22\u5f15\u3002</p> <p></p> <p>\u6b63\u5982\u60a8\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\u6240\u770b\u5230\u7684\uff0c\u5bf9\u4e8e\u7ed9\u5b9a\u7684\u8f93\u5165'geeks'\uff0c\u6211\u4eec\u76843\u4e2a\u6563\u5217\u51fd\u6570\u5c06\u7ed9\u51fa3\u4e2a\u4e0d\u540c\u7684\u8f93\u51fa -1,4\u548c7\uff0c\u6211\u4eec\u5df2\u7ecf\u6807\u8bb0\u4e86\u5b83\u4eec\u3002</p> <p></p> <p>\u5bf9\u4e8e\u53e6\u4e00\u4e2a\u8f93\u5165'nerd'\uff0c\u54c8\u5e0c\u51fd\u6570\u7ed9\u51fa\u4e863,4\u548c5.\u60a8\u53ef\u80fd\u5df2\u7ecf\u6ce8\u610f\u5230\u7d22\u5f15'4'\u5df2\u7ecf\u88ab\u5148\u524d\u7684'geeks'\u8f93\u5165\u6807\u8bb0\u3002\u575a\u6301\u4f60\u7684\u60f3\u6cd5\uff0c\u8fd9\u4e00\u70b9\u5f88\u6709\u8da3\uff0c\u6211\u4eec\u5f88\u5feb\u5c31\u4f1a\u8ba8\u8bba\u5b83\u3002</p> <p>\u6211\u4eec\u5df2\u7ecf\u7528\u4e24\u4e2a\u8f93\u5165\u586b\u5145\u4e86\u6211\u4eec\u7684\u4f4d\u5411\u91cf\uff0c\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u68c0\u67e5\u5b83\u5b58\u5728\u7684\u503c\u3002\u6211\u4eec\u600e\u4e48\u505a\uff1f \u7b80\u5355\u3002\u5c31\u50cf\u6211\u4eec\u5728\u6563\u5217\u8868\u4e2d\u5b8c\u6210\u5b83\u4e00\u6837\u3002\u6211\u4eec\u5c06\u4f7f\u7528\u6211\u4eec\u76843\u4e2a\u54c8\u5e0c\u51fd\u6570\u5bf9\u641c\u7d22\u8f93\u5165\u8fdb\u884c\u54c8\u5e0c\u5904\u7406\uff0c\u5e76\u67e5\u770b\u7ed3\u679c\u7d22\u5f15\u4fdd\u6301\u7684\u5185\u5bb9\u3002</p> <p></p> <p>\u56e0\u6b64\uff0c\u641c\u7d22'cat'\uff0c\u6211\u4eec\u7684\u54c8\u5e0c\u51fd\u6570\u8fd9\u6b21\u7ed9\u6211\u4eec1,3\u548c7\u3002\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7d22\u5f15\u90fd\u5df2\u6807\u8bb0\u4e3a1.\u8fd9\u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u8bf4\uff0c\u201c\u4e5f\u8bb8'cat'\u5df2\u7ecf\u63d2\u5165\u6211\u4eec\u7684\u5217\u8868\u4e2d\u201d\u3002\u4f46\u4e8b\u5b9e\u5e76\u975e\u5982\u6b64\u3002\u51fa\u4e86\u4ec0\u4e48\u95ee\u9898\uff1f</p> <p>\u5b9e\u9645\u4e0a\uff0c\u6ca1\u6709\u51fa\u9519\u3002\u95ee\u9898\u662f\uff0c\u8fd9\u662f\u8bef\u62a5\u7684\u60c5\u51b5\u3002\u5e03\u9686\u8fc7\u6ee4\u5668\u544a\u8bc9\u6211\u4eec\u4f3c\u4e4e\u4e4b\u524d\u53ef\u80fd\u63d2\u5165\u4e86'cat'\uff0c\u56e0\u4e3a\u7d22\u5f15\u5e94\u8be5\u5df2\u7ecf\u88ab'cat'\u6807\u8bb0\uff08\u5c3d\u7ba1\u662f\u5176\u4ed6\u4e0d\u540c\u7684\u6570\u636e\uff09\u3002</p> <p>\u90a3\u4e48\uff0c\u5982\u679c\u662f\u8fd9\u6837\u7684\u8bdd\uff0c\u5b83\u6709\u4ec0\u4e48\u7528\u5462\uff1f\u90a3\u4e48\uff0c\u8ba9\u6211\u4eec\u8003\u8651\u4e00\u4e0b'cat'\u662f\u5426\u4f1a\u7ed9\u6211\u4eec\u8f93\u51fa1,6,7\u800c\u4e0d\u662f1,3,7\uff0c\u90a3\u4e48\u4f1a\u53d1\u751f\u4ec0\u4e48\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u57283\u4e2a\u7d22\u5f15\u4e2d\uff0c6\u4e3a'0'\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u6ca1\u6709\u88ab\u4efb\u4f55\u5148\u524d\u7684\u8f93\u5165\u6807\u8bb0\u3002\u8fd9\u610f\u5473\u7740\u5f88\u660e\u663e'\u732b'\u4ece\u672a\u63d2\u5165\u8fc7\uff0c\u5982\u679c\u662f\u7684\u8bdd\uff0c\u90a3\u4e486\u5c31\u6ca1\u6709\u673a\u4f1a\u6210\u4e3a'0'\uff0c\u5bf9\u5417\uff1f\u8fd9\u5c31\u662f\u5982\u679c\u6570\u636e\u4e0d\u5728\u5217\u8868\u4e2d\uff0c\u5e03\u9686\u8fc7\u6ee4\u5668\u53ef\u4ee5\u201c\u80af\u5b9a\u201d\u5730\u544a\u8bc9\u5b83\u3002</p> <p>\u6240\u4ee5\uff0c\u7b80\u800c\u8a00\u4e4b\uff1a</p> <ul> <li>\u5982\u679c\u6211\u4eec\u641c\u7d22\u4e00\u4e2a\u503c\u5e76\u770b\u5230\u8be5\u503c\u7684\u4efb\u4f55\u6563\u5217\u7d22\u5f15\u4e3a'0'\uff0c\u90a3\u4e48\u8be5\u503c\u80af\u5b9a\u4e0d\u5728\u5217\u8868\u4e2d\u3002</li> <li>\u5982\u679c\u6240\u6709\u6563\u5217\u7d22\u5f15\u90fd\u4e3a\u201c1\u201d\uff0c\u5219\u201c\u53ef\u80fd\u201d\u641c\u7d22\u7684\u503c\u5728\u5217\u8868\u4e2d\u3002</li> </ul> <p>\u5b83\u5f00\u59cb\u6709\u610f\u4e49\u5417\uff1f\u6709\u70b9\u53ef\u80fd\u5417\uff1f</p> <p>\u5f88\u597d\uff0c\u73b0\u5728\uff0c\u56de\u5230\u6211\u4eec\u4e4b\u524d\u8c08\u5230\u7684'\u5bc6\u7801'\u793a\u4f8b\u3002\u5982\u679c\u6211\u4eec\u7528\u8fd9\u79cd\u7c7b\u578b\u7684\u5e03\u9686\u8fc7\u6ee4\u5668\u5b9e\u73b0\u6211\u4eec\u7684\u5f31\u5bc6\u7801\u68c0\u67e5\uff0c\u4f60\u53ef\u4ee5\u770b\u5230\uff0c\u6700\u521d\uff0c\u6211\u4eec\u4f1a\u7528\u6211\u4eec\u7684\u5bc6\u7801\u5217\u8868\u6807\u8bb0\u6211\u4eec\u7684\u5e03\u9686\u8fc7\u6ee4\u5668\uff0c\u8fd9\u5c06\u7ed9\u6211\u4eec\u4e00\u4e2a\u4f4d\u5411\u91cf\uff0c\u5176\u4e2d\u4e00\u4e9b\u7d22\u5f15\u6807\u8bb0\u4e3a'1'\u800c\u5176\u4ed6\u7d22\u5f15\u56e0\u4e3a\u5e03\u9686\u8fc7\u6ee4\u5668\u7684\u5927\u5c0f\u4e0d\u4f1a\u5f88\u5927\u5e76\u4e14\u662f\u56fa\u5b9a\u5927\u5c0f\uff0c\u6240\u4ee5\u5982\u679c\u9700\u8981\uff0c\u5b83\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u5b58\u50a8\u5728\u5b58\u50a8\u5668\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u5b58\u50a8\u5728\u5ba2\u6237\u7aef\u3002\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u5e03\u9686\u8fc7\u6ee4\u5668\u975e\u5e38\u8282\u7701\u7a7a\u95f4\u7684\u539f\u56e0\u3002\u5728\u6563\u5217\u8868\u9700\u8981\u57fa\u4e8e\u8f93\u5165\u6570\u636e\u7684\u4efb\u610f\u5927\u5c0f\u7684\u60c5\u51b5\u4e0b\uff0c\u5e03\u9686\u8fc7\u6ee4\u5668\u53ef\u4ee5\u5728\u56fa\u5b9a\u5927\u5c0f\u4e0b\u5f88\u597d\u5730\u5de5\u4f5c\u3002</p> <p>\u56e0\u6b64\uff0c\u6bcf\u6b21\u7528\u6237\u8f93\u5165\u5bc6\u7801\u65f6\uff0c\u6211\u4eec\u90fd\u4f1a\u5c06\u5176\u63d0\u4f9b\u7ed9\u6211\u4eec\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u5e76\u6839\u636e\u6211\u4eec\u7684\u4f4d\u5411\u91cf\u8fdb\u884c\u68c0\u67e5\u3002\u5982\u679c\u5bc6\u7801\u8db3\u591f\u5f3a\uff0c\u5e03\u9686\u8fc7\u6ee4\u5668\u5c06\u5411\u6211\u4eec\u663e\u793a\u5bc6\u7801\u80af\u5b9a\u4e0d\u5728\u201c\u5f31\u5bc6\u7801\u5217\u8868\u201d\u4e2d\uff0c\u6211\u4eec\u4e0d\u5fc5\u518d\u8fdb\u884c\u4efb\u4f55\u67e5\u8be2\u3002\u4f46\u662f\u5982\u679c\u5bc6\u7801\u770b\u8d77\u6765\u5f88\u5f31\u5e76\u4e14\u7ed9\u6211\u4eec\u4e00\u4e2a\u201c\u80af\u5b9a\u7684\u201d\uff08\u53ef\u80fd\u662f\u8bef\u62a5\uff09\u7ed3\u679c\uff0c\u6211\u4eec\u4f1a\u5c06\u5b83\u53d1\u9001\u5230\u6211\u4eec\u7684\u670d\u52a1\u5668\u5e76\u68c0\u67e5\u6211\u4eec\u7684\u5b9e\u9645\u5217\u8868\u4ee5\u786e\u8ba4\u3002</p> <p>\u5982\u60a8\u6240\u89c1\uff0c\u5927\u591a\u6570\u65f6\u5019\u6211\u4eec\u751a\u81f3\u4e0d\u9700\u8981\u5411\u6211\u4eec\u7684\u670d\u52a1\u5668\u53d1\u51fa\u8bf7\u6c42\u6216\u4ece\u78c1\u76d8\u8bfb\u53d6\u4ee5\u68c0\u67e5\u5217\u8868\uff0c\u8fd9\u5c06\u663e\u7740\u63d0\u9ad8\u5e94\u7528\u7a0b\u5e8f\u7684\u901f\u5ea6\u3002\u5982\u679c\u6211\u4eec\u4e0d\u60f3\u5728\u5ba2\u6237\u7aef\u5b58\u50a8\u4f4d\u5411\u91cf\uff0c\u6211\u4eec\u4ecd\u7136\u53ef\u4ee5\u5c06\u5176\u52a0\u8f7d\u5230\u670d\u52a1\u5668\u5185\u5b58\u4e2d\uff0c\u8fd9\u81f3\u5c11\u53ef\u4ee5\u8282\u7701\u4e00\u4e9b\u78c1\u76d8\u67e5\u627e\u65f6\u95f4\u3002\u8fd8\u8981\u8003\u8651\u4e00\u4e0b\uff0c\u5982\u679c\u60a8\u7684\u5e03\u9686\u8fc7\u6ee4\u5668\u8bef\u62a5\u7387\u4e3a1\uff05\uff08\u6211\u4eec\u7a0d\u540e\u4f1a\u8be6\u7ec6\u8ba8\u8bba\u9519\u8bef\u7387\uff09\uff0c\u8fd9\u610f\u5473\u7740\u5728\u670d\u52a1\u5668\u6216\u78c1\u76d8\u7684\u6602\u8d35\u5f80\u8fd4\u4e2d\uff0c\u53ea\u67091\uff05\u7684\u67e5\u8be2\u5c06\u662f\u4ee5\u865a\u5047\u7ed3\u679c\u8fd4\u56de\uff0c\u5176\u4ed699\uff05\u4e0d\u4f1a\u5f92\u52b3\u65e0\u529f\u3002\u4e0d\u9519\u3002</p> <p></p>"},{"location":"2019-07-01-%F0%9F%90%9A%E5%88%9D%E8%AF%86%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8/#_2","title":"\u5e03\u9686\u8fc7\u6ee4\u5668\u64cd\u4f5c","text":"<p>\u57fa\u672c\u5e03\u9686\u8fc7\u6ee4\u5668\u652f\u6301\u4e24\u79cd\u64cd\u4f5c\uff1a\u6d4b\u8bd5\u548c\u6dfb\u52a0\u3002\u6d4b\u8bd5\u7528\u4e8e\u68c0\u67e5\u7ed9\u5b9a\u5143\u7d20\u662f\u5426\u5728\u96c6\u5408\u4e2d\u3002\u6dfb\u52a0\u53ea\u662f\u5411\u96c6\u5408\u6dfb\u52a0\u5143\u7d20\u3002</p> <p>\u73b0\u5728\u95ee\u9898\u6765\u4e86\uff0c\u6839\u636e\u6211\u4eec\u5230\u76ee\u524d\u4e3a\u6b62\u6240\u8ba8\u8bba\u7684\u5185\u5bb9\uff0c\u662f\u5426\u53ef\u4ee5\u4ece\u5e03\u9686\u8fc7\u6ee4\u5668\u4e2d\u5220\u9664\u9879\u76ee\uff1f\u5982\u679c\u662f\uff0c\u90a3\u600e\u4e48\u6837\uff1f</p> <p>\u4f11\u606f2\u5206\u949f\uff0c\u8003\u8651\u4e00\u4e0b\u89e3\u51b3\u65b9\u6848\u3002</p> <p></p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u8981\u4ece\u4e2d\u5220\u9664'geeks'\u3002\u56e0\u6b64\uff0c\u5982\u679c\u6211\u4eec\u4ece\u4f4d\u5411\u91cf\u4e2d\u79fb\u96641,4,7\uff0c\u56e0\u4e3a\u5b83\u4eec\u88ab'geeks'\u6807\u8bb0\uff0c\u5e76\u5c06\u5b83\u4eec\u8f6c\u6362\u4e3a'0'\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f\u60a8\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u770b\u5230\uff0c\u4e0b\u6b21\u5982\u679c\u6211\u4eec\u641c\u7d22'nerd'\uff0c\u56e0\u4e3a\u7d22\u5f15'4'\u5c06\u663e\u793a'0'\uff0c\u5b83\u80af\u5b9a\u4f1a\u544a\u8bc9\u6211\u4eec'nerd'\u4e0d\u5728\u5217\u8868\u4e2d\uff0c\u5c3d\u7ba1\u5b83\u5b9e\u9645\u4e0a\u662f\u3002\u8fd9\u610f\u5473\u7740\u5728\u4e0d\u5f15\u5165\u5047\u9634\u6027\u7684\u60c5\u51b5\u4e0b\u65e0\u6cd5\u79fb\u9664\u3002</p> <p>\u90a3\u4e48\uff0c\u89e3\u51b3\u65b9\u6848\u662f\u4ec0\u4e48\uff1f</p> <p>\u89e3\u51b3\u65b9\u6848\u662f\u6211\u4eec\u4e0d\u80fd\u5728\u8fd9\u4e2a\u7b80\u5355\u7684\u5e03\u9686\u8fc7\u6ee4\u5668\u4e2d\u652f\u6301\u5220\u9664\u64cd\u4f5c\u3002\u4f46\u662f\u5982\u679c\u6211\u4eec\u771f\u7684\u9700\u8981\u5177\u6709\u79fb\u9664\u529f\u80fd\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u79f0\u4e3a<code>\u8ba1\u6570\u5e03\u9686\u8fc7\u6ee4\u5668</code>\u7684\u5e03\u9686\u8fc7\u6ee4\u5668\u7684\u53d8\u4f53\u3002\u8fd9\u4e2a\u60f3\u6cd5\u5f88\u7b80\u5355\u3002\u6211\u4eec\u5c06\u5b58\u50a8\u4e00\u4e2a\u6574\u6570\u503c\uff0c\u800c\u4e0d\u662f\u5b58\u50a8\u5355\u4e2a\u4f4d\u503c\uff0c\u7136\u540e\u6211\u4eec\u7684\u4f4d\u5411\u91cf\u5c06\u662f\u4e00\u4e2a\u6574\u6570\u5411\u91cf\u3002\u8fd9\u5c06\u589e\u52a0\u5c3a\u5bf8\u5e76\u589e\u52a0\u7a7a\u95f4\uff0c\u4e3a\u6211\u4eec\u63d0\u4f9b\u5220\u9664\u529f\u80fd\u3002\u6211\u4eec\u4e0d\u4f1a\u5728\u63d2\u5165\u503c\u65f6\u5c06\u4f4d\u503c\u6807\u8bb0\u4e3a\u201c1\u201d\uff0c\u800c\u662f\u5c06\u6574\u6570\u503c\u9012\u589e1.\u8981\u68c0\u67e5\u5143\u7d20\u662f\u5426\u5b58\u5728\uff0c\u8bf7\u68c0\u67e5\u6563\u5217\u5143\u7d20\u540e\u7684\u76f8\u5e94\u7d22\u5f15\u662f\u5426\u5927\u4e8e0\u3002</p> <p>\u5982\u679c\u60a8\u5f88\u96be\u7406\u89e3\u201c\u8ba1\u6570\u5e03\u9686\u8fc7\u6ee4\u5668\u201d\u5982\u4f55\u4e3a\u6211\u4eec\u63d0\u4f9b\u201c\u5220\u9664\u201d\u529f\u80fd\uff0c\u6211\u5efa\u8bae\u60a8\u62ff\u7b14\u548c\u7eb8\u5f20\u6a21\u62df\u6211\u4eec\u7684\u5e03\u9686\u8fc7\u6ee4\u5668\u4f5c\u4e3a\u8ba1\u6570\u8fc7\u6ee4\u5668\uff0c\u7136\u540e\u5c1d\u8bd5\u5220\u9664\u5b83\u3002\u5e0c\u671b\u4f60\u80fd\u8f7b\u677e\u641e\u5b9a\u3002</p>"},{"location":"2019-07-01-%F0%9F%90%9A%E5%88%9D%E8%AF%86%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8/#_3","title":"\u5e03\u9686\u8fc7\u6ee4\u5668\u5927\u5c0f\u548c\u6563\u5217\u51fd\u6570\u7684\u6570\u91cf","text":"<p>\u60a8\u53ef\u80fd\u5df2\u7ecf\u660e\u767d\uff0c\u5982\u679c\u5e03\u9686\u8fc7\u6ee4\u5668\u7684\u5927\u5c0f\u592a\u5c0f\uff0c\u5f88\u5feb\u5c31\u4f1a\u5c06\u6240\u6709\u4f4d\u5b57\u6bb5\u53d8\u4e3a\u201c1\u201d\uff0c\u7136\u540e\u6211\u4eec\u7684\u5e03\u9686\u8fc7\u6ee4\u5668\u5c06\u4e3a\u6bcf\u4e2a\u8f93\u5165\u8fd4\u56de\u201c\u8bef\u62a5\u201d\u3002\u56e0\u6b64\uff0c\u5e03\u9686\u8fc7\u6ee4\u5668\u7684\u5927\u5c0f\u662f\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u51b3\u5b9a\u3002\u8f83\u5927\u7684\u8fc7\u6ee4\u5668\u5c06\u5177\u6709\u8f83\u5c11\u7684\u8bef\u62a5\uff0c\u5e76\u4e14\u8f83\u5c0f\u7684\u4e00\u4e2a\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u201c\u8bef\u62a5\u8bef\u5dee\u7387\u201d\u8c03\u6574\u6211\u4eec\u7684\u5e03\u9686\u8fc7\u6ee4\u5668\u4ee5\u786e\u5b9a\u6211\u4eec\u9700\u8981\u591a\u5c11\u7cbe\u786e\u5ea6\u3002 \u53e6\u4e00\u4e2a\u91cd\u8981\u53c2\u6570\u662f\u201c\u6211\u4eec\u5c06\u4f7f\u7528\u591a\u5c11\u54c8\u5e0c\u51fd\u6570\u201d\u3002\u6211\u4eec\u4f7f\u7528\u7684\u54c8\u5e0c\u51fd\u6570\u8d8a\u591a\uff0c\u5e03\u9686\u8fc7\u6ee4\u5668\u5c31\u8d8a\u6162\uff0c\u586b\u5145\u8d8a\u5feb\u3002\u4f46\u662f\uff0c\u5982\u679c\u6211\u4eec\u7684\u4eba\u6570\u592a\u5c11\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u906d\u53d7\u592a\u591a\u8bef\u62a5\u3002</p> <p></p> <p>\u4ece\u4e0a\u56fe\u53ef\u4ee5\u770b\u51fa\uff0c\u589e\u52a0\u6563\u5217\u51fd\u6570k\u7684\u6570\u91cf\u5c06\u5927\u5927\u964d\u4f4e\u9519\u8bef\u7387p\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u8fc7\u6ee4\u5668\u7684\u5927\u5c0fm\uff0c\u6563\u5217\u51fd\u6570\u7684\u6570\u91cfk\u548c\u63d2\u5165\u7684\u5143\u7d20\u6570n\u6765\u8ba1\u7b97\u8bef\u5dee\u7387p\uff0c\u516c\u5f0f\u5982\u4e0b\uff1a</p> <p></p> <p>\u4f5c\u4e3aBloom\u8fc7\u6ee4\u5668\u7684\u5143\u7d20\u6570\u91cf\u548c\u5927\u5c0f\u7684\u51fd\u6570\u7684\u8bef\u62a5\u6982\u7387\u3002\u5df2\u5047\u8bbe<code>k=(m/n)ln2</code>\uff1a</p> <p></p> <p>\u53e6\u5916\u4e00\u70b9\u6211\u8fd8\u9700\u8981\u5728\u8fd9\u91cc\u63d0\u4e00\u4e0b\u3002\u7531\u4e8e\u4f7f\u7528bloom\u8fc7\u6ee4\u5668\u7684\u552f\u4e00\u76ee\u7684\u662f\u641c\u7d22\u901f\u5ea6\u66f4\u5feb\uff0c\u6211\u4eec\u4e0d\u80fd\u4f7f\u7528\u6162\u901f\u6563\u5217\u51fd\u6570\uff0c\u5bf9\u5427\uff1f\u8bf8\u5982Sha-1\uff0cMD5\u4e4b\u7c7b\u7684\u52a0\u5bc6\u6563\u5217\u51fd\u6570\u5bf9\u4e8e\u5e03\u9686\u8fc7\u6ee4\u5668\u6765\u8bf4\u4e0d\u662f\u4e00\u4e2a\u597d\u9009\u62e9\uff0c\u56e0\u4e3a\u5b83\u4eec\u6709\u70b9\u6162\u3002\u56e0\u6b64\uff0c\u66f4\u5feb\u7684\u6563\u5217\u51fd\u6570\u5b9e\u73b0\u7684\u66f4\u597d\u9009\u62e9\u5c06\u662fmurmur\uff0cfnv\u7cfb\u5217\u6563\u5217\uff0cJenkins\u6563\u5217\u548cHashMix\u3002</p>"},{"location":"2019-07-01-%F0%9F%90%9A%E5%88%9D%E8%AF%86%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8/#_4","title":"\u53c2\u8003","text":"<ul> <li>http://www.sigma.me/2011/09/13/hash-and-bloom-filter.html</li> <li>https://guava.dev/releases/22.0/api/docs/com/google/common/hash/BloomFilter.html</li> </ul>"},{"location":"2019-07-02-%F0%9F%97%9C%E5%8E%9F%E5%A7%8B%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%8C%85%E8%A3%85%E7%B1%BB%E5%9E%8B%E5%9C%A8%E8%87%AA%E5%A2%9E%E8%BF%90%E7%AE%97%E4%B8%8A%E7%9A%84%E5%8C%BA%E5%88%AB/","title":"2019 07 02 \ud83d\udddc\u539f\u59cb\u7c7b\u578b\u4e0e\u5305\u88c5\u7c7b\u578b\u5728\u81ea\u589e\u8fd0\u7b97\u4e0a\u7684\u533a\u522b","text":"<p>\u5728\u7f16\u7801\u65f6\uff0c\u4e3a\u4e86\u5b9e\u73b0\u8ba1\u6570\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u5728for\u5faa\u73af\u4e2d\u5bf9<code>\u539f\u59cb\u7c7b\u578b</code>\u6216\u8005<code>\u5305\u88c5\u7c7b\u578b</code>\u7684\u503c\uff08\u5bf9\u4e8e\u5305\u88c5\u7c7b\u578b\u662f<code>\u5b9e\u4f8b</code>\uff09\u8fdb\u884c\u81ea\u589e\uff0c\u90a3\u4e48\u5b83\u4eec\u4e24\u79cd\u5199\u6cd5\u7684\u533a\u522b\u5982\u4f55\uff1f\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u5982\u4e0b\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>private static void primitive() {\nint i = 0;\ni++;\nSystem.out.println(i);\n}\n\nprivate static void wrapper() {\nInteger i = 0;\ni++;\nSystem.out.println(i);\n}\n</code></pre> <p>\u622a\u56fe\u81ea\u5b57\u8282\u7801\u67e5\u770b\u5de5\u5177jclasslib</p> <p><code>primitive</code>\u65b9\u6cd5\uff1a</p> <p></p> <p><code>wrapper</code>\u65b9\u6cd5\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5305\u88c5\u7c7b\u578b\u7684\u81ea\u589e\u6bd4\u539f\u59cb\u7c7b\u578b\u590d\u6742\u5f97\u591a\uff0c\u5e94\u5c3d\u91cf\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\u3002</p>"},{"location":"2019-07-20-%F0%9F%94%8D%E5%A6%82%E4%BD%95%E6%AF%94%E8%BE%83%E4%B8%A4%E4%B8%AACollection%E5%90%AB%E6%9C%89%E7%9B%B8%E5%90%8C%E7%9A%84%E5%85%83%E7%B4%A0%E2%80%94%E2%80%94%E6%9D%A5%E8%87%AAApache%20Commons%20Collections%E7%9A%84%E5%AE%9E%E7%8E%B0/","title":"2019 07 20 \ud83d\udd0d\u5982\u4f55\u6bd4\u8f83\u4e24\u4e2aCollection\u542b\u6709\u76f8\u540c\u7684\u5143\u7d20\u2014\u2014\u6765\u81eaApache Commons Collections\u7684\u5b9e\u73b0","text":"<p>\u60a8\u53ef\u4ee5\u5728org.apache.commons.collections4.CollectionUtils\u67e5\u770b\u6e90\u4ee3\u7801\u3002</p> <p><code>Apache Commons Collections</code>\u4e2d\u7684<code>CollectionUtils#isEqualCollection(java.util.Collection&lt;?&gt;, java.util.Collection&lt;?&gt;)</code>\u65b9\u6cd5\uff08\u53ca\u5176\u91cd\u8f7d\uff09\uff0c\u63d0\u4f9b\u4e86\u6bd4\u8f83\u4e24\u4e2aCollection\u542b\u6709\u76f8\u540c\u7684\u5143\u7d20\u7684\u5b9e\u73b0\uff0c\u5176\u6e90\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>/**\n * Returns {@code true} iff the given {@link Collection}s contain\n * exactly the same elements with exactly the same cardinalities.\n * &lt;p&gt;\n * That is, iff the cardinality of &lt;i&gt;e&lt;/i&gt; in &lt;i&gt;a&lt;/i&gt; is\n * equal to the cardinality of &lt;i&gt;e&lt;/i&gt; in &lt;i&gt;b&lt;/i&gt;,\n * for each element &lt;i&gt;e&lt;/i&gt; in &lt;i&gt;a&lt;/i&gt; or &lt;i&gt;b&lt;/i&gt;.\n * &lt;/p&gt;\n *\n * @param a  the first collection, must not be null\n * @param b  the second collection, must not be null\n * @return &lt;code&gt;true&lt;/code&gt; iff the collections contain the same elements with the same cardinalities.\n */\npublic static boolean isEqualCollection(final Collection&lt;?&gt; a, final Collection&lt;?&gt; b) {\nif(a.size() != b.size()) {\nreturn false;\n}\nfinal CardinalityHelper&lt;Object&gt; helper = new CardinalityHelper&lt;&gt;(a, b);\nif(helper.cardinalityA.size() != helper.cardinalityB.size()) {\nreturn false;\n}\nfor( final Object obj : helper.cardinalityA.keySet()) {\nif(helper.freqA(obj) != helper.freqB(obj)) {\nreturn false;\n}\n}\nreturn true;\n}\n</code></pre> <p>\u5728\u6bd4\u8f83\u5927\u5c0f\u4e4b\u540e\uff0c\u4ee5\u4e24\u4e2a\u96c6\u5408\u5b9e\u4f8b\u4e3a\u5165\u53c2\uff0c\u521b\u5efa\u4e86\u4e00\u4e2a<code>CardinalityHelper</code>\u5b9e\u4f8b\uff0c\u5176\u6e90\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>/**\n * Helper class to easily access cardinality properties of two collections.\n * @param &lt;O&gt;  the element type\n */\nprivate static class CardinalityHelper&lt;O&gt; {\n\n/** Contains the cardinality for each object in collection A. */\nfinal Map&lt;O, Integer&gt; cardinalityA;\n\n/** Contains the cardinality for each object in collection B. */\nfinal Map&lt;O, Integer&gt; cardinalityB;\n\n/**\n     * Create a new CardinalityHelper for two collections.\n     * @param a  the first collection\n     * @param b  the second collection\n     */\npublic CardinalityHelper(final Iterable&lt;? extends O&gt; a, final Iterable&lt;? extends O&gt; b) {\ncardinalityA = CollectionUtils.getCardinalityMap(a);\ncardinalityB = CollectionUtils.getCardinalityMap(b);\n}\n\n/**\n     * Returns the maximum frequency of an object.\n     * @param obj  the object\n     * @return the maximum frequency of the object\n     */\npublic final int max(final Object obj) {\nreturn Math.max(freqA(obj), freqB(obj));\n}\n\n/**\n     * Returns the minimum frequency of an object.\n     * @param obj  the object\n     * @return the minimum frequency of the object\n     */\npublic final int min(final Object obj) {\nreturn Math.min(freqA(obj), freqB(obj));\n}\n\n/**\n     * Returns the frequency of this object in collection A.\n     * @param obj  the object\n     * @return the frequency of the object in collection A\n     */\npublic int freqA(final Object obj) {\nreturn getFreq(obj, cardinalityA);\n}\n\n/**\n     * Returns the frequency of this object in collection B.\n     * @param obj  the object\n     * @return the frequency of the object in collection B\n     */\npublic int freqB(final Object obj) {\nreturn getFreq(obj, cardinalityB);\n}\n\nprivate int getFreq(final Object obj, final Map&lt;?, Integer&gt; freqMap) {\nfinal Integer count = freqMap.get(obj);\nif (count != null) {\nreturn count.intValue();\n}\nreturn 0;\n}\n}\n</code></pre> <p>\u5176\u6784\u9020\u65b9\u6cd5\u5185\uff0c\u8c03\u7528<code>org.apache.commons.collections4.CollectionUtils#getCardinalityMap</code>\uff0c\u521b\u5efa\u4e86\u4e24\u4e2a\u96c6\u5408\u7684\u57fa\u6570\u6620\u5c04\uff0c\u5176\u6e90\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>/**\n * Returns a {@link Map} mapping each unique element in the given\n * {@link Collection} to an {@link Integer} representing the number\n * of occurrences of that element in the {@link Collection}.\n * &lt;p&gt;\n * Only those elements present in the collection will appear as\n * keys in the map.\n * &lt;/p&gt;\n *\n * @param &lt;O&gt;  the type of object in the returned {@link Map}. This is a super type of &amp;lt;I&amp;gt;.\n * @param coll  the collection to get the cardinality map for, must not be null\n * @return the populated cardinality map\n */\npublic static &lt;O&gt; Map&lt;O, Integer&gt; getCardinalityMap(final Iterable&lt;? extends O&gt; coll) {\nfinal Map&lt;O, Integer&gt; count = new HashMap&lt;&gt;();\nfor (final O obj : coll) {\nfinal Integer c = count.get(obj);\nif (c == null) {\ncount.put(obj, Integer.valueOf(1));\n} else {\ncount.put(obj, Integer.valueOf(c.intValue() + 1));\n}\n}\nreturn count;\n}\n</code></pre> <p>\u7136\u540e\uff0c\u904d\u5386\u67d0\u4e2a\u96c6\u5408\u57fa\u6570\u6620\u5c04\u7684\u952e\u96c6\u5408\uff0c\u6bd4\u8f83\u5176\u57fa\u6570\u662f\u5426\u4e0e\u53e6\u4e00\u4e2a\u96c6\u5408\u4e2d\u76f8\u540c\uff1b\u82e5\u5b58\u5728\u67d0\u4e2a\u952e\u4e0d\u540c\uff0c\u5219\u5224\u5b9a\u4e24\u4e2a\u96c6\u5408\u4e0d\u542b\u6709\u76f8\u540c\u7684\u5143\u7d20\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/","title":"2019 09 01 \ud83c\udf6b\uff08\u8bd1\uff09Java\u5185\u5b58\u6a21\u578b\u8bed\u4e49\u5b66","text":"<p>\u7ffb\u8bd1\u81eaJava Memory Model Pragmatics (transcript)</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#_1","title":"\u524d\u8a00","text":"<p>Java\u5185\u5b58\u6a21\u578b\uff08Java Memory Model\uff0c\u4ee5\u540e\u7b80\u79f0<code>JMM</code>\uff09\u662fJava\u89c4\u8303\u4e2d\u6700\u590d\u6742\u7684\u90e8\u5206\uff0c\u81f3\u5c11\u5fc5\u987b\u7531\u7a0b\u5e8f\u5e93\u548c\u8fd0\u884c\u65f6\u5f00\u53d1\u4eba\u5458\u7406\u89e3\u3002\u4e0d\u5e78\u7684\u662f\uff0c\u5b83\u7684\u63aa\u8f9e\u662f\u8fd9\u6837\u7684\u6666\u6da9\uff0c\u4ee5\u81f3\u4e8e\u5b83\u9700\u8981\u4e00\u4e9b\u8d44\u6df1\u4eba\u58eb\u4e3a\u5f7c\u6b64\u7834\u8bd1\u5b83\u3002\u5f53\u7136\uff0c\u5927\u591a\u6570\u5f00\u53d1\u4eba\u5458\u5e76\u6ca1\u6709\u6309\u7167\u89c4\u5b9a\u4f7f\u7528JMM\u89c4\u5219\uff0c\u800c\u662f\u6839\u636e\u89c4\u5219\u5236\u5b9a\u4e00\u4e9b\u7ed3\u6784\uff0c\u6216\u8005\u66f4\u7cdf\u7cd5\u7684\u662f\uff0c\u76f2\u76ee\u5730\u590d\u5236\u9ad8\u7ea7\u5f00\u53d1\u4eba\u5458\u7684\u7ed3\u6784\u800c\u4e0d\u4e86\u89e3\u5176\u9002\u7528\u6027\u7684\u9650\u5236\u3002\u5982\u679c\u4f60\u662f\u4e00\u4e2a\u6ca1\u6709\u8fdb\u5165\u6838\u5fc3\u5e76\u53d1\u7684\u666e\u901a\u4eba\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u8fd9\u7bc7\u6587\u7ae0\uff0c\u9605\u8bfb\u9ad8\u7ea7\u4e66\u7c4d\uff0c\u5982\u201cJava Concurrency in Practice\u201d\u3002\u5982\u679c\u60a8\u662f\u5bf9\u6240\u6709\u8fd9\u4e9b\u5de5\u4f5c\u611f\u5174\u8da3\u7684\u9ad8\u7ea7\u4eba\u5458\u4e4b\u4e00\uff0c\u8bf7\u7ee7\u7eed\u9605\u8bfb\uff01</p> <p>\u8fd9\u7bc7\u6587\u7ae0\u662f\u6211\u4eca\u5e74\u5728\u4e0d\u540c\u4f1a\u8bae\u4e0a\u53d1\u8868\u7684\u201cJava Memory Model Pragmatics\u201d\u6f14\u8bb2\u7684\u8bb0\u5f55\u526f\u672c\uff0c\u4e3b\u8981\u662f\u4fc4\u8bed\u3002\u4e16\u754c\u4e0a\u4f3c\u4e4e\u63d0\u4f9b\u53ef\u4ee5\u5bb9\u7eb3\u8fd9\u4e48\u957f\u65f6\u95f4\u7684\u8ba8\u8bba\u7684\u4f1a\u8bae\u6570\u91cf\u6709\u9650\uff0c\u5e76\u4e14\u9700\u8981\u5728\u4eca\u5e74\u7684JVMLS\u4e0a\u4e3a\u6211\u7684JMM\u7814\u8ba8\u4f1a\u63ed\u9732\u4e00\u4e9b\u80cc\u666f\u9605\u8bfb\uff0c\u6211\u51b3\u5b9a\u5c06\u5176\u8f6c\u5f55\u3002</p> <p>\u6211\u4eec\u5c06\u91cd\u7528\u5f88\u591a\u5e7b\u706f\u7247\uff0c\u5e76\u4e14\u6211\u5c06\u5c1d\u8bd5\u57fa\u4e8e\u5b83\u4eec\u6784\u5efa\u53d9\u8ff0\u3002\u5f53\u5e7b\u706f\u7247\u4e0d\u8a00\u81ea\u660e\u65f6\uff0c\u6709\u65f6\u5019\u6211\u4f1a\u8df3\u8fc7\u6ca1\u6709\u53d9\u8ff0\u7684\u3002\u5e7b\u706f\u7247\u6709\u4fc4\u8bed\u548c\u82f1\u8bed\u7248\u672c\u3002\u4e0b\u9762\u7684\u5e7b\u706f\u7247\u662f\u5149\u6805\u5316(rasterized)\u7684\uff0c\u4f46\u5177\u6709\u5f88\u597d\u7684\u539f\u59cb\u5206\u8fa8\u7387\u3002</p> <p>\u6211\u8981\u611f\u8c22Brian Goetz\uff0cDoug Lea\uff0cDavid Holmes\uff0cSergey Kuksenko\uff0cDmitry Chyuko\uff0cMark Cooper\uff0cC.Scott Andreas\uff0cJoe Kearney\u4ee5\u53ca\u5176\u4ed6\u8bb8\u591a\u4eba\u63d0\u4f9b\u6709\u7528\u7684\u8bc4\u8bba\u548c\u66f4\u6b63\u3002\u5173\u4e8e\u6700\u7ec8\u5b57\u6bb5\u7684\u793a\u4f8b\u90e8\u5206\u5305\u542b\u7531Vladimir Sitnikov\u548cValentin Kovalenko\u89e3\u51b3\u7684\u4fe1\u606f\uff0c\u5e76\u4e14\u662f\u4ed6\u4eec\u5173\u4e8eFinal Fields Semantics\u7684\u66f4\u5927\u8bdd\u9898\u7684\u6458\u5f55\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#_2","title":"\u4ecb\u7ecd","text":"<p>\u5982\u679c\u60a8\u9605\u8bfb\u4efb\u4f55\u8bed\u8a00\u89c4\u8303\uff0c\u60a8\u4f1a\u53d1\u73b0\u5b83\u53ef\u4ee5\u5728\u903b\u8f91\u4e0a\u5212\u5206\u4e3a\u4e24\u4e2a\u76f8\u5173\u4f46\u4e0d\u540c\u7684\u90e8\u5206\u3002\u9996\u5148\uff0c\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u90e8\u5206\u662f<code>\u8bed\u6cd5</code>\uff0c\u5b83\u63cf\u8ff0\u4e86\u5982\u4f55\u7528\u8be5\u8bed\u8a00\u7f16\u5199\u7a0b\u5e8f\u3002\u5176\u6b21\uff0c\u6700\u5927\u7684\u90e8\u5206\u662f<code>\u8bed\u4e49</code>\uff0c\u5b83\u51c6\u786e\u63cf\u8ff0\u4e86\u7279\u5b9a\u8bed\u6cd5\u7ed3\u6784\u7684\u542b\u4e49\u3002\u8bed\u8a00\u89c4\u8303\u901a\u5e38\u901a\u8fc7\u6267\u884c\u7a0b\u5e8f\u7684<code>\u62bd\u8c61\u673a\u5668</code>\u7684\u884c\u4e3a\u6765\u63cf\u8ff0\u8bed\u4e49\uff0c\u56e0\u6b64\u8fd9\u79cd\u8bed\u8a00\u89c4\u8303\u53ea\u662f\u4e00\u4e2a\u62bd\u8c61\u7684\u673a\u5668\u89c4\u8303\u3002</p> <p></p> <p>\u5f53\u60a8\u7684\u8bed\u8a00\u5177\u6709\u5b58\u50a8\uff08\u4ee5\u53d8\u91cf\uff0c\u5806\u5185\u5b58\u7b49\u5f62\u5f0f\uff09\u65f6\uff0c\u62bd\u8c61\u673a\u5668\u4e5f\u5177\u6709\u5b58\u50a8\uff0c\u60a8\u5fc5\u987b\u5b9a\u4e49\u4e00\u7ec4\u6709\u5173\u5b58\u50a8\u884c\u4e3a\u7684\u89c4\u5219\u3002\u8fd9\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684<code>\u5185\u5b58\u6a21\u578b</code>\u3002\u5982\u679c\u60a8\u7684\u8bed\u8a00\u6ca1\u6709\u663e\u5f0f\u5b58\u50a8\uff08\u4f8b\u5982\uff0c\u60a8\u5728\u8c03\u7528\u4e0a\u4e0b\u6587\u4e2d\u4f20\u9012\u6570\u636e\uff09\uff0c\u90a3\u4e48\u60a8\u7684\u5185\u5b58\u6a21\u578b\u975e\u5e38\u7b80\u5355\u3002\u5728\u5b58\u50a8\u7cbe\u901a\u8bed\u8a00\u4e2d\uff0c\u5185\u5b58\u6a21\u578b\u4f3c\u4e4e\u56de\u7b54\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u95ee\u9898\uff1a\u201c<code>\u7279\u5b9a\u8bfb\u53d6\u53ef\u4ee5\u89c2\u5bdf\u5230\u4ec0\u4e48\u503c\uff1f</code>\u201d</p> <p></p> <p>\u5728\u987a\u5e8f\u7a0b\u5e8f\u4e2d\uff0c\u8fd9\u4f3c\u4e4e\u662f\u4e00\u4e2a\u7a7a\u6d1e\u7684\u95ee\u9898\uff1a\u56e0\u4e3a\u4f60\u6709\u987a\u5e8f\u7a0b\u5e8f\uff0c\u6240\u4ee5\u5b58\u50a8\u5230\u5185\u5b58\u4e2d\u7684\u662f\u6309\u7167\u7ed9\u5b9a\u7684\u987a\u5e8f\u8fdb\u884c\u7684\uff0c\u5f88\u660e\u663e\u8bfb\u53d6\u5e94\u8be5\u6309\u987a\u5e8f\u89c2\u5bdf\u6700\u65b0\u7684\u5199\u5165\u3002\u8fd9\u5c31\u662f\u4eba\u4eec\u901a\u5e38\u53ea\u4e3a\u591a\u7ebf\u7a0b\u7a0b\u5e8f\u9047\u5230\u5185\u5b58\u6a21\u578b\u7684\u539f\u56e0\uff0c\u8fd9\u4e2a\u95ee\u9898\u53d8\u5f97\u590d\u6742\u4e86\u3002\u7136\u800c\uff0c\u5373\u4f7f\u5728\u8fde\u7eed\u7684\u60c5\u51b5\u4e0b\uff0c\u8bb0\u5fc6\u6a21\u578b\u4e5f\u5f88\u91cd\u8981\uff08\u5c3d\u7ba1\u5b83\u4eec\u901a\u5e38\u5728<code>\u8bc4\u4f30\u987a\u5e8f</code>\u7684\u6982\u5ff5\u4e2d\u5de7\u5999\u5730\u4f2a\u88c5\uff09\u3002</p> <p></p> <p>\u4f8b\u5982\uff0cC\u7a0b\u5e8f\u4e2d<code>\u672a\u5b9a\u4e49\u884c\u4e3a</code>\u7684\u81ed\u540d\u662d\u7740\u7684\u4f8b\u5b50\uff0c\u5b83\u5728\u5e8f\u5217\u70b9\u4e4b\u95f4\u5305\u542b\u4e00\u4e9b\u589e\u91cf\u3002\u8be5\u7a0b\u5e8f\u53ef\u4ee5\u6ee1\u8db3\u7ed9\u5b9a\u7684\u65ad\u8a00\uff0c\u4f46\u4e5f\u53ef\u4ee5\u4f7f\u5176\u5931\u8d25\uff0c\u6216\u4ee5\u5176\u4ed6\u65b9\u5f0f\u53ec\u5524\u9f3b\u5b50\u6076\u9b54\u3002\u6709\u4eba\u53ef\u80fd\u4f1a\u4e89\u8fa9\u8bf4\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u7ed3\u679c\u53ef\u80fd\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u56e0\u4e3a\u589e\u91cf\u7684\u8bc4\u4f30\u987a\u5e8f\u662f\u4e0d\u540c\u7684\uff0c\u4f46\u5b83\u4e0d\u4f1a\u89e3\u91ca\uff0c\u4f8b\u5982\uff0c 12\u7684\u7ed3\u679c\uff0c\u5f53\u4e24\u4e2a\u589e\u91cf\u90fd\u6ca1\u6709\u770b\u5230\u53e6\u4e00\u4e2a\u7684\u5199\u5165\u503c\u65f6\u3002\u8fd9\u662f\u5185\u5b58\u6a21\u578b\u7684\u5173\u6ce8\u70b9\uff1a\u6bcf\u4e2a\u589e\u91cf\u5e94\u8be5\u770b\u5230\u4ec0\u4e48\u503c\uff08\u5e76\u4e14\u901a\u8fc7\u6269\u5c55\uff0c\u5b83\u5c06\u5b58\u50a8\u4ec0\u4e48\uff09\u3002</p> <p></p> <p>\u65e0\u8bba\u54ea\u79cd\u65b9\u5f0f\uff0c\u5f53\u63d0\u51fa\u5b9e\u73b0\u7279\u5b9a\u8bed\u8a00\u7684\u6311\u6218\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u4e24\u79cd\u65b9\u5f0f\u4e4b\u4e00\uff1a\u89e3\u91ca\u6216\u5c06\u62bd\u8c61\u673a\u5668\u7f16\u8bd1\u5230\u76ee\u6807\u786c\u4ef6\u3002\u65e0\u8bba\u5982\u4f55\uff0c\u89e3\u91ca\u548c\u7f16\u8bd1\u90fd\u901a\u8fc7Futamura Projections\u8fde\u63a5\u3002 \u5b9e\u9645\u5e94\u7528\u662f\u89e3\u91ca\u5668\u548c\u7f16\u8bd1\u5668\u90fd\u8d1f\u8d23\u6a21\u62df\u62bd\u8c61\u673a\u5668\u3002\u7f16\u8bd1\u5668\u901a\u5e38\u88ab\u6307\u8d23\u641e\u7838\u5185\u5b58\u6a21\u578b\u548c\u591a\u7ebf\u7a0b\u7a0b\u5e8f\uff0c\u4f46\u89e3\u91ca\u5668\u4e5f\u4e0d\u80fd\u514d\u75ab\u3002\u672a\u80fd\u5c06\u89e3\u91ca\u5668\u8fd0\u884c\u5230\u62bd\u8c61\u673a\u5668\u89c4\u8303\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5185\u5b58\u6a21\u578b\u8fdd\u89c4\u3002\u6700\u7b80\u5355\u7684\u4f8b\u5b50\uff1a\u5c06\u5b57\u6bb5\u503c\u7f13\u5b58\u5728\u89e3\u91ca\u5668\u4e2d\u7684volatile\u8bfb\u53d6\u4e0a\uff0c\u60a8\u5c31\u5b8c\u6210\u4e86\u3002\u8fd9\u8ba9\u6211\u4eec\u8fdb\u884c\u4e86\u4e00\u6b21\u6709\u8da3\u7684\u6743\u8861\u3002</p> <p></p> <p>\u7f16\u7a0b\u8bed\u8a00\u4ecd\u7136\u9700\u8981\u667a\u80fd\u5f00\u53d1\u4eba\u5458\u7684\u539f\u56e0\u662f\u6ca1\u6709\u8d85\u7ea7\u8ba1\u7b97\u673a\u7f16\u8bd1\u5668\u3002 \u201cHyper\u201d\u5e76\u4e0d\u5938\u5f20\uff1a\u7f16\u8bd1\u5668\u5de5\u7a0b\u4e2d\u7684\u4e00\u4e9b\u95ee\u9898\u662f\u4e0d\u53ef\u5224\u5b9a\u7684\uff0c\u5373\u4f7f<code>\u5728\u7406\u8bba\u4e0a</code>\u4e5f\u662f\u4e0d\u53ef\u89e3\u51b3\u7684\uff0c\u66f4\u4e0d\u7528\u8bf4\u5728\u5b9e\u8df5\u4e2d\u4e86\u3002\u5176\u4ed6\u6709\u8da3\u7684\u95ee\u9898\u5728\u7406\u8bba\u4e0a\u53ef\u884c\uff0c\u4f46\u4e0d\u5b9e\u7528\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u4f7f\u5b9e\u7528\uff08\u4f18\u5316\uff09\u7f16\u8bd1\u5668\u6210\u4e3a\u53ef\u80fd\uff0c\u6211\u4eec\u9700\u8981\u5728\u8bed\u8a00\u4e2d\u9020\u6210\u4e00\u4e9b\u4e0d\u4fbf\u3002\u786c\u4ef6\u4e5f\u662f\u5982\u6b64\uff0c\u56e0\u4e3a\uff08\u81f3\u5c11\u5bf9\u56fe\u7075\u673a\u800c\u8a00\uff09\u5b83\u53ea\u662f<code>\u4e8c\u6c27\u5316\u7845</code>\u4e2d\u7684\u7b97\u6cd5\u3002</p> <p></p> <p>\u4e3a\u4e86\u8be6\u7ec6\u8bf4\u660e\u8fd9\u4e2a\u60f3\u6cd5\uff0c\u5176\u4f59\u7684\u8ba8\u8bba\u7ed3\u6784\u5982\u4e0b\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#access-atomicity","title":"\u7b2c\u4e00\u90e8\u5206 Access Atomicity","text":""},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#_3","title":"\u6211\u4eec\u60f3\u8981\u4ec0\u4e48","text":"<p>\u5728JMM\u4e2d\u6700\u5bb9\u6613\u7406\u89e3\u7684\u662f\u8bbf\u95ee\u539f\u5b50\u6027\u4fdd\u8bc1\u3002\u4e3a\u4e86\u6216\u591a\u6216\u5c11\u5730\u4e25\u683c\u6307\u5b9a\uff0c\u6211\u4eec\u9700\u8981\u5f15\u5165\u4e00\u4e9b\u7b26\u53f7\u3002\u5728\u6b64\u5e7b\u706f\u7247\u7684\u793a\u4f8b\u4e2d\uff0c\u60a8\u53ef\u4ee5\u770b\u5230\u5305\u542b\u4e24\u5217\u7684\u8868\u3002\u8be5\u8868\u793a\u6cd5\u5982\u4e0b\u3002\u6807\u9898\u4e2d\u7684\u6240\u6709\u5185\u5bb9\u90fd\u5df2\u7ecf\u53d1\u751f\uff1a\u6240\u6709\u53d8\u91cf\u90fd\u5df2\u5b9a\u4e49\uff0c\u6240\u6709\u521d\u59cb\u5316\u7684\u5546\u5e97\u90fd\u5df2\u63d0\u4ea4\uff0c\u7b49\u7b49\u3002\u5217\u662f\u4e0d\u540c\u7684\u7ebf\u7a0b\u3002\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c<code>\u7ebf\u7a0b1</code>\u5c06\u4e00\u4e9b\u503c<code>V2</code>\u5b58\u50a8\u5230\u5168\u5c40\u53d8\u91cf<code>t</code>\u4e2d\u3002<code>\u7ebf\u7a0b2</code>\u8bfb\u53d6\u53d8\u91cf\uff0c\u5e76\u65ad\u8a00\u8bfb\u53d6\u503c\u3002\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u8981\u786e\u4fdd\u8bfb\u53d6\u7ebf\u7a0b\u4ec5\u89c2\u5bdf\u5df2\u77e5\u503c\uff0c\u800c\u4e0d\u662f\u4e4b\u95f4\u7684\u67d0\u4e9b\u503c\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#_4","title":"\u6211\u4eec\u6709\u4ec0\u4e48","text":"<p>\u5bf9\u4e8e\u7406\u667a\u7684\u7f16\u7a0b\u8bed\u8a00\u6765\u8bf4\uff0c\u8fd9\u4f3c\u4e4e\u662f\u4e00\u4e2a\u975e\u5e38\u660e\u663e\u7684\u8981\u6c42\uff1a\u4f60\u600e\u4e48\u53ef\u80fd\u8fdd\u53cd\u8fd9\u4e2a\uff0c\u4e3a\u4ec0\u4e48\uff1f\u8fd9\u5c31\u662f\u539f\u56e0\u3002 \u4e3a\u4e86\u5728\u5e76\u53d1\u8bbf\u95ee\u4e0b\u4fdd\u6301<code>\u539f\u5b50\u6027</code>\uff0c\u4f60\u5fc5\u987b\u81f3\u5c11\u8ba9\u673a\u5668\u6307\u4ee4\u4ee5\u7ed9\u5b9a\u5bbd\u5ea6\u7684\u64cd\u4f5c\u6570\u64cd\u4f5c\uff0c\u5426\u5219\u539f\u5b50\u6027\u5728\u6307\u4ee4\u7ea7\u522b\u88ab\u7834\u574f\uff1a\u5982\u679c\u4f60\u9700\u8981\u5c06\u8bbf\u95ee\u5206\u6210\u51e0\u4e2a\u5b50\u8bbf\u95ee\uff0c\u5b83\u4eec\u53ef\u4ee5\u4ea4\u9519\u3002\u4f46\u5373\u4f7f\u4f60\u6709\u6240\u9700\u7684\u5bbd\u5ea6\u6307\u4ee4\uff0c\u5b83\u4eec\u4ecd\u7136\u53ef\u4ee5\u662f\u975e\u539f\u5b50\u7684\uff1a\u4f8b\u5982\uff0c\u5bf9\u4e8ePowerPC\u6765\u8bf4\uff0c2\u5b57\u8282\u548c4\u5b57\u8282\u8bfb\u53d6\u7684\u539f\u5b50\u6027\u4fdd\u8bc1\u662f\u672a\u77e5\u7684\uff08\u5b83\u4eec\u6697\u793a\u662f\u539f\u5b50\u7684\uff09\u3002</p> <p></p> <p>\u4f46\u662f\uff0c\u5927\u591a\u6570\u5e73\u53f0\u90fd\u80fd\u4fdd\u8bc1\u6700\u591a32\u4f4d\u8bbf\u95ee\u7684\u539f\u5b50\u6027\u3002\u8fd9\u5c31\u662f\u6211\u4eec\u5728JMM\u4e2d\u505a\u51fa<code>\u59a5\u534f</code>\u7684\u539f\u56e0\uff0c\u5b83\u653e\u5bbd\u4e8664\u4f4d\u503c\u7684\u539f\u5b50\u6027\u4fdd\u8bc1\u3002\u5f53\u7136\uff0c\u4ecd\u7136\u5b58\u5728\u5bf964\u4f4d\u503c\u5f3a\u5236\u6267\u884c\u539f\u5b50\u6027\u7684\u65b9\u6cd5\uff0c\u4f8b\u5982\uff0c\u901a\u8fc7\u60b2\u89c2\u5730\u83b7\u53d6\u66f4\u65b0\u548c\u8bfb\u53d6\u9501\u5b9a\uff0c\u4f46\u8fd9\u5c06\u4ed8\u51fa\u4ee3\u4ef7\uff0c\u56e0\u6b64\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9003\u751f\u8231\uff1a\u7528\u6237\u5c06volatile\u653e\u5728\u9700\u8981\u539f\u5b50\u6027\u7684\u4f4d\u7f6e\uff0c\u5e76\u4e14VM\u548c\u786c\u4ef6\u534f\u540c\u5de5\u4f5c\u4ee5\u4fdd\u7559\u5b83\uff0c\u65e0\u8bba\u6210\u672c\u662f\u591a\u5c11\u3002</p> <p></p> <p>\u4f46\u662f\uff0c\u5728\u5927\u591a\u6570\u786c\u4ef6\u4e0a\uff0c\u4f7f\u7528\u6240\u9700\u5bbd\u5ea6\u7684\u64cd\u4f5c\u6765\u7ef4\u6301\u539f\u5b50\u6027\u662f\u4e0d\u591f\u7684\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6570\u636e\u8bbf\u95ee\u5bfc\u81f4\u591a\u4e2a\u4e8b\u52a1\u5230\u5185\u5b58\uff0c\u5219\u5373\u4f7f\u6211\u4eec\u6267\u884c\u4e86\u5355\u4e2a\u8bbf\u95ee\u6307\u4ee4\uff0c\u539f\u5b50\u6027\u4e5f\u4f1a\u5173\u95ed\u3002\u4f8b\u5982\uff0c\u5728x86\u4e2d\uff0c\u5982\u679c\u8bfb/\u5199\u8de8\u8d8a\u4e24\u4e2a\u9ad8\u901f\u7f13\u5b58\u884c\uff0c\u5219\u4e0d\u4fdd\u8bc1\u539f\u5b50\u6027\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u4e24\u4e2a\u5185\u5b58\u4e8b\u52a1\u3002\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u901a\u5e38\u53ea\u6709\u5bf9\u9f50\u7684\u8bfb/\u5199\u662f\u539f\u5b50\u7684\uff0c\u8fd9\u8feb\u4f7fVM\u5bf9\u9f50\uff08align\uff09\u6570\u636e\u3002</p> <p>\u5728\u8fd9\u4e2a\u7531JOL\u6253\u5370\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5728\u5bf9\u8c61start\u7684\u504f\u79fb\u91cf16\u5904\u5206\u914d\u4e86\u957f\u5b57\u6bb5\u3002\u4e0e8\u5b57\u8282\u7684\u5bf9\u8c61\u5bf9\u9f50\u76f8\u7ed3\u5408\uff0c\u6211\u4eec\u5177\u6709\u5b8c\u7f8e\u5bf9\u9f50\u7684\u957f\u5ea6\u3002\u73b0\u5728\uff0c\u5982\u679c\u6211\u4eec\u77e5\u9053\u5b83\u4e0d\u662f\u6613\u5931\u6027\u7684\u8bdd\uff0c\u5b83\u5c31\u4e0d\u4f1a\u8fdd\u53cd\u5185\u5b58\u6a21\u578b\uff0c\u5982\u679c\u6211\u4eec\u77e5\u9053\u5b83\u4e0d\u662f\u6613\u5931\u6027\u7684\uff0c\u90a3\u53ea\u80fd\u5728x86\u4e0a\u8fd0\u884c\uff08\u5176\u4ed6\u5e73\u53f0\u5728\u6267\u884c\u9519\u4f4d\u8bbf\u95ee\u65f6\u53ef\u80fd\u4f1a\u975e\u5e38\u4e0d\u540c\u610f\uff09\uff0c\u5e76\u4e14\u53ef\u80fd\u5b58\u5728\u6027\u80fd\u52a3\u52bf\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#test-your-understanding","title":"Test Your Understanding","text":"<p>\u8ba9\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684\u6d4b\u9a8c\u6765\u6d4b\u8bd5\u6211\u4eec\u7684\u7406\u89e3\u3002\u8bbe\u7f6e<code>-1L</code>\u76f8\u5f53\u4e8e\u5c06\u6240\u6709\u4f4d\u8bbe\u7f6e\u4e3a1\u3002 \u7b54\u6848\uff08\u9009\u62e9\u8fc7\u6765\u63ed\u793a\uff09\uff1a\u4e0d\u6d89\u53ca\u4efb\u4f55\u9b54\u6cd5; <code>AtomicLong</code>\u5185\u90e8\u7684\u4e00\u4e2a\u4e0d\u7a33\u5b9a\u7684\u957f\u573a\u4fdd\u8bc1\u4e86\u8fd9\u4e00\u70b9\u3002\u8fd9\u662f\u8bed\u8a00\u89c4\u8303\u6240\u8981\u6c42\u7684\uff0c\u5e76\u4e14\u6b64\u793a\u4f8b\u65e0\u9700\u5bf9VM\u7aef\u7684<code>AtomicLong</code>\u8fdb\u884c\u7279\u6b8a\u5904\u7406\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#ccvalue-types-and-cc","title":"\u503c\u7c7b\u578b\u548cC/C++\uff08Value Types and C/C++\uff09","text":"<p>\u5728Java\u4e2d\uff0c\u6211\u4eec\u201c\u5e78\u8fd0\u201d\u62e5\u6709\u5185\u7f6e\u7c7b\u578b\u7684\u5c0f\u5bbd\u5ea6\u3002\u5728\u63d0\u4f9b\u503c\u7c7b\u578b\u7684\u5176\u4ed6\u8bed\u8a00\u4e2d\uff0c\u7c7b\u578b\u5bbd\u5ea6\u662f\u4efb\u610f\u7684\uff0c\u8fd9\u7ed9\u5185\u5b58\u6a21\u578b\u5e26\u6765\u4e86\u6709\u8da3\u7684\u6311\u6218\u3002</p> <p>\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c<code>C++</code>\u901a\u8fc7\u652f\u6301\u7ed3\u6784\u6765\u9075\u5faaC\u517c\u5bb9\u6027\u3002 <code>C++11</code>\u8fd8\u652f\u6301<code>std::atomic</code>\uff0c\u5b83\u9700\u8981\u6bcf\u4e2a\u666e\u901a\u65e7\u6570\u636e\uff08POD\uff09\u7c7b\u578bT\u7684\u8bbf\u95ee\u539f\u5b50\u6027\u3002\u56e0\u6b64\uff0c\u5982\u679c\u6211\u4eec\u5728<code>C++11</code>\u4e2d\u505a\u8fd9\u6837\u7684\u6280\u5de7\uff0c\u90a3\u4e48\u5b9e\u73b0\u5c06\u88ab\u8feb\u5904\u7406\u539f\u5b50\u5199\u5165\u5e76\u8bfb\u53d6<code>104\u5b57\u8282</code>\u7684\u5185\u5b58\u5757\u3002\u6ca1\u6709\u673a\u5668\u6307\u4ee4\u53ef\u4ee5\u4fdd\u8bc1\u8fd9\u4e9b\u5bbd\u5ea6\u7684\u539f\u5b50\u6027\uff0c\u56e0\u6b64\u5b9e\u73b0\u5e94\u8be5\u91c7\u7528<code>CAS-ing</code>\u6216<code>\u9501\u5b9a</code>\u6216\u5176\u4ed6\u65b9\u5f0f\u3002</p> <p>\uff08\u5b83\u53d8\u5f97\u66f4\u6709\u8da3\uff0c\u56e0\u4e3a<code>C++</code>\u5141\u8bb8\u5355\u72ec\u7f16\u8bd1\uff1a\u73b0\u5728<code>\u94fe\u63a5\u5668</code>\u7684\u4efb\u52a1\u662f\u786e\u5b9a\u8fd9\u4e2a\u7279\u5b9a\u7684<code>std::atomic</code>\u4f7f\u7528\u4e86\u4ec0\u4e48<code>\u9501/CAS\u4fdd\u62a4</code>\u3002\u6211\u4e0d\u5b8c\u5168\u786e\u5b9a\u5982\u679c\u7ebf\u7a0b\u6267\u884c\u7684\u8bdd\u4f1a\u53d1\u751f\u4ec0\u4e48\u4e0a\u4f8b\u4e2d\u4e0d\u540c\u7f16\u8bd1\u5668\u751f\u6210\u7684\u4ee3\u7801\u3002\uff09</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#jmm-updates","title":"JMM Updates","text":"<p>\u672c\u8282\u4ecb\u7ecd\u66f4\u65b0\u7684Java\u5185\u5b58\u6a21\u578b\u7684\u539f\u5b50\u6027\u6ce8\u610f\u4e8b\u9879\u3002\u8bf7\u5728\u53e6\u4e00\u7bc7\u6587\u7ae0\u4e2d\u67e5\u770b\u66f4\u5168\u9762\u7684\u89e3\u91ca\u3002</p> <p></p> <p>2014\u5e74\uff0c\u6211\u4eec\u662f\u5426\u8981\u91cd\u65b0\u8003\u865164\u4f4d\u5f02\u5e38\uff1f\u5f53<code>long\u548cdouble</code>\u7684\u7ade\u4e89\u66f4\u65b0\u6709\u610f\u4e49\u65f6\uff0c\u5f88\u5c11\u6709\u7528\u4f8b\u3002\u5728\u53ef\u6269\u5c55\u7684\u6982\u7387\u8ba1\u6570\u5668\u4e2d\u3002\u5f00\u53d1\u4eba\u5458\u53ef\u80fd\u6709\u7406\u7531\u5e0c\u671b<code>long/double\u8bbf\u95ee</code>\u572864\u4f4d\u5e73\u53f0\u4e0a\u662f\u539f\u5b50\u7684\uff0c\u4f46\u662f\u5982\u679c\u4ee3\u7801\u662f\u572832\u4f4d\u5e73\u53f0\u4e0a\u610f\u5916\u8fd0\u884c\u7684\u8bdd\uff0c\u5b83\u4eec\u4ecd\u9700\u8981<code>volatile</code>\u3002\u6807\u8bb0\u5b57\u6bb5volatile\u4f1a\u652f\u4ed8\u5185\u5b58\u969c\u788d\uff08memory barriers\uff09\u7684\u6210\u672c\u3002</p> <p>\u6362\u53e5\u8bdd\u8bf4\uff0c\u7531\u4e8evolatile\u91cd\u8f7d\u4e86\u4e24\u4e2a\u542b\u4e49\uff1a</p> <ol> <li>\u8bbf\u95ee\u539f\u5b50\u6027;</li> <li>\u5185\u5b58\u6392\u5e8f</li> </ol> <p>\u4f60\u4e0d\u80fd\u5f97\u5230\u4e00\u4e2a\u6ca1\u6709\u53e6\u4e00\u4e2a\u4f5c\u4e3a\u884c\u674e\u3002\u53ef\u4ee5\u63a8\u6d4b\u5220\u966464\u4f4d\u5f02\u5e38\u7684\u6210\u672c\u3002\u7531\u4e8eVM\u901a\u8fc7\u53d1\u51fa\u7279\u6b8a\u6307\u4ee4\u5e8f\u5217\u6765\u5206\u522b\u5904\u7406\u8bbf\u95ee\u539f\u5b50\u6027\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5728\u9700\u8981\u65f6\u5c06VM\u7834\u89e3\u4e3a\u65e0\u6761\u4ef6\u5730\u53d1\u51fa\u539f\u5b50\u6307\u4ee4\u5e8f\u5217\u3002</p> <p></p> <p>\u7406\u89e3\u6b64\u56fe\u8868\u9700\u8981\u4e00\u4e9b\u65f6\u95f4\u3002\u6211\u4eec\u53ef\u4ee5\u6d4b\u91cflongs\u7684\u8bfb\u53d6\u548c\u5199\u5165 - \u6bcf\u79cd\u8bbf\u95ee\u6a21\u5f0f\u4e09\u6b21\uff08<code>plain</code>\uff0c<code>volatile</code>\u548c\u901a\u8fc7 <code>Unsafe.putOrdered</code>\uff09\u3002\u5982\u679c\u6211\u4eec\u6b63\u786e\u5730\u5b9e\u73b0\u8be5\u529f\u80fd\uff0c\u90a3\u4e48\u572864\u4f4d\u5e73\u53f0\u4e0a\u5e94\u8be5\u6ca1\u6709\u533a\u522b\uff0c\u56e0\u4e3a\u8bbf\u95ee\u5df2\u7ecf\u662f\u539f\u5b50\u7684\u3002\u5b9e\u9645\u4e0a\uff0c64\u4f4dIvy Bridge\u4e0a\u7684\u5f69\u8272\u6761\u4e4b\u95f4\u6ca1\u6709\u533a\u522b\u3002 \u6ce8\u610f<code>volatile long</code>\u5199\u7684\u91cd\u91cf\u7ea7\u662f\u591a\u5c11\u3002\u5982\u679c\u6211\u53ea\u60f3\u8981\u539f\u5b50\u6027\uff0c\u6211\u4f1a\u4e3a\u5185\u5b58\u6392\u5e8f\u652f\u4ed8\u8fd9\u7b14\u6210\u672c\u3002</p> <p></p> <p>\u5904\u740632\u4f4d\u5e73\u53f0\u65f6\u4f1a\u53d8\u5f97\u66f4\u52a0\u590d\u6742\u3002\u5728\u90a3\u91cc\uff0c\u60a8\u9700\u8981\u6ce8\u5165\u7279\u6b8a\u7684\u6307\u4ee4\u5e8f\u5217\u6765\u83b7\u5f97<code>\u539f\u5b50\u6027</code>\u3002\u5728x86\u7684\u60c5\u51b5\u4e0b\uff0c\u5373\u4f7f\u572832\u4f4d\u5e73\u53f0\u4e2d\uff0c<code>FPU\u52a0\u8f7d/\u5b58\u50a8</code>\u4e5f\u662f64\u4f4d\u5bbd\u3002\u60a8\u652f\u4ed8\u201c\u5197\u4f59\u201d\u526f\u672c\u7684\u8d39\u7528\uff0c\u4f46\u4e0d\u662f\u90a3\u4e48\u591a\u3002</p> <p></p> <p>\u5728\u975ex86\u5e73\u53f0\u4e0a\uff0c\u6211\u4eec\u8fd8\u5fc5\u987b\u4f7f\u7528\u66ff\u4ee3\u6307\u4ee4\u5e8f\u5217\u6765\u91cd\u65b0\u83b7\u5f97<code>\u539f\u5b50\u6027</code>\uff0c\u5e76\u5177\u6709<code>\u53ef\u9884\u6d4b</code>\u7684\u6027\u80fd\u5f71\u54cd\u3002\u8bf7\u6ce8\u610f\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u540c\u6837\u572832\u4f4dx86\u7684\u60c5\u51b5\u4e0b\uff0cvolatile\u901a\u8fc7\u5f3a\u5236\u539f\u5b50\u6027\u7a0d\u5fae\u6162\u4e00\u70b9\uff0c\u4f46\u8fd9\u662f\u7cfb\u7edf\u9519\u8bef\uff0c\u56e0\u4e3a\u6211\u4eec\u8fd8\u9700\u8981\u5c06\u503c\u8f6c\u50a8\u5230<code>long</code>\u5b57\u6bb5\u4e2d\u4ee5\u9632\u6b62\u67d0\u4e9b\u7f16\u8bd1\u5668\u4f18\u5316\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#word-tearing","title":"\u7b2c\u4e8c\u90e8\u5206 \u5b57\u8282\u6495\u88c2\uff08Word Tearing\uff09","text":""},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#_5","title":"\u6211\u4eec\u60f3\u8981\u4ec0\u4e48","text":"<p>\u5b57\u8282\u6495\u88c2\u4e0e\u8bbf\u95ee\u539f\u5b50\u6027\u6709\u5173\u3002 \u5982\u679c\u4e24\u4e2a\u53d8\u91cf\u662f\u4e0d\u540c\u7684\uff0c\u90a3\u4e48\u5bf9\u5b83\u4eec\u7684\u64cd\u4f5c\u4e5f\u5e94\u8be5\u662f\u4e0d\u540c\u7684\uff0c\u5e76\u4e14\u4e0d\u5e94\u53d7\u76f8\u90bb\u5143\u7d20\u4e0a\u7684\u64cd\u4f5c\u7684\u5f71\u54cd\u3002\u8fd9\u4e2a\u4f8b\u5b50\u5982\u4f55\u6253\u7834\uff1f\u975e\u5e38\u7b80\u5355\uff1a\u5982\u679c\u6211\u4eec\u7684\u786c\u4ef6\u65e0\u6cd5\u8bbf\u95ee\u4e0d\u540c\u7684\u6570\u7ec4\u5143\u7d20\uff0c\u5b83\u5c06\u88ab\u5f3a\u5236\u8bfb\u53d6\u591a\u4e2a\u5143\u7d20\uff0c\u4fee\u6539\u4e00\u5806\u4e2d\u7684\u4e00\u4e2a\u5143\u7d20\uff0c\u7136\u540e\u5c06\u6574\u4e2a\u5143\u7d20\u653e\u56de\u53bb\u3002</p> <p>\u5982\u679c\u4e24\u4e2a\u7ebf\u7a0b\u5728\u5b83\u4eec\u5404\u81ea\u7684\u5143\u7d20\u4e0a\u8fdb\u884c\u76f8\u540c\u7684dance\uff0c\u5219\u53ef\u80fd\u4f1a\u53d1\u751f\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u5c06\u5176\u81ea\u5df1\u7684\u6b65\u9aa4\u5b58\u50a8\u56de\u5185\u5b58\uff0c\u4ece\u800c\u8986\u76d6\u7531\u7b2c\u4e00\u4e2a\u7ebf\u7a0b\u66f4\u65b0\u7684\u5143\u7d20\u3002\u5bf9\u4e8e\u6beb\u65e0\u6212\u5fc3\u7684\u7528\u6237\u800c\u8a00\uff0c\u8fd9\u53ef\u80fd\u5e76\u4e14\u5c06\u4f1a\u5f15\u8d77\u5f88\u591a\u9ebb\u70e6\uff0c\u56e0\u4e3a\u5982\u679c\u6ca1\u6709\u8bed\u8a00\u89c4\u8303\u4e2d\u7684\u660e\u786e\u89c4\u5b9a\uff0c\u8fd0\u884c\u65f6\u53ef\u4ee5\u81ea\u7531\u5730\u5e94\u7528\u53ef\u80fd\u5bfc\u81f4\u96be\u4ee5\u8bca\u65ad\u7684\u9519\u8bef\u7684\u8f6c\u6362\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#_6","title":"\u6211\u4eec\u6709\u4ec0\u4e48","text":"<p>\u5982\u679c\u6211\u4eec\u60f3\u7981\u6b62\u5b57\u8282\u6495\u88c2\uff0c\u6211\u4eec\u9700\u8981\u786c\u4ef6\u652f\u6301\u7ed9\u5b9a\u5bbd\u5ea6\u7684\u8bbf\u95ee\u3002\u5728<code>boolean[]</code>\u6570\u7ec4\u6216\u4e00\u7ec4\u5e03\u5c14\u5b57\u6bb5\u7684\u6700\u7b80\u5355\u573a\u666f\u4e2d\uff0c\u60a8\u65e0\u6cd5\u5728\u5927\u591a\u6570\u786c\u4ef6\u4e0a\u8f7b\u677e\u8bbf\u95ee\u5355\u4e2a\u5185\u5b58\u4f4d\uff0c\u56e0\u4e3a\u8f83\u4f4e\u7684\u53ef\u5bfb\u5740\u6027\u8fb9\u754c\u901a\u5e38\u662f\u5355\u4e2a\u5b57\u8282\u3002</p> <p></p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u4e9b\u5929\u4f60\u5fc5\u987b\u5411\u7a0b\u5e8f\u5458\u89e3\u91ca\u5b57\u8282\u6495\u88c2\u3002\u5927\u591a\u6570\u7cfb\u7edf\u7a0b\u5e8f\u5458\u4ece\u524d\u51e0\u5929\u90fd\u975e\u5e38\u719f\u6089\u5b83\uff0c\u5e76\u4e14\u7406\u89e3\u5728\u771f\u5b9e\u7cfb\u7edf\u4e2d\u8ffd\u9010\u8fd9\u6837\u4e00\u4e2abug\u7684\u6050\u6016\u3002</p> <p>\u56e0\u6b64\uff0cJava\uff0c\u76ee\u6807\u662f\u4e00\u79cd\u7406\u667a\u7684\u8bed\u8a00\uff0c\u7981\u6b62\u5b57\u8282\u6495\u88c2\u3002Bill Pugh\uff08FindBugs\u662f\u4ed6\u6700\u6709\u7279\u8272\u7684\u4f5c\u54c1\uff0c\u4f46\u4ed6\u4e5f\u662f<code>JMM JSR 133</code>\u7684\u9886\u5bfc\u8005\uff09\u5bf9\u6b64\u975e\u5e38\u6e05\u695a\u3002\u6211\u66fe\u7ecf\u5728C++\u7a0b\u5e8f\u4e2d\u8ffd\u9010\u4e00\u4e2a\u7834\u574f\u5b57\u7684\u9519\u8bef - \u4e0d\u662f\u5f88\u6709\u8da3\u3002</p> <p>\u8fd9\u4e2a\u8981\u6c42\u4f3c\u4e4e\u5f88\u5bb9\u6613\u9002\u5e94\u5f53\u524d\u7684\u786c\u4ef6\uff1a\u60a8\u53ef\u80fd\u5173\u5fc3\u7684\u552f\u4e00\u6570\u636e\u7c7b\u578b\u662f<code>\u5e03\u5c14\u503c</code>\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u91c7\u7528<code>\u5b8c\u6574\u5b57\u8282</code>\u800c\u4e0d\u662f<code>\u5355\u4e2a\u4f4d</code>\u3002\u5f53\u7136\uff0c\u60a8\u8fd8\u9700\u8981\u9a6f\u670d\u4efb\u4f55\u53ef\u80fd\u7f13\u51b2\u8bfb\u53d6\u548c\u5199\u5165\u4ee5\u53ca\u76f8\u90bb\u6570\u636e\u7684\u7f16\u8bd1\u5668\u4f18\u5316\u3002</p> <p></p> <p>\u5927\u591a\u6570\u4eba\u5728\u6587\u6863\u4e2d\u67e5\u627e\u5141\u8bb8\u7684<code>\u57fa\u7840\u7c7b\u578b\u503c</code>\u8303\u56f4\uff0c\u5e76\u4ece\u90a3\u91cc\u63a8\u65ad\u673a\u5668\u8868\u793a\u5bbd\u5ea6\u3002\u60a8\u53ea\u80fd\u8868\u793a\u6700\u5c0f\u673a\u5668\u5bbd\u5ea6\u6765\u8868\u793a\uff0c\u4f8b\u5982long\u6709<code>2^64</code>\u4e2a\u6848\u4f8b\u3002\u5b83\u5e76\u4e0d\u5f3a\u5236\u8fd0\u884c\u65f6\u5b9e\u9645\u4e3a\u6bcf\u4e2along\u5206\u914d8\u4e2a\u5b57\u8282;\u5b83\u539f\u5219\u4e0a\u53ef\u4ee5\u4f7f\u7528<code>128\u5b57\u8282\u957f</code>\uff0c\u53ea\u8981\u5b83\u6709\u4e00\u4e9b\u5947\u602a\u7684\u539f\u56e0\u662f<code>\u5b9e\u7528</code>\u7684\u3002 \u4f46\u662f\uff0c\u6211\u6240\u77e5\u9053\u7684\u5927\u591a\u6570\u8fd0\u884c\u65f6\u90fd\u662f\u5b9e\u7528\u7684\uff0c\u5e76\u4e14<code>\u673a\u5668\u8868\u793a\u5bbd\u5ea6</code>\u975e\u5e38\u9002\u5408<code>\u503c\u57df</code>\uff0c\u4e0d\u4f1a\u6d6a\u8d39\u7a7a\u95f4\u3002\u6b63\u5982\u6211\u4e4b\u524d\u6240\u8bf4\uff0cboolean\u662f\u8fd9\u6761\u89c4\u5219\u7684\u552f\u4e00\u4f8b\u5916\u3002 JOL\u8bd5\u56fe\u627e\u51fa\u5b9e\u9645\u7684\u673a\u5668\u5bbd\u5ea6\uff0c\u4f60\u53ef\u4ee5\u5728\u8fd9\u5f20\u5e7b\u706f\u7247\u4e0a\u770b\u5230\u523b\u5ea6\u3002\u8fd9\u4e9b\u6570\u5b57\u5206\u522b\u662f<code>\u5f15\u7528\uff0cboolean\uff0cbyte\uff0cshort\uff0cchar\uff0cint\uff0cfloat\uff0clong\u548cdouble</code>\u6240\u5360\u7684\u5b57\u8282\u6570 - \u6b63\u662f\u6211\u4eec\u6240\u671f\u671b\u7684\u90a3\u6837\u3002\u5176\u4ed6\u5e73\u53f0\u53ef\u80fd\u88ab\u8ba4\u4e3a......\u5f88\u5947\u602a\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#test-your-understanding_1","title":"Test Your Understanding","text":"<p>\u7b54\u6848\uff08\u9009\u62e9\u7ed3\u675f\u663e\u793a\uff09\uff1a\u4efb\u4f55\uff08\u771f\uff0c\u771f\uff09\uff0c\uff08\u5047\uff0c\u771f\uff09\uff0c\uff08\u771f\uff0c\u5047\uff09\uff0c\u56e0\u4e3a<code>BitSet</code>\u5bc6\u96c6\u5b58\u50a8\u5728<code>long[]</code>\u6570\u7ec4\u4e2d\u7684\u4f4d\u5e76\u4f7f\u7528\u4f4d\u9b54\u672f\u6765\u8bbf\u95ee\u7279\u5b9a\u4f4d\u3002\u5b83\u5728\u5185\u5b58\u5360\u7528\u65b9\u9762\u83b7\u5f97\u4e86\u5de8\u5927\u7684\u6210\u529f\uff0c\u5b83\u6446\u8131\u4e86\u8bed\u8a00\u7684\u8bed\u8a00\u4fdd\u8bc1\u3002 \uff08BitSet Javadocs\u8bf4\u591a\u7ebf\u7a0b\u7528\u6cd5\u5e94\u8be5\u662f<code>\u540c\u6b65</code>\u7684\uff0c\u6240\u4ee5\u8fd9\u53ef\u4ee5\u8bf4\u662f\u4e00\u4e2a\u4eba\u4e3a\u7684\u4f8b\u5b50\uff09</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#cc-layout-control-and-cc","title":"\u5e03\u5c40\u63a7\u5236\u548cC/C ++\uff08Layout Control and C/C++\uff09","text":"<p>\u76f8\u5f53\u591a\u7684\u4eba\u5e0c\u671b\u63a7\u5236\u7279\u5b9a\u7c7b\u7684\u5185\u5b58\u5e03\u5c40\uff0c\u4ee5\u4fbf\u5728\u8fb9\u7f18\u60c5\u51b5\u4e0b\u83b7\u5f97\u66f4\u597d\u7684\u5360\u7528\u7a7a\u95f4\uff0c\u548c/\u6216\u66f4\u597d\u7684\u6027\u80fd\u3002\u4f46\u662f\u5728\u4e00\u79cd\u5141\u8bb8\u5bf9\u5176\u53d8\u91cf\u8fdb\u884c\u4efb\u610f\u5e03\u5c40\u7684\u8bed\u8a00\u4e2d\uff0c\u60a8\u4e0d\u80fd\u59cb\u7ec8\u7981\u6b62\u5b57\u8282\u6495\u88c2\uff0c\u56e0\u4e3a\u60a8\u5fc5\u987b\u4ed8\u51fa\u4ee3\u4ef7\uff0c\u5982\u672c\u793a\u4f8b\u6240\u793a\u3002</p> <p>\u6ca1\u6709\u673a\u5668\u6307\u4ee4\u53ef\u4ee5\u4e00\u6b21\u5199\u51657\u4f4d\uff0c\u6216\u8005\u4e00\u6b21\u53ea\u80fd\u8bfb\u53d63\u4f4d\uff0c\u56e0\u6b64\u5982\u679c\u5b83\u4eec\u7684\u4efb\u52a1\u662f\u907f\u514d\u5b57\u8282\u6495\u88c2\uff0c\u5219\u9700\u8981\u5b9e\u73b0\u521b\u9020\u6027\u3002 <code>C/C++ 11</code>\u5141\u8bb8\u4f60\u4f7f\u7528\u8fd9\u4e2a\u950b\u5229\u7684\u5de5\u5177\uff0c\u4f46\u544a\u8bc9\u4f60\uff0c\u4e00\u65e6\u4f60\u5f00\u59cb\uff0c\u4f60\u5c31\u662f\u4f60\u81ea\u5df1\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#jmm-updates_1","title":"JMM Updates","text":"<p>\u6ca1\u6709\u4eba\u8d28\u7591\u5b57\u8282\u6495\u88c2\u5e94\u8be5\u88ab\u7981\u6b62\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#sc-drf","title":"\u7b2c\u4e09\u90e8\u5206 SC-DRF","text":""},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#_7","title":"\u6211\u4eec\u60f3\u8981\u4ec0\u4e48","text":"<p>\u73b0\u5728\u6211\u4eec\u5f00\u59cb\u8ba8\u8bba\u5185\u5b58\u6a21\u578b\u4e2d\u6700\u6709\u8da3\u7684\u90e8\u5206\uff1a\u5173\u4e8e\u7a0b\u5e8f\u8bfb\u53d6\u7684\u63a8\u7406\u3002\u5f88\u81ea\u7136\u5730\u8ba4\u4e3a\u7a0b\u5e8f\u6b63\u5728\u4ee5\u67d0\u79cd\u5168\u5c40\u987a\u5e8f\u6267\u884c\u5b83\u4eec\u7684\u8bed\u53e5\uff0c\u6709\u65f6\u5728\u7ebf\u7a0b\u4e4b\u95f4\u5207\u6362\u3002\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u6a21\u578b\uff0cLamport\u5df2\u7ecf\u4e3a\u6211\u4eec\u5b9a\u4e49\u4e86\u5b83\uff1a<code>\u987a\u5e8f\u4e00\u81f4\u6027</code>\u3002</p> <p></p> <p>\u6ce8\u610f\u7a81\u51fa\u663e\u793a\u3002\u987a\u5e8f\u4e00\u81f4\u6027\u5e76\u4e0d\u610f\u5473\u7740\u64cd\u4f5c\u662f\u6309\u7279\u5b9a\u7684<code>\u603b\u987a\u5e8f\uff08total order\uff09</code>\u6267\u884c\u7684\uff01 \uff08\u66f4\u4e25\u683c\u7684\u4e00\u81f4\u6027\u63d0\u4f9b\u4e86\u8fd9\u4e00\u70b9\uff09\u3002\u91cd\u8981\u7684\u662f\uff0c\u7ed3\u679c\u4e0e\u5177\u6709\u603b\u64cd\u4f5c\u987a\u5e8f\u7684\u6267\u884c\u65e0\u6cd5\u533a\u5206\uff08indistinguishable\uff09\u3002\u6211\u4eec\u5c06\u6267\u884c\u79f0\u4e3a<code>\u987a\u5e8f\u4e00\u81f4\u7684\u6267\u884c\uff08sequentially consistent executions\uff09</code>\uff0c\u5e76\u5c06\u5176\u7ed3\u679c\u79f0\u4e3a<code>\u987a\u5e8f\u4e00\u81f4\u7684\u7ed3\u679c\uff08sequentially consistent results\uff09</code>\u3002</p> <p></p> <p>SC\u663e\u7136\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4f18\u5316\u4ee3\u7801\u7684\u673a\u4f1a\u3002\u7531\u4e8e\u6211\u4eec\u4e0d\u53d7\u5b9e\u9645\u603b\u6267\u884c\u987a\u5e8f\u7684\u7ea6\u675f\uff0c\u4f46\u53ea\u9700\u5047\u88c5\u6709\u4e00\u4e2a\uff0c\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u6709\u8da3\u7684\u4f18\u5316\u3002\u4f8b\u5982\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u8f6c\u6362\u4e0d\u4f1a\u7834\u574fSC\uff1a\u663e\u7136\u539f\u59cb\u7a0b\u5e8f\u7684SC\u6267\u884c\u4f1a\u4ea7\u751f\u76f8\u540c\u7684\u7ed3\u679c\uff08\u5047\u8bbe\u6ca1\u6709\u4eba\u5173\u5fc3a\u548cb\u7684\u503c\uff09\u3002</p> <p>\u8bf7\u6ce8\u610f\uff0cSC\u5141\u8bb8\u6211\u4eec\u7f29\u5c0f\u53ef\u80fd\u7684\u6267\u884c\u96c6\u3002\u5728\u6781\u7aef\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u7531\u9009\u62e9\u5355\u4e2a\u8ba2\u5355\u5e76\u575a\u6301\u4e0b\u53bb\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#_8","title":"\u6211\u4eec\u6709\u4ec0\u4e48","text":"<p>\u4f46\u662f\uff0cSC\u7684\u53ef\u4f18\u5316\u6027\u88ab\u9ad8\u4f30\u4e86\u3002\u8bf7\u6ce8\u610f\uff0c\u5f53\u524d\u7684\u4f18\u5316\u7f16\u8bd1\u5668\uff0c\u66f4\u4e0d\u7528\u8bf4\u786c\u4ef6\uff0c\u53ea\u5173\u5fc3\u5f53\u524d\u7684\u6307\u4ee4\u6d41\u3002\u90a3\u4e48\uff0c\u5982\u679c\u6211\u4eec\u5728\u6307\u4ee4\u6d41\u4e2d\u6709\u4e24\u4e2a\u8bfb\u53d6\uff0c\u6211\u4eec\u53ef\u4ee5\u50cf\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u90a3\u6837\u5bf9\u5b83\u4eec\u8fdb\u884c\u91cd\u65b0\u6392\u5e8f\u5e76\u7ef4\u62a4SC\u5417\uff1f</p> <p></p> <p>\u4e8b\u5b9e\u8bc1\u660e\uff0c\u4f60\u505a\u4e0d\u5230\u3002\u5982\u679c\u7a0b\u5e8f\u7684\u53e6\u4e00\u90e8\u5206\u5c06\u503c\u5b58\u50a8\u5230<code>a</code>\u548c<code>b</code>\u4e2d\uff0c\u5219\u8bfb\u53d6\u91cd\u65b0\u6392\u5e8f\u4f1a\u7834\u574fSC\u3002\u5b9e\u9645\u4e0a\uff0c\u5728SC\u4e0b\u6267\u884c\u7684\u539f\u59cb\u7a0b\u5e8f\u53ea\u80fd\u5f97\u5230\u5339\u914d<code>\uff08*\uff0c2\uff09</code>\u6216<code>\uff080\uff0c*\uff09</code>\u7684\u7ed3\u679c\uff0c\u4f46\u4fee\u6539\u540e\u7684\u7a0b\u5e8f\uff0c\u5373\u4f7f\u4ee5\u603b\u987a\u5e8f\u65b9\u5f0f\u6267\u884c\uff0c\u4e5f\u4f1a\u4ea7\u751f<code>\uff081,0\uff09</code>\uff0c\u4ee4\u4eba\u56f0\u60d1\u7684\u5f00\u53d1\u4eba\u5458\u671f\u671bSC\u6765\u81ea\u4ed6\u4eec\u7684\u4ee3\u7801\u3002</p> <p></p> <p>\u90a3\u4e48\uff0c\u4f60\u53ef\u4ee5\u770b\u51fa\uff0c\u5373\u4f7f\u662f\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u8f6c\u6362\u4e5f\u662f\u5408\u7406\u7684\uff0c\u4f60\u9700\u8981\u590d\u6742\u7684\u5206\u6790\uff0c\u800c\u8fd9\u79cd\u5206\u6790\u5e76\u4e0d\u5bb9\u6613\u6269\u5c55\u5230\u73b0\u5b9e\u7684\u7a0b\u5e8f\u3002\u4ece\u7406\u8bba\u4e0a\u8bb2\uff0c\u6211\u4eec\u53ef\u4ee5\u62e5\u6709\u4e00\u4e2a\u53ef\u4ee5\u6267\u884c\u6b64\u5206\u6790\u7684\u667a\u80fd\u5168\u5c40\u4f18\u5316\u5668\uff08GMO\uff09\u3002\u6211\u8ba4\u4e3a\u8f6c\u57fa\u56e0\u751f\u7269\u7684\u5b58\u5728\u4e0e\u62c9\u666e\u62c9\u65af\u7684\u6076\u9b54\u7684\u5b58\u5728\u5bc6\u5207\u76f8\u5173\u3002</p> <p>\u4f46\u7531\u4e8e\u6211\u4eec\u6ca1\u6709\u8f6c\u57fa\u56e0\u751f\u7269\uff08GMO\uff09\uff0c\u6240\u4ee5\u6240\u6709\u7684\u4f18\u5316\u90fd\u662f\u4fdd\u5b88\u7684\uff0c\u56e0\u4e3a\u62c5\u5fc3\u65e0\u610f\u4e2d\u8fdd\u53cd\u4e86SC\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u6027\u80fd\u635f\u5931\u3002\u6240\u4ee5\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u4e0d\u8fdb\u884c\u8f6c\u578b\uff0c\u5bf9\u5427\uff1f\u4e0d\u592a\u53ef\u80fd\uff1a\u5373\u4f7f\u662f\u975e\u5e38\u57fa\u672c\u7684\u8f6c\u53d8\u4e5f\u662f\u88ab\u7981\u6b62\u7684\u3002\u60f3\u4e00\u60f3\uff1a\u5982\u679c\u6709\u6548\u5730\u6d88\u9664\u4e86\u7a0b\u5e8f\u4e2d\u5176\u4ed6\u5730\u65b9\u7684\u8bfb\u53d6\uff0c\u5373\u91cd\u65b0\u6392\u5e8f\uff0c\u4f60\u80fd\u628a\u53d8\u91cf\u653e\u5728\u5bc4\u5b58\u5668\u4e0a\u5417\uff1f</p> <p></p> <p>...\u867d\u7136\u6211\u4eec\u53ef\u4ee5\u7981\u6b62\u7f16\u8bd1\u5668\u4e2d\u7684\u4e00\u4e9b\u4f18\u5316\u4ee5\u963b\u6b62\u5728\u5176\u4ed6SC\u7a0b\u5e8f\u4e2d\u9020\u6210\u4e25\u91cd\u7834\u574f\uff0c\u4f46\u786c\u4ef6\u65e0\u6cd5\u8f7b\u6613\u534f\u5546\u3002\u786c\u4ef6\u5df2\u7ecf\u91cd\u65b0\u5b89\u6392\u4e86\u8bb8\u591a\u4e1c\u897f\uff0c\u5e76\u63d0\u4f9b\u6602\u8d35\u7684\u9003\u751f\u8231\uff08escape hatches\uff09\u4ee5\u6050\u5413\u91cd\u65b0\u6392\u5e8f\uff08\u201c\u5185\u5b58\u5c4f\u969c\u201d\uff09\u3002\u56e0\u6b64\uff0c\u4e00\u4e2a\u4e0d\u80fd\u63a7\u5236\u53ef\u80fd\u8f6c\u6362\u7684\u6a21\u578b\u4ee5\u53ca\u9f13\u52b1\u8fdb\u884c\u54ea\u4e9b\u4f18\u5316\u7684\u6a21\u578b\u5b9e\u9645\u4e0a\u5e76\u4e0d\u80fd\u4ee5\u826f\u597d\u7684\u6027\u80fd\u8fd0\u884c\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u8981\u6c42\u8bed\u8a00\u4e2d\u7684\u987a\u5e8f\u4e00\u81f4\u6027\uff0c\u6211\u4eec\u53ef\u80fd\u4e0d\u5f97\u4e0d\u60b2\u89c2\u5730\u56f4\u7ed5\u51e0\u4e4e\u6bcf\u4e00\u6b21\u5185\u5b58\u8bbf\u95ee\u53d1\u51fa\u5185\u5b58\u969c\u788d\uff0c\u4ee5\u4fbf\u6740\u6b7b\u786c\u4ef6\u5c1d\u8bd5\u201c\u4f18\u5316\u201d\u3002</p> <p></p> <p>\u6b64\u5916\uff0c\u5982\u679c\u60a8\u7684\u7a0b\u5e8f\u5305\u542b<code>\u7ade\u4e89</code>\uff0c\u5219\u5f53\u524d\u786c\u4ef6\u4e0d\u4fdd\u8bc1\u8fd9\u4e9b\u51b2\u7a81\u64cd\u4f5c\u7684\u4efb\u4f55\u7279\u5b9a\u7ed3\u679c\u3002 Hans Boehm\u548cSarita Adve\u575a\u5b9a\u4e0d\u79fb\u3002</p> <p></p> <p>\u56e0\u6b64\uff0c\u4e3a\u4e86\u5c06\u73b0\u5b9e\u878d\u5165\u5230\u5177\u6709\u5408\u7406\u6027\u80fd\u7684\u6a21\u578b\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u524a\u5f31\u5b83\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#java-memory-model","title":"Java Memory Model","text":"<p>\u8fd9\u662f\u4e8b\u60c5\u53d8\u5f97\u66f4\u52a0\u590d\u6742\u7684\u5730\u65b9\u3002\u7531\u4e8e\u8bed\u8a00\u89c4\u8303\u5e94\u8be5\u6db5\u76d6\u8bed\u8a00\u4e2d\u53ef\u4ee5\u8868\u8fbe\u7684\u6240\u6709\u53ef\u80fd\u7684\u7a0b\u5e8f\uff0c\u6211\u4eec\u65e0\u6cd5\u771f\u6b63\u63d0\u4f9b\u6709\u9650\u6570\u91cf\u7684\u7ed3\u6784\uff0c\u8fd9\u4e9b\u7ed3\u6784\u53ef\u4ee5\u4fdd\u8bc1\u5de5\u4f5c\uff1a\u5b83\u4eec\u7684\u8054\u5408\u5c06\u5728\u8bed\u4e49\u4e0a\u7559\u4e0b\u767d\u70b9\uff0c\u5e76\u4e14\u767d\u70b9\u662f\u574f\u7684\u3002 \u56e0\u6b64\uff0cJMM\u8bd5\u56fe\u7acb\u5373\u6db5\u76d6\u6240\u6709\u53ef\u80fd\u7684\u7a0b\u5e8f\u3002\u5b83\u901a\u8fc7\u63cf\u8ff0\u62bd\u8c61\u7a0b\u5e8f\u53ef\u4ee5\u6267\u884c\u7684\u64cd\u4f5c\u6765\u5b9e\u73b0\uff0c\u5e76\u4e14\u8fd9\u4e9b\u64cd\u4f5c\u63cf\u8ff0\u4e86\u5728\u6267\u884c\u7a0b\u5e8f\u65f6\u53ef\u4ee5\u4ea7\u751f\u54ea\u4e9b\u7ed3\u679c\u3002\u64cd\u4f5c\u5728\u6267\u884c\u4e2d\u7ed1\u5b9a\u5728\u4e00\u8d77\uff0c\u6267\u884c\u5c06\u64cd\u4f5c\u4e0e\u63cf\u8ff0\u64cd\u4f5c\u5173\u7cfb\u7684\u5176\u4ed6\u8ba2\u5355\u7ec4\u5408\u5728\u4e00\u8d77\u3002\u8fd9\u611f\u89c9\u975e\u5e38\u8c61\u7259\u5854\u5f0f\uff0c\u6240\u4ee5\u6211\u4eec\u9a6c\u4e0a\u5c31\u53bb\u770b\u770b\u5427\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#program-order","title":"Program Order","text":"<p>\u7b2c\u4e00\u4e2a\u8ba2\u5355\u662f\u7a0b\u5e8f\u8ba2\u5355\uff08PO\uff09\u3002\u5b83\u5728\u5355\u4e2a\u7ebf\u7a0b\u4e2d\u5bf9\u64cd\u4f5c\u8fdb\u884c\u6392\u5e8f\u3002\u6ce8\u610f\u539f\u59cb\u7a0b\u5e8f\uff0c\u4ee5\u53ca\u8be5\u7a0b\u5e8f\u53ef\u80fd\u7684\u6267\u884c\u4e4b\u4e00\u3002\u5728\u90a3\u91cc\uff0c\u7a0b\u5e8f\u53ef\u4ee5\u4ecex\u8bfb\u53d61\uff0c\u901a\u8fc7else\u5206\u652f\u8bfb\u53d6\uff0c\u5c061\u5b58\u50a8\u5230z\uff0c\u7136\u540e\u7ee7\u7eed\u4ecey\u8bfb\u53d6\u5185\u5bb9\u3002</p> <p></p> <p>\u7a0b\u5e8f\u987a\u5e8f\u662f\u603b\u8ba1\uff08\u5728\u4e00\u4e2a\u7ebf\u7a0b\u5185\uff09\uff0c\u5373\u6bcf\u5bf9\u52a8\u4f5c\u4e0e\u8be5\u987a\u5e8f\u76f8\u5173\u3002\u4e86\u89e3\u4e00\u4e9b\u4e8b\u60c5\u5f88\u91cd\u8981\u3002</p> <p>\u6309\u7a0b\u5e8f\u987a\u5e8f\u94fe\u63a5\u5728\u4e00\u8d77\u7684\u64cd\u4f5c\u4e0d\u6392\u9664\u201c\u91cd\u65b0\u6392\u5e8f\u201d\u3002\u4e8b\u5b9e\u4e0a\uff0c\u8c08\u8bba\u884c\u52a8\u7684\u91cd\u65b0\u6392\u5e8f\u6709\u70b9\u4ee4\u4eba\u56f0\u60d1\uff0c\u56e0\u4e3a\u4eba\u4eec\u53ef\u80fd\u6253\u7b97\u5728\u7a0b\u5e8f\u4e2d\u8c08\u8bba\u58f0\u660e\u91cd\u65b0\u6392\u5e8f\uff0c\u8fd9\u4f1a\u4ea7\u751f\u65b0\u7684\u6267\u884c\u3002\u90a3\u4e48\u8fd9\u4e2a\u65b0\u8ba1\u5212\u4ea7\u751f\u7684\u6267\u884c\u662f\u5426\u8fdd\u53cd\u4e86JMM\u7684\u89c4\u5b9a\u5c06\u662f\u4e00\u4e2a\u60ac\u800c\u672a\u51b3\u7684\u95ee\u9898\u3002</p> <p>\u7a0b\u5e8f\u987a\u5e8f\u6ca1\u6709\uff0c\u6211\u518d\u8bf4\u4e00\u904d\uff0c\u4e0d\u63d0\u4f9b\u8ba2\u8d2d\u4fdd\u8bc1\u3002\u5b83\u5b58\u5728\u7684\u552f\u4e00\u539f\u56e0\u662f\u63d0\u4f9b\u53ef\u80fd\u7684\u6267\u884c\u548c\u539f\u59cb\u7a0b\u5e8f\u4e4b\u95f4\u7684\u94fe\u63a5\u3002</p> <p></p> <p>\u8fd9\u5c31\u662f\u6211\u4eec\u7684\u610f\u601d\u3002\u7ed9\u5b9a\u52a8\u4f5c\u548c\u6267\u884c\u7684\u7b80\u5355\u793a\u610f\u56fe\uff0c\u60a8\u53ef\u4ee5\u6784\u9020\u65e0\u9650\u6570\u91cf\u7684\u6267\u884c\u3002\u8fd9\u4e9b\u5904\u51b3\u8131\u79bb\u4e86\u4efb\u4f55\u73b0\u5b9e;\u5b83\u4eec\u53ea\u662f\u201c\u539f\u59cb\u6c64\u201d\uff0c\u5305\u542b\u4e00\u5207\u53ef\u80fd\u7684\u5efa\u7b51\u3002\u5728\u8fd9\u4e2a\u6c64\u7684\u67d0\u4e2a\u5730\u65b9\u6d6e\u52a8\u53ef\u4ee5\u89e3\u91ca\u7ed9\u5b9a\u7a0b\u5e8f\u7684\u7279\u5b9a\u7ed3\u679c\u7684\u6267\u884c\uff0c\u4ee5\u53ca\u6240\u6709\u8fd9\u4e9b\u5408\u7406\u6267\u884c\u7684\u96c6\u5408\u6db5\u76d6\u4e86\u8be5\u7a0b\u5e8f\u7684\u6240\u6709\u5408\u7406\u7ed3\u679c\u3002</p> <p></p> <p>\u8fd9\u662f\u7a0b\u5e8f\u987a\u5e8f\uff08PO\uff09\u8df3\u5165\u7684\u5730\u65b9\u3002\u4e3a\u4e86\u8fc7\u6ee4\u6389\u6211\u4eec\u53ef\u4ee5\u7406\u89e3\u7279\u5b9a\u7a0b\u5e8f\u7684\u6267\u884c\uff0c\u6211\u4eec\u6709\u7ebf\u7a0b\u5185\u4e00\u81f4\u6027\u89c4\u5219\uff0c\u5b83\u6d88\u9664\u4e86\u6240\u6709\u4e0d\u76f8\u5173\u7684\u6267\u884c\u3002\u4f8b\u5982\uff0c\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5c3d\u7ba1\u6240\u793a\u7684\u6267\u884c\u662f\u62bd\u8c61\u53ef\u80fd\u7684\uff0c\u4f46\u5b83\u4e0e\u539f\u59cb\u7a0b\u5e8f\u65e0\u5173\uff1a\u5728\u4ecex\u8bfb\u53d62\u4e4b\u540e\uff0c\u6211\u4eec\u5e94\u8be5\u5199\u51651\u5230y\uff0c\u800c\u4e0d\u662fz\u3002</p> <p></p> <p>\u4ee5\u4e0b\u662f\u6211\u4eec\u5982\u4f55\u8bf4\u660e\u8fd9\u79cd\u8fc7\u6ee4\u3002\u7ebf\u7a0b\u5185\u4e00\u81f4\u6027\u662f\u7b2c\u4e00\u4e2a\u6267\u884c\u8fc7\u6ee4\u5668\uff0c\u5927\u591a\u6570\u4eba\u5728\u5904\u7406JMM\u65f6\u90fd\u4f1a\u9690\u542b\u5728\u5176\u4e2d\u3002\u5728\u8fd9\u4e00\u70b9\u4e0a\u4f60\u53ef\u80fd\u4f1a\u6ce8\u610f\u5230JMM\u662f\u4e00\u4e2a\u975e\u5efa\u8bbe\u6027\u7684\u6a21\u578b\uff1a\u6211\u4eec\u4e0d\u662f\u5f52\u7eb3\u5730\u5efa\u7acb\u89e3\u51b3\u65b9\u6848\uff0c\u800c\u662f\u91c7\u7528\u6574\u4e2a\u6267\u884c\u9886\u57df\uff0c\u5e76\u8fc7\u6ee4\u6389\u90a3\u4e9b\u5bf9\u6211\u4eec\u611f\u5174\u8da3\u7684\u4e1c\u897f\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#synchronization-order","title":"Synchronization Order","text":"<p>\u73b0\u5728\u6211\u4eec\u5f00\u59cb\u6784\u5efa\u771f\u6b63\u547d\u4ee4\u7684\u6a21\u578b\u7684\u4e00\u90e8\u5206\u3002\u5728\u5f31\u5185\u5b58\u6a21\u578b\u4e2d\uff0c\u6211\u4eec\u4e0d\u4f1a\u5bf9\u6240\u6709\u64cd\u4f5c\u8fdb\u884c\u6392\u5e8f\uff0c\u6211\u4eec\u53ea\u5bf9\u4e00\u4e9b\u6709\u9650\u7684\u57fa\u5143\u5f3a\u52a0\u4e00\u4e2a\u786c\u547d\u4ee4\u3002\u5728JMM\u4e2d\uff0c\u8fd9\u4e9b\u539f\u8bed\u5305\u542b\u5728\u5404\u81ea\u7684\u540c\u6b65\u64cd\u4f5c\u4e2d\u3002</p> <p></p> <p>\u540c\u6b65\u987a\u5e8f\uff08SO\uff09\u662f\u8de8\u8d8a\u6240\u6709\u540c\u6b65\u64cd\u4f5c\u7684\u603b\u987a\u5e8f\u3002\u4f46\u8fd9\u4e0d\u662f\u5173\u4e8e\u8fd9\u4e2a\u8ba2\u5355\u6700\u6709\u8da3\u7684\u90e8\u5206\u3002 JMM\u63d0\u4f9b\u4e86\u4e24\u4e2a\u989d\u5916\u7684\u7ea6\u675f\uff1aSO-PO\u4e00\u81f4\u6027\u548cSO\u4e00\u81f4\u6027\u3002\u8ba9\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u6765\u89e3\u5305\u8fd9\u4e9b\u7ea6\u675f\u3002</p> <p></p> <p>\u8fd9\u662f\u4e00\u4e2a\u6e90\u81eaDekker Lock\u7684\u76f8\u5f53\u7b80\u5355\u7684\u4f8b\u5b50\u3002\u8bd5\u7740\u60f3\u4e00\u4e0b\u5141\u8bb8\u7684\u7ed3\u679c\u548c\u539f\u56e0\u3002\u4e4b\u540e\uff0c\u6211\u4eec\u5c06\u7ee7\u7eed\u4f7f\u7528JMM\u8fdb\u884c\u5206\u6790\u3002</p> <p>\u4e0b\u9762\u7684\u5e7b\u706f\u7247\u662f\u4e0d\u8a00\u81ea\u660e\u7684\uff0c\u6211\u4eec\u5c06\u8df3\u8fc7\u5b83\u4eec\uff1a</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>\u73b0\u5728\uff0c\u5982\u679c\u6211\u4eec\u66f4\u4ed4\u7ec6\u5730\u7814\u7a76\u8fd9\u4e9b\u89c4\u5219\uff0c\u6211\u4eec\u4f1a\u6ce8\u610f\u5230\u4e00\u4e2a\u6709\u8da3\u7684\u5c5e\u6027\u3002 SO-PO\u4e00\u81f4\u6027\u544a\u8bc9\u6211\u4eecSO\u4e2d\u7684\u6548\u679c\u662f\u53ef\u89c1\u7684\uff0c\u597d\u50cf\u52a8\u4f5c\u662f\u6309\u7a0b\u5e8f\u987a\u5e8f\u5b8c\u6210\u7684\u3002 SO\u4e00\u81f4\u6027\u544a\u8bc9\u6211\u4eec\u8981\u89c2\u5bdfSO\u4e4b\u524d\u7684\u6240\u6709\u52a8\u4f5c\uff0c\u5373\u4f7f\u662f\u90a3\u4e9b\u53d1\u751f\u5728\u4e0d\u540c\u7ebf\u7a0b\u4e2d\u7684\u52a8\u4f5c\u3002\u5c31\u597d\u50cfSO-PO\u4e00\u81f4\u6027\u544a\u8bc9\u6211\u4eec\u9075\u5faa\u7a0b\u5e8f\uff0cSO\u4e00\u81f4\u6027\u5141\u8bb8\u6211\u4eec\u201c\u5728\u7ebf\u7a0b\u4e4b\u95f4\u5207\u6362\u201d\uff0c\u6240\u6709\u6548\u679c\u90fd\u843d\u540e\u4e8e\u6211\u4eec\u3002\u4e0eSO\u7684\u6574\u4f53\u6df7\u5408\uff0c\u6211\u4eec\u5f97\u51fa\u4e00\u4e2a\u6709\u8da3\u7684\u89c4\u5219\uff1a</p> <p></p> <p><code>\u540c\u6b65\u64cd\u4f5c\uff08Synchronization Actions \uff09</code>\u662f<code>\u987a\u5e8f\u4e00\u81f4\uff08sequentially consistent\uff09</code>\u7684\u3002\u5728\u7531<code>volatiles</code>\u7ec4\u6210\u7684\u7a0b\u5e8f\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6ca1\u6709\u6df1\u601d\u719f\u8651\u7684\u60c5\u51b5\u4e0b\u63a8\u65ad\u7ed3\u679c\u3002\u7531\u4e8e<code>SAs</code>\u662f<code>SC</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u6240\u6709\u7684\u52a8\u4f5c\u4ea4\u9519\uff0c\u5e76\u4ece\u4e2d\u627e\u51fa\u7ed3\u679c\u3002\u8bf7\u6ce8\u610f\uff0c\u4e4b\u524d\u6ca1\u6709\u201c\u5148\u53d1\u751f\u8fc7\uff08happens before\uff09\u201d;\u8fd9\u8db3\u4ee5\u8bf4\u660e\u539f\u56e0\u3002</p> <p></p> <p>IRIW\uff08Independent Reads of Independent Writes\uff09\u662fSO\u5c5e\u6027\u7684\u53e6\u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\u3002\u540c\u6837\uff0c\u6240\u6709\u64cd\u4f5c\u90fd\u4f1a\u4ea7\u751f\u540c\u6b65\u64cd\u4f5c\u3002\u53ef\u4ee5\u901a\u8fc7\u679a\u4e3e\u7a0b\u5e8f\u8bed\u53e5\u7684\u6240\u6709\u4ea4\u9519\u6765\u751f\u6210\u7ed3\u679c\u3002\u8be5\u7ed3\u6784\u4ec5\u7981\u6b62\u5355\u4e2a\u56db\u8fb9\u5f62\uff0c\u5c31\u597d\u50cf\u6211\u4eec\u5728\u4e0d\u540c\u7684\u7ebf\u7a0b\u4e2d\u89c2\u5bdf\u5230x\u548cy\u5728\u4e0d\u540c\u987a\u5e8f\u4e2d\u7684\u5199\u5165\u4e00\u6837\u3002</p> <p>\u771f\u6b63\u7684\u5173\u952e\u7531<code>Hans Boehm</code>\u603b\u7ed3\u4e86\u3002\u5982\u679c\u4f60\u91c7\u7528\u4efb\u610f\u7a0b\u5e8f\uff0c\u65e0\u8bba\u5b83\u5305\u542b\u591a\u5c11\u7ade\u4e89\uff0c\u5e76\u5728\u8be5\u7a0b\u5e8f\u5468\u56f4\u6492\u4e0a\u8db3\u591f\u7684volatile\uff0c\u5b83\u6700\u7ec8\u4f1a\u53d8\u5f97\u987a\u5e8f\u4e00\u81f4\uff0c\u5373\u7a0b\u5e8f\u7684\u6240\u6709\u7ed3\u679c\u90fd\u5c06\u7531\u67d0\u4e9bSC\u6267\u884c\u6765\u89e3\u91ca\u3002\u8fd9\u662f\u56e0\u4e3a\u5f53\u6240\u6709\u91cd\u8981\u7684\u7a0b\u5e8f\u64cd\u4f5c\u53d8\u6210\u540c\u6b65\u64cd\u4f5c\u5e76\u4e14\u53d8\u5f97\u5b8c\u5168\u6709\u5e8f\u65f6\uff0c\u60a8\u6700\u7ec8\u4f1a\u9047\u5230\u5173\u952e\u65f6\u523b\uff08Critical moment\uff09\u3002</p> <p></p> <p>\u4ee5\u6211\u4eec\u7684\u7ef4\u6069\u56fe\u7ed3\u675f\uff0cSO\u4e00\u81f4\u6027\u8fc7\u6ee4\u6389\u540c\u6b65\u201c\u9aa8\u67b6\u201d\u7684\u6267\u884c\u3002\u6240\u6709\u5269\u4f59\u6267\u884c\u7684\u7ed3\u679c\u53ef\u4ee5\u901a\u8fc7\u540c\u6b65\u52a8\u4f5c\u7684\u7a0b\u5e8f\u987a\u5e8f\u4e00\u81f4\u4ea4\u9519\u6765\u89e3\u91ca\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#happens-before","title":"Happens-Before","text":"<p>\u867d\u7136\u4e3a\u63a8\u7406\u9879\u76ee\u63d0\u4f9b\u4e86\u826f\u597d\u7684\u57fa\u7840\uff0c\u4f46SO\u8fd8\u4e0d\u8db3\u4ee5\u6784\u5efa\u4e00\u4e2a\u5b9e\u7528\u7684\u5f31\u6a21\u578b\u3002\u8fd9\u5c31\u662f\u539f\u56e0\u3002</p> <p></p> <p>\u8ba9\u6211\u4eec\u5206\u6790\u4e00\u4e2a\u7b80\u5355\u7684\u6848\u4f8b\u3002\u9274\u4e8e\u8fc4\u4eca\u4e3a\u6b62\u6211\u4eec\u6240\u5b66\u5230\u7684\u5173\u4e8eSO\u7684\u6240\u6709\u77e5\u8bc6\uff0c\u6211\u4eec\u662f\u5426\u77e5\u9053\u662f\u5426\u5141\u8bb8\uff081,0\uff09\u7ed3\u679c\uff1f</p> <p></p> <p>\u8ba9\u6211\u4eec\u6765\u770b\u770b\u3002\u7531\u4e8eSO\u53ea\u901a\u8fc7g\u547d\u4ee4\u52a8\u4f5c\uff0c\u6240\u4ee5\u6ca1\u6709\u4ec0\u4e48\u80fd\u963b\u6b62\u6211\u4eec\u4ecex\u8bfb\u53d60\u62161\u3002\u574f...</p> <p></p> <p>\u6211\u4eec\u9700\u8981\u4e00\u4e9b\u4e1c\u897f\u6765\u8fde\u63a5\u7ebf\u7a0b\u72b6\u6001\uff0c\u8fd9\u5c06\u62d6\u52a8\u975eSA\u503c\u3002 SO\u4e0d\u9002\u7528\u4e8e\u6b64\uff0c\u56e0\u4e3a\u4e0d\u6e05\u695a\u5b83\u4f55\u65f6\u4ee5\u53ca\u5982\u4f55\u62d6\u5ef6\u72b6\u6001\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u660e\u786e\u7684SO\u5b50\u5e8f\u5217\u6765\u63cf\u8ff0\u6570\u636e\u6d41\u3002\u6211\u4eec\u79f0\u6b64\u5b50\u987a\u5e8f\u4e0e\u987a\u5e8f\uff08SW\uff09\u540c\u6b65\u3002</p> <p></p> <p>\u6784\u5efaSW\u975e\u5e38\u5bb9\u6613\u3002 SW\u662f\u90e8\u5206\u987a\u5e8f\uff0c\u5e76\u4e0d\u8de8\u8d8a\u6240\u6709\u540c\u6b65\u64cd\u4f5c\u5bf9\u3002\u4f8b\u5982\uff0c\u5373\u4f7f\u6b64\u5e7b\u706f\u7247\u4e0a\u7684g\u4e0a\u7684\u4e24\u4e2a\u64cd\u4f5c\u90fd\u5728SO\u4e2d\uff0c\u5b83\u4eec\u4e5f\u4e0d\u5728SW\u4e2d\u3002</p> <p></p> <p>SW\u4ec5\u914d\u5bf9\u5f7c\u6b64\u201c\u770b\u5230\u201d\u7684\u7279\u5b9a\u52a8\u4f5c\u3002\u66f4\u6b63\u5f0f\u5730\u8bf4\uff0c\u5bf9g\u7684\u6613\u5931\u6027\u5199\u5165\u4e0e\u6765\u81eag\u7684\u6240\u6709\u540e\u7eed\u8bfb\u53d6\u540c\u6b65\u3002 \u201c\u540e\u7eed\u201d\u662f\u6839\u636eSO\u5b9a\u4e49\u7684\uff0c\u56e0\u6b64\u7531\u4e8eSO\u7684\u4e00\u81f4\u6027\uff0c1\u7684\u5199\u5165\u4ec5\u4e0e1\u7684\u8bfb\u53d6\u540c\u6b65\u3002\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u770b\u5230\u4e24\u4e2a\u52a8\u4f5c\u4e4b\u95f4\u7684SW\u3002\u6b64\u5b50\u987a\u5e8f\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u7ebf\u7a0b\u4e4b\u95f4\u7684\u201c\u6865\u6881\u201d\uff0c\u4f46\u9002\u7528\u4e8e\u540c\u6b65\u64cd\u4f5c\u3002\u8ba9\u6211\u4eec\u5c06\u5176\u6269\u5c55\u5230\u5176\u4ed6\u884c\u52a8\u3002</p> <p></p> <p>\u7ebf\u7a0b\u5185\u8bed\u4e49\u7531\u7a0b\u5e8f\u987a\u5e8f\u63cf\u8ff0\u3002\u8fd9\u91cc\u662f\u3002</p> <p></p> <p>\u73b0\u5728\uff0c\u5982\u679c\u6211\u4eec\u6784\u9020PO\u548cSW\u987a\u5e8f\u7684\u5e76\u96c6\uff0c\u7136\u540e<code>\u4f20\u9012\u5173\u95ed\uff08[transitively close](http://en.wikipedia.org/wiki/Transitive_closure)\uff09</code>\u8be5\u8054\u5408\uff0c\u6211\u4eec\u5f97\u5230\u6d3e\u751f\u7684\u987a\u5e8f\uff1aHappens-Before\uff08HB\uff09\u3002\u5728\u8fd9\u4e2a\u610f\u4e49\u4e0a\uff0cHB\u83b7\u53d6\u7ebf\u7a0b\u95f4\u548c\u7ebf\u7a0b\u5185\u8bed\u4e49\u3002 PO\u5c06\u6709\u5173\u6bcf\u4e2a\u7ebf\u7a0b\u5185\u7684\u987a\u5e8f\u64cd\u4f5c\u7684\u4fe1\u606f\u6cc4\u6f0f\u5230HB\u4e2d\uff0c\u5e76\u4e14\u5f53\u72b6\u6001\u201c\u540c\u6b65\u201d\u65f6SW\u6cc4\u6f0f\u3002 HB\u662f\u90e8\u5206\u987a\u5e8f\uff0c\u5141\u8bb8\u4f7f\u7528\u91cd\u65b0\u6392\u5e8f\u7684\u64cd\u4f5c\u6784\u9020\u7b49\u6548\u6267\u884c\u3002</p> <p></p> <p>\u53d1\u751f\u4e4b\u524d\u8fd8\u6709\u53e6\u4e00\u4e2a\u4e00\u81f4\u6027\u89c4\u5219\u3002\u8bb0\u4f4fSO\u4e00\u81f4\u6027\u89c4\u5219\uff0c\u5b83\u89c4\u5b9a\u540c\u6b65\u64cd\u4f5c\u5e94\u8be5\u5728SO\u4e2d\u770b\u5230\u6700\u65b0\u7684\u76f8\u5173\u5199\u5165\u3002\u53d1\u751f\u4e4b\u524d\u7684\u4e00\u81f4\u6027\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7c7b\u4f3c\u4e8eHB\u987a\u5e8f\uff1a\u5b83\u89c4\u5b9a\u4e86\u7279\u5b9a\u8bfb\u53d6\u53ef\u4ee5\u89c2\u5bdf\u5230\u7684\u5199\u5165\u3002</p> <p></p> <p>HB\u4e00\u81f4\u6027\u5728\u5141\u8bb8\u7ade\u4e89\u4e2d\u5f88\u6709\u610f\u601d\u3002\u5982\u679c\u6ca1\u6709\u6bd4\u8d5b\uff0c\u6211\u4eec\u53ea\u80fd\u770b\u5230HB\u4e2d\u6700\u65b0\u7684\u524d\u4e00\u6b21\u5199\u5165\u3002\u4f46\u662f\u5982\u679c\u6211\u4eec\u5728HB\u4e2d\u5bf9\u4e8e\u7ed9\u5b9a\u7684\u8bfb\u53d6\u8fdb\u884c\u65e0\u5e8f\u5199\u5165\uff0c\u90a3\u4e48\u6211\u4eec\u4e5f\u53ef\u4ee5\u770b\u5230\uff08racy\uff09\u5199\u5165\u3002\u8ba9\u6211\u4eec\u66f4\u4e25\u683c\u5730\u5b9a\u4e49\u5b83\u3002</p> <p>\u7b2c\u4e00\u90e8\u5206\u662f\u76f8\u5f53\u8f7b\u677e\u7684\uff1a\u6211\u4eec\u88ab\u5141\u8bb8\u89c2\u5bdf\u53d1\u751f\u5728\u6211\u4eec\u9762\u524d\u7684\u5199\u5165\uff0c\u6216\u4efb\u4f55\u5176\u4ed6\u65e0\u5e8f\u5199\uff08\u8fd9\u662f\u4e00\u573a\u6bd4\u8d5b\uff09\u3002\u8fd9\u662f\u8be5\u6a21\u578b\u7684\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u5c5e\u6027\uff1a\u6211\u4eec\u7279\u522b\u5141\u8bb8\u6bd4\u8d5b\uff0c\u56e0\u4e3a\u6bd4\u8d5b\u53d1\u751f\u5728\u73b0\u5b9e\u4e16\u754c\u4e2d\u3002\u5982\u679c\u6211\u4eec\u7981\u6b62\u6a21\u578b\u4e2d\u7684\u6bd4\u8d5b\uff0c\u8fd0\u884c\u65f6\u5c06\u5f88\u96be\u4f18\u5316\u4ee3\u7801\uff0c\u56e0\u4e3a\u4ed6\u4eec\u9700\u8981\u5728\u4efb\u4f55\u5730\u65b9\u5f3a\u5236\u6267\u884c\u547d\u4ee4\u3002 \u8bf7\u6ce8\u610f\uff0c\u5728HB\u987a\u5e8f\u8bfb\u53d6\u540e\uff0c\u5982\u4f55\u7981\u6b62\u770b\u5230\u5199\u5165\u7684\u5199\u5165\u3002</p> <p></p> <p>\u7b2c\u4e8c\u90e8\u5206\u5bf9\u770b\u5230\u524d\u9762\u7684\u5199\u5165\u63d0\u51fa\u4e86\u989d\u5916\u7684\u7ea6\u675f\uff1a\u6211\u4eec\u53ea\u80fd\u770b\u5230\u6700\u65b0\u7684\u5199\u5165\u53d1\u751f\u5728\u5148\u524d\u7684\u987a\u5e8f\u3002\u4e4b\u524d\u7684\u4efb\u4f55\u5176\u4ed6\u5199\u4f5c\u5bf9\u6211\u4eec\u6765\u8bf4\u90fd\u662f\u4e0d\u53ef\u89c1\u7684\u3002\u56e0\u6b64\uff0c\u5728\u6ca1\u6709\u6bd4\u8d5b\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ea\u80fd\u770b\u5230\u6700\u65b0\u7684HB\u7f16\u5199\u3002</p> <p></p> <p>HB\u4e00\u81f4\u6027\u7684\u7ed3\u679c\u662f\u8fc7\u6ee4\u6389\u53e6\u4e00\u4e2a\u6267\u884c\u5b50\u96c6\uff0c\u5b83\u4eec\u89c2\u5bdf\u6211\u4eec\u5141\u8bb8\u4ed6\u4eec\u89c2\u5bdf\u7684\u5185\u5bb9\u3002 HB\u6269\u5c55\u4e86\u975e\u540c\u6b65\u64cd\u4f5c\uff0c\u56e0\u6b64\u5141\u8bb8\u6a21\u578b\u5305\u542b\u6267\u884c\u4e2d\u7684\u6240\u6709\u64cd\u4f5c\u3002</p> <p></p> <p>\u8fd9\u5c31\u662fSC-DRF\u7684\u5168\u90e8\u5185\u5bb9\uff1a\u5982\u679c\u6211\u4eec\u5728\u7a0b\u5e8f\u4e2d\u6ca1\u6709\u7ade\u4e89 - \u4e5f\u5c31\u662f\u8bf4\uff0c\u6240\u6709\u7684\u8bfb\u5199\u90fd\u662f\u6309SO\u6216HB\u6392\u5e8f\u7684 - \u90a3\u4e48\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u7ed3\u679c\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u987a\u5e8f\u4e00\u81f4\u7684\u6267\u884c\u6765\u89e3\u91ca\u3002\u6709\u4e00\u4e2aSC-DRF\u5c5e\u6027\u7684\u6b63\u5f0f\u8bc1\u660e\uff0c\u4f46\u6211\u4eec\u5c06\u4f7f\u7528\u76f4\u89c2\u7684\u7406\u89e3\u4e3a\u4ec0\u4e48\u8fd9\u5e94\u8be5\u662f\u771f\u7684\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#happens-before-publication","title":"Happens-Before: Publication","text":"<p>\u4e0a\u9762\u7684\u4f8b\u5b50\u76f8\u5f53\u9ad8\u6df1\uff0c\u4f46\u8fd9\u5c31\u662f\u8bed\u8a00\u89c4\u8303\u7684\u5b9a\u4e49\u65b9\u5f0f\u3002\u8ba9\u6211\u4eec\u770b\u4e00\u4e0b\u8fd9\u4e2a\u4f8b\u5b50\u6765\u66f4\u76f4\u89c2\u5730\u7406\u89e3\u8fd9\u4e00\u70b9\u3002\u4f7f\u7528\u76f8\u540c\u7684\u4ee3\u7801\u793a\u4f8b\uff0c\u5e76\u4f7f\u7528HB\u4e00\u81f4\u6027\u89c4\u5219\u8fdb\u884c\u5206\u6790\u3002</p> <p></p> <p>\u8fd9\u79cd\u6267\u884c\u5728\u4e00\u81f4\u4e4b\u524d\u53d1\u751f\uff1aread\uff08x\uff09\u89c2\u5bdfHB\u4e2d\u7684\u6700\u65b0\u5199\u5165\u3002\u7ed3\u679c\uff081,1\uff09\u56e0\u6b64\u662f\u5408\u7406\u7684\u3002</p> <p></p> <p>\u8fd9\u4e2a\u6267\u884c\u662f\u5728\u4e00\u81f4\u4e4b\u524d\u53d1\u751f\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u8bfb\u53d6\u4e86x\u7684\u9ed8\u8ba4\u503c\u3002\u6211\u4eec\u7701\u7565\u4e86HB\u8fb9\u7f18\u7684\u9ed8\u8ba4\u521d\u59cb\u5316\uff0c\u5b83\u4e0e\u6b64\u56fe\u8868\u4e0a\u7684\u7ebf\u7a0b\u4e2d\u7684\u7b2c\u4e00\u4e2a\u64cd\u4f5c\u540c\u6b65\u3002</p> <p></p> <p>\u6709\u4e9b\u4ee4\u4eba\u60ca\u8bb6\u7684\u662f\uff0c\u5373\u4f7f\u5728\u8bfb\u53d6\u548c\u5199\u5165x\u4e4b\u95f4\u6ca1\u6709\u4f20\u9012\u6027HB\uff0c\u7ed3\u679c\uff080,1\uff09\u7684\u6267\u884c\u4e5f\u4f1a\u5728\u4e00\u81f4\u4e4b\u524d\u53d1\u751f\u3002\u6211\u4eec\u53ea\u662f\u901a\u8fc7\u6bd4\u8d5b\u8bfb\u53d6\u503c - \u8bb0\u4f4fHB\u4e00\u81f4\u6027\u5b9a\u4e49\u7684\u7b2c\u4e00\u90e8\u5206\u3002</p> <p></p> <p>\u5e76\u4e14\u6b64\u6267\u884c\u4e0d\u80fd\u9075\u5b88HB\u4e00\u81f4\u6027\uff0c\u56e0\u6b64\u4e0d\u80fd\u7528\u4e8e\u63a8\u65ad\u7a0b\u5e8f\u7ed3\u679c\u3002\u56e0\u6b64\u8fd9\u79cd\u7ed3\u679c\u662f\u4e0d\u53ef\u80fd\u7684\u3002\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u4ece\u56db\u4e2a\u53ef\u80fd\u7684\u7ed3\u679c\u4e2d\u6d88\u9664\u4e86\uff081,0\uff09\uff0c\u8fd9\u5b9e\u9645\u4e0a\u610f\u5473\u7740\u6211\u4eec\u88ab\u8feb\u5c06x\u89c6\u4e3a1\uff0c\u5982\u679c\u6211\u4eec\u5c06g\u89c6\u4e3a1\u3002</p> <p></p> <p>\u60f3\u8981\u786e\u5b9a\u5b9e\u9645\u7a0b\u5e8f\u7684HB\u547d\u4ee4\u4f1a\u4f24\u5bb3\u8111\u7ec6\u80de\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa\u4e00\u4e9b\u7b80\u5355\u7684\u89c4\u5219\u3002\u540c\u6b65\u8fb9\u7f18\u7684\u6765\u6e90\u79f0\u4e3a\u201c\u91ca\u653e\u201d\uff0c\u76ee\u7684\u5730\u79f0\u4e3a\u201c\u83b7\u53d6\u201d\u3002 HB\u5305\u542bSW\uff0c\u56e0\u6b64\u8de8\u8d8a\u4e0d\u540c\u7ebf\u7a0b\u7684HB\u4e5f\u4ece\u201crelease\u201d\u5f00\u59cb\uff0c\u4ee5\u201cacquire\u201d\u7ed3\u675f\u3002</p> <p>\u53ef\u4ee5\u5c06\u91ca\u653e\u89c6\u4e3a\u5c06\u6240\u6709\u5148\u524d\u72b6\u6001\u66f4\u65b0\u91ca\u653e\u5230\u91ce\u5916\u7684\u64cd\u4f5c\uff0c\u5e76\u4e14\u83b7\u53d6\u662f\u63a5\u6536\u8fd9\u4e9b\u66f4\u65b0\u7684\u914d\u5bf9\u64cd\u4f5c\u3002\u56e0\u6b64\uff0c\u5728\u6210\u529f\u83b7\u5f97\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u914d\u5bf9\u7248\u672c\u4e4b\u524d\u7684\u6240\u6709\u66f4\u65b0\u3002</p> <p>\u7531\u4e8e\u6211\u4eec\u4e4b\u524d\u63d0\u51fa\u7684\u6784\u9020\uff0c\u5b83\u53ea\u6709\u5728\u83b7\u53d6/\u91ca\u653e\u53d1\u751f\u5728\u540c\u4e00\u4e2a\u53d8\u91cf\u4e0a\u65f6\u624d\u6709\u6548\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u770b\u5230\u4e86\u5199\u5165\u7684\u503c\u3002\u4e0b\u9762\u7684\u6d4b\u9a8c\u8fdb\u4e00\u6b65\u63a2\u8ba8\u4e86\u8fd9\u4e00\u70b9\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#happens-before-test-your-understanding","title":"Happens-Before: Test Your Understanding","text":"<p>\u8ba9\u6211\u4eec\u5728\u8fd9\u91cc\u66f4\u73b0\u5b9e\u5730\u73a9\u3002\u5047\u8bbe\u4f60\u6709\u4e00\u4e2a\u5305\u88c5\u7c7b\uff0c\u5b83\u5b58\u50a8\uff08\uff08\u90ae\u4ef6\uff09\u76d2\u5b50\uff09\u7c7b\u578bT\u7684\u4e00\u4e9b\u503c\u3002\u663e\u7136\uff0c\u4f60\u6709\u4e00\u4e2a\u53d6\u503c\u7684setter\uff0c\u4ee5\u53ca\u8fd4\u56de\u5b83\u7684getter\u3002\u5728\u5927\u591a\u6570\u7a0b\u5e8f\u4e2d\uff0c\u8bfb\u53d6\u6570\u91cf\u8fdc\u8fdc\u591a\u4e8e\u5199\u5165\uff08\u5426\u5219\u4e3a\u4ec0\u4e48\u8981\u5b58\u50a8\u503c\uff1f\uff09\uff0c\u56e0\u6b64\u540c\u6b65\u7684getter\u53ef\u80fd\u4f1a\u6210\u4e3a\u53ef\u4f38\u7f29\u6027\u74f6\u9888\u3002</p> <p></p> <p>\u4eba\u4eec\u5e26\u7740\u4ed6\u4eec\u7684\u5206\u6790\u5668\uff0c\u67e5\u770b\u4ee3\u7801\u5e76\u4e89\u8bba\uff1a\u597d\u5427\uff0c\u5b83\u53ea\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u503cT\uff0c\u6211\u4eec\u5c06\u5b83\u5b58\u50a8\u5728\u540c\u6b65\u4e2d\uff0c\u7f13\u5b58\u901a\u8fc7\u540c\u6b65\u5237\u65b0\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u8df3\u8fc7\u8bfb\u53d6\u65f6\u7684\u540c\u6b65\u3002 \u771f\u7684\u5417\uff1f\u7b54\u6848\uff08\u9009\u62e9\u7ed3\u675f\u663e\u793a\uff09\uff1a\u5728\u8bbe\u7f6e\u5668\u4e2d\u786e\u5b9e\u6709\u4e00\u4e2a\u5173\u4e8e\u76d1\u89c6\u5668\u89e3\u9501\u7684\u91ca\u653e\u64cd\u4f5c\uff0c\u4f46\u662fgetter\u4e2d\u7f3a\u5c11\u83b7\u53d6\u64cd\u4f5c\u3002\u56e0\u6b64\uff0c\u5728\u6211\u4eec\u8bfb\u53d6\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u4e2d\u7684val\u4e4b\u540e\uff0c\u5185\u5b58\u6a21\u578b\u5e76\u6ca1\u6709\u8981\u6c42\u5c06\u5b58\u50a8\u5230val\u4e4b\u524d\u5b58\u50a8\u7684\u503c\u53ef\u89c1 - \u5982\u679c\u90a3\u4e9b\u662f\u5b58\u50a8\u5230val\u5b57\u6bb5\u4e2d\u5219\u975e\u5e38\u574f\u7684\u6d88\u606f\u3002</p> <p></p> <p>\u8bf4\u6ca1\u6709\u83b7\u5f97\u5c4f\u969c\u5417\uff1f\u597d\u5427\uff0c\u8ba9\u6211\u4eec\u6dfb\u52a0\u4e00\u4e2a\uff0c\u56e0\u4e3a\u6211\u4eec\u201c\u77e5\u9053\u201d\u7f16\u8bd1\u5668\u4e3a\u6613\u5931\u6027\u8bfb\u53d6\u53d1\u51fa\u4e00\u4e2a\u3002 \u8fd9\u574f\u4e86\u5417\uff1f\u5982\u679c\u662f\u8fd9\u6837\uff0c\u4e3a\u4ec0\u4e48\uff1f\u56de\u7b54\uff08\u9009\u62e9\u7ed3\u675f\u4ee5\u663e\u793a\uff09\uff1a\u5728\u5f53\u524d\u7684\u5b9e\u8df5\u4e2d\uff0c\u5b83\u9002\u7528\u4e8e\u7ed9\u5b9a\u7684\u4fdd\u5b88VM\u5b9e\u73b0\uff0c\u4f46\u662fJMM\u65b9\u9762\uff0c\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709\u50cf\u53d1\u5e03\u65f6\u90a3\u6837\u83b7\u53d6\u76f8\u540c\u7684\u53d8\u91cf\uff0c\u6240\u4ee5\u4e0d\u80fd\u4fdd\u8bc1\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u66f4\u667a\u80fd\u7684VM\u53ef\u4ee5\u770b\u5230\u60a8\u4e0d\u4f7f\u7528\u4e0b\u6c89\u503c\uff0c\u56e0\u6b64\u53ef\u4ee5\u5047\u88c5\u6211\u4eec\u6ca1\u6709\u770b\u5230\u5c4f\u969c\u7684\u66f4\u65b0\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\uff0c\u5e76\u5b8c\u5168\u6d88\u9664\u5b83\u3002</p> <p></p> <p>\u8fd9\u662f\u4e00\u79cd\u6b63\u786e\u7684\u65b9\u6cd5\u3002\u5c06\u5b57\u6bb5\u6807\u8bb0\u4e3avolatile\u53ef\u5728setter\u4e2d\u63d0\u4f9b\u91ca\u653e\u64cd\u4f5c\uff0c\u5e76\u5728getter\u4e2d\u63d0\u4f9b\u5df2\u914d\u5bf9\u7684\u83b7\u53d6\u3002\u8fd9\u5141\u8bb8\u6211\u4eec\u5728getter\u4e2d\u540c\u6b65\u653e\u677e\uff0c\u5e76\u4e14\u53ea\u7559\u4e0b\u8f7b\u91cf\u7ea7\u7684volatile\u3002 \u662f\u5426\u4ecd\u9700\u8981\u5728setter\u4e2d\u540c\u6b65\uff1f\u56de\u7b54\uff08\u9009\u62e9\u7ed3\u675f\u663e\u793a\uff09\uff1a\u662f\u7684\uff0c\u56e0\u4e3asetter\u9700\u8981\u4e92\u65a5\uff1a\u5b83\u5e94\u8be5\u53ea\u8bbe\u7f6e\u4e00\u6b21val\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#jmm-interpretation-roach-motel","title":"JMM Interpretation: Roach Motel","text":"<p>\u4f18\u5316\u7f16\u8bd1\u5668\u53ef\u80fd\u5f88\u96be\u786e\u5b9a\u7279\u5b9a\u4f18\u5316\u662f\u5426\u7834\u574f\u4e86JMM\u7684\u89c4\u5b9a\u3002\u4e00\u4e9b\u9ad8\u7ea7\u7f16\u8bd1\u5668\u53ef\u4ee5\u76f4\u63a5\u6784\u9020\u5185\u5b58\u6d41\u3002\u4f46\u662f\uff0c\u57fa\u672c\u7f16\u8bd1\u5668\u4eba\u5458\u9700\u8981\u4e00\u7ec4\u7b80\u5355\u7684\u89c4\u5219\u6765\u786e\u5b9a\u662f\u5426\u5141\u8bb8\u67d0\u4e9b\u5185\u5bb9\u3002 JSR 133\u4e13\u5bb6\u7ec4\u521b\u5efa\u4e86JSR 133 Cookbook for Compiler Writers\u6765\u6db5\u76d6\u8fd9\u4e00\u70b9\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cCookbook\u662f\u4e00\u5957\u4fdd\u5b88\u7684\u89e3\u91ca\uff0c\u800c\u4e0d\u662fJMM\u672c\u8eab\u3002\u6211\u4eec\u5c06\u7b80\u8981\u8ba8\u8bba\u5982\u4f55\u5f97\u51fa\u8fd9\u4e9b\u89e3\u91ca\u3002</p> <p>\u8003\u8651\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u6a21\u677f\u6267\u884c\u6765\u8868\u793a\u3002\u524d\u4e24\u79cd\u91cd\u65b0\u6392\u5e8f\u5f88\u7b80\u5355\uff1a</p> <p></p> <p></p> <p></p> <p>\u8fd9\u4e9b\u89c4\u5219\u6709\u6548\u5730\u5141\u8bb8\u5c06\u4ee3\u7801\u63a8\u9001\u5230\u83b7\u53d6/\u91ca\u653e\u5757\u4e2d\uff0c\u4f8b\u5982\uff0c\u5c06\u4ee3\u7801\u63a8\u5165\u9501\u5b9a\u533a\u57df\uff0c\u8fd9\u53ef\u4ee5\u5728\u4e0d\u8fdd\u53cdJMM\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u9501\u5b9a\u7c97\u5316\u3002</p> <p>\u4fdd\u5b88\u5730\u7981\u6b62\u53e6\u5916\u4e24\u79cd\u7c7b\u578b\u7684\u91cd\u65b0\u6392\u5e8f\u3002\u8bf7\u6ce8\u610f\uff0cJMM\u672c\u8eab\u5e76\u4e0d\u7981\u6b62\u5b83\u4eec\uff0c\u4f46\u5982\u679c\u672c\u5730\u5206\u6790\u65e0\u6cd5\u786e\u5b9a\u6b63\u786e\u6027\uff0c\u5219\u5fc5\u987b\u7981\u6b62\u5b83\u4eec\uff08\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4f8b\u5982\u6784\u9020\u51fd\u6570\u4e2d\u7684\u5b57\u6bb5\u5b58\u50a8\uff0c\u5b83\u53ef\u4ee5\uff09\uff1a</p> <p></p> <p></p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#test-your-understanding_2","title":"Test Your Understanding","text":"<p>\u8ba9\u6211\u4eec\u518d\u8bd5\u4e00\u6b21\u771f\u5b9e\u7684\u4f8b\u5b50\u3002 \u8fd9\u6bb5\u4ee3\u7801\u53ef\u4ee5\u6253\u5370\u4ec0\u4e48\uff1f\u7b54\u6848\uff08\u9009\u62e9\u7ed3\u675f\u663e\u793a\uff09\uff1a\u5b58\u50a8\u5c31\u7eea\u4e4b\u95f4\u5b58\u5728\u540c\u6b65\u8fb9\u7f18\uff0c\u5e76\u4e14\u8bfb\u53d6\u5c31\u7eea== true\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230HB\u987a\u5e8f\u4e2d\u7684\u6700\u65b0\u5199\u5165\uff0c\u537342\u3002\u4f46\u662f\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u770b\u5230\u8d85\u51faHB\uff08racy\uff09\u7684\u5199\u5165\uff0c\u8fd9\u4e5f\u7ed9\u6211\u4eec\u5e26\u6765\u4e8643\u3002</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u53bb\u6389volatile\u3002 \u8fd9\u6bb5\u4ee3\u7801\u53ef\u4ee5\u6253\u5370\u4ec0\u4e48\uff1f\u7b54\u6848\uff08\u9009\u62e9\u7ed3\u675f\u663e\u793a\uff09\uff1a\u4efb\u4f55\u503c\u90fd\u662f\u53ef\u80fd\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7ade\u8d5b\u89c2\u5bdf\u4efb\u4f55\u503c\uff0c\u5e76\u4e14\u5982\u679cwhile\u5faa\u73af\u51cf\u5c11\u5230while\uff08true\uff09\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u770b\u4e0d\u5230\u4efb\u4f55\u503c\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#benchmarks","title":"Benchmarks","text":"<p>\u5f53\u7136\uff0c\u5728\u6ca1\u6709\u57fa\u51c6\u6d4b\u8bd5\u7684\u60c5\u51b5\u4e0b\u53d1\u5e03\u4efb\u4f55\u5185\u5bb9\u7684\u7528\u9014\u662f\u4ec0\u4e48\uff1f\u6211\u4eec\u60f3\u8981\u91cf\u5316\u81f3\u5c11\u4e00\u4e9b\u6210\u672c\u3002\u6d4b\u91cf\u7edd\u5bf9\u6570\u5b57\u5e76\u4e0d\u662f\u4e00\u4e2a\u597d\u4e3b\u610f\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u4f1a\u5c55\u793a\u4e00\u4e9b\u91cd\u8981\u7684\u9ad8\u7ea7\u522b\u8981\u70b9\u3002\u57fa\u51c6\u6d4b\u8bd5\u7531JMH\u9a71\u52a8\uff0c\u6211\u4eec\u5047\u8bbe\u60a8\u719f\u6089\u5b83\u3002</p> <p>\u8ba9\u6211\u4eec\u4ece\u201c\u63d0\u5347\u201d\u57fa\u51c6\u5f00\u59cb\u3002\u6211\u4eec\u5e0c\u671b\u8fd0\u884c\u4e00\u4e2a\u5929\u8d4b\u8ba1\u7b97v\u6b21v\u7684\u7efc\u5408\u6d4b\u8bd5\u3002\u533a\u522b\u5728\u4e8e\u5e95\u5c42\u5b58\u50a8\u7684\u5171\u4eab\u548cv\u6613\u53d8\u6027\u3002\u6beb\u4e0d\u5947\u602a\uff0c\u5f53\u6211\u4eec\u9605\u8bfb\u5185\u5bb9\u65f6\uff0c\u5206\u4eab\u4f3c\u4e4e\u5e76\u4e0d\u91cd\u8981\u3002</p> <p>Volatile\u6d4b\u8bd5\u7528\u4f8b\u660e\u663e\u53d8\u6162\u3002\u7136\u800c\uff0c\u5b83\u5e76\u4e0d\u662f\u6325\u53d1\u7269\u672c\u8eab\u7684\u6210\u672c\uff0c\u800c\u662f\u8fc7\u4e8e\u4fdd\u5b88\u7684\u5b9e\u65bd\u8bc1\u660e\u4e86\u5c06s.v\u63a8\u51fa\u5faa\u73af\u7684\u8bc1\u636e\uff0c\u8fd9\u5c06\u5728\u6536\u8d2d\u4e4b\u524d\u79fb\u52a8\u8bfb\u6570\uff08\u53c2\u89c1\u4e0a\u9762\u7684\u201c\u7f57\u5947\u6c7d\u8f66\u65c5\u9986\u201d\uff09\u3002\u5c06s.v\u9884\u8bfb\u6210\u5c40\u90e8\u53d8\u91cf\u5e76\u518d\u6b21\u6d4b\u91cf\u662f\u7559\u7ed9\u8bfb\u8005\u7684\u7ec3\u4e60\u3002</p> <p></p> <p></p> <p>\u5bf9\u4e8e\u5199\u5165\u6d4b\u8bd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u9012\u589e\u76f8\u540c\u7684\u53d8\u91cf\u3002\u6211\u4eec\u505a\u4e86\u4e00\u4e9b\u9000\u907f\u4ee5\u505c\u6b62\u4f7f\u7528\u5199\u5165\u6765\u62a8\u51fb\u7cfb\u7edf\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u89c2\u5bdf\u5171\u4eab/\u975e\u5171\u4eab\u60c5\u51b5\u4e4b\u95f4\u4ee5\u53ca\u6613\u5931\u6027/\u975e\u6613\u5931\u6027\u60c5\u51b5\u4e4b\u95f4\u7684\u5dee\u5f02\u3002\u4eba\u4eec\u53ef\u80fd\u4f1a\u8ba4\u4e3a\u4e0d\u7a33\u5b9a\u7684\u6d4b\u8bd5\u4f1a\u5168\u9762\u5931\u8d25\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5171\u4eab\u6d4b\u8bd5\u6b63\u5728\u5931\u8d25\u3002\u8fd9\u5f3a\u5316\u4e86\u6570\u636e\u5171\u4eab\u9996\u5148\u5e94\u8be5\u907f\u514d\u7684\u60f3\u6cd5\uff0c\u800c\u4e0d\u662fvolatiles\u3002</p> <p></p> <p></p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#jmm-updates_2","title":"JMM Updates","text":"<p>\u76ee\u524d\u7684\u4e3b\u6d41\u8bed\u8a00\u4f3c\u4e4e\u5168\u9762\u91c7\u7528SC-DRF\u3002\u4f46\u662f\uff0c\u6709\u8bc1\u636e\u8868\u660e\u4e25\u683c\u652f\u6301SC-DRF\u53ef\u80fd\u5bf9\u6240\u6709\u60c5\u51b5\u90fd\u4e0d\u5229\u3002\u4f8b\u5982\uff0cLinux RCU\u653e\u677e\u4e86\u4e00\u4e9b\u7ea6\u675f\uff0c\u5728\u5f31\u6709\u5e8f\u7684\u5e73\u53f0\u4e0a\u6709\u975e\u5e38\u597d\u7684\u6027\u80fd\u6539\u8fdb\uff0c\u53ef\u4ee5\u8bf4\u8fd9\u6837\u505a\u800c\u4e0d\u4f1a\u7834\u574f\u53ef\u7528\u6027\u3002 \u56e0\u6b64\uff0c\u4e0b\u4e00\u4e2aJMM\u66f4\u65b0\u7684\u95ee\u9898\u662f\uff1a\u6211\u4eec\u662f\u5426\u5e94\u8be5\u653e\u677eSC-DRF\u4ee5\u83b7\u5f97\u66f4\u9ad8\u7684\u6027\u80fd\uff1f</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#part-iv-out-of-thin-air","title":"Part IV: Out of Thin Air","text":""},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#_9","title":"\u6211\u4eec\u60f3\u8981\u4ec0\u4e48","text":"<p>\u4f3c\u4e4eSC-DRF\u6210\u7acb\u540e\uff0c\u6211\u4eec\u5f88\u9ad8\u5174\u3002\u4efb\u4f55\u8f6c\u6362\u5728\u540c\u6b65\u64cd\u4f5c\u4e4b\u95f4\u90fd\u662f\u6709\u6548\u7684\uff0c\u56e0\u4e3a\u5982\u679c\u4ee3\u7801\u4e2d\u5b58\u5728\u672a\u6ce8\u91ca\u7684\u7ade\u4e89\uff0c\u5219\u884c\u4e3a\u662f\u975eSC\u5f00\u59cb\u7684\u3002\u6559\u5bfc\u8fd0\u884c\u65f6SC-DRF\u89c4\u5219\uff0c\u4f60\u5f88\u597d\uff0c\u5bf9\u5417\uff1f</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#_10","title":"\u6211\u4eec\u6709\u4ec0\u4e48","text":"<p>\u4f46\u662f\uff0c\u8fd9\u53ea\u662f\u4e8b\u5b9e\u7684\u4e00\u90e8\u5206\u3002\u4e00\u4e9b\u8f6c\u53d8\u4ecd\u7136\u7834\u574f\u4e86SC\u3002\u8003\u8651\u4e00\u4e0b\u8fd9\u4e2a\u7a0b\u5e8f\uff1a\u6709\u70b9\u4ee4\u4eba\u60ca\u8bb6\u7684\u662f\uff0c\u5b83\u662f\u6b63\u786e\u540c\u6b65\u7684\uff0c\u56e0\u4e3a\u6240\u6709SC\u6267\u884c\u90fd\u6ca1\u6709\u6bd4\u8d5b\uff0c\u552f\u4e00\u53ef\u80fd\u7684\u7ed3\u679c\u662f\uff080,0\uff09</p> <p></p> <p>\u73b0\u5728\uff0c\u4f18\u5316\u8fd0\u884c\u65f6/\u786c\u4ef6\u8fdb\u5165\u5e76\u5c1d\u8bd5\u63a8\u6d4b\u5206\u652f\u3002\u5982\u679c\u63a8\u6d4b\u5931\u8d25\uff0c\u6709\u65f6\u63a8\u6d4b\u6027\u5730\u6267\u884c\u5206\u652f\u5e76\u9000\u56de\u53ef\u80fd\u662f\u4e00\u4e2a\u597d\u4e3b\u610f\u3002 \u5047\u8bbe\u6211\u4eec\u5728\u4ee3\u7801\u4e2d\u505a\u4e86\u8fd9\u4e2a\u63a8\u6d4b\u3002</p> <p></p> <p>\u6211\u4eec\u73b0\u5728\u6267\u884c\u4fee\u6539\u540e\u7684\u7a0b\u5e8f\u3002\u7b2c\u4e8c\u4e2a\u7ebf\u7a0b\u672a\u7ecf\u4fee\u6539\u8fd0\u884c\u3002\u5982\u679c\u6211\u4eec\u6309\u7167\u5e7b\u706f\u7247\u4e0a\u63cf\u8ff0\u7684\u987a\u5e8f\u8fd0\u884c\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u6211\u4eec\u5c06\u6709\uff0842,42\uff09\uff0c\u56e0\u4e3a\u731c\u6d4b\u5df2\u7ecf\u53d8\u6210\u4e86\u81ea\u6211\u8fa9\u89e3\u7684\u9884\u8a00\uff01\u597d\u50cf42\u4f3c\u4e4e\u662f\u51ed\u7a7a\u4ea7\u751f\u7684\u3002 \u8fd9\u4e2a\u4f8b\u5b50\u4f3c\u4e4e\u662f\u4eba\u4e3a\u7684\uff0c\u76f4\u5230\u4f60\u610f\u8bc6\u5230\u53d8\u91cfa\u5f88\u5bb9\u6613\u5c31\u662fSystem.securityManager\uff0c\u800c\u6211\u4eec\u521a\u521a\u7834\u574f\u4e86\u5e73\u53f0\u5b89\u5168\u4fdd\u969c\uff01\u53ef\u6015\u3002</p> <p></p> <p>\u4e3a\u4e86\u5f25\u8865\u8fd9\u4e00\u70b9\uff0cJMM\u7981\u6b62\u8d85\u8584\uff08OoTA\uff09\u503c\u3002\u4e3a\u4e86\u5efa\u8bbe\u6027\u5730\u7981\u6b62OoTA\uff0c\u4f60\u9700\u8981\u4e00\u4e9b\u56e0\u679c\u5173\u7cfb\u7684\u6982\u5ff5\uff08\u5373\u201c\u4ec0\u4e48\u9020\u6210\u4e86\u4ec0\u4e48\u201d\uff09\uff0c\u8fd9\u5728\u8bd5\u56fe\u6446\u8131\u5168\u7403\u65f6\u95f4\u7684\u81f4\u547d\u62e5\u62b1\u7684\u6a21\u578b\u4e2d\u5f15\u5165\u662f\u68d8\u624b\u7684\u3002</p> <p></p> <p>JLS 17.4.8\u4e2d\u7684\u6574\u4e2a\u90e8\u5206\u8bd5\u56fe\u4e25\u683c\u6307\u5b9a\u201c\u63d0\u4ea4\u8bed\u4e49\u201d\uff0c\u8fd9\u53e6\u5916\u9a8c\u8bc1\u4e86\u56e0\u679c\u5173\u7cfb\u8fdd\u89c4\u7684\u6267\u884c\u3002\u6211\u4eec\u4e0d\u4f1a\u5728\u8fd9\u91cc\u6df1\u5165\u4e86\u89e3\u7ec6\u8282\uff0c\u6240\u4ee5\u8bf7\u5c3d\u60c5\u4eab\u53d7\u8fd9\u4e2a\u770b\u8d77\u6765\u50cfBill\u7684\u597d\u4eba\u3002</p> <p></p> <p>\u63d0\u4ea4\u8bed\u4e49\u7ed9\u51fa\u4e86\u6267\u884c\u6c64\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u8fc7\u6ee4\u5668\u3002\u8fdd\u53cd\u56e0\u679c\u5173\u7cfb\u8981\u6c42\u7684\u6267\u884c\u4e0d\u80fd\u7528\u4e8e\u63a8\u7406\u8be5\u7a0b\u5e8f\u3002</p> <p></p> <p>\u8fd9\u5c06\u6211\u4eec\u5e26\u5230\u6700\u540e\u7684\u753b\u9762\u3002\u4e3a\u4e86\u6d4b\u8bd5JMM\u4e0b\u7684\u6267\u884c\u662f\u5426\u5408\u7406\uff0c\u60a8\u9700\u8981\u67e5\u770b\u5b83\u662f\u5426\u901a\u8fc7\u4e86\u6240\u6709\u8981\u6c42\u3002\u4f46\u8bf7\u6ce8\u610f\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u7279\u5b9a\u6d4b\u8bd5\u7684\u5931\u8d25\u5feb\u901f\u5206\u652f\u5e76\u7ed1\u5b9a\u6240\u8003\u8651\u7684\u6267\u884c\u96c6\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u751a\u81f3\u4e0d\u4f1a\u63d0\u4ea4\u8bed\u4e49\uff0c\u56e0\u4e3a\u901a\u8fc7\u5176\u4ed6\u8fc7\u6ee4\u5668\u7684\u6240\u6709\u6267\u884c\u90fd\u53ea\u4ea7\u751f\u4e86\u9884\u671f\u7684\u7ed3\u679c\uff0c\u6211\u4eec\u4e0d\u518d\u5173\u5fc3\u5b83\u4eec\u4e86\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#oota-and-cc","title":"OoTA and C/C++","text":"<p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5230\u76ee\u524d\u4e3a\u6b62\uff0cJava\u4f3c\u4e4e\u662f\u552f\u4e00\u8bd5\u56fe\u6307\u5b9aOoTA\u771f\u6b63\u542b\u4e49\u7684\u5e73\u53f0\u3002\u8003\u8651\u5230\u975e\u5e38\u590d\u6742\u4e14\u6709\u65f6\u53cd\u76f4\u89c9\u7684\u56e0\u679c\u5173\u7cfb\u6a21\u578b\uff0c\u5e76\u975eJava\u975e\u5e38\u6210\u529f\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#jmm-updates_3","title":"JMM Updates","text":"<p>\u56e0\u6b64\uff0c\u5728\u4e0b\u4e00\u4e2aJMM\u66f4\u65b0\u4e2d\uff0c\u6211\u4eec\u4f1a\u95ee\u6700\u5927\u7684\u95ee\u9898\uff1a\u6211\u4eec\u53ef\u4ee5\u91cd\u65b0\u5236\u5b9a/\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u4f7f\u5176\u66f4\u5177\u9632\u5f39\u6027\uff0c\u7b80\u6d01\u6027\u548c\u53ef\u7406\u89e3\u6027\u5417\uff1f</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#part-v-finals","title":"Part V: Finals","text":""},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#test-your-basic-understanding","title":"Test Your Basic Understanding","text":"<p>\u65e2\u7136\u6211\u4eec\u5df2\u7ecf\u5b66\u5230\u4e86\u5f88\u591a\u5173\u4e8eJMM\u7684\u77e5\u8bc6\uff0c\u90a3\u4e48\u8ba9\u6211\u4eec\u4ece\u8fd9\u4e2a\u7b80\u5355\u7684\u6d4b\u9a8c\u5f00\u59cb\u5427\u3002\u8fd9\u4e2a\u7a0b\u5e8f\u6253\u5370\u4ec0\u4e48\uff1f\u56de\u7b54\uff08\u9009\u62e9\u7ed3\u675f\u4ee5\u663e\u793a\uff09\uff1aNothing\uff0c0,42\u6216\u8005\u629b\u51faNPE\uff08\uff01\uff09\u3002 Racy\u8bfb\u53d6\u6bd4\u6bd4\u7686\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u771f\u6b63\u8bfb\u53d6\u4efb\u4f55\u5199\u5165\u7684\u503c\uff1a\u9ed8\u8ba4\u503c\u6216\u6784\u9020\u51fd\u6570\u4e2d\u5199\u5165\u7684\u503c\u3002\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u5148\u89c2\u5bdf\uff08a\uff01= null\uff09\u5e76\u6253\u5370\uff0c\u53ea\u662f\u4e3a\u4e86\u5b9e\u73b0\u7b2c\u4e8c\u6b21\u8fd4\u56de\u7684racy\u8bfb\u53d6\uff08a == null\uff09\uff0c\u8bbe\u7f6e\u4e00\u4e2aNPE\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#what-do-we-want","title":"What Do We Want","text":"<p>\u6211\u4eec\u663e\u7136\u5e0c\u671b\u4ee5\u8fd9\u6837\u7684\u65b9\u5f0f\u4fee\u6539\u5bf9\u8c61\u58f0\u660e\uff0c\u5373\u6211\u4eec\u53ea\u83b7\u5f9742\uff08\u6216\u6ca1\u6709\uff09\u3002\u4f60\u53ef\u4ee5\u731c\u5230\u90a3\u91cc\u9690\u85cf\u7740\u4e94\u4e2a\u95ee\u53f7\uff0c\u5bf9\u5427\uff1f</p> <p></p> <p>\u6211\u4eec\u9700\u8981\u8fd9\u6837\u6765\u4fdd\u62a4\u81ea\u5df1\u514d\u53d7\u79cd\u65cf\u4f24\u5bb3\u3002\u5982\u679c\u5bf9\u8c61\u63a5\u6536\u5668\u6076\u610f\u884c\u4e3a\uff0c\u6211\u4eec\u5c31\u4e0d\u80fd\u7740\u706b\u5e76\u7834\u574f\u5bf9\u8c61\u4e0d\u53d8\u91cf - \u5426\u5219\u6211\u4eec\u5c31\u65e0\u6cd5\u7f16\u5199\u5b89\u5168\u4ee3\u7801\u3002 \u5982\u4eca\uff0c\u4e00\u4e9b\u52c7\u6562\u7684\u4eba\u4eec\u56f4\u7ed5\u7740\u6bd4\u8d5b\u8bd5\u56fe\u4f18\u5316\u8868\u73b0\u3002\u8bf7\u518d\u6b21\u9605\u8bfbHans\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#what-do-we-have","title":"What Do We Have","text":"<p>\u4e0e\u6211\u4eec\u9700\u8981\u89c4\u8303\u5b83\u4eec\u7684\u65b9\u5f0f\u76f8\u6bd4\uff0c\u6700\u7ec8\u5b57\u6bb5\u7684\u5b9e\u73b0\u975e\u5e38\u7b80\u5355\u3002\u5728\u5927\u591a\u6570\u4f53\u7cfb\u7ed3\u6784\u4e2d\uff0c\u53ea\u9700\u5728\u6784\u9020\u51fd\u6570\u7684\u672b\u5c3e\u653e\u7f6e\u4e00\u4e2a\u5185\u5b58\u5c4f\u969c\uff0c\u5e76\u901a\u8fc7\u4f9d\u8d56\u9879\u5c06\u5bf9\u8c61\u5b57\u6bb5\u7684\u8d1f\u8f7d\u4e0e\u539f\u59cb\u5f15\u7528\u7684\u8d1f\u8f7d\u8054\u7cfb\u8d77\u6765\u3002\u5b8c\u6210\u3002</p> <p></p> <p>\u7136\u800c\uff0c\u89c4\u8303\u53d8\u5f97\u76f8\u5f53\u590d\u6742\u3002\u6211\u4eec\u5fc5\u987b\u5728\u4e00\u4e2a\u8bed\u6cd5\u4e0d\u7ecf\u610f\u7684\u89c4\u8303\u4e2d\u5f15\u7528\u6784\u9020\u51fd\u6570\uff0c\u5e76\u5728\u6784\u9020\u51fd\u6570\u7684\u672b\u5c3e\u5f15\u5165\u7279\u6b8a\u7684\u51bb\u7ed3\u64cd\u4f5c\u3002\u76f4\u89c2\u5730\u8bf4\uff0c\u8fd9\u4e2a\u51bb\u7ed3\u52a8\u4f5c\u4f7f\u7528\u5728\u6784\u9020\u51fd\u6570\u4e2d\u521d\u59cb\u5316\u7684\u503c\u201c\u7c98\u8d34\u201d\u8be5\u5b57\u6bb5\u3002\u4f46\u662f\uff0c\u5b83\u4e0d\u4f1a\u9650\u5236\u5b57\u6bb5\u7684\u53ef\u4fee\u6539\u6027\uff08\u60a8\u4ecd\u7136\u53ef\u4ee5\u901a\u8fc7\u53cd\u5c04\u6765\u89c4\u907f\u6700\u7ec8\u7ed3\u679c\uff09\uff0c\u51bb\u7ed3\u53ea\u662f\u5173\u4e8e\u521d\u59cb\u5316\u5b58\u50a8\u3002</p> <p></p> <p>\u8fd9\u662f\u5982\u4f55\u6b63\u5f0f\u6307\u5b9a\u7684\u3002\u8bf7\u6ce8\u610f\uff0cw\u548cr2\u53ef\u80fd\u662f\u4e5f\u53ef\u80fd\u4e0d\u662f\u6700\u7ec8\u5b57\u6bb5\u7684\u5199\u5165\u548c\u8bfb\u53d6\uff0c\u5b83\u4eec\u4e5f\u53ef\u80fd\u662f\u666e\u901a\u975e\u6700\u7ec8\u5b57\u6bb5\u7684\u5199\u5165\u548c\u8bfb\u53d6\u3002\u771f\u6b63\u91cd\u8981\u7684\u662f\u5305\u542b\u51bb\u7ed3\u52a8\u4f5cF\u7684\u5b50\u94fe\uff0c\u4e00\u4e9b\u52a8\u4f5ca\u548c\u8bfb\u53d6\u6700\u7ec8\u573a\u7684r1 - \u4e00\u8d77\u4f7fr2\u89c2\u5bdf\u5230w\u3002 \u8bf7\u6ce8\u610f\uff0c\u9700\u8981\u4e24\u4e2a\u65b0\u8ba2\u5355\uff0c\u53d6\u6d88\u5f15\u7528\u987a\u5e8f\u548c\u5185\u5b58\u987a\u5e8f\u6765\u9650\u5b9a\u51bb\u7ed3\u503c\u7684\u4f20\u64ad\u65b9\u5f0f\u3002</p> <p></p> <p>\u6211\u4eec\u201c\u53ea\u201d\u9700\u8981\u786e\u4fdd\u4ece\u76ee\u6807\u8bfb\u53d6\u7684\u6240\u6709\u8def\u5f84\u901a\u8fc7F\u548c\u6700\u7ec8\u5b57\u6bb5\u8bfb\u53d6\u5bfc\u81f4\u51bb\u7ed3\u503c\u7684\u5199\u5165\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#constructive-example","title":"Constructive Example","text":"<p>\u8fd9\u4e2a\u4f8b\u5b50\u88ab\u5f17\u62c9\u57fa\u7c73\u5c14\u00b7\u897f\u7279\u5c3c\u79d1\u592b\u548c\u5f17\u62c9\u57fa\u7c73\u5c14\u00b7\u79d1\u74e6\u8fde\u79d1\u5927\u5927\u89e3\u5f00\uff0c\u5bf9\u4ed6\u4eec\u7684\u79f0\u8d5e\uff01\u8fd9\u662f\u57fa\u4e8e\u4ed6\u4eec\u7684\u5206\u6790\u7684\u53ef\u89c6\u5316\uff1a</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#premature-publication","title":"Premature Publication","text":"<p>\u8fd9\u662fJeremy Manson\u7684PoPL\u8bba\u6587\u4e2d\u7684\u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\u3002\u5728\u90a3\u91cc\uff0c\u7b2c\u4e00\u4e2a\u7ebf\u7a0b\u521d\u59cb\u5316\u5bf9\u8c61\u5e76\u5c0642\u5b58\u50a8\u5230\u6700\u7ec8\u5b57\u6bb5f\uff0c\u7136\u540e\u901a\u8fc7p\u201c\u6cc4\u6f0f\u201d\u5bf9\u8c61\u5f15\u7528\uff0c\u7136\u540e\u624d\u901a\u8fc7q\u6b63\u786e\u53d1\u5e03\u3002 \u4f20\u7edf\u89c2\u70b9\u8ba4\u4e3a\uff0c\u6700\u7ec8\u7684\u5b57\u6bb5\u4fdd\u8bc1\u4f1a\u56e0\u8fc7\u65e9\u53d1\u5e03\u800c\u6d88\u5931\uff0c\u4f46\u5b9e\u9645\u4e0a\uff0c\u7b2c\u4e09\u4e2a\u7ebf\u7a0b\u53ea\u89c2\u5bdf\u5b8c\u5168\u6784\u9020\u7684\u5bf9\u8c61\uff0c\u6211\u4eec\u53ea\u80fd\u627e\u5230\u5408\u9002\u7684\u6700\u7ec8\u8def\u5f84\u3002 \uff08\u53c2\u89c1\u4e0a\u9762\u7684\u4f8b\u5b50\u8fdb\u884c\u7c7b\u6bd4\u3002\uff09 \u7136\u800c\uff0c\u5f53\u901a\u8fc7p\u8bfb\u53d6\u65f6\uff0c\u7b2c\u4e8c\u4e2a\u7ebf\u7a0b\u7a81\u7834\u4e86\u6700\u7ec8\u8def\u5f84\uff0c\u56e0\u6b64\u53ef\u80fd\u89c2\u5bdf\u5230\u975e\u51bb\u7ed3\u503c\u3002\u6709\u70b9\u4ee4\u4eba\u60ca\u8bb6\u7684\u662f\uff0c\u901a\u8bfbq\u4e5f\u53ef\u4ee5\u89c2\u5bdf\u5230\u975e\u51bb\u7ed3\u503c\u3002\u8fd9\u662fdr\u548cmc\u547d\u4ee4\u7684\u5c5e\u6027\u6b63\u5f0f\u5141\u8bb8\u7684\uff0c\u5e76\u4e14\u6709\u4e00\u4e2a\u5b9e\u7528\u7684\u539f\u56e0\uff1a</p> <p></p> <p>\u5b9e\u7528\u7684\u539f\u56e0\u662f\u8fd0\u884c\u65f6\u53ef\u80fd\u4f1a\u5728\u53d1\u73b0\u6700\u7ec8\u5b57\u6bb5\u540e\u5bf9\u5176\u8fdb\u884c\u7f13\u5b58\uff01\u8fd9\u610f\u5473\u7740\u5982\u679c\u7f16\u8bd1\u5668\u53d1\u73b0p\u548cq\u662f\u540c\u4e00\u4e2a\u5bf9\u8c61\u7684\u522b\u540d\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8bf4r3 = r2\uff0c\u5e76\u7528\u5b83\u6765\u5b8c\u6210\u3002\u6240\u4ee5\uff0c\u5982\u679c\u6211\u4eec\u89c2\u5bdf\u5230\u6784\u9020\u4e0d\u8db3\u7684\u5bf9\u8c61\uff0c\u6211\u4eec\u7684\u7ebf\u7a0b\u5c31\u4f1a\u53d8\u5f97\u6c61\u79fd\uff0c\u800c\u4e14\u4e00\u5207\u90fd\u5d29\u6e83\u4e86\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#test-your-understanding-tricky","title":"Test Your Understanding (tricky)","text":"<p>\u8bf7\u6ce8\u610f\uff0c\u89c4\u8303\u8ba8\u8bba\u4e86\u6784\u9020\u51fd\u6570\u4e2d\u7684\u521d\u59cb\u5316\uff0c\u8fd9\u91cc\u6211\u4eec\u8fd8\u6709\u5176\u4ed6\u7684\u4e1c\u897f\u3002\u7b54\u6848\uff08\u9009\u62e9\u7ed3\u675f\u4ee5\u663e\u793a\uff09\uff1a\u5f53\u7136\uff0c\u6211\u4eec\u5c06\u770b\u523042\u6216\u4ec0\u4e48\u90fd\u6ca1\u6709\u3002\u5b57\u6bb5\u521d\u59cb\u503c\u8bbe\u5b9a\u9879\u548c\u5b9e\u4f8b\u521d\u59cb\u503c\u8bbe\u5b9a\u9879\u5728\u5b9e\u4f8b\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\u89e6\u53d1\uff0c\u53ef\u4ee5\u8bf4\u662f\u6784\u9020\u51fd\u6570\u7684\u4e00\u90e8\u5206\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#jmm-updates_4","title":"JMM Updates","text":"<p>final-s\u5b58\u5728\u5f88\u591a\u95ee\u9898\uff0c\u4e3b\u8981\u662f\u4e0e\u5176\u4ed6JMM\u5143\u7d20\u7684\u6b63\u4ea4\u6027\u6709\u5173\u3002\u5982\u679c\u5b57\u6bb5\u5df2\u7ecf\u662fvolatile\uff0c\u90a3\u4e48\u5982\u4f55\u5728\u6784\u9020\u51fd\u6570\u4e2d\u5b9e\u73b0\u521d\u59cb\u5316\u5b58\u50a8\u7684\u53ef\u89c1\u6027\u7279\u522b\u6709\u8da3\u3002 \uff08\u63d0\u793a\uff1a\u4e0d\u7a33\u5b9a\u662f\u4e0d\u591f\u7684\uff0c\u56e0\u4e3a\u5b83\u7b26\u5408\u89c4\u8303\uff0c\u6b64\u65f6\uff09\u3002 \u4ece\u6559\u5b66\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u6211\u4eec\u662f\u5426\u5e94\u8be5\u6392\u65a5\u90a3\u4e9b\u5fd8\u8bb0\u5728\u6784\u9020\u51fd\u6570\u4e2d\u58f0\u660e\u4e00\u6b21\u5199\u5165\u7684\u7528\u6237\uff0c\u5e76\u8ba9\u4ed6\u4eec\u7684\u4ee3\u7801\u5728\u975ex86\u5e73\u53f0\u4e0a\u7206\u70b8\uff0c\u8fd9\u4e5f\u5f88\u6709\u8da3\u3002 \u56e0\u6b64\uff0c\u4e0b\u4e00\u4e2aJMM\u66f4\u65b0\u9700\u8981\u51b3\u5b9a\u662f\u5426\u5e94\u8be5\u5c06\u6700\u7ec8\u5b57\u6bb5\u4fdd\u8bc1\u6269\u5c55\u5230\u5728\u6240\u6709\u6784\u9020\u51fd\u6570\u4e2d\u521d\u59cb\u5316\u7684\u6240\u6709\u5b57\u6bb5\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#benchmarks_1","title":"Benchmarks","text":"<p>\u672c\u8282\u4ecb\u7ecd\u66f4\u65b0\u7684Java\u5185\u5b58\u6a21\u578b\u7684\u6700\u7ec8\u5b57\u6bb5\u6ce8\u610f\u4e8b\u9879\u3002\u8bf7\u53c2\u9605\u53e6\u4e00\u7bc7\u6587\u7ae0\u4e2d\u66f4\u5168\u9762\u7684\u89e3\u91ca\u3002</p> <p></p> <p>\u5f53\u7136\uff0c\u6211\u4eec\u5e0c\u671b\u4e25\u683c\u91cf\u5316\u6807\u8bb0\u6240\u6709\u5b57\u6bb5\u7684\u6700\u7ec8\u6210\u672c\u3002\u7531\u4e8e\u6700\u7ec8\u7684\u5b57\u6bb5\u5b58\u50a8\u5728\u6784\u9020\u51fd\u6570\u4e2d\u9700\u8981\u5185\u5b58\u969c\u788d\u4ee5\u7528\u4e8e\u5f31\u6709\u5e8f\u7684\u5e73\u53f0\uff0c\u56e0\u6b64\u6211\u4eec\u8fd8\u5c06ARM\u4e3b\u673a\u4f5c\u4e3a\u6d4b\u8bd5\u5e73\u53f0\u3002</p> <p>\u4ee5\u4e0b\u662f\u57fa\u51c6\u6d4b\u8bd5\uff1a\u94fe\u63a5\u8c03\u7528\u5c42\u6b21\u7ed3\u6784\u4e2d\u7684N\u4e2a\u6784\u9020\u51fd\u6570\uff0c\u4e3a\u6bcf\u4e2a\u7c7b\u521d\u59cb\u5316\u5355\u4e2a\u5b57\u6bb5\uff0c\u5e76\u5408\u5e76\u521d\u59cb\u5316\u6240\u6709N\u4e2a\u5b57\u6bb5\u3002\u5b57\u6bb5\u53ef\u4ee5\u662f\u666e\u901a\u5b57\u6bb5\u6216\u6700\u7ec8\u5b57\u6bb5\u6211\u4eec\u4f7f\u7528\u4e0d\u540c\u7684N-s\u8fdb\u884c\u6d4b\u8bd5\uff0c\u4ee5\u786e\u5b9a\u6027\u80fd\u662f\u5426\u4ee5\u5408\u7406\u7684\u65b9\u5f0f\u53d1\u751f\u53d8\u5316\u3002</p> <p></p> <p></p> <p></p> <p>\u4f5c\u4e3aTotal Store Order\u673a\u5668\u7684x86\u6ca1\u6709\u5185\u5b58\u5c4f\u969c\uff0c\u56e0\u6b64\u6240\u6709\u56db\u79cd\u53d8\u4f53\u4e4b\u95f4\u7684\u5dee\u5f02\u90fd\u5728\u6d4b\u91cf\u8bef\u5dee\u8303\u56f4\u5185\uff0c\u4e0eN\u65e0\u5173\u3002</p> <p></p> <p>\u5728\u5f31\u6709\u5e8f\u7684\u673a\u5668\u4e0a\uff0c\u6700\u7ec8\u6d89\u53ca\u4e00\u4e2a\u771f\u6b63\u7684\u5185\u5b58\u5c4f\u969c\uff0c\u5e76\u4e14\u5728\u7eff\u8272\u6761\u4e0a\u7684\u6267\u884c\u65f6\u95f4\u4e2d\u589e\u52a0\u4e86\u5c4f\u969c\u6210\u672c\u3002\u6b64\u5916\uff0c\u6211\u4eec\u5728\u6bcf\u4e2a\u8d85\u7c7b\u4e2d\u90fd\u6709\u969c\u788d\uff0c\u8fd9\u89e3\u91ca\u4e86\u4e3a\u4ec0\u4e48\u7ea2\u7ebf\u9700\u8981\u7ebf\u6027\u66f4\u591a\u7684\u65f6\u95f4\u3002\u6211\u4eec\u53ef\u4ee5\u6559VM\u5408\u5e76\u969c\u788d\uff0c\u7136\u540e\u6267\u884c\u6700\u7ec8\u8bed\u4e49\u7684\u6210\u672c\u4f1a\u6df9\u6ca1\u5728\u5206\u914d\u6210\u672c\u4e2d\u3002</p>"},{"location":"2019-09-01-%F0%9F%8D%AB%EF%BC%88%E8%AF%91%EF%BC%89Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E8%AF%AD%E4%B9%89%E5%AD%A6/#conclusion","title":"Conclusion","text":"<p>\u5f53\u6211\u4eec\u5904\u7406\u4e00\u4e2a\u8ba8\u538c\u7684JMM\u9519\u8bef\u65f6\uff0cDoug\u653e\u5f03\u4e86\u4e00\u4e2a\u667a\u6167\u7684\u5b9d\u77f3\uff0c\u5e94\u8be5\u5f88\u597d\u5730\u603b\u7ed3\u8fd9\u4e2a\u8c08\u8bdd\u3002\u5982\u679c\u4f7f\u7528\u5e76\u53d1\u7ed3\u6784\u7684\u4eba\u80fd\u591f\u5f04\u6e05\u695a\u8fd9\u4e9b\u7ed3\u6784\u4f55\u65f6\u4ee5\u53ca\u4f55\u65f6\u8d77\u4f5c\u7528\uff0c\u90a3\u4e5f\u662f\u597d\u4e8b\u3002\u5e0c\u671b\u8fd9\u4e2a\u8bb2\u8bdd\u80fd\u591f\u6539\u5584JMM\u7684\u7406\u89e3\u3002</p> <p></p> <p>\u6211\u4eec\u60f3\u5728JMM\u4e2d\u89e3\u51b3\u4e00\u4e9b\u5df2\u77e5\u7684\u95ee\u9898......</p> <p></p> <p>...\u5f15\u8d77\u4e86\u201cJava\u5185\u5b58\u6a21\u578b\u66f4\u65b0\u201d\u7684\u52aa\u529b\u3002</p> <p></p> <p>\u5728\u4e00\u5929\u7ed3\u675f\u65f6\uff0c\u4e3a\u8bfb\u8005\u63d0\u4f9b\u4e00\u4e9b\u6709\u7528\u7684\u94fe\u63a5\uff1a</p> <ul> <li> <p>Goetz et al: \"Java Concurrency in Practice\"</p> </li> <li> <p>Herilhy, Shavit, \"The Art of Multiprocessor Programming\"</p> </li> <li> <p>Adve, \"Shared Memory Consistency Models: A Tutorial\"</p> </li> <li> <p>McKenney, \"Is Parallel Programming Hard, And, If So, What Can You Do About It?\"</p> </li> <li> <p>Manson, \"Special PoPL Issue: The Java Memory Model\"</p> </li> <li> <p>Huisman, Petri, \"JMM: A Formal Explanation\"</p> </li> </ul>"},{"location":"2019-09-23-%F0%9F%A7%B6Java%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%85%B6%E5%AF%B9%E5%BA%94%E7%9A%84Linux%E8%BF%9B%E7%A8%8B%E5%8F%B7/","title":"2019 09 23 \ud83e\uddf6Java\u7ebf\u7a0b\u4e0e\u5176\u5bf9\u5e94\u7684Linux\u8fdb\u7a0b\u53f7","text":""},{"location":"2019-09-23-%F0%9F%A7%B6Java%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%85%B6%E5%AF%B9%E5%BA%94%E7%9A%84Linux%E8%BF%9B%E7%A8%8B%E5%8F%B7/#1-ps-elf","title":"1 ps -eLf","text":"<p>\u9996\u5148\uff0c\u5728Linux\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u7528<code>ps -eLf</code>\u547d\u4ee4\u770b\u5230<code>java</code>\u7684\u7ebf\u7a0b\u53f7\uff1a</p> <pre><code>$ ps -eLf | grep java | grep -v grep \nopt      10801     1 10801  0   23 Sep19 ?        00:00:00 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10806  0   23 Sep19 ?        00:00:02 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10807  0   23 Sep19 ?        00:00:25 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10808  0   23 Sep19 ?        00:00:00 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10809  0   23 Sep19 ?        00:00:27 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10810  0   23 Sep19 ?        00:00:00 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10811  0   23 Sep19 ?        00:00:51 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10812  0   23 Sep19 ?        00:00:00 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10813  0   23 Sep19 ?        00:00:16 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10814  0   23 Sep19 ?        00:00:00 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10815  0   23 Sep19 ?        00:00:00 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10816  0   23 Sep19 ?        00:00:00 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10817  0   23 Sep19 ?        00:00:20 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10818  0   23 Sep19 ?        00:00:06 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10819  0   23 Sep19 ?        00:00:02 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10820  0   23 Sep19 ?        00:00:00 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10821  0   23 Sep19 ?        00:04:35 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10822  0   23 Sep19 ?        00:00:00 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10825  0   23 Sep19 ?        00:00:00 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10828  0   23 Sep19 ?        00:00:11 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10830  0   23 Sep19 ?        00:00:20 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 10831  0   23 Sep19 ?        00:00:20 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\nopt      10801     1 19608  0   23 21:49 ?        00:00:00 java -XX:+UseG1GC -XX:+UseStringDeduplication -Xms32m -Xmx32m -server -jar gogo.jar\n</code></pre>"},{"location":"2019-09-23-%F0%9F%A7%B6Java%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%85%B6%E5%AF%B9%E5%BA%94%E7%9A%84Linux%E8%BF%9B%E7%A8%8B%E5%8F%B7/#jstack","title":"jstack","text":"<p>\u5176\u6b21\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>jstack</code>\u547d\u4ee4\u8f6c\u50a8\u7ebf\u7a0b\u4fe1\u606f\uff0c\u4e5f\u80fd\u5f97\u5230java\u7ebf\u7a0b\u53f7\uff1a</p> <pre><code>\"Reference Handler\" #2 daemon prio=10 os_prio=0 cpu=30.65ms elapsed=339658.01s tid=0x00007fa6e0120000 nid=0x2a3e waiting on condition  [0x00007fa6c435b000]\n   java.lang.Thread.State: RUNNABLE\n    at java.lang.ref.Reference.waitForReferencePendingList(java.base@11.0.3/Native Method)\n    at java.lang.ref.Reference.processPendingReferences(java.base@11.0.3/Reference.java:241)\n    at java.lang.ref.Reference$ReferenceHandler.run(java.base@11.0.3/Reference.java:213)\n</code></pre> <p>\u5176\u4e2d\u7684<code>nid=0x2a3e</code>\u7684\u5341\u8fdb\u5236\u4e3a<code>10814</code>\uff1a</p> <pre><code>$ printf \"%d\\n\" 0x2a3e\n10814\n</code></pre>"},{"location":"2019-09-23-%F0%9F%A7%B6Java%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%85%B6%E5%AF%B9%E5%BA%94%E7%9A%84Linux%E8%BF%9B%E7%A8%8B%E5%8F%B7/#top-h-p","title":"top -H -p","text":"<pre><code>$ top -H -p 10801\n\ntop - 22:07:00 up 4 days, 26 min,  1 user,  load average: 0.00, 0.00, 0.00\nThreads:  23 total,   0 running,  23 sleeping,   0 stopped,   0 zombie\n%Cpu(s):  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\nKiB Mem :  1025532 total,    87060 free,   309220 used,   629252 buff/cache\nKiB Swap:   266236 total,   243336 free,    22900 used.   565344 avail Mem \n\n  PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND                                                             \n10801 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:00.00 java                                                                \n10806 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:02.78 java                                                                \n10807 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:26.07 GC Thread#0                                                         \n10808 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:00.14 G1 Main Marker                                                      \n10809 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:27.40 G1 Conc#0                                                           \n10810 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:00.00 G1 Refine#0                                                         \n10811 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:51.73 G1 Young RemSet                                                     \n10812 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:00.02 StrDedup                                                            \n10813 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:17.05 VM Thread                                                           \n10814 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:00.02 Reference Handl                                                     \n10815 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:00.02 Finalizer                                                           \n10816 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:00.00 Signal Dispatch                                                     \n10817 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:20.07 C2 CompilerThre                                                     \n10818 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:06.41 C1 CompilerThre                                                     \n10819 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:02.51 Sweeper thread                                                      \n10820 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:00.00 Service Thread                                                      \n10821 opt       20   0 2185948 187316  11692 S  0.0 18.3   4:36.19 VM Periodic Tas                                                     \n10822 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:00.37 Common-Cleaner                                                      \n10825 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:00.00 AsyncAppender-W                                                     \n10828 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:11.31 nioEventLoopGro                                                     \n10830 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:20.83 nioEventLoopGro                                                     \n10831 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:20.76 nioEventLoopGro                                                     \n19608 opt       20   0 2185948 187316  11692 S  0.0 18.3   0:00.00 Attach Listener\n</code></pre>"},{"location":"2019-09-23-%F0%9F%A7%B6Java%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%85%B6%E5%AF%B9%E5%BA%94%E7%9A%84Linux%E8%BF%9B%E7%A8%8B%E5%8F%B7/#_1","title":"\u53c2\u8003","text":"<ul> <li>How to find a Java thread running on Linux with ps -axl?</li> <li>rednaxelafx/PrintThreadIds.java</li> </ul>"},{"location":"2020-01-17-%F0%9F%A7%B7%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF%E5%86%99%E4%BD%9C/","title":"2020 01 17 \ud83e\uddf7\u5173\u4e8e\u6280\u672f\u5199\u4f5c","text":"<p>\u7ffb\u8bd1\u81eaNotes on Technical Writing\uff0c\u4f5c\u8005<code>Marcus Kazmierczak</code>\u3002</p> <p>\u5728\u8fc7\u53bb\u7684\u4e00\u5e74\u4e2d\uff0c\u6211\u5904\u7406\u8fc7WordPress\u7684\u6587\u6863\u3002\u5728\u51bb\u7ed3\u53d1\u5e03\u671f\u95f4\uff0c\u6211\u5f00\u59cb\u505a\u51fa\u8d21\u732e\uff0c\u4ee5\u5e2e\u52a9\u5f00\u53d1\u4eba\u5458\u8fc7\u6e21\u5230\u65b0\u5e73\u53f0\u3002\u6211\u53d1\u73b0\u7f16\u5199\u6587\u6863\u662f\u6211\u7684\u6700\u7231\uff0c\u5e76\u4e14\u4e50\u4e8e\u5e2e\u52a9\u548c\u6559\u80b2\u4eba\u4eec\u3002\u5c3d\u7ba1\u8fd9\u4e0d\u662f\u6211\u5de5\u4f5c\u7684\u4e3b\u8981\u90e8\u5206\uff0c\u4f46\u6211\u4ecd\u7136\u5728\u8fd9\u91cc\u548c\u90a3\u91cc\u627e\u65f6\u95f4\u7ee7\u7eed\u52aa\u529b\u3002</p> <p>\u8fd9\u4e00\u6b21\uff0c\u6211\u9605\u8bfb\u4e86\u6709\u5173\u6280\u672f\u5199\u4f5c\u548c\u6587\u6863\u7684\u5404\u79cd\u8d44\u6e90\u3002\u8fd9\u4e9b\u662f\u6211\u7684\u7b14\u8bb0\uff0c\u65e2\u53ef\u4ee5\u5e2e\u52a9\u6211\u4ee5\u540e\u8bb0\u4f4f\uff0c\u53c8\u53ef\u4ee5\u4f5c\u4e3a\u5e2e\u52a9\u6211\u8003\u8651\u73b0\u5728\u5199\u7684\u5de5\u5177\u3002</p>"},{"location":"2020-01-17-%F0%9F%A7%B7%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF%E5%86%99%E4%BD%9C/#principles","title":"Principles","text":"<p>\u5728\u7f16\u5199\u6587\u6863\u65f6\uff0c\u6211\u5c1d\u8bd5\u7262\u8bb0\u4ee5\u4e0b\u539f\u5219\uff1a</p> <ul> <li>\u6280\u672f\u5199\u4f5c\u7684\u76ee\u7684\u662f\u5e2e\u52a9\u7528\u6237\u5c3d\u53ef\u80fd\u5feb\u548c\u9ad8\u6548\u5730\u5b8c\u6210\u4efb\u52a1\u3002#</li> <li>People learn by doing, prefer to be shown and not told</li> <li>Get users to their first success quickly</li> <li>\u6709\u4e0d\u6b62\u4e00\u79cd\u7c7b\u578b\u7684\u6587\u6863</li> <li>\u4fdd\u6301\u7b80\u5355\uff0c\u7528\u5e73\u6613\u7684\u8bed\u8a00</li> </ul>"},{"location":"2020-01-17-%F0%9F%A7%B7%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF%E5%86%99%E4%BD%9C/#tips","title":"Tips","text":"<ul> <li>Know your audience, know your purpose</li> <li>Put the most important information first</li> <li>Use bullet lists\uff08\u4f7f\u7528\u65e0\u5e8f\u7b26\u53f7\u5217\u8868\uff09</li> <li>One idea per paragraph</li> <li>Edit, Edit, Edit\uff08\u4e0d\u65ad\u6539\u8fdb\uff09</li> </ul>"},{"location":"2020-01-17-%F0%9F%A7%B7%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF%E5%86%99%E4%BD%9C/#avoid-meta-writing","title":"Avoid Meta Writing","text":"<p>\u907f\u514d\u5199\u5173\u4e8e\u6587\u5b57\u7684\u6587\u7ae0\uff0c\u6587\u5b57\u6ca1\u6709\u81ea\u5df1\u7684\u60f3\u6cd5\u3002 \u6d3b\u8dc3\u7684\u90e8\u5206\u662f\u4f5c\u5bb6\u548c\u8bfb\u8005\u3002</p> <p>\u60a8\u65e0\u9700\u544a\u8bc9\u8bfb\u8005\u60a8\u5c06\u8981\u544a\u8bc9\u4ed6\u4eec\u7684\u5185\u5bb9\u3002 \u544a\u8bc9\u4ed6\u4eec\uff1a</p> <ul> <li><code>Bad</code>: This chapter discusses the factors that cause names to rise and fall in popularity.</li> <li><code>Good</code>: What makes a name rise and fall in popularity?</li> </ul> <p>\u4e0d\u8981\u5728\u5199\u4f5c\u4e2d\u5f15\u7528\u7ae0\u8282\uff1a</p> <ul> <li><code>Bad</code>: Summarizing the preceding section about\u2026</li> <li><code>Good</code>: In summary, \u2026</li> </ul> <p>Don\u2019t tell the reader something is extremely complex; likewise don\u2019t tell the reader something is simple. The reader will make up their own mind about a concept being easy or hard.</p>"},{"location":"2020-01-17-%F0%9F%A7%B7%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF%E5%86%99%E4%BD%9C/#minimalist-instruction","title":"Minimalist Instruction","text":"<p>John M. Carroll\u548c\u4ed6\u5728IBM\u7684\u540c\u4e8b\u7814\u7a76\u4e86\u521b\u5efa<code>\u652f\u6301\u6587\u6863</code>\u7684\u8fc7\u7a0b\uff0c\u5206\u6790\u4e86\u4f7f\u7528\u6237\u7cbe\u901a\u7684\u6700\u4f73\u65b9\u6cd5\u3002\u57281980\u5e74\u4ee3\uff0c\u4ed6\u4eec\u5f00\u53d1\u4e86\u4e00\u79cd\u6781\u7b80\u4e3b\u4e49\u7684\u65b9\u6cd5\uff0c\u5e76\u521b\u5efa\u4e86\u7cbe\u5f69\u7684IBM Displaywriter\u64cd\u4f5c\u5458\u57f9\u8bad\u624b\u518c\uff0c\u60f3\u8c61\u4e00\u4e0b\u5fc5\u987b\u9996\u5148\u5411\u67d0\u4eba\u4ecb\u7ecd\u4f7f\u7528\u6587\u5b57\u5904\u7406\u5668\u7684\u60c5\u51b5\u3002</p> <p>\u6781\u7b80\u4e3b\u4e49\u6559\u5b66\u7684\u56db\u4e2a\u539f\u5219\uff1a</p> <ul> <li>\u9009\u62e9\u4e00\u79cd\u9762\u5411\u884c\u52a8\u7684\u65b9\u6cd5\u3002 \u7528\u6237\u901a\u5e38\u60f3\u505a\u4e8b\u3002 \u8be5\u539f\u5219\u53cd\u6620\u4e86\u6781\u7b80\u4e3b\u4e49\u7684\u4ee5\u7528\u6237\u4e3a\u4e2d\u5fc3\u7684\u672c\u8d28\u3002</li> <li>\u5c06\u5de5\u5177\u951a\u5b9a\u5728\u4efb\u52a1\u57df\u4e2d\u3002 \u5de5\u5177\u662f\u8fbe\u5230\u76ee\u7684\u7684\u624b\u6bb5\u3002 \u8be5\u539f\u5219\u8981\u6c42\u8bbe\u8ba1\u4eba\u5458\u9009\u62e9\u5bf9\u7528\u6237\u6709\u610f\u4e49\u7684\u57f9\u8bad\u4efb\u52a1\u3002</li> <li>\u652f\u6301\u9519\u8bef\u8bc6\u522b\u548c\u6062\u590d\u3002 \u4eba\u975e\u5723\u8d24\u5b70\u80fd\u65e0\u8fc7\u3002 \u6709\u51e0\u79cd\u65b9\u6cd5\u53ef\u4ee5\u63d0\u9ad8\u7528\u6237\u5904\u7406\u9519\u8bef\u7684\u80fd\u529b\u548c\u8212\u9002\u5ea6\u3002</li> <li>\u652f\u6301\u9605\u8bfb\u505a\uff0c\u7814\u7a76\u548c\u5b9a\u4f4d\u3002 \u8bbe\u8ba1\u5fc5\u987b\u5c3d\u53ef\u80fd\u6ee1\u8db3\u76ee\u6807\u53d7\u4f17\u7684\u4e0d\u540c\u9700\u6c42\u548c\u503e\u5411\u3002 \u8be5\u539f\u5219\u53cd\u6620\u4e86\u6781\u7b80\u4e3b\u4e49\u7684\u4ee5\u7528\u6237\u4e3a\u4e2d\u5fc3\u7684\u672c\u8d28\u3002</li> </ul> <p>\u4ece\u8377\u5170\u7279\u6e29\u7279\u5927\u5b66\u7684\u6559\u5b66\u6280\u672f\u7cfb\u4e2d\u8fdb\u4e00\u6b65\u4e86\u89e3\u6781\u7b80\u4e3b\u4e49\u6559\u5b66\u3002</p>"},{"location":"2020-01-17-%F0%9F%A7%B7%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF%E5%86%99%E4%BD%9C/#constructivism","title":"Constructivism","text":"<p>\u7f8e\u56fd\u5fc3\u7406\u5b66\u5bb6\u6770\u7f57\u59c6\u00b7\u5e03\u9c81\u7eb3\uff08Jerome Bruner\uff09\u7814\u7a76\u4e86\u4eba\u7c7b\u7684\u8ba4\u77e5\u5fc3\u7406\u5b66\u3002\u5e03\u9c81\u7eb3\u8457\u4f5c\u7684\u4e00\u4e2a\u4e3b\u8981\u4e3b\u9898\u662f\u5b66\u4e60\u662f\u4e00\u4e2a\u6d3b\u8dc3\u7684\u8fc7\u7a0b\uff0c\u5b66\u4e60\u8005\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u77e5\u8bc6\u6784\u9020\u65b0\u7684\u60f3\u6cd5\u3002\u5c06\u5efa\u6784\u4e3b\u4e49\u539f\u7406\u5e94\u7528\u4e8e\u6587\u6863\uff1a</p> <ul> <li>\u5c1d\u8bd5\u9f13\u52b1\u8bfb\u8005\u81ea\u5df1\u53d1\u73b0\u539f\u7406\u3002</li> <li>\u5c06\u4fe1\u606f\u8f6c\u6362\u4e3a\u9002\u5408\u8bfb\u8005\u5f53\u524d\u6c34\u5e73\u7684\u683c\u5f0f\u3002</li> <li>\u87ba\u65cb\u5f0f\u7ec4\u7ec7\u6750\u6599\uff0c\u56e0\u6b64\u5b83\u4f1a\u7ee7\u7eed\u5efa\u7acb\u5728\u4ed6\u4eec\u5df2\u5b66\u5230\u7684\u77e5\u8bc6\u4e4b\u4e0a\u3002</li> <li>\u53c2\u4e0e\u6d3b\u52a8\u5bf9\u8bdd\u6846\uff0c\u9080\u8bf7\u7528\u6237\u6267\u884c\u201c\u8bf7\u5c1d\u8bd5\u201d\uff0c\u201c\u770b\u770b\u4f1a\u53d1\u751f\u4ec0\u4e48\u201d\uff0c\u201c\u63a2\u7d22\u81ea\u5df1\u201d\u3002</li> </ul> <p>\u8fdb\u4e00\u6b65\u4e86\u89e3\u5e03\u9c81\u7eb3\u548c\u6784\u5efa\u6ce8\u610f\u7406\u8bba</p>"},{"location":"2020-01-17-%F0%9F%A7%B7%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF%E5%86%99%E4%BD%9C/#types-of-documentation","title":"Types of Documentation","text":"<p>\u4e39\u5c3c\u5c14\u00b7\u666e\u7f57\u5947\u8fbe\uff08Daniele Procida\uff09\u64b0\u5199\u4e86What nobody tells you about documentation\uff0c\uff08\u81f3\u5c11\uff09\u6709\u56db\u79cd\u6587\u6863\uff1a</p> <ul> <li><code>Tutorials</code> \u2013 A tutorial is learning-oriented for newcomers, a directed set of lessons to give the user basic confidence and skills. A tutorial should not assume knowledge or language, but is there to take a beginner who doesn\u2019t know what questions to ask through learning.</li> <li><code>How-to Guides</code> \u2013 A how-to guide, or FAQ is goal-oriented, directed by the user. A how-to guide can assume the user has basic knowledge and language, but needs to know how to solve a specific problem.</li> <li><code>Explanation</code> \u2013 An explanation or overview document is understanding-oriented providing background or additional detailed context.</li> <li><code>Reference Guides</code> \u2013 A reference guide is information-oriented, it is accurate and complete describing the machinery. API documentation is an example of a reference guide.</li> </ul>"},{"location":"2020-01-17-%F0%9F%A7%B7%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF%E5%86%99%E4%BD%9C/#resources","title":"Resources","text":"<ul> <li>On Writing Well (book) The classic guide to writing non-fiction by William Zinsser.</li> <li>Basic Writing Tips an article by Andrew Etter</li> <li>Wordiness: Danger Signals (2 page pdf) by Margaret Procter, University of Toronto</li> <li>Writing is Thinking by Sally Kerrigan, A List Apart</li> <li>Writing is Thinking, by Steph Smith</li> <li>Tips on Writing a Great Science Paper from Cormac McCarthy</li> <li>Microsoft Writing Style Guide</li> </ul>"},{"location":"2020-01-19-%F0%9F%A7%99%F0%9F%8F%BD%E2%80%8D%E2%99%82%EF%B8%8F%E6%96%B0%E4%BA%BA%E5%92%8C%E9%9D%9E%E6%8A%80%E6%9C%AF%E4%BA%BA%E5%91%98%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8%E6%8B%93%E5%B1%95/","title":"2020 01 19 \ud83e\uddd9\ud83c\udffd\u200d\u2642\ufe0f\u65b0\u4eba\u548c\u975e\u6280\u672f\u4eba\u5458\u4e5f\u80fd\u770b\u61c2\u7684\u7f51\u7ad9\u5e94\u7528\u62d3\u5c55","text":"<p>\u7ffb\u8bd1\u81eaScaling webapps for newbs &amp; non-techies \uff0c\u4f5c\u8005Wolfram Hempel</p>"},{"location":"2020-01-19-%F0%9F%A7%99%F0%9F%8F%BD%E2%80%8D%E2%99%82%EF%B8%8F%E6%96%B0%E4%BA%BA%E5%92%8C%E9%9D%9E%E6%8A%80%E6%9C%AF%E4%BA%BA%E5%91%98%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8%E6%8B%93%E5%B1%95/#_1","title":"\u62d3\u5c55\u662f\u4ec0\u4e48\uff1f","text":"<p>\u62d3\u5c55\u5206\u4e3a\u6a2a\u5411\u4e0e\u7eb5\u5411\uff1b\u7b80\u5355\u6765\u8bf4\uff1a</p> <p>\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u79f0\u4e4b\u4e3a\u6c34\u5e73\u62d3\u5c55\u4e0e\u5782\u76f4\u62d3\u5c55\u3002</p> <ul> <li>\u6a2a\u5411\u62d3\u5c55\uff08horizontal scaling\uff09\uff1a\u5e76\u884c\u5730\u8fd0\u884c\u5f88\u591a\u8fdb\u7a0b\uff1b</li> <li>\u7eb5\u5411\u62d3\u5c55\uff08vertical scaling\uff09\uff1a\u5728\u66f4\u5f3a\u5927\u7684\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u540c\u6837\u7684\u7a0b\u5e8f\uff1b</li> </ul> <p>\u4eca\u5929\uff0c\u5f88\u5c11\u6709\u4eba\u518d\u7eb5\u5411\u62d3\u5c55\uff0c\u56e0\u4e3a\uff1a</p> <ul> <li>\u8ba1\u7b97\u673a\u7684\u4ef7\u683c\u968f\u7740\u6027\u80fd\u7684\u63d0\u9ad8\u5448\u6307\u6570\u589e\u957f</li> <li>\u4e00\u53f0\u8ba1\u7b97\u673a\u53ea\u80fd\u5982\u6b64\u4e4b\u5feb\uff0c\u8fd9\u5bf9\u4e00\u53f0\u8ba1\u7b97\u673a\u53ef\u4ee5\u5782\u76f4\u6269\u5c55\u7684\u8303\u56f4\u65bd\u52a0\u4e86\u4e25\u683c\u7684\u9650\u5236</li> <li>\u591a\u6838CPU\u610f\u5473\u7740\u5373\u4f7f\u4e00\u53f0\u8ba1\u7b97\u673a\u90fd\u53ef\u4ee5\u6709\u6548\u5730\u5e76\u884c\u5316-\u90a3\u4e48\u4e3a\u4ec0\u4e48\u4e0d\u4ece\u4e00\u5f00\u59cb\u5c31\u5e76\u884c\u5316\u5462\uff1f</li> </ul>"},{"location":"2020-01-19-%F0%9F%A7%99%F0%9F%8F%BD%E2%80%8D%E2%99%82%EF%B8%8F%E6%96%B0%E4%BA%BA%E5%92%8C%E9%9D%9E%E6%8A%80%E6%9C%AF%E4%BA%BA%E5%91%98%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8%E6%8B%93%E5%B1%95/#_2","title":"\u5355\u4e2a\u670d\u52a1\u5668+\u6570\u636e\u5e93","text":"<p>\u8fd9\u4e5f\u8bb8\u662f\u4f60\u7684\u540e\u7aef\u6700\u5f00\u59cb\u7684\u6837\u5b50\u3002\u4e00\u4e2a\u5355\u72ec\u7684\u5e94\u7528\u670d\u52a1\u5668\u8fd0\u884c\u7740\u4f60\u7684\u4e1a\u52a1\u903b\u8f91\uff0c\u4e00\u4e2a\u6570\u636e\u5e93\u4fdd\u5b58\u7740\u6570\u636e\u3002\u4e8b\u60c5\u65e2\u7b80\u5355\u53c8\u597d\uff0c\u4f46\u662f\u6ee1\u8db3\u66f4\u9ad8\u9700\u6c42\u7684\u6b64\u8bbe\u7f6e\u7684\u552f\u4e00\u65b9\u6cd5\u662f\u5728\u529f\u80fd\u66f4\u5f3a\u5927\u7684\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u5b83-\u4e0d\u597d\u3002</p>"},{"location":"2020-01-19-%F0%9F%A7%99%F0%9F%8F%BD%E2%80%8D%E2%99%82%EF%B8%8F%E6%96%B0%E4%BA%BA%E5%92%8C%E9%9D%9E%E6%8A%80%E6%9C%AF%E4%BA%BA%E5%91%98%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8%E6%8B%93%E5%B1%95/#_3","title":"\u6dfb\u52a0\u4e00\u4e2a\u53cd\u5411\u4ee3\u7406","text":"<p>\u6dfb\u52a0\u4e00\u4e2a\u53cd\u5411\u4ee3\u7406\u662f\u4f60\u51c6\u5907\u67b6\u6784\u7684\u7b2c\u4e00\u6b65\u3002\u60f3\u4e00\u4e0b\u9152\u5e97\u524d\u53f0\uff0c\u4e5f\u8bb8\u4f60\u53ef\u4ee5\u76f4\u63a5\u5c06\u5ba2\u4eba\u5e26\u5230\u623f\u95f4\u2014\u2014\u4f46\u662f\uff0c\u4f60\u771f\u7684\u9700\u8981\u4e00\u4f4d\u4e2d\u95f4\u4eba\u6765\u6821\u9a8c\u4e00\u4f4d\u5ba2\u4eba\u662f\u5426\u88ab\u5141\u8bb8\u8fdb\u5165\uff0c\u662f\u5426\u5979\u7684\u6240\u6709\u6587\u4ef6\u90fd\u9f50\u5168\u5e76\u4e14\u51c6\u5907\u524d\u53bb\u4e00\u4e2a\u5b58\u5728\u7684\u623f\u95f4\u3002\u800c\u4e14\u5982\u679c\u623f\u95f4\u5173\u95ed\uff0c\u60a8\u5e0c\u671b\u6709\u4eba\u7528\u53cb\u597d\u7684\u58f0\u97f3\u544a\u8bc9\u5ba2\u4eba\uff0c\u800c\u4e0d\u662f\u8ba9\u4ed6\u4eec\u9677\u5165\u56f0\u5883\u3002\u8fd9\u5c31\u662f\u4e00\u4e2a\u53cd\u5411\u4ee3\u7406\u6240\u505a\u7684\u5de5\u4f5c\u3002\u901a\u5e38\uff0c\u4ee3\u7406\u53ea\u662f\u4e00\u4e2a\u63a5\u6536\u548c\u8f6c\u53d1\u8bf7\u6c42\u7684\u8fc7\u7a0b\u3002\u901a\u5e38\uff0c\u8fd9\u4e9b\u8bf7\u6c42\u5c06\u4ece\u6211\u4eec\u7684\u670d\u52a1\u5668\u53d1\u9001\u5230Internet\u3002\u4f46\u662f\u8fd9\u91cc\u7684\u8bf7\u6c42\u6765\u81ea\u4e92\u8054\u7f51\uff0c\u9700\u8981\u8def\u7531\u5230\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u56e0\u6b64\u6211\u4eec\u5c06\u5176\u79f0\u4e3a\u201c\u53cd\u5411\u4ee3\u7406\u201d\u3002</p> <p>\u8fd9\u6837\u7684\u4ee3\u7406\u53ef\u4ee5\u505a\u8fd9\u4e9b\u4e8b\uff1a</p> <ul> <li><code>\u8fd0\u884c\u72b6\u51b5\u68c0\u67e5</code>\u53ef\u786e\u4fdd\u6211\u4eec\u7684\u5b9e\u9645\u670d\u52a1\u5668\u4ecd\u5728\u8fd0\u884c</li> <li><code>\u8def\u7531</code>\u5c06\u8bf7\u6c42\u8f6c\u53d1\u5230\u6b63\u786e\u7684\u7aef\u70b9</li> <li><code>\u8eab\u4efd\u9a8c\u8bc1\uff08Authentication\uff09</code>\u53ef\u786e\u4fdd\u5b9e\u9645\u4e0a\u5df2\u6388\u4e88\u7528\u6237\u8bbf\u95ee\u670d\u52a1\u5668\u7684\u6743\u9650</li> <li><code>\u9632\u706b\u5899</code>\u786e\u4fdd\u7528\u6237\u53ea\u80fd\u8bbf\u95ee\u4ed6\u4eec\u88ab\u5141\u8bb8\u4f7f\u7528\u7684\u7f51\u7edc\u90e8\u5206</li> </ul> <p>\u4ee5\u53ca\u66f4\u591a\u3002</p>"},{"location":"2020-01-19-%F0%9F%A7%99%F0%9F%8F%BD%E2%80%8D%E2%99%82%EF%B8%8F%E6%96%B0%E4%BA%BA%E5%92%8C%E9%9D%9E%E6%8A%80%E6%9C%AF%E4%BA%BA%E5%91%98%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8%E6%8B%93%E5%B1%95/#_4","title":"\u5f15\u5165\u4e00\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668","text":"<p>\u53cd\u5411\u4ee3\u7406\u901a\u5e38\u53ef\u4ee5\u6709\u8d1f\u8f7d\u5747\u8861\u7684\u529f\u80fd\u3002\u8d1f\u8f7d\u5747\u8861\u7684\u6982\u5ff5\u5f88\u7b80\u5355\uff0c\u60f3\u8c61\u4e00\u4e0b\u73b0\u5728\u6709100\u4f4d\u7528\u6237\u9700\u8981\u652f\u4ed8\uff0c\u4f46\u662f\u4f60\u76ee\u524d\u53ea\u6709\u4e00\u53f0\u652f\u4ed8\u670d\u52a1\u5668\uff0c\u4e00\u53f0\u652f\u4ed8\u670d\u52a1\u5668\u6700\u591a\u53ea\u80fd\u652f\u630150\u4f4d\u7528\u6237\u652f\u4ed8\uff0c\u4f60\u53ef\u4ee5\u540c\u65f6\u8fd0\u884c\u4e24\u4e2a\u652f\u4ed8\u670d\u52a1\u5668\u3002</p> <p>\u4e00\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u5de5\u4f5c\u5c31\u662f\u5c06\u8bf7\u6c42\u6309\u7167\u914d\u7f6e\u7684\u7b56\u7565\u5206\u5230\u4e24\u4e2a\u670d\u52a1\u5668\uff0c\u6bd4\u5982\u5e73\u5747\u5206\u914d\u3001\u6309\u6743\u91cd\u5206\u914d\u7b49\u7b49\u3002</p>"},{"location":"2020-01-19-%F0%9F%A7%99%F0%9F%8F%BD%E2%80%8D%E2%99%82%EF%B8%8F%E6%96%B0%E4%BA%BA%E5%92%8C%E9%9D%9E%E6%8A%80%E6%9C%AF%E4%BA%BA%E5%91%98%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8%E6%8B%93%E5%B1%95/#_5","title":"\u589e\u52a0\u6570\u636e\u670d\u52a1\u5668","text":"<p>\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\u5668\u53ef\u4ee5\u5c06\u8d1f\u8f7d\u5206\u62c5\u7ed9\u591a\u4e2a\u5e94\u7528\u670d\u52a1\u5668\uff0c\u4f60\u770b\u51fa\u4e86\u76ee\u524d\u7684\u95ee\u9898\u5417\uff1f\u4f60\u53ef\u4ee5\u5229\u7528\u8d1f\u8f7d\u5747\u8861\u5c06\u8d1f\u8f7d\u5206\u62c5\u7ed9\u6210\u5343\u4e0a\u4e07\u7684\u5e94\u7528\u670d\u52a1\u5668\uff0c\u4f46\u662f\u6570\u636e\u5e93\u670d\u52a1\u5668\u53ea\u6709\u4e00\u4e2a\u3002\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u7528\u540c\u6837\u7684\u65b9\u5f0f\u6765\u62d3\u5c55\u6570\u636e\u5e93\u5417\uff1f\u4e0d\u5e78\u7684\u662f\u4e0d\u53ef\u4ee5\u3002\u8fd9\u91cc\u7684\u95ee\u9898\u662f\u4e00\u81f4\u6027\uff08consistency\uff09\uff0c\u6211\u4eec\u7cfb\u7edf\u7684\u6240\u6709\u90e8\u5206\u90fd\u9700\u8981\u5c31\u4f7f\u7528\u7684\u6570\u636e\u8fbe\u6210\u4e00\u81f4\u3002\u4e0d\u4e00\u81f4\u7684\u6570\u636e\u5c06\u5bfc\u81f4\u5f88\u591a\u95ee\u9898\uff0c\u4f8b\u5982\u8ba2\u5355\u88ab\u5904\u7406\u591a\u6b21\uff0c\u4ece\u540c\u4e00\u4e2a\u8d26\u6237\u4e2d\u91cd\u590d\u6263\u6b3e\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff1b\u90a3\u4e48\u6211\u4eec\u5982\u4f55\u5728\u786e\u4fdd\u4e00\u81f4\u6027\u7684\u540c\u65f6\u62d3\u5c55\u6570\u636e\u5e93\uff1f</p> <p>\u6211\u4eec\u53ef\u4ee5\u505a\u7684\u7b2c\u4e00\u4ef6\u4e8b\u662f\u5c06\u5176\u5206\u4e3a\u591a\u4e2a\u90e8\u5206\u3002\u4e00\u90e8\u5206\u4e13\u95e8\u8d1f\u8d23\u63a5\u6536\u548c\u5b58\u50a8\u6570\u636e\uff0c\u5176\u4ed6\u6240\u6709\u90e8\u5206\u8d1f\u8d23\u68c0\u7d22\u5b58\u50a8\u7684\u6570\u636e\u3002\u8fd9\u79cd\u89e3\u51b3\u65b9\u6848\u4e5f\u79f0\u4e3a\u4e3b/\u4ece\u8bbe\u7f6e\u4e0e\u8bfb\u5199\u5206\u79bb\u3002\u6b64\u5904\u7684\u5047\u8bbe\u662f\u8bfb\u7684\u64cd\u4f5c\u6bd4\u5199\u7684\u64cd\u4f5c\u6b21\u6570\u591a\u3002\u6b64\u89e3\u51b3\u65b9\u6848\u7684\u4f18\u70b9\u662f\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u4e00\u81f4\u6027\uff0c\u56e0\u4e3a\u6570\u636e\u4ec5\u5199\u5165\u5355\u4e2a\u5b9e\u4f8b\uff0c\u5e76\u4ece\u4e00\u4e2a\u5b9e\u4f8b\uff08\u4ece\u5199\u5165\u5230\u8bfb\u53d6\uff09\u4ece\u90a3\u91cc\u6d41\u52a8\u3002\u7f3a\u70b9\u662f\u6211\u4eec\u4ecd\u7136\u53ea\u6709\u4e00\u4e2a\u6570\u636e\u5e93\u5b9e\u4f8b\u8981\u5199\u5165\u3002\u8fd9\u5bf9\u4e8e\u4e2d\u5c0f\u578bWeb\u9879\u76ee\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u5982\u679c\u60a8\u8fd0\u884cFacebook\uff0c\u5b83\u5c31\u4e0d\u4f1a\u8fd9\u6837\u505a\u3002</p>"},{"location":"2020-01-19-%F0%9F%A7%99%F0%9F%8F%BD%E2%80%8D%E2%99%82%EF%B8%8F%E6%96%B0%E4%BA%BA%E5%92%8C%E9%9D%9E%E6%8A%80%E6%9C%AF%E4%BA%BA%E5%91%98%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8%E6%8B%93%E5%B1%95/#_6","title":"\u5fae\u670d\u52a1","text":"<p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u53ea\u5904\u7406\u4e00\u53f0\u670d\u52a1\u5668\uff0c\u8be5\u670d\u52a1\u5668\u53ef\u4ee5\u5b8c\u6210\u6240\u6709\u5de5\u4f5c\uff1a\u5904\u7406\u4ed8\u6b3e\uff0c\u8ba2\u5355\uff0c\u5e93\u5b58\uff0c\u4e3a\u7f51\u7ad9\u63d0\u4f9b\u670d\u52a1\uff0c\u7ba1\u7406\u7528\u6237\u5e10\u6237\u7b49\u7b49\u3002\u8fd9\u4e0d\u4e00\u5b9a\u662f\u4e00\u4ef6\u574f\u4e8b-\u5355\u4e2a\u670d\u52a1\u5668\u610f\u5473\u7740\u8f83\u4f4e\u7684\u590d\u6742\u6027\uff0c\u56e0\u6b64\u5bf9\u6211\u4eec\u7684\u5f00\u53d1\u4eba\u5458\u800c\u8a00\uff0c\u5934\u75db\u66f4\u5c11\u3002\u4f46\u662f\u968f\u7740\u89c4\u6a21\u7684\u6269\u5927\uff0c\u4e8b\u60c5\u5f00\u59cb\u53d8\u5f97\u590d\u6742\u548c\u4f4e\u6548\uff1a</p> <ul> <li>\u6211\u4eec\u670d\u52a1\u5668\u7684\u4e0d\u540c\u90e8\u5206\u88ab\u4e0d\u540c\u7a0b\u5ea6\u5730\u5229\u7528-\u5bf9\u4e8e\u6bcf\u4e2a\u7528\u6237\u767b\u5f55\uff0c\u53ef\u80fd\u8981\u5904\u7406\u51e0\u767e\u6b21\u6d4f\u89c8\u91cf\u548c\u8981\u63d0\u4f9b\u7684\u8d44\u4ea7\uff0c\u4f46\u662f\u6240\u6709\u64cd\u4f5c\u90fd\u662f\u7531\u540c\u4e00\u53f0\u670d\u52a1\u5668\u5b8c\u6210\u7684</li> <li>\u6211\u4eec\u7684\u5f00\u53d1\u56e2\u961f\u4f1a\u968f\u7740\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u53d1\u5c55\u800c\u589e\u957f-\u4f46\u662f\uff0c\u968f\u7740\u8d8a\u6765\u8d8a\u591a\u7684\u5f00\u53d1\u4eba\u5458\u5728\u540c\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u5de5\u4f5c\uff0c\u4ed6\u4eec\u66f4\u6709\u53ef\u80fd\u8e29\u5230\u5f7c\u6b64\u7684\u811a\u8dbe\u3002</li> <li>\u4ec5\u62e5\u6709\u4e00\u53f0\u670d\u52a1\u5668\u610f\u5473\u7740\u6bcf\u5f53\u6211\u4eec\u8981\u4e0a\u7ebf\u65b0\u7248\u672c\u65f6\uff0c\u90fd\u5fc5\u987b\u5b8c\u6210\u6240\u6709\u5de5\u4f5c\u5e76\u8fdb\u884c\u5904\u7406\u3002\u6bcf\u5f53\u4e00\u4e2a\u56e2\u961f\u8fc5\u901f\u60f3\u8981\u53d1\u5e03\u66f4\u65b0\u65f6\uff0c\u8fd9\u5c31\u4f1a\u5bfc\u81f4\u5371\u9669\u7684\u76f8\u4e92\u4f9d\u8d56\uff0c\u800c\u53e6\u4e00\u56e2\u961f\u4ec5\u5b8c\u6210\u4e86\u4e00\u534a\u7684\u5de5\u4f5c\u3002</li> </ul> <p>\u5e94\u5bf9\u8fd9\u4e9b\u6311\u6218\u7684\u89e3\u51b3\u65b9\u6848\u662f\u4e00\u79cd\u67b6\u6784\u8303\u4f8b\uff0c\u5df2\u5e2d\u5377\u5f00\u53d1\u4eba\u5458\uff1a\u5fae\u670d\u52a1\u3002\u8fd9\u4e2a\u60f3\u6cd5\u5f88\u7b80\u5355-\u5c06\u60a8\u7684\u670d\u52a1\u5668\u5206\u89e3\u4e3a\u529f\u80fd\u5355\u5143\uff0c\u5e76\u5c06\u5b83\u4eec\u90e8\u7f72\u4e3a\u5355\u72ec\u7684\uff0c\u76f8\u4e92\u8fde\u63a5\u7684\u5fae\u578b\u670d\u52a1\u5668\u3002\u8fd9\u6709\u5f88\u591a\u597d\u5904\uff1a</p> <ul> <li>\u6bcf\u4e2a\u670d\u52a1\u53ef\u4ee5\u5355\u72ec\u62d3\u5c55\uff0c\u4f7f\u6211\u4eec\u80fd\u591f\u66f4\u597d\u5730\u9002\u5e94\u9700\u6c42</li> <li>\u5f00\u53d1\u56e2\u961f\u53ef\u4ee5\u72ec\u7acb\u5de5\u4f5c\uff0c\u6bcf\u4e2a\u56e2\u961f\u90fd\u8d1f\u8d23\u5404\u81ea\u5fae\u670d\u52a1\u7684\u751f\u547d\u5468\u671f\uff08\u521b\u5efa\uff0c\u90e8\u7f72\uff0c\u66f4\u65b0\u7b49\uff09</li> <li>\u6bcf\u4e2a\u5fae\u670d\u52a1\u90fd\u53ef\u4ee5\u4f7f\u7528\u81ea\u5df1\u7684\u8d44\u6e90\uff0c\u4f8b\u5982\u81ea\u5df1\u7684\u6570\u636e\u5e93</li> </ul>"},{"location":"2020-01-19-%F0%9F%A7%99%F0%9F%8F%BD%E2%80%8D%E2%99%82%EF%B8%8F%E6%96%B0%E4%BA%BA%E5%92%8C%E9%9D%9E%E6%8A%80%E6%9C%AF%E4%BA%BA%E5%91%98%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8%E6%8B%93%E5%B1%95/#cdn","title":"\u7f13\u5b58\u548cCDN","text":"<p>\u6709\u4ec0\u4e48\u6bd4\u63d0\u9ad8\u5de5\u4f5c\u6548\u7387\u66f4\u597d\uff1f\u6839\u672c\u4e0d\u7528\u5de5\u4f5c\uff01\u6211\u4eec\u7684\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f\u5f88\u5927\u4e00\u90e8\u5206\u662f\u7531\u9759\u6001\u8d44\u4ea7\u7ec4\u6210\u7684\uff0c\u8fd9\u4e9b\u8d44\u4ea7\u662f\u6c38\u8fdc\u4e0d\u53d8\u7684\uff0c\u4f8b\u5982\u56fe\u50cf\uff0cJavaScript\u548cCSS\u6587\u4ef6\uff0c\u67d0\u4e9b\u4ea7\u54c1\u7684\u9884\u6e32\u67d3\u76ee\u6807\u7f51\u9875\u7b49\u3002\u65e0\u9700\u5728\u6bcf\u4e2a\u8bf7\u6c42\u4e0a\u91cd\u65b0\u8ba1\u7b97\u6216\u4fdd\u7559\u8fd9\u4e9b\u8d44\u4ea7\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u201c\u7f13\u5b58\u201d-\u4e00\u79cd\u5c0f\u578b\u5b58\u50a8\uff0c\u4ec5\u8bb0\u4f4f\u6700\u540e\u7684\u7ed3\u679c\u5e76\u5c06\u5176\u5206\u53d1\u7ed9\u6240\u6709\u611f\u5174\u8da3\u7684\u4eba\uff0c\u800c\u4e0d\u4f1a\u6253\u6270\u5e95\u5c42\u670d\u52a1\u5668\u3002</p> <p>\u201c\u5185\u5bb9\u4ea4\u4ed8\u7f51\u7edc\u201d\uff08CDN\uff09-\u904d\u5e03\u4e16\u754c\u5404\u5730\u7684\u5927\u91cf\u7f13\u5b58\uff0c\u88ab\u79f0\u4e3a\u7f13\u5b58\u7684\u201c\u5347\u7ea7\u7248\u201d\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4ece\u7528\u6237\u9644\u8fd1\u7684\u5546\u5e97\u5411\u7528\u6237\u63d0\u4f9b\u5185\u5bb9\uff0c\u800c\u4e0d\u5fc5\u6bcf\u6b21\u90fd\u5728\u5168\u7403\u8303\u56f4\u5185\u53d1\u9001\u6570\u636e\u3002</p>"},{"location":"2020-01-19-%F0%9F%A7%99%F0%9F%8F%BD%E2%80%8D%E2%99%82%EF%B8%8F%E6%96%B0%E4%BA%BA%E5%92%8C%E9%9D%9E%E6%8A%80%E6%9C%AF%E4%BA%BA%E5%91%98%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8%E6%8B%93%E5%B1%95/#_7","title":"\u6d88\u606f\u961f\u5217","text":"<p>\u60a8\u53bb\u8fc7\u6e38\u4e50\u56ed\u5417\uff1f\u60a8\u53ea\u662f\u8d70\u5230\u552e\u7968\u67dc\u53f0\u4e70\u7968\u5417\uff1f\u53ef\u80fd\u4e0d\u662f-\u60a8\u6700\u7ec8\u53ef\u80fd\u4f1a\u6392\u961f\u7b49\u5f85\u3002\u653f\u5e9c\u673a\u6784\uff0c\u90ae\u5c40\u548c\u6e38\u4e50\u56ed\u5165\u53e3\u90fd\u662f\u201c\u6b21\u5bb9\u91cf\u5e76\u884c\u6027\u201d\u6982\u5ff5\u7684\u7edd\u4f73\u793a\u4f8b-\u662f\u7684\uff0c\u5b83\u4eec\u662f\u5e76\u884c\u7684\uff1a\u591a\u4e2a\u552e\u7968\u4ead\u53ef\u4ee5\u540c\u65f6\u51fa\u552e\u95e8\u7968-\u4f46\u4f3c\u4e4e\u6c38\u8fdc\u4e0d\u8db3\u4ee5\u7acb\u5373\u4e3a\u6bcf\u4e2a\u4eba\u63d0\u4f9b\u670d\u52a1\uff0c\u7ed3\u679c\uff0c\u961f\u5217\u5f00\u59cb\u5f62\u6210\u3002</p> <p>\u5927\u578bWeb\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u76f8\u540c\u7684\u6982\u5ff5\u3002\u6bcf\u5206\u949f\u5c06\u6570\u5341\u4e07\u5f20\u56fe\u50cf\u4e0a\u4f20\u5230Instagram\uff0cFacebook\u548cCo\uff0c\u5176\u4e2d\u6bcf\u4e2a\u56fe\u50cf\u90fd\u9700\u8981\u8fdb\u884c\u5904\u7406\uff0c\u8c03\u6574\u5927\u5c0f\uff0c\u5206\u6790\u548c\u6807\u8bb0-\u8fd9\u662f\u4e00\u4e2a\u8017\u65f6\u7684\u8fc7\u7a0b\u3002\u56e0\u6b64\uff0c\u4e0d\u5fc5\u8ba9\u7528\u6237\u7b49\u5230\u4ed6\u4eec\u7684\u4e0a\u4f20\u5b8c\u6210\u6240\u6709\u8fd9\u4e9b\u6b65\u9aa4\u3002\u63a5\u6536\u56fe\u50cf\u7684\u670d\u52a1\u5668\u4ec5\u505a\u4e09\u4ef6\u4e8b\uff1a</p> <ul> <li>\u5b83\u5b58\u50a8\u672a\u5904\u7406\u7684\u539f\u59cb\u56fe\u50cf</li> <li>\u786e\u8ba4\u4e0a\u4f20\u7ed9\u7528\u6237</li> <li>\u5b83\u5728\u4e00\u5927\u5806\u7eb8\u4e0a\u6dfb\u52a0\u4e86\u865a\u62df\u4fbf\u7b7e\uff0c\u6307\u5b9a\u9700\u8981\u505a\u4ec0\u4e48</li> </ul> <p>\u4ece\u8fd9\u91cc\u5f00\u59cb\uff0c\u6b64\u7b14\u8bb0\u7531\u4efb\u610f\u6570\u91cf\u7684\u5176\u4ed6\u670d\u52a1\u5668\u62fe\u53d6\uff0c\u6bcf\u4e2a\u670d\u52a1\u5668\u90fd\u5b8c\u6210\u5176\u4efb\u52a1\u4e4b\u4e00\uff0c\u5c06\u5176\u9009\u4e2d\uff0c\u7136\u540e\u5c06\u5176\u653e\u56de\u5806\u4e2d-\u76f4\u5230\u5b8c\u6210\u5f85\u529e\u4e8b\u9879\u5217\u8868\u3002\u7ba1\u7406\u8fd9\u5806\u7b14\u8bb0\u7684\u7cfb\u7edf\u79f0\u4e3a\u201c\u6d88\u606f\u961f\u5217\u201d\u3002\u4f7f\u7528\u8fd9\u6837\u7684\u961f\u5217\u6709\u8bb8\u591a\u4f18\u70b9\uff1a</p> <ul> <li>\u5b83\u4f7f\u4efb\u52a1\u548c\u5904\u7406\u5668\u5206\u79bb\u3002\u6709\u65f6\u9700\u8981\u5904\u7406\u5927\u91cf\u56fe\u50cf\uff0c\u6709\u65f6\u4ec5\u9700\u8981\u5904\u7406\u5c11\u91cf\u56fe\u50cf\u3002\u6709\u65f6\u6709\u5f88\u591a\u5904\u7406\u5668\u53ef\u7528\uff0c\u6709\u65f6\u53ea\u6709\u51e0\u4e2a\u3002\u901a\u8fc7\u7b80\u5355\u5730\u5c06\u4efb\u52a1\u6dfb\u52a0\u5230\u79ef\u538b\u4e2d\u800c\u4e0d\u662f\u76f4\u63a5\u5904\u7406\u5b83\u4eec\uff0c\u53ef\u4ee5\u786e\u4fdd\u6211\u4eec\u7684\u7cfb\u7edf\u4fdd\u6301\u54cd\u5e94\u80fd\u529b\uff0c\u5e76\u4e14\u4e0d\u4f1a\u4e22\u5931\u4efb\u4f55\u4efb\u52a1\u3002</li> <li>\u5b83\u4f7f\u6211\u4eec\u80fd\u591f\u6309\u9700\u6269\u5c55\u3002\u542f\u52a8\u66f4\u591a\u7684\u5904\u7406\u5668\u9700\u8981\u65f6\u95f4-\u56e0\u6b64\uff0c\u5f53\u8bb8\u591a\u7528\u6237\u5c1d\u8bd5\u4e0a\u4f20\u56fe\u50cf\u65f6\uff0c\u5df2\u7ecf\u4e3a\u65f6\u5df2\u665a\u3002\u901a\u8fc7\u5c06\u6211\u4eec\u7684\u4efb\u52a1\u6dfb\u52a0\u5230\u961f\u5217\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u63a8\u8fdf\u63d0\u4f9b\u66f4\u591a\u529f\u80fd\u6765\u5904\u7406\u5b83\u4eec\u7684\u9700\u8981</li> </ul> <p>\u597d\u5427\uff0c\u5982\u679c\u6211\u4eec\u6309\u7167\u4e0a\u9762\u7684\u6240\u6709\u6b65\u9aa4\u8fdb\u884c\u64cd\u4f5c\uff0c\u6211\u4eec\u7684\u7cfb\u7edf\u73b0\u5728\u5c31\u53ef\u4ee5\u63d0\u4f9b\u53ef\u89c2\u7684\u6d41\u91cf\u4e86\u3002\u4f46\u662f\uff0c\u5982\u679c\u6211\u4eec\u60f3\u505a\u5927\u7684\u4e8b\u60c5-\u771f\u7684\u505a\u5927\u4e86\uff0c\u600e\u4e48\u529e\uff1f\u597d\u4e86\uff0c\u8fd8\u6709\u4e00\u4e9b\u9009\u62e9\uff1a</p>"},{"location":"2020-01-19-%F0%9F%A7%99%F0%9F%8F%BD%E2%80%8D%E2%99%82%EF%B8%8F%E6%96%B0%E4%BA%BA%E5%92%8C%E9%9D%9E%E6%8A%80%E6%9C%AF%E4%BA%BA%E5%91%98%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8%E6%8B%93%E5%B1%95/#_8","title":"\u5206\u7247","text":"<p>\u5206\u7247\u662f\uff1a</p> <p>Sharding is a technique of parallelizing an application's stacks by separating them into multiple units, each responsible for a certain key or namespace.</p> <p>\u90a3\u5230\u5e95\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u5b9e\u9645\u4e0a\u5f88\u7b80\u5355\uff1a\u9700\u8981\u4e3a20\u4ebf\u7528\u6237\u63d0\u4f9bFacebook\u4e2a\u4eba\u8d44\u6599\u5417\uff1f\u5c06\u60a8\u7684\u67b6\u6784\u5206\u89e3\u4e3a26\u4e2a\u8ff7\u4f60Facebook\uff0c\u6bcf\u4e2aFacebook\u7528\u4e0d\u540c\u7684\u5b57\u6bcd\u4e3a\u7528\u6237\u670d\u52a1\u3002\u4e9a\u4f26\u00b7\u4e9a\u4f2f\u62c9\u7f55\uff08Aaron Abrahams\uff09\uff1f\u5806\u6808A. Zacharias Zuckerberg\u5c06\u4e3a\u60a8\u670d\u52a1\uff1f Z\u6808\u662f...</p> <p>\u5206\u7247\u4e0d\u5fc5\u57fa\u4e8e\u5b57\u6bcd\uff0c\u800c\u53ef\u4ee5\u57fa\u4e8e\u591a\u79cd\u56e0\u7d20\uff0c\u4f8b\u5982\u4f4d\u7f6e\uff0c\u4f7f\u7528\u9891\u7387\uff08\u9ad8\u7ea7\u7528\u6237\u88ab\u8def\u7531\u5230\u597d\u7684\u786c\u4ef6\uff09\u7b49\u7b49\u3002\u60a8\u53ef\u4ee5\u6839\u636e\u9700\u8981\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u5bf9\u670d\u52a1\u5668\uff0c\u6570\u636e\u5e93\u6216\u5806\u6808\u7684\u51e0\u4e4e\u4efb\u4f55\u65b9\u9762\u8fdb\u884c\u5206\u7247\u3002</p>"},{"location":"2020-01-19-%F0%9F%A7%99%F0%9F%8F%BD%E2%80%8D%E2%99%82%EF%B8%8F%E6%96%B0%E4%BA%BA%E5%92%8C%E9%9D%9E%E6%8A%80%E6%9C%AF%E4%BA%BA%E5%91%98%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8%E6%8B%93%E5%B1%95/#_9","title":"\u57df\u540d\u7cfb\u7edf","text":"<p>\u5355\u4e2a\u8d1f\u8f7d\u5e73\u8861\u5668\u53ea\u80fd\u5e26\u60a8\u5230\u60a8\u4e3a\u6b62-\u5373\u4f7f\u60a8\u5f00\u59cb\u8d2d\u4e70\u4e00\u4e9b\u529f\u80fd\u5f3a\u5927\uff08\u4e14\u4ef7\u683c\u6602\u8d35\uff09\u7684\u786c\u4ef6\u8d1f\u8f7d\u5e73\u8861\u5668\uff0c\u5bf9\u5176\u53ef\u4ee5\u5904\u7406\u7684\u8bf7\u6c42\u6570\u91cf\u4e5f\u6709\u4e25\u683c\u7684\u9650\u5236\u3002</p> <p>\u5e78\u8fd0\u7684\u662f\uff0c\u5728\u5168\u7403\u8303\u56f4\u5185\uff0c\u5229\u7528\u57df\u540d\u7cfb\u7edf\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6d41\u91cf\u672a\u8fbe\u5230\u6211\u4eec\u7684\u8d1f\u8f7d\u5747\u8861\u5668\u4e4b\u524d\u5c31\u53ef\u4ee5\u7528\u6765\u5bf9\u6d41\u91cf\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\u3002\u548c\u6700\u597d\u7684\u4e8b\u60c5\uff1f\u5b83\u662f\u5b8c\u5168\u514d\u8d39\u7684\u3002\u5c06\u57df\u540d\uff08\u4f8b\u5982\u201c arcentry.com\u201d\uff09\u6620\u5c04\u5230IP\uff08\u4f8b\u5982\u201c 143.204.47.77\u201d\uff09\u7684\u5168\u7403\u6ce8\u518c\u8868\u3002\u8be5\u6ce8\u518c\u8868\u5141\u8bb8\u6211\u4eec\u4e3a\u6bcf\u4e2a\u57df\u540d\u6307\u5b9a\u591a\u4e2aIP\uff0c\u6bcf\u4e2aIP\u5bfc\u81f4\u4e00\u4e2a\u4e0d\u540c\u7684\u8d1f\u8f7d\u5747\u8861\u5668\u3002</p> <p>\u6211\u5e0c\u671b\u8fd9\u7bc7\u535a\u5ba2\u6587\u7ae0\u5bf9\u60a8\u6709\u7528\u3002\u4f46\u662f-\u5982\u679c\u60a8\u5728\u4efb\u4f55\u4e0eIT\u76f8\u5173\u7684\u9886\u57df\u4e2d\u5de5\u4f5c\uff0c\u90a3\u4e48\u5728\u9605\u8bfb\u672c\u6587\u65f6\uff0c\u60a8\u7684\u80f8\u53e3\u53ef\u80fd\u4f1a\u71c3\u8d77\u4e00\u4e2a\u95ee\u9898\uff1a\u201c\u4e91\u670d\u52a1\u5462\uff1f\u201d</p>"},{"location":"2020-01-19-%F0%9F%A7%99%F0%9F%8F%BD%E2%80%8D%E2%99%82%EF%B8%8F%E6%96%B0%E4%BA%BA%E5%92%8C%E9%9D%9E%E6%8A%80%E6%9C%AF%E4%BA%BA%E5%91%98%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8%E6%8B%93%E5%B1%95/#serverless","title":"\u4e91\u8ba1\u7b97/Serverless","text":"<p>\u4f46\u662f\u4e91\u670d\u52a1\u5462\uff1f\u5f88\u597d-\u73b0\u5728\u662f2018\u5e74\uff0c\u89e3\u51b3\u4e0a\u8ff0\u8bb8\u591a\u95ee\u9898\u7684\u6700\u4fbf\u5b9c\uff0c\u6700\u6709\u6548\u7684\u89e3\u51b3\u65b9\u6848\u975e\u5e38\u6e05\u695a\uff1a</p> <p>\u6839\u672c\u4e0d\u89e3\u51b3\u5b83\u4eec\u3002</p> <p>\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\uff0c\u5c06\u5176\u4ea4\u7ed9\u60a8\u7684\u4e91\u63d0\u4f9b\u5546\uff0c\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u53ef\u4ee5\u8f7b\u677e\u6ee1\u8db3\u60a8\u7684\u9700\u6c42\u7684\u7cfb\u7edf\uff0c\u800c\u60a8\u4e0d\u5fc5\u62c5\u5fc3\u5176\u590d\u6742\u6027\u3002 </p> <p>\u4f8b\u5982\uff0cArcentry\u4e0d\u6267\u884c\u4e0a\u8ff0\u4efb\u4f55\u64cd\u4f5c\uff08\u9664\u4e86\u5bf9\u5176\u6570\u636e\u5e93\u8fdb\u884c\u5199/\u8bfb\u62c6\u5206\u4e4b\u5916\uff09\uff0c\u800c\u53ea\u662f\u5c06\u5176\u7559\u7ed9Amazon Web Service\u7684Lambda\u51fd\u6570\u6765\u8fd0\u884c\u5176\u903b\u8f91-\u65e0\u9700\u670d\u52a1\u5668\uff0c\u65e0\u9700\u9ebb\u70e6\u3002</p> <p>\u4f46\u662f\uff0c\u4e91\u5e76\u4e0d\u662f\u60a8\u7b80\u5355\u6253\u5f00\u7684\u4e1c\u897f\uff0c\u800c\u662f\u53ef\u4ee5\u89e3\u51b3\u6240\u6709\u95ee\u9898\u7684\uff0c\u5b83\u5e26\u6709\u81ea\u5df1\u7684\u4e00\u7cfb\u5217challenge\u548ctrade-off\u3002</p>"},{"location":"2020-04-05-%F0%9F%92%BC%E5%91%BD%E4%BB%A4Command%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%9C%A8%E8%AE%BE%E8%AE%A1API%E6%97%B6%E7%9A%84%E8%BF%90%E7%94%A8/","title":"2020 04 05 \ud83d\udcbc\u547d\u4ee4Command\u8bbe\u8ba1\u6a21\u5f0f\u5728\u8bbe\u8ba1API\u65f6\u7684\u8fd0\u7528","text":"<p>\u4f60\u662f\u5426\u4f7f\u7528\u8fc7\u4e00\u4e9b\u7c7b\u4f3c\u4e8e\u8fd9\u6837\u7684API\uff1f</p> <p>\u547d\u4ee4\u6a21\u5f0f\u662f\u4e00\u79cd\u884c\u4e3a\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u5b83\u53ef\u5c06\u8bf7\u6c42\u8f6c\u6362\u4e3a\u4e00\u4e2a\u5305\u542b\u4e8e\u8bf7\u6c42\u76f8\u5173\u7684\u6240\u6709\u4fe1\u606f\u7684\u72ec\u7acb\u5bf9\u8c61\u3002\u6539\u88c5\u6362\u8ba9\u4f60\u6839\u636e\u4e0d\u540c\u7684\u8bf7\u6c42\u5c06\u65b9\u6cd5\u53c2\u6570\u5316\uff0c\u5ef6\u8fdf\u8bf7\u6c42\u6267\u884c\u6216\u5c06\u5176\u653e\u5165\u961f\u5217\u4e2d\uff0c\u4e14\u80fd\u5b9e\u73b0\u53ef\u64a4\u9500\u64cd\u4f5c\u3002- https://refactoringguru.cn/design-patterns/command</p>"},{"location":"2020-06-14-%F0%9F%A7%AF%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%AF%BC%E8%87%B4%E7%9A%84%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81/","title":"2020 06 14 \ud83e\uddef\u8bb0\u4e00\u6b21\u73af\u5883\u53d8\u91cf\u5bfc\u81f4\u7684\u4e2d\u6587\u4e71\u7801","text":""},{"location":"2020-06-14-%F0%9F%A7%AF%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%AF%BC%E8%87%B4%E7%9A%84%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81/#_1","title":"\u4e00\u3001\u73b0\u8c61","text":"<ol> <li>\u4f7f\u7528\u672c\u5730<code>ssh</code>\u8bbf\u95ee\u670d\u52a1\u5668</li> <li>\u91cd\u542f\u5e94\u7528</li> <li><code>\u67e5\u8be2\u4e3b\u6570\u636e\u5546\u54c1\u4fe1\u606f</code>\u7684\u5185\u5bb9\u4e2d\u6587\u4e71\u7801</li> <li><code>jinfo</code>\u547d\u4ee4\u8f93\u51fa<code>file.encoding = ANSI_X3.4-1968</code></li> <li>\u4f7f\u7528<code>Xshell</code>\u8bbf\u95ee\u670d\u52a1\u5668</li> <li>\u91cd\u542f\u5e94\u7528</li> <li><code>jinfo</code>\u547d\u4ee4\u8f93\u51fa<code>file.encoding = UTF-8</code></li> <li><code>\u67e5\u8be2\u4e3b\u6570\u636e\u5546\u54c1\u4fe1\u606f</code>\u7684\u5185\u5bb9\u4e2d\u6587\u6062\u590d\u6b63\u5e38</li> </ol>"},{"location":"2020-06-14-%F0%9F%A7%AF%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%AF%BC%E8%87%B4%E7%9A%84%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81/#_2","title":"\u4e8c\u3001\u4e3a\u4ec0\u4e48\u4e71\u7801","text":""},{"location":"2020-06-14-%F0%9F%A7%AF%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%AF%BC%E8%87%B4%E7%9A%84%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81/#_3","title":"\u731c\u60f3","text":"<p>\u521d\u6b65\u731c\u60f3\u662f<code>\u672c\u5730ssh</code>\u548c<code>Xshell</code>\u7684<code>ssh\u4f1a\u8bdd</code>\u7684<code>locale</code>\u4f1a\u8bdd\u4e0d\u540c\uff0c\u5bfc\u81f4\u91cd\u542f\u540e\u7684<code>JVM\u9ed8\u8ba4\u5b57\u7b26\u96c6</code>\u7684\u4e0d\u540c\u5bfc\u81f4\u4e86\u4e71\u7801\uff0c\u4f7f\u7528\u4e0b\u9762\u7684\u4ee3\u7801\u7247\u6bb5\u6765\u9a8c\u8bc1\uff1a</p> <pre><code>import java.nio.charset.Charset;\n\npublic class Main {\npublic static void main(String[] args) {\nSystem.out.println(System.getProperty(\"file.encoding\"));\nSystem.out.println(Charset.defaultCharset());\n}\n}\n</code></pre> <p>\u601d\u8def\uff1a\u5206\u522b\u4f7f\u7528<code>\u672c\u5730ssh</code>\u548c<code>Xshell</code>\u8bbf\u95ee\u670d\u52a1\u5668\uff0c\u67e5\u770blocale\u5e76\u6267\u884c\u4ee3\u7801\u7247\u6bb5</p> <p>\u4f7f\u7528<code>\u672c\u5730ssh</code>\u8bbf\u95ee\uff1a</p> <pre><code>[\u670d\u52a1\u5668 ~]$ locale\nlocale: Cannot set LC_CTYPE to default locale: No such file or directory # \u5f02\u5e38\u4fe1\u606f\nlocale: Cannot set LC_ALL to default locale: No such file or directory   # \u5f02\u5e38\u4fe1\u606f\nLANG=en_US.UTF-8\nLC_CTYPE=UTF-8\nLC_NUMERIC=\"en_US.UTF-8\"\nLC_TIME=\"en_US.UTF-8\"\nLC_COLLATE=\"en_US.UTF-8\"\nLC_MONETARY=\"en_US.UTF-8\"\nLC_MESSAGES=\"en_US.UTF-8\"\nLC_PAPER=\"en_US.UTF-8\"\nLC_NAME=\"en_US.UTF-8\"\nLC_ADDRESS=\"en_US.UTF-8\"\nLC_TELEPHONE=\"en_US.UTF-8\"\nLC_MEASUREMENT=\"en_US.UTF-8\"\nLC_IDENTIFICATION=\"en_US.UTF-8\"\nLC_ALL=\n[\u670d\u52a1\u5668 ~]$ java Main\nANSI_X3.4-1968\nUS-ASCII\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6b64\u65f6JVM\u5c5e\u6027<code>file.encoding</code>\u7684\u503c\u4e3a<code>ANSI_X3.4-1968</code>\uff0c\u9ed8\u8ba4\u5b57\u7b26\u96c6\u4e3a<code>US-ASCII</code>\uff1b</p> <p>\u4f7f\u7528<code>Xshell</code>\u8bbf\u95ee\uff1a</p> <pre><code>[\u670d\u52a1\u5668 ~]$ locale\n# \u6ca1\u6709\u5f02\u5e38\u4fe1\u606f\nLANG=en_US.UTF-8\nLC_CTYPE=\"en_US.UTF-8\"\nLC_NUMERIC=\"en_US.UTF-8\"\nLC_TIME=\"en_US.UTF-8\"\nLC_COLLATE=\"en_US.UTF-8\"\nLC_MONETARY=\"en_US.UTF-8\"\nLC_MESSAGES=\"en_US.UTF-8\"\nLC_PAPER=\"en_US.UTF-8\"\nLC_NAME=\"en_US.UTF-8\"\nLC_ADDRESS=\"en_US.UTF-8\"\nLC_TELEPHONE=\"en_US.UTF-8\"\nLC_MEASUREMENT=\"en_US.UTF-8\"\nLC_IDENTIFICATION=\"en_US.UTF-8\"\nLC_ALL=\n[\u670d\u52a1\u5668 ~]$ java Main\nUTF-8\nUTF-8\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6b64\u65f6JVM\u5c5e\u6027<code>file.encoding</code>\u7684\u503c\u4e3a<code>UTF-8</code>\uff0c\u9ed8\u8ba4\u5b57\u7b26\u96c6\u4e3a<code>UTF-8</code>\uff1b</p>"},{"location":"2020-06-14-%F0%9F%A7%AF%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%AF%BC%E8%87%B4%E7%9A%84%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81/#_4","title":"\u5230\u4ee3\u7801\u4e2d\u9a8c\u8bc1\u731c\u60f3","text":"<p>\u4e71\u7801\u7684\u63a5\u53e3\u6838\u5fc3\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>try {\nresult = httpClient.execute(request);\n} catch (Exception e) {\nthrow new RuntimeException(\"\u67e5\u8be2\u5f02\u5e38\",e);\n}\n</code></pre> <p><code>httpclient</code>\u6267\u884cHTTP\u8bf7\u6c42\uff0cexecute\u65b9\u6cd5\u4ee3\u7801\uff1a</p> <pre><code>if(\"POST\".equals(reqType)){\nresponseStr = new String(this.doHttpPost(reqParams, serverUrl)); // \u6ce8\u610f\u70b91\uff1a\u67e5\u8be2\u4e3b\u6570\u636e\u5546\u54c1\u4fe1\u606f\uff0c\u4ee3\u7801\u4f1a\u6267\u884c\u6b64\u884c\n}else if (\"GET\".equals(reqType)){\nresponseStr = new String(this.doHttpGet(reqParams,serverUrl));\n}\n</code></pre> <p><code>\u6ce8\u610f\u70b91</code>\u8fd9\u884c\u4ee3\u7801\uff0c\u901a\u8fc7\u8c03\u7528<code>doHttpPost</code>\u65b9\u6cd5\uff1a</p> <pre><code>URIBuilder uriBuilder = new URIBuilder(serverUrl);\nHttpPost httpPost = new HttpPost(uriBuilder.build());\nhttpPost.setHeader(\"Accept\", \"application/json;charset=utf-8\"); // \u6ce8\u610f\u70b92\uff1a\u5934\u90e8Accept\u6307\u5b9a\u4e86\u63a5\u53d7\u7684\u54cd\u5e94\u5b57\u7b26\u96c6\u4e3autf-8\uff0c\u4f46HTTP\u534f\u8bae\u5e76\u672a\u5f3a\u5236\u670d\u52a1\u7aef\u8981\u6839\u636eAccept\u7684\u5b57\u7b26\u96c6\u6765\u54cd\u5e94\uff0c\u6240\u4ee5\u9700\u8981\u5176\u4ed6\u65b9\u6cd5\u6765\u5224\u65ad\u54cd\u5e94\u7684\u5b57\u7b26\u96c6\nhttpPost.setHeader(\"Content-Type\", \"application/json;charset=utf-8\");\nthis.addHeader(httpPost);\nStringEntity postingString = new StringEntity(JSONObject.toJSONString(params), \"utf-8\");\nhttpPost.setEntity(postingString);\nreturn getEntityAndRelease(httpPost);\n</code></pre> <p>\u63a5\u4e0b\u6765\u5728\u5f00\u53d1\u73af\u5883\uff0c\u901a\u8fc7\u6539\u53d8\u5934\u90e8<code>Accept</code>\u7684<code>charset</code>\uff0c\u6dfb\u52a0JVM\u53c2\u6570<code>-Dorg.apache.commons.logging.Log=org.apache.commons.logging.impl.SimpleLog -Dorg.apache.commons.logging.simplelog.log.org.apache.http=DEBUG</code>\uff0c\u89c2\u5bdfHTTP\u54cd\u5e94\u7684\u5934\u90e8<code>Content-Type</code>\u7684\u65b9\u5f0f\u6765\u5224\u65ad\u54cd\u5e94\u7684\u7f16\u7801</p> <ul> <li>charset\u8bbe\u7f6e\u4e3autf-8\u65f6\uff0c\u65e5\u5fd7\u4e3a\uff1a</li> </ul> <pre><code>[DEBUG] wire - http-outgoing-0 &gt;&gt; \"POST /winshare-center-gateway/api/item/v1/item/ec/4435922 HTTP/1.1[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"Accept: application/json;charset=utf-8[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"Content-Type: application/json;charset=utf-8[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"Content-Length: 14[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"Host: 10.100.9.202:8607[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"Connection: Keep-Alive[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"Accept-Encoding: gzip,deflate[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"{\"id\":4435922}\"\n[DEBUG] wire - http-outgoing-0 &lt;&lt; \"HTTP/1.1 503 Service Unavailable[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &lt;&lt; \"Content-Type: application/json;charset=UTF-8[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &lt;&lt; \"Content-Length: 186[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &lt;&lt; \"[\\r][\\n]\"\n</code></pre> <ul> <li>charset\u8bbe\u7f6e\u4e3agb18030\u65f6\uff0c\u65e5\u5fd7\u4e3a\uff1a</li> </ul> <pre><code>[DEBUG] wire - http-outgoing-0 &gt;&gt; \"POST /winshare-center-gateway/api/item/v1/item/ec/4435922 HTTP/1.1[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"Accept: application/json;charset=gb18030[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"Content-Type: application/json;charset=utf-8[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"Content-Length: 14[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"Connection: Keep-Alive[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"Accept-Encoding: gzip,deflate[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &gt;&gt; \"{\"id\":4435922}\"\n[DEBUG] wire - http-outgoing-0 &lt;&lt; \"HTTP/1.1 503 Service Unavailable[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &lt;&lt; \"Content-Type: application/json;charset=UTF-8[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &lt;&lt; \"Content-Length: 186[\\r][\\n]\"\n[DEBUG] wire - http-outgoing-0 &lt;&lt; \"[\\r][\\n]\"\n</code></pre> <p>\u901a\u8fc7\u67e5\u770b\u65e5\u5fd7\uff0c\u6211\u4eec\u53d1\u73b0\u54cd\u5e94\u7684\u5b57\u7b26\u96c6\u90fd\u662fUTF-8\uff0c\u4e5f\u5c31\u662f\u8bf4\u8be5\u65b9\u6cd5\u8fd4\u56de\u7684\u5b57\u8282\u6570\u7ec4\u5e94\u8be5\u88abUTF-8\u89e3\u7801\uff1b</p> <p>\u56de\u5230<code>\u6ce8\u610f\u70b91</code>\uff0c\u6b64\u5904\u4f7f\u7528\u4e86\u6784\u9020\u65b9\u6cd5<code>java.lang.String#String(byte[])</code>\u521b\u5efaString\u5b9e\u4f8b\uff0c\u6b64\u6784\u9020\u65b9\u6cd5\u4f7f\u7528\u9ed8\u8ba4\u5b57\u7b26\u96c6\u89e3\u7801\u5b57\u8282\u6570\u7ec4\uff0c\u4f7f\u7528<code>\u672c\u5730ssh</code>\u91cd\u542f\u540e\uff0c\u9ed8\u8ba4\u5b57\u7b26\u96c6\u4e3a<code>US-ASCII</code>\uff0c\u800c\u4e0d\u662f<code>UTF-8</code>\uff0c\u8fd9\u662f\u6b64\u6b21\u53d1\u751f\u4e71\u7801\u7684\u7f16\u7801\u539f\u56e0\u3002</p>"},{"location":"2020-06-14-%F0%9F%A7%AF%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%AF%BC%E8%87%B4%E7%9A%84%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81/#sshxshell","title":"\u4e09\u3001\u4e3a\u4ec0\u4e48\u672c\u5730ssh\u4e0eXshell\u8868\u73b0\u4e0d\u540c","text":"<p>\u67e5\u8d44\u6599\u5f97\u77e5\uff0c\u672c\u5730<code>/etc/ssh/ssh_config</code>\u542b\u6709<code>SendEnv LANG LC_*</code>\uff0c\u6b64\u9009\u9879\u6307\u660e\u4e86\u521b\u5efassh\u4f1a\u8bdd\u65f6\uff0c\u5c06\u672c\u5730\u7684<code>LANG</code>\u548c<code>LC_*</code>\u73af\u5883\u53d8\u91cf\u53d1\u9001\u5230\u670d\u52a1\u7aef\uff0c\u4f7f\u5f97\u521b\u5efa\u7684ssh\u4f1a\u8bdd\u4f7f\u7528\u672c\u5730\u7684<code>LANG</code>\u548c<code>LC_*</code>\u73af\u5883\u53d8\u91cf\uff1b</p> <p>\u4f46\u662f\u672c\u5730\u7684\u8fd9\u4e9b\u53d8\u91cf\u7684\u503c\u662f\uff1a</p> <pre><code>[\u672c\u5730 ~]$ locale\nLANG=\"\"\nLC_COLLATE=\"C\"\nLC_CTYPE=\"UTF-8\"\nLC_MESSAGES=\"C\"\nLC_MONETARY=\"C\"\nLC_NUMERIC=\"C\"\nLC_TIME=\"C\"\nLC_ALL=\n</code></pre> <p>\u8fd8\u8bb0\u5f97\u672c\u5730ssh\u8bbf\u95ee\u670d\u52a1\u5668\u6267\u884c<code>locale</code>\u65f6\u7684\u8fd9\u4e24\u884c\u62a5\u9519\u5417\uff1f</p> <pre><code>locale: Cannot set LC_CTYPE to default locale: No such file or directory\nlocale: Cannot set LC_ALL to default locale: No such file or directory\n</code></pre> <p>\u8bf4\u660e\u5f53\u524d\u7684\u670d\u52a1\u5668\u914d\u7f6e\u662f\u4e0d\u652f\u6301<code>LC_CTYPE=\"UTF-8\"</code>\u548c<code>LC_ALL=</code>\u7684\uff0c\u4f46\u672a\u5f15\u8d77\u91cd\u89c6\uff0c\u4e00\u76f4\u9009\u62e9\u7684\u5ffd\u7565\uff1b\u89e3\u51b3\u529e\u6cd5\u662f\uff1a\u6ce8\u91ca\u672c\u5730\u7684<code>/etc/ssh/ssh_config</code>\u4e2d\u7684<code>SendEnv LANG LC_*</code></p>"},{"location":"2020-06-14-%F0%9F%A7%AF%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%AF%BC%E8%87%B4%E7%9A%84%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81/#_5","title":"\u56db\u3001\u5f97\u5230\u7684\u6559\u8bad","text":"<ol> <li>ssh\u8bbf\u95ee\u670d\u52a1\u5668\u65f6\uff0c\u4e0d\u8981\u4f7f\u7528\u672c\u5730\u7684locale\u8bbe\u7f6e\uff0c\u907f\u514d\u672c\u5730\u73af\u5883\u5f71\u54cd\u670d\u52a1\u5668</li> <li>\u542f\u52a8\u5e94\u7528\u65f6\u901a\u8fc7JVM\u6307\u5b9a\u6587\u4ef6\u7f16\u7801\uff08<code>-Dfile.encoding=UTF-8</code>\uff09\uff0c\u6392\u9664\u542f\u52a8\u7684<code>ssh\u4f1a\u8bdd</code>\u5bf9\u5e94\u7528\u7684\u6587\u4ef6\u7f16\u7801\u7684\u5f71\u54cd</li> <li>\u7f16\u7801\u65f6\u4e0d\u8981\u5047\u5b9a\u4efb\u4f55\u7684\u73af\u5883\u53d8\u91cf\uff1a\u89e3\u7801\u5b57\u8282\u6570\u7ec4\u65f6\uff0c\u6307\u5b9a\u5b57\u7b26\u96c6\uff0c\u4e0d\u4f7f\u7528\u9ed8\u8ba4\u5b57\u7b26\u96c6</li> </ol>"},{"location":"2020-06-14-%F0%9F%A7%AF%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%AF%BC%E8%87%B4%E7%9A%84%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81/#_6","title":"\u4e94\u3001\u53c2\u8003","text":"<p>1 Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content 2 String ( Java SE 11 &amp; JDK 11 ) 3 man 5 ssh_config</p>"},{"location":"2020-07-11-%F0%9F%9A%87%E5%9F%BA%E4%BA%8Ev2ray%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/","title":"2020 07 11 \ud83d\ude87\u57fa\u4e8ev2ray\u7684\u79d1\u5b66\u4e0a\u7f51","text":"<p>\u672c\u7bc7\u7b14\u8bb0\u5c1d\u8bd5\u4ece<code>v2ray\u662f\u4ec0\u4e48</code>\u3001<code>\u6d45\u8c08\u5de5\u4f5c\u539f\u7406</code>\u3001<code>\u8fd0\u884c\u670d\u52a1\u7aef</code>\u3001<code>\u8fd0\u884c\u5ba2\u6237\u7aef</code>\u56db\u4e2a\u65b9\u9762\uff0c\u901a\u8fc7\u5c11\u8bb8\u547d\u4ee4\u548c\u914d\u7f6e\u5185\u5bb9\uff0c\u8ba9\u6211\u4eec\u80fd\u8fc5\u901f\u4e0a\u624b\u4f7f\u7528v2ray\u3002</p>"},{"location":"2020-07-11-%F0%9F%9A%87%E5%9F%BA%E4%BA%8Ev2ray%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#v2ray","title":"v2ray\u662f\u4ec0\u4e48\uff1f","text":"<p>Project V \u662f\u4e00\u4e2a\u5de5\u5177\u96c6\u5408\uff0c\u5b83\u53ef\u4ee5\u5e2e\u52a9\u4f60\u6253\u9020\u4e13\u5c5e\u7684\u57fa\u7840\u901a\u4fe1\u7f51\u7edc\u3002Project V \u7684\u6838\u5fc3\u5de5\u5177\u79f0\u4e3aV2Ray\uff0c\u5176\u4e3b\u8981\u8d1f\u8d23\u7f51\u7edc\u534f\u8bae\u548c\u529f\u80fd\u7684\u5b9e\u73b0\uff0c\u4e0e\u5176\u5b83 Project V \u901a\u4fe1\u3002V2Ray \u53ef\u4ee5\u5355\u72ec\u8fd0\u884c\uff0c\u4e5f\u53ef\u4ee5\u548c\u5176\u5b83\u5de5\u5177\u914d\u5408\uff0c\u4ee5\u63d0\u4f9b\u7b80\u4fbf\u7684\u64cd\u4f5c\u6d41\u7a0b\u3002</p> <p>\u5f53\u7136\uff0cv2ray\u662f\u5f00\u6e90\u7684\uff0c\u4e3b\u8981\u7279\u6027\u5982\u4e0b\uff1a</p> <ul> <li>\u591a\u5165\u53e3\u591a\u51fa\u53e3: \u4e00\u4e2a V2Ray \u8fdb\u7a0b\u53ef\u5e76\u53d1\u652f\u6301\u591a\u4e2a\u5165\u7ad9\u548c\u51fa\u7ad9\u534f\u8bae\uff0c\u6bcf\u4e2a\u534f\u8bae\u53ef\u72ec\u7acb\u5de5\u4f5c\u3002</li> <li>\u53ef\u5b9a\u5236\u5316\u8def\u7531: \u5165\u7ad9\u6d41\u91cf\u53ef\u6309\u914d\u7f6e\u7531\u4e0d\u540c\u7684\u51fa\u53e3\u53d1\u51fa\u3002\u8f7b\u677e\u5b9e\u73b0\u6309\u533a\u57df\u6216\u6309\u57df\u540d\u5206\u6d41\uff0c\u4ee5\u8fbe\u5230\u6700\u4f18\u7684\u7f51\u7edc\u6027\u80fd\u3002</li> <li>\u591a\u534f\u8bae\u652f\u6301: V2Ray \u53ef\u540c\u65f6\u5f00\u542f\u591a\u4e2a\u534f\u8bae\u652f\u6301\uff0c\u5305\u62ec Socks\u3001HTTP\u3001Shadowsocks\u3001VMess \u7b49\u3002\u6bcf\u4e2a\u534f\u8bae\u53ef\u5355\u72ec\u8bbe\u7f6e\u4f20\u8f93\u8f7d\u4f53\uff0c\u6bd4\u5982 TCP\u3001mKCP\u3001WebSocket \u7b49\u3002</li> <li>\u9690\u853d\u6027: V2Ray \u7684\u8282\u70b9\u53ef\u4ee5\u4f2a\u88c5\u6210\u6b63\u5e38\u7684\u7f51\u7ad9\uff08HTTPS\uff09\uff0c\u5c06\u5176\u6d41\u91cf\u4e0e\u6b63\u5e38\u7684\u7f51\u9875\u6d41\u91cf\u6df7\u6dc6\uff0c\u4ee5\u907f\u5f00\u7b2c\u4e09\u65b9\u5e72\u6270\u3002</li> <li>\u53cd\u5411\u4ee3\u7406: \u901a\u7528\u7684\u53cd\u5411\u4ee3\u7406\u652f\u6301\uff0c\u53ef\u5b9e\u73b0\u5185\u7f51\u7a7f\u900f\u529f\u80fd\u3002</li> <li>\u591a\u5e73\u53f0\u652f\u6301: \u539f\u751f\u652f\u6301\u6240\u6709\u5e38\u89c1\u5e73\u53f0\uff0c\u5982 Windows\u3001Mac OS\u3001Linux\uff0c\u5e76\u5df2\u6709\u7b2c\u4e09\u65b9\u652f\u6301\u79fb\u52a8\u5e73\u53f0\u3002</li> </ul>"},{"location":"2020-07-11-%F0%9F%9A%87%E5%9F%BA%E4%BA%8Ev2ray%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#_1","title":"\u6d45\u8c08\u5de5\u4f5c\u539f\u7406","text":"<p>\u4f7f\u7528\u65b9\u5f0f\u4e0a\uff0c<code>v2ray</code>\u4e0e\u5176\u4ed6\u4ee3\u7406shadowsocks\u5de5\u5177\u7c7b\u4f3c\uff0c\u9700\u8981\u8fd0\u884c<code>\u670d\u52a1\u7aef</code>\u548c<code>\u5ba2\u6237\u7aef</code>\u4e24\u4e2a\u5b9e\u4f8b(instance)\u3002</p> <p>\u5e38\u89c1\u7684\u573a\u666f\u91cc\uff0c\u5ba2\u6237\u7aef\u8fd0\u884c\u5728PC\u3001\u624b\u673a\u7b49\u7ec8\u7aef\u8bbe\u5907\uff0c\u670d\u52a1\u7aef\u8fd0\u884c\u5728\u4e91\u4e3b\u673a\u7b49\u670d\u52a1\u5668\u4e0a\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u82e5\u8981\u5728\u624b\u673a\u8bbf\u95eeGoogle\u641c\u7d22\u5f15\u64ce\u65f6\uff0c\u5982\u679c\u624b\u673a\u6240\u5728\u7684\u7f51\u7edc\u7981\u7528\u4e86Google\u7684IP\u548c\u57df\u540d\uff0c\u90a3\u4e48\u624b\u673a\u662f\u65e0\u6cd5\u76f4\u63a5\u8bbf\u95ee\u7684\uff0c\u9700\u8981\u7531\u4e00\u4e2a\u300c\u624b\u673a\u53ef\u4ee5\u8bbf\u95ee\u7684\u4e2d\u95f4\u7f51\u7edc\u8282\u70b9\uff0c\u4e14\u8be5\u8282\u70b9\u80fd\u8bbf\u95eeGoogle\u641c\u7d22\u5f15\u64ce\u300d\u7684\u4ee3\u7406\u6765\u8d77\u5230\u4e00\u4e2a\u6865\u6881\u7684\u4f5c\u7528\uff1a\u624b\u673a\u7684<code>\u6d4f\u89c8\u5668</code>\u628a<code>HTTP\u8bf7\u6c42</code>\u53d1\u9001\u5230<code>\u4ee3\u7406</code>\uff0c<code>\u4ee3\u7406</code>\u628a<code>HTTP\u8bf7\u6c42</code>\u53d1\u9001\u5230<code>Google\u641c\u7d22\u5f15\u64ce</code>\uff0c<code>Google\u641c\u7d22\u5f15\u64ce</code>\u7684<code>HTTP\u54cd\u5e94</code>\u4f1a\u987a\u7740\u8fd9\u6761\u8def\u7ebf\u6700\u7ec8\u8fd4\u56de\u7ed9\u7ec8\u7aef\u8bbe\u5907\u7684<code>\u6d4f\u89c8\u5668</code>\u3002</p> <p>\u5728\u8fd9\u91cc\uff0cv2ray\u548cshadowsocks\u7b49\u7f51\u7edc\u5de5\u5177\u5c31\u626e\u6f14\u4e86\u4ee3\u7406\u8fd9\u4e2a\u89d2\u8272\uff0c\u4f46\u4ec5\u4ec5\u505a\u7f51\u7edc\u6d41\u91cf\u4ee3\u7406\u662f\u4e0d\u591f\u7684\uff0c\u56e0\u4e3a\u7f51\u7edc\u6d41\u91cf\u7531\u7f51\u7edc\u534f\u8bae\u627f\u8f7d\uff0c\u82e5\u534f\u8bae\u7684\u7279\u5f81\u80fd\u88ab\u9632\u706b\u5899\u8bc6\u522b\uff0c\u88ab\u8bc6\u522b\u5c31\u610f\u5473\u7740\u9632\u706b\u5899\u6709\u7406\u7531\u628a\u6211\u4eec\u7684\u4ee3\u7406IP\u6dfb\u52a0\u5230\u9ed1\u540d\u5355\u4e2d\uff0c\u5bfc\u81f4\u65e0\u6cd5\u7ec8\u7aef\u8bbe\u5907\u65e0\u6cd5\u8bbf\u95ee\u8fd9\u4e2a\u4ee3\u7406\uff1b\u6240\u4ee5\u7f51\u7edc\u5de5\u5177\u8fd8\u9700\u8981\u652f\u6301\u4e0d\u6613\u88ab\u8bc6\u522b\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u8fd9\u4e9b\u534f\u8bae\u5f80\u5f80\u4e0d\u88ab\u6d4f\u89c8\u5668\u7b49\u5e94\u7528\u652f\u6301\uff0c\u9700\u8981\u7531\u7f51\u7edc\u5de5\u5177\u81ea\u5df1\u6765\u652f\u6301\uff0c\u6240\u4ee5\u7528\u4f5c\u4ee3\u7406\u7684\u7f51\u7edc\u5de5\u5177\u9700\u8981\u8fd0\u884c<code>\u5ba2\u6237\u7aef</code>\u548c<code>\u670d\u52a1\u7aef</code>\u3002</p> <p>\u6d4f\u89c8\u5668\u7b49\u7ec8\u7aef\u5e94\u7528\u901a\u8fc7HTTP\u3001Socks5\u7b49\u5e38\u89c1\u7684\u7f51\u7edc\u534f\u8bae\u628a\u6d41\u91cf\u53d1\u9001\u7ed9\u4ee3\u7406<code>\u5ba2\u6237\u7aef</code>\uff0c<code>\u5ba2\u6237\u7aef</code>\u518d\u901a\u8fc7<code>\u7279\u5b9a\u7684\u534f\u8bae</code>\u5c06\u6d41\u91cf\u53d1\u9001\u7ed9\u4ee3\u7406<code>\u670d\u52a1\u7aef</code>\uff1b</p> <p>\u5728v2ray\u7684\u8bbe\u8ba1\u4e2d\uff0c\u7ec8\u7aef\u5e94\u7528\u5230\u4ee3\u7406<code>\u5ba2\u6237\u7aef</code>\u7684\u63a5\u53e3\u88ab\u79f0\u4e3a<code>Inbound</code>\uff08\u5165\u53e3\uff09\uff0c\u4ee3\u7406<code>\u670d\u52a1\u7aef</code>\u5230\u5b9e\u9645\u76ee\u7684\u5730\uff08\u4f8b\u5982Google\u641c\u7d22\u5f15\u64ce\uff09\u7684\u63a5\u53e3\u88ab\u79f0\u4e3a<code>Outbound</code>\uff08\u51fa\u53e3\uff09\u3002</p>"},{"location":"2020-07-11-%F0%9F%9A%87%E5%9F%BA%E4%BA%8Ev2ray%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#_2","title":"\u8fd0\u884c\u670d\u52a1\u7aef","text":"<p>\u6458\u81eaProject V\u5b98\u7f51\uff0c\u5e76\u5047\u8bbe\u4f60\u7684\u670d\u52a1\u7aef\u8fd0\u884c\u5728Linux\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u3002</p>"},{"location":"2020-07-11-%F0%9F%9A%87%E5%9F%BA%E4%BA%8Ev2ray%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#1-v2ray","title":"1 \u4e0b\u8f7d V2Ray","text":"<p>\u9884\u7f16\u8bd1\u7684\u538b\u7f29\u5305\u53ef\u4ee5\u5728\u5982\u4e0b\u51e0\u4e2a\u7ad9\u70b9\u627e\u5230\uff1a</p> <ul> <li>Github Release: github.com/v2ray/v2ray-core</li> <li>Github \u5206\u6d41: github.com/v2ray/dist</li> </ul> <p>\u538b\u7f29\u5305\u5747\u4e3a zip \u683c\u5f0f\uff0c\u627e\u5230\u5bf9\u5e94\u5e73\u53f0\u7684\u538b\u7f29\u5305\uff0c\u4e0b\u8f7d\u89e3\u538b\u5373\u53ef\u4f7f\u7528\u3002</p>"},{"location":"2020-07-11-%F0%9F%9A%87%E5%9F%BA%E4%BA%8Ev2ray%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#2","title":"2 \u9a8c\u8bc1\u5b89\u88c5\u5305","text":"<p>V2Ray \u63d0\u4f9b\u4e24\u79cd\u9a8c\u8bc1\u65b9\u5f0f\uff1a</p> <ol> <li>\u5b89\u88c5\u5305 zip \u6587\u4ef6\u7684 SHA1 / SHA256 \u6458\u8981\uff0c\u5728\u6bcf\u4e2a\u5b89\u88c5\u5305\u5bf9\u5e94\u7684.dgst\u6587\u4ef6\u4e2d\u53ef\u4ee5\u627e\u5230\u3002</li> <li>\u53ef\u8fd0\u884c\u7a0b\u5e8f\uff08v2ray \u6216 v2ray.exe\uff09\u7684 gpg \u7b7e\u540d\uff0c\u6587\u4ef6\u4f4d\u4e8e\u5b89\u88c5\u5305\u4e2d\u7684 v2ray.sig \u6216 v2ray.exe.sig\u3002\u7b7e\u540d\u516c\u94a5\u53ef\u4ee5\u5728\u4ee3\u7801\u5e93\u4e2d\u627e\u5230\u3002</li> </ol>"},{"location":"2020-07-11-%F0%9F%9A%87%E5%9F%BA%E4%BA%8Ev2ray%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#3-linux","title":"3 Linux \u5b89\u88c5\u811a\u672c","text":"<p>V2Ray \u63d0\u4f9b\u4e86\u4e00\u4e2a\u5728 Linux \u4e2d\u7684\u81ea\u52a8\u5316\u5b89\u88c5\u811a\u672c\u3002\u8fd9\u4e2a\u811a\u672c\u4f1a\u81ea\u52a8\u68c0\u6d4b\u6709\u6ca1\u6709\u5b89\u88c5\u8fc7 V2Ray\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5219\u8fdb\u884c\u5b8c\u6574\u7684\u5b89\u88c5\u548c\u914d\u7f6e\uff1b\u5982\u679c\u4e4b\u524d\u5b89\u88c5\u8fc7 <code>V2Ray</code>\uff0c\u5219\u53ea\u66f4\u65b0 <code>V2Ray \u4e8c\u8fdb\u5236\u7a0b\u5e8f</code>\u800c\u4e0d\u66f4\u65b0\u914d\u7f6e\u3002</p> <p>\u4ee5\u4e0b\u6307\u4ee4\u5047\u8bbe\u5df2\u5728 <code>su</code> \u73af\u5883\u4e0b\uff0c\u5982\u679c\u4e0d\u662f\uff0c\u8bf7\u5148\u8fd0\u884c <code>sudo su</code>\u3002</p> <p>\u8fd0\u884c\u4e0b\u9762\u7684\u6307\u4ee4\u4e0b\u8f7d\u5e76\u5b89\u88c5 V2Ray\u3002\u5f53 <code>yum</code> \u6216 <code>apt-get</code> \u53ef\u7528\u7684\u60c5\u51b5\u4e0b\uff0c\u6b64\u811a\u672c\u4f1a\u81ea\u52a8\u5b89\u88c5 <code>unzip</code> \u548c <code>daemon</code>\u3002\u8fd9\u4e24\u4e2a\u7ec4\u4ef6\u662f\u5b89\u88c5 V2Ray \u7684\u5fc5\u8981\u7ec4\u4ef6\u3002\u5982\u679c\u4f60\u4f7f\u7528\u7684\u7cfb\u7edf\u4e0d\u652f\u6301 yum \u6216 apt-get\uff0c\u8bf7\u81ea\u884c\u5b89\u88c5 unzip \u548c daemon</p> <pre><code>bash &lt;(curl -L -s https://install.direct/go.sh)\n</code></pre> <p>\u6b64\u811a\u672c\u4f1a\u81ea\u52a8\u5b89\u88c5\u4ee5\u4e0b\u6587\u4ef6\uff1a</p> <ul> <li>/usr/bin/v2ray/v2ray\uff1aV2Ray \u7a0b\u5e8f\uff1b</li> <li>/usr/bin/v2ray/v2ctl\uff1aV2Ray \u5de5\u5177\uff1b</li> <li>/etc/v2ray/config.json\uff1a\u914d\u7f6e\u6587\u4ef6\uff1b</li> <li>/usr/bin/v2ray/geoip.dat\uff1aIP \u6570\u636e\u6587\u4ef6</li> <li>/usr/bin/v2ray/geosite.dat\uff1a\u57df\u540d\u6570\u636e\u6587\u4ef6</li> </ul> <p>\u6b64\u811a\u672c\u4f1a\u914d\u7f6e\u81ea\u52a8\u8fd0\u884c\u811a\u672c\u3002\u81ea\u52a8\u8fd0\u884c\u811a\u672c\u4f1a\u5728\u7cfb\u7edf\u91cd\u542f\u4e4b\u540e\uff0c\u81ea\u52a8\u8fd0\u884c V2Ray\u3002\u76ee\u524d\u81ea\u52a8\u8fd0\u884c\u811a\u672c\u53ea\u652f\u6301\u5e26\u6709 Systemd \u7684\u7cfb\u7edf\uff0c\u4ee5\u53ca Debian / Ubuntu \u5168\u7cfb\u5217\u3002</p> <ul> <li>/etc/systemd/system/v2ray.service: Systemd</li> <li>/etc/init.d/v2ray: SysV</li> </ul> <p>\u811a\u672c\u8fd0\u884c\u5b8c\u6210\u540e\uff0c\u4f60\u9700\u8981\uff1a</p> <ul> <li>\u7f16\u8f91 /etc/v2ray/config.json \u6587\u4ef6\u6765\u914d\u7f6e\u4f60\u9700\u8981\u7684\u4ee3\u7406\u65b9\u5f0f\uff1b</li> <li>\u8fd0\u884c service v2ray start \u6765\u542f\u52a8 V2Ray \u8fdb\u7a0b\uff1b</li> <li>\u4e4b\u540e\u53ef\u4ee5\u4f7f\u7528 service v2ray start|stop|status|reload|restart|force-reload \u63a7\u5236 V2Ray \u7684\u8fd0\u884c\u3002</li> </ul>"},{"location":"2020-07-11-%F0%9F%9A%87%E5%9F%BA%E4%BA%8Ev2ray%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#4-gosh","title":"4 go.sh \u53c2\u6570","text":"<p>go.sh \u652f\u6301\u5982\u4e0b\u53c2\u6570\uff0c\u53ef\u5728\u624b\u52a8\u5b89\u88c5\u65f6\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\uff1a</p> <ul> <li>-p \u6216 --proxy: \u4f7f\u7528\u4ee3\u7406\u670d\u52a1\u5668\u6765\u4e0b\u8f7d V2Ray \u7684\u6587\u4ef6\uff0c\u683c\u5f0f\u4e0e curl \u63a5\u53d7\u7684\u53c2\u6570\u4e00\u81f4\uff0c\u6bd4\u5982 \"socks5://127.0.0.1:1080\" \u6216 \"http://127.0.0.1:3128\"\u3002</li> <li>-f \u6216 --force: \u5f3a\u5236\u5b89\u88c5\u3002\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u5f53\u524d\u7cfb\u7edf\u4e2d\u5df2\u6709\u6700\u65b0\u7248\u672c\u7684 V2Ray\uff0cgo.sh \u4f1a\u5728\u68c0\u6d4b\u4e4b\u540e\u5c31\u9000\u51fa\u3002\u5982\u679c\u9700\u8981\u5f3a\u5236\u91cd\u88c5\u4e00\u904d\uff0c\u5219\u9700\u8981\u6307\u5b9a\u8be5\u53c2\u6570\u3002</li> <li>--version: \u6307\u5b9a\u9700\u8981\u5b89\u88c5\u7684\u7248\u672c\uff0c\u6bd4\u5982 \"v1.13\"\u3002\u9ed8\u8ba4\u503c\u4e3a\u6700\u65b0\u7248\u672c\u3002</li> <li>--local: \u4f7f\u7528\u4e00\u4e2a\u672c\u5730\u6587\u4ef6\u8fdb\u884c\u5b89\u88c5\u3002\u5982\u679c\u4f60\u5df2\u7ecf\u4e0b\u8f7d\u4e86\u67d0\u4e2a\u7248\u672c\u7684 V2Ray\uff0c\u5219\u53ef\u901a\u8fc7\u8fd9\u4e2a\u53c2\u6570\u6307\u5b9a\u4e00\u4e2a\u6587\u4ef6\u8def\u5f84\u6765\u8fdb\u884c\u5b89\u88c5\u3002</li> </ul> <p>\u793a\u4f8b\uff1a</p> <ul> <li>\u4f7f\u7528\u5730\u5740\u4e3a 127.0.0.1:1080 \u7684 SOCKS \u4ee3\u7406\u4e0b\u8f7d\u5e76\u5b89\u88c5\u6700\u65b0\u7248\u672c\uff1a./go.sh -p socks5://127.0.0.1:1080</li> <li>\u5b89\u88c5\u672c\u5730\u7684 v1.13 \u7248\u672c\uff1a./go.sh --version v1.13 --local /path/to/v2ray.zip</li> </ul>"},{"location":"2020-07-11-%F0%9F%9A%87%E5%9F%BA%E4%BA%8Ev2ray%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#5","title":"5 \u914d\u7f6e\u670d\u52a1\u7aef","text":"<p>\u4e00\u4e2a\u53c2\u8003\uff0cInbound\u534f\u8bae\u4e3avmess\uff0coutbound\u534f\u8bae\u4e3afreedom\uff1a</p> <pre><code>{\n\"log\": {\n\"loglevel\": \"warning\"\n},\n\"inbounds\": [\n{\n\"port\": \uff08\u60a8\u914d\u7f6e\u7684\u670d\u52a1\u7aef\u76d1\u542c\u7684\u7aef\u53e3\uff0c\u6574\u6570\uff0c\u9700\u8981\u88ab\u670d\u52a1\u5668\u7684\u9632\u706b\u5899\u5f00\u653eTCP\u534f\u8bae\u8bbf\u95ee\uff09,\n\"protocol\": \"vmess\",\n\"settings\": {\n\"clients\": [\n{\n\"id\": \"\u60a8\u751f\u6210\u7684UUID\uff0c\u53ef\u4ee5\u901a\u8fc7Linux\u547d\u4ee4uuidgen\u751f\u6210\",\n\"level\": 1,\n\"alterId\": 1,\n\"security\": \"auto\"\n}\n]\n},\n\"streamSettings\": {\n\"network\": \"h2\",\n\"httpSettings\": {\n\"path\": \"/hello\"\n},\n\"security\": \"tls\",\n\"tlsSettings\": {\n\"certificates\": [\n{\n\"certificateFile\": \"\u60a8\u7684PEM certificate\u6587\u4ef6\",\n\"keyFile\": \"\u60a8\u7684PEM RSA private key\u6587\u4ef6\"\n}\n]\n}\n}\n}\n],\n\"outbounds\": [\n{\n\"protocol\": \"freedom\",\n\"settings\": {}\n}\n],\n\"routing\": {\n\"rules\": [\n{\n\"type\": \"field\",\n\"ip\": [\n\"geoip:private\"\n],\n\"outboundTag\": \"blocked\"\n}\n]\n}\n}\n</code></pre> <p>\u60a8\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u811a\u672c\u6765\u751f\u6210\u4e00\u4efd\u81ea\u7b7e\u8bc1\u4e66\uff1a</p> <pre><code>#!/bin/sh\n\n# create self-signed server certificate:\n\nread -p \"Enter your domain [www.example.com]: \" DOMAIN\n\necho \"Create server key...\"\n\nopenssl genrsa -des3 -out $DOMAIN.key 4096\n\necho \"Create server certificate signing request...\"\n\nSUBJECT=\"/C=US/ST=Mars/L=Mars/O=Mars/OU=Mars/CN=$DOMAIN\"\n\nopenssl req -new -subj $SUBJECT -key $DOMAIN.key -out $DOMAIN.csr\n\necho \"Remove password...\"\n\nmv $DOMAIN.key $DOMAIN.origin.key\nopenssl rsa -in $DOMAIN.origin.key -out $DOMAIN.key\n\necho \"Sign SSL certificate...\"\n\nopenssl x509 -req -days 365 -in $DOMAIN.csr -signkey $DOMAIN.key -out $DOMAIN.crt\n\necho \"TODO:\"\necho \"Copy $DOMAIN.crt to /etc/nginx/ssl/$DOMAIN.crt\"\necho \"Copy $DOMAIN.key to /etc/nginx/ssl/$DOMAIN.key\"\necho \"Add configuration in nginx:\"\necho \"server {\"\necho \" ...\"\necho \" listen 443 ssl;\"\necho \" ssl_certificate /etc/nginx/ssl/$DOMAIN.crt;\"\necho \" ssl_certificate_key /etc/nginx/ssl/$DOMAIN.key;\"\necho \"}\"\n</code></pre>"},{"location":"2020-07-11-%F0%9F%9A%87%E5%9F%BA%E4%BA%8Ev2ray%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#_3","title":"\u8fd0\u884c\u5ba2\u6237\u7aef","text":""},{"location":"2020-07-11-%F0%9F%9A%87%E5%9F%BA%E4%BA%8Ev2ray%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#windows","title":"Windows","text":"<p>\u6f14\u793a\u5728<code>Windows</code>\u64cd\u4f5c\u7cfb\u7edf\u8fd0\u884c<code>v2ray-core</code>\u5ba2\u6237\u7aef</p> <p>\u5728Github Release\u9875\u9762\u4e0b\u8f7dv2ray-windows-64.zip\uff0c\u89e3\u538b\u5230\u6587\u4ef6\u5939<code>D:\\bin\\v2ray</code>\uff1b\u7528\u8bb0\u4e8b\u672c\u7b49\u8f6f\u4ef6\u65b0\u5efa\u4e00\u4e2a\u540d\u4e3a<code>v2ray.bat</code>\u7684\u6279\u5904\u7406\u6587\u4ef6\uff0c\u8fbe\u5230\u53cc\u51fb\u8fd9\u4e2a\u6587\u4ef6\u542f\u52a8v2ray\u7684\u4f5c\u7528\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>start D:\\bin\\v2ray\\wv2ray.exe -config D:\\bin\\v2ray\\vpoint_socks_vmess.json\n</code></pre> <p></p> <p>\u914d\u7f6e\u6587\u4ef6<code>D:\\bin\\v2ray\\vpoint_socks_vmess.json</code>\u4e0e\u60a8\u7684\u670d\u52a1\u7aef\u914d\u7f6e\u6709\u5173\uff0c\u5bf9\u5e94\u4e0a\u9762\u7684\u670d\u52a1\u7aef\u7684\u53c2\u8003\u914d\u7f6e\uff0c\u5ba2\u6237\u7aef\u7684\u53c2\u8003\u914d\u7f6e\uff1a</p> <pre><code>{\n\"log\": {\n\"loglevel\": \"warning\"\n},\n\"inbounds\": [\n{\n\"port\": 1080,\n\"listen\": \"127.0.0.1\",\n\"protocol\": \"socks\",\n\"sniffing\": {\n\"enabled\": true,\n\"destOverride\": [\n\"http\",\n\"tls\"\n]\n},\n\"settings\": {\n\"auth\": \"noauth\",\n\"udp\": false\n}\n}\n],\n\"outbounds\": [\n{\n\"protocol\": \"vmess\",\n\"settings\": {\n\"vnext\": [\n{\n\"address\": \"\u60a8\u7684\u670d\u52a1\u5668\u7684IP\",\n\"port\": \uff08\u60a8\u914d\u7f6e\u7684\u670d\u52a1\u7aef\u76d1\u542c\u7684\u7aef\u53e3\uff09,\n\"users\": [\n{\n\"id\": \"\u60a8\u751f\u6210\u7684UUID\uff0c\u9700\u8981\u4e0e\u670d\u52a1\u7aef\u914d\u7f6e\u76f8\u540c\",\n\"level\": 1,\n\"alterId\": 1,\n\"security\": \"auto\"\n}\n]\n}\n]\n},\n\"streamSettings\": {\n\"network\": \"h2\",\n\"httpSettings\": {\n\"path\": \"/hello\"\n},\n\"security\": \"tls\",\n\"tlsSettings\": {\n\"serverName\": \"\u60a8\u7684PEM certificate\u6587\u4ef6\u7684\u57df\u540d\",\n\"allowInsecure\": true\n}\n}\n}\n]\n}\n</code></pre> <p>\u4fdd\u5b58\u914d\u7f6e\u6587\u4ef6\u540e\uff0c\u5373\u53ef\u53cc\u51fb<code>v2ray.bat</code>\u8fd0\u884c\uff0c\u82e5\u5ba2\u6237\u7aef\u914d\u7f6e\u4e89\u53d6\uff0c\u5219\u80fd\u5728<code>\u4efb\u52a1\u7ba1\u7406\u5668</code>\u770b\u5230<code>w2ray.exe</code>\u8fd0\u884c\uff1a</p> <p></p> <p>\u63a5\u4e0b\u6765\u5728<code>Chrome</code>\u4e2d\u5b89\u88c5<code>Proxy SwitchyOmega</code>\u63d2\u4ef6\uff0c\u5173\u95ed\u6240\u6709\u6253\u5f00\u7684<code>Chrome</code>\u7a97\u53e3\uff0c\u7136\u540e\u5728powershell\u8fd0\u884c\u4e0b\u9762\u547d\u4ee4\uff0c\u8fd0\u884c\u4e00\u4e2aChrome\u5b9e\u4f8b\uff0c\u6240\u6709\u6d41\u91cf\u7531<code>socks5://localhost:1080</code>\u4ee3\u7406\uff0c\u6ca1\u9519\uff0c\u8fd9\u4e2a\u4ee3\u7406\u5c31\u662f\u6211\u4eec\u521a\u521a\u5728\u672c\u5730\u8fd0\u884c\u7684v2ray\u5b9e\u4f8b\uff1a</p> <pre><code>C:\\Users\\\uff08\u60a8\u7684\u7528\u6237\u540d\uff09\\AppData\\Local\\Google\\Chrome\\Application\\chrome.exe --proxy-server=\"socks5://localhost:1080\"\n</code></pre> <p>\u8bbf\u95ee<code>https://chrome.google.com/webstore/detail/proxy-switchyomega/padekgcemlokbadohgkifijomclgjgif</code>\uff0c\u6216\u8005\u641c\u7d22<code>Proxy SwitchyOmega</code>\uff1a</p> <p></p> <p>\u5b89\u88c5\u63d2\u4ef6\uff0c\u8bbe\u7f6e\u4ee3\u7406\u670d\u52a1\u5668\u4e3a\u672c\u5730\u7684\u5b9e\u4f8b\uff1a</p> <p></p> <p>\u70b9\u51fb\u56fe\u6807\u5e76\u8bbe\u7f6e\u4e3a<code>auto switch</code>\uff1a</p> <p></p> <p>\u5173\u95ed\u5f53\u524d\u6240\u6709Chrome\u7a97\u53e3\uff0c\u4e0d\u6307\u5b9a\u4ee3\u7406\u8fd0\u884c\u4e00\u4e2a\u65b0\u7a97\u53e3\uff0c\u8bbf\u95ee<code>https://www.google.com</code>\uff0c\u7b49\u5f85<code>\u56fe\u6807\u663e\u793a\u6a59\u8272\u6570\u5b57</code>\u65f6\uff0c\u70b9\u51fb\u57df\u540d\uff0c\u70b9\u51fb<code>proxy</code>\uff0c\u5c06\u57df\u540d<code>goole.com</code>\u6dfb\u52a0\u5230\u4ee3\u7406\u89c4\u5219\u4e2d\uff1a</p> <p></p> <p>\u518d\u5237\u65b0\u9875\u9762\uff0c\u4e0d\u51fa\u610f\u5916\u7684\u8bdd\uff0c\u6210\u529f\u8bbf\u95ee\uff1a</p> <p></p> <p>\u540e\u7eed\u518d\u8865\u5145\u5b89\u5353\u3001iOS\u7b49\u5176\u4ed6\u5ba2\u6237\u7aef</p>"},{"location":"2020-07-11-%F0%9F%9A%87%E5%9F%BA%E4%BA%8Ev2ray%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#android","title":"Android","text":"<p>\u6211\u4eec\u8fd9\u91cc\u7528\u5230V2rayNG\uff0c\u4e00\u6b3e\u5f00\u6e90\u7684\u5b89\u5353\u8f6f\u4ef6\uff0c\u6240\u6709\u7248\u672c\u5728https://github.com/2dust/v2rayNG/releases\u53ef\u4ee5\u770b\u5230\uff08\u8bf7\u4f7f\u7528\u6d4f\u89c8\u5668\u6253\u5f00\uff09\uff1b</p> <p>\u5b89\u88c5\u6210\u529f\u4e4b\u540e\uff0c\u56e0\u4e3aV2rayNG\u53ea\u4f5c\u4e3a\u5ba2\u6237\u7aef\uff0c\u4e0d\u63d0\u4f9b\u4ee3\u7406\u670d\u52a1\uff0c\u6240\u4ee5\u9700\u8981\u8f93\u5165\u670d\u52a1\u5668\u914d\u7f6e\u3002</p> <p>\u60a8\u53ef\u4ee5\u81ea\u5df1\u642d\u5efa\u670d\u52a1\u5668\uff0c\u6216\u8005\u4f7f\u7528\u670b\u53cb\u7684\u670d\u52a1\u5668\uff08\u4e5f\u6709\u670d\u52a1\u5546\u63d0\u4f9b\u4ed8\u8d39\u670d\u52a1\uff09\uff0cV2rayNG\u63d0\u4f9b\u4e86\u3010\u626b\u63cf\u4e8c\u7ef4\u7801\u3011\u7684\u529f\u80fd\uff0c\u4fbf\u4e8e\u5206\u4eab\u670d\u52a1\u5668\u914d\u7f6e\uff0c\u5982\u4e0b\uff1a</p> <p></p> <p>\u5bfc\u5165\u6210\u529f\u4e4b\u540e\uff0c\u3010\u914d\u7f6e\u6587\u4ef6\u3011\u5217\u8868\u4e2d\u4f1a\u6dfb\u52a0\u4e00\u4e2a\u914d\u7f6e\uff0c\u5982\u4e0b\uff1a</p> <p></p> <p>\u5c31\u5feb\u5b8c\u6210\u4e86\uff0c\u70b9\u51fb\u5de6\u4e0a\u89d2\u7684\u4e09\u9053\u6760\uff08\u4e0a\u56fe\u84dd\u8272\u5708\u51fa\uff09\u547c\u51fa\u8bbe\u7f6e\u83dc\u5355\u680f\uff0c\u70b9\u51fb\u3010\u8bbe\u7f6e\u3011</p> <p></p> <p>\u5c06\u3010\u9884\u5b9a\u4e49\u89c4\u5219\u3011\u8bbe\u7f6e\u4e3a\u300c\u7ed5\u8fc7\u5c40\u57df\u7f51\u53ca\u5927\u9646\u5730\u5740\u300d\uff0c\u4f7f\u5f97\u8bbf\u95ee\u5927\u9646\u7f51\u5740\u548c\u5c40\u57df\u7f51\u5730\u5740\u4e0d\u4f7f\u7528\u4ee3\u7406\uff1a</p> <p></p> <p>\u518d\u6b21\u70b9\u51fb\u5de6\u4e0a\u89d2\uff0c\u56de\u5230\u3010\u914d\u7f6e\u6587\u4ef6\u3011\uff0c\u9009\u4e2d\u6211\u4eec\u521a\u521a\u5bfc\u5165\u7684\u914d\u7f6e\uff0c\u7136\u540e\u70b9\u51fb\u53f3\u4e0b\u89d2\u7684V\u5b57\u6309\u94ae\uff0c\u542f\u52a8\u670d\u52a1\uff08\u9996\u6b21\u542f\u52a8\u65f6\uff0c\u7cfb\u7edf\u4f1a\u5f39\u51fa\u63d0\u793a\u6846\uff0c\u5141\u8bb8\u5373\u53ef\uff09\uff1a</p> <p></p> <p>\u597d\u4e86\uff0c\u8bd5\u8bd5\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95eehttps://www.google.com/\u5427\uff0c\u5982\u679c\u8bbf\u95ee\u6210\u529f\uff0c\u8bf4\u660e\u5df2\u7ecf\u53ef\u4ee5\u79d1\u5b66\u4e0a\u7f51\u4e86\u3002</p>"},{"location":"2020-07-11-%F0%9F%9A%87%E5%9F%BA%E4%BA%8Ev2ray%E7%9A%84%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#_4","title":"\u53c2\u8003","text":"<ol> <li>How to set Google Chrome\u2019s proxy settings in command line on Linux?</li> <li>Project V</li> </ol>"},{"location":"2020-07-12-%F0%9F%93%9C%E8%AF%BB%E5%8F%96MySQL%E7%9A%84binlog/","title":"2020 07 12 \ud83d\udcdc\u8bfb\u53d6MySQL\u7684binlog","text":"<p>\u914d\u7f6e<code>~/.my.cnf</code>\uff0c\u5f00\u542fbinlog:</p> <pre><code>[mysqld]\nserver-id=master-01\nlog-bin=mysql-bin\n</code></pre> <p>\u5047\u8bbe\u9700\u8981\u8bfb\u53d6\u7684binlog\u7684\u6587\u4ef6\u662f<code>mysql-bin.000001</code>\uff0c\u90a3\u4e48\u7528\u4e0b\u9762\u547d\u4ee4\u5373\u53ef\u6839\u636e\u5f00\u59cb\u7ed3\u675f\u65f6\u95f4\u8f93\u51fa\u53ef\u8bfb\u65e5\u5fd7\uff1a</p> <pre><code>mysqlbinlog --base64-output=DECODE-ROWS \\\n-v \\\n--start-datetime='2020-07-12 21:33:10' \\\n--stop-datetime='2020-07-12 21:40:10' \\\nmysql-bin.000001\n</code></pre> <p>\u8f93\u51fa\u5982\u4e0b\uff1a</p> <pre><code>/*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=1*/;\n/*!50003 SET @OLD_COMPLETION_TYPE=@@COMPLETION_TYPE,COMPLETION_TYPE=0*/;\nDELIMITER /*!*/;\n# at 4\n#200712 21:24:18 server id 0  end_log_pos 123 CRC32 0x0d383a89  Start: binlog v 4, server v 5.7.29-log created 200712 21:24:18 at startup\nROLLBACK/*!*/;\n# at 672\n#200712 21:33:44 server id 0  end_log_pos 737 CRC32 0x71a595ed  Anonymous_GTID  last_committed=2    sequence_number=3   rbr_only=yes\n/*!50718 SET TRANSACTION ISOLATION LEVEL READ COMMITTED*//*!*/;\nSET @@SESSION.GTID_NEXT= 'ANONYMOUS'/*!*/;\n# at 737\n#200712 21:33:44 server id 0  end_log_pos 809 CRC32 0xb207c15c  Query   thread_id=2 exec_time=0 error_code=0\nSET TIMESTAMP=1594560824/*!*/;\nSET @@session.pseudo_thread_id=2/*!*/;\nSET @@session.foreign_key_checks=1, @@session.sql_auto_is_null=0, @@session.unique_checks=1, @@session.autocommit=1/*!*/;\nSET @@session.sql_mode=1436549152/*!*/;\nSET @@session.auto_increment_increment=1, @@session.auto_increment_offset=1/*!*/;\n/*!\\C utf8mb4 *//*!*/;\nSET @@session.character_set_client=45,@@session.collation_connection=45,@@session.collation_server=45/*!*/;\nSET @@session.lc_time_names=0/*!*/;\nSET @@session.collation_database=DEFAULT/*!*/;\nBEGIN\n/*!*/;\n# at 809\n#200712 21:33:44 server id 0  end_log_pos 860 CRC32 0x6aa48d0d  Table_map: `test`.`int_test` mapped to number 107\n# at 860\n#200712 21:33:44 server id 0  end_log_pos 900 CRC32 0xb6d5df66  Write_rows: table id 107 flags: STMT_END_F\n### INSERT INTO `test`.`int_test`\n### SET\n###   @1=8\n# at 900\n#200712 21:33:44 server id 0  end_log_pos 931 CRC32 0x5b5c9d33  Xid = 15\nCOMMIT/*!*/;\n# at 931\n#200712 21:35:32 server id 0  end_log_pos 954 CRC32 0x95c3815f  Stop\nSET @@SESSION.GTID_NEXT= 'AUTOMATIC' /* added by mysqlbinlog */ /*!*/;\nDELIMITER ;\n# End of log file\n/*!50003 SET COMPLETION_TYPE=@OLD_COMPLETION_TYPE*/;\n/*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=0*/;\n</code></pre>"},{"location":"2020-07-12-%F0%9F%93%9C%E8%AF%BB%E5%8F%96MySQL%E7%9A%84binlog/#_1","title":"\u53c2\u8003","text":"<ol> <li>16.1.2.1 Setting the Replication Master Configuration</li> <li>4.6.7.2 mysqlbinlog Row Event Display</li> </ol>"},{"location":"2020-07-19-%F0%9F%93%9D%E5%9F%BA%E4%BA%8ExeCJK%E7%9A%84TeX%E4%B8%AD%E6%96%87%E4%B9%A6%E5%86%99/","title":"\ud83d\udcdd\u57fa\u4e8exeCJK\u7684TeX\u4e2d\u6587\u4e66\u5199","text":""},{"location":"2020-07-19-%F0%9F%93%9D%E5%9F%BA%E4%BA%8ExeCJK%E7%9A%84TeX%E4%B8%AD%E6%96%87%E4%B9%A6%E5%86%99/#1","title":"1 \u5b89\u88c5\u73af\u5883","text":"<p>\u9996\u5148\uff0c\u60a8\u9700\u8981\u5728\u672c\u5730\u5b89\u88c5\u4e00\u4e2aTeX\u53d1\u884c\u7248\uff0c\u60a8\u53ef\u4ee5\u9009\u62e9\u5927\u800c\u5168\u7684MacTeX\uff0c\u4e3a\u4e86\u8282\u7701\u672c\u5730\u7a7a\u95f4\uff0c\u6b64\u5904\u9009\u62e9\u66f4\u5c0f\u7684\u53d1\u884c\u7248BasicTeX\uff1b\u82e5\u7f51\u901f\u8fc7\u6162\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u56fd\u5185\u9662\u6821\u63d0\u4f9b\u7684\u955c\u50cf\uff0c\u6bd4\u5982tuna\uff08\u6e05\u534e\u5927\u5b66\u5f00\u6e90\u8f6f\u4ef6\u955c\u50cf\u7ad9\uff09\uff1b\u4e0b\u8f7d\u5b8c\u6210\u4e4b\u540e\uff0c\u8fd0\u884c\u7a0b\u5e8f\uff0c\u4e00\u8def<code>continue</code>\u5373\u53ef\uff1a</p> <p></p> <p>\u5176\u6b21\uff0c\u4f7f\u7528<code>tlmgr(the native TeX Live Manager)</code>\u5b89\u88c5<code>ctex</code>\u548c<code>xecjk</code>\uff1a</p> <pre><code>$ sudo tlmgr install ctex xecjk\n</code></pre>"},{"location":"2020-07-19-%F0%9F%93%9D%E5%9F%BA%E4%BA%8ExeCJK%E7%9A%84TeX%E4%B8%AD%E6%96%87%E4%B9%A6%E5%86%99/#2-hello-world","title":"2 Hello World","text":"<p>\u521b\u5efa\u4e00\u4e2a\u7eaf\u6587\u672c\u6587\u4ef6<code>hello_world.tex</code>\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>\\documentclass{article}\n\\usepackage{xeCJK}\n\\setCJKmainfont{STSong}\n\\begin{document}\nHello World!\\\\\n\u5929\u5730\u7384\u9ec3\u5b87\u5b99\u6d2a\u8352\u65e5\u6708\u76c8\u4ec4\n\\end{document}\n</code></pre> <p>\u4fdd\u5b58\u6587\u4ef6\uff0c\u4f7f\u7528<code>xelatex</code>\u547d\u4ee4\uff0c\u8f93\u51fapdf\u6587\u4ef6\uff1a</p> <pre><code>$ xelatex hello_world.tex\n</code></pre> <p>\u5982\u679c\u4e0d\u51fa\u95ee\u9898\u7684\u8bdd\uff0c\u8f93\u51fa\u7684<code>hello_world.pdf</code>\u6587\u4ef6\u5c06\u4f1a\u662f\uff1a</p> <p></p>"},{"location":"2020-07-19-%F0%9F%93%9D%E5%9F%BA%E4%BA%8ExeCJK%E7%9A%84TeX%E4%B8%AD%E6%96%87%E4%B9%A6%E5%86%99/#3","title":"3 \u53c2\u8003","text":"<ol> <li> Smaller Download </li> <li>\u5168\u9762\u603b\u7ed3\u5982\u4f55\u5728 LaTeX \u4e2d\u4f7f\u7528\u4e2d\u6587 (2020 \u6700\u65b0\u7248) - jdhao's blog</li> <li>Include Chinese characters into article in Xelatex</li> </ol>"},{"location":"2020-10-19-%F0%9F%8F%8E%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%98/","title":"2020 10 19 \ud83c\udfce\u534f\u53d8\u3001\u9006\u53d8\u4e0e\u4e0d\u53d8","text":""},{"location":"2020-10-19-%F0%9F%8F%8E%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%98/#formal-definition","title":"Formal definition","text":"<p>\u6458\u81eaCovariance_and_contravariance_(computer_science)\uff1a</p> <p>Within the type system of a programming language, a <code>typing rule</code> or a<code>type constructor</code> is:  - covariant if it preserves the rdering of types (\u2264), which orders types from more specific to more generic;  - contravariant if it reverses this ordering;  - bivariant if both of these apply (i.e., both <code>I&lt;A&gt;</code> \u2264 <code>I&lt;B&gt;</code> and <code>I&lt;B&gt;</code> \u2264 <code>I&lt;A&gt;</code> at the same time);[1]  - variant if covariant, contravariant or bivariant;  - invariant or nonvariant if not variant.</p>"},{"location":"2020-10-19-%F0%9F%8F%8E%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%98/#_1","title":"\u534f\u53d8","text":"<p>\u9996\u5148\u8003\u8651\u6570\u7ec4\u7c7b\u578b\u6784\u9020\u5668\uff1a \u4eceAnimal\u7c7b\u578b\uff0c\u53ef\u4ee5\u5f97\u5230<code>Animal[]</code>\uff08\u201canimal\u6570\u7ec4\u201d\uff09\u3002 \u662f\u5426\u53ef\u4ee5\u628a\u5b83\u5f53\u4f5c</p> <ul> <li>\u534f\u53d8\uff1aa <code>Cat[]</code> is an <code>Animal[]</code></li> <li>\u9006\u53d8\uff1aan <code>Animal[]</code> is  a <code>Cat[]</code></li> <li>\u4e0d\u53d8\uff1aan <code>Animal[]</code> is not a <code>Cat[]</code> and a <code>Cat[]</code> is not an <code>Animal[]</code></li> </ul>"},{"location":"2020-10-19-%F0%9F%8F%8E%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%98/#java","title":"Java\u4e2d\u7684\u534f\u53d8\u6570\u7ec4","text":"<pre><code>// a \u662f\u5355\u5143\u7d20\u7684 String \u6570\u7ec4\nString[] a = new String[1];\n\n// b \u662f Object \u7684\u6570\u7ec4\nObject[] b = a;\n\n// \u5411 b \u4e2d\u8d4b\u4e00\u4e2a\u6574\u6570\u3002\u5982\u679c b \u786e\u5b9e\u662f Object \u7684\u6570\u7ec4\uff0c\u8fd9\u662f\u53ef\u80fd\u7684\uff1b\u7136\u800c\u5b83\u5176\u5b9e\u662f\u4e2a String \u7684\u6570\u7ec4\uff0c\u56e0\u6b64\u4f1a\u53d1\u751f java.lang.ArrayStoreException\nb[0] = 1;\n</code></pre>"},{"location":"2020-10-19-%F0%9F%8F%8E%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%98/#oop","title":"OOP\u4e2d\u7684\u7ee7\u627f","text":"<p>\u5f53\u4e00\u4e2a\u5b50\u7c7b\u91cd\u5199\u4e00\u4e2a\u8d85\u7c7b\u7684\u65b9\u6cd5\u65f6\uff0c\u7f16\u8bd1\u5668\u5fc5\u987b\u68c0\u67e5\u91cd\u5199\u65b9\u6cd5\u662f\u5426\u5177\u6709\u6b63\u786e\u7684\u7c7b\u578b\u3002\u867d\u7136\u4e00\u4e9b\u8bed\u8a00\u8981\u6c42\u7c7b\u578b\u5fc5\u987b\u4e0e\u8d85\u7c7b\u76f8\u540c\uff0c\u4f46\u5141\u8bb8\u91cd\u5199\u65b9\u6cd5\u6709\u4e00\u4e2a\u201c\u66f4\u597d\u7684\u201d\u7c7b\u578b\u4e5f\u662f\u7c7b\u578b\u5b89\u5168\u7684\u3002\u5bf9\u4e8e\u5927\u90e8\u5206\u7684\u65b9\u6cd5\u5b50\u7c7b\u5316\u89c4\u5219\u6765\u8bf4\uff0c\u8fd9\u8981\u6c42\u8fd4\u56de\u503c\u7684\u7c7b\u578b\u5fc5\u987b\u66f4\u5177\u4f53\uff0c\u4e5f\u5c31\u662f<code>\u534f\u53d8</code>\uff0c\u800c\u4e14\u63a5\u53d7\u66f4\u5bbd\u6cdb\u7684\u53c2\u6570\u7c7b\u578b\uff0c\u4e5f\u5c31\u662f<code>\u9006\u53d8</code>\u3002</p> <p></p> <p>\u4ee5\u4e0b\u8ba8\u8bba\u57fa\u4e8eJava\u8bed\u6cd5\uff0c<code>\u62bd\u8c61\u7c7bC</code>\u5982\u4e0b\uff1a <pre><code>jshell&gt; abstract class C {\n...&gt; abstract C foo(C c);\n...&gt; }\n|  replaced class C\n</code></pre></p>"},{"location":"2020-10-19-%F0%9F%8F%8E%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%98/#_2","title":"\u8fd4\u56de\u503c\u7684\u534f\u53d8","text":"<p>\u5728\u5141\u8bb8\u534f\u53d8\u8fd4\u56de\u503c\u7684\u8bed\u8a00\u4e2d, \u5b50\u7c7b\u53ef\u4ee5\u91cd\u5199<code>foo</code>\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u66f4\u5177\u4f53\u7684\u7c7b\u578b\uff1a</p> <pre><code>jshell&gt; class D extends C {\n   ...&gt; @Override\n   ...&gt; D foo(C c) {return this;}\n   ...&gt; }\n|  created class D\n</code></pre>"},{"location":"2020-10-19-%F0%9F%8F%8E%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%98/#_3","title":"\u65b9\u6cd5\u53c2\u6570\u7684\u534f\u53d8\u4e0e\u9006\u53d8","text":"<p>\u5141\u8bb8\u53c2\u6570\u534f\u53d8\u3001\u9006\u53d8\u7684\u9762\u5411\u5bf9\u8c61\u8bed\u8a00\u5e76\u4e0d\u591a\u2014\u2014Java\u4f1a\u628a\u5b83\u5f53\u6210\u4e00\u4e2a\u51fd\u6570\u91cd\u8f7d\uff1a</p> <p>\u534f\u53d8\uff1a</p> <pre><code>jshell&gt; class E extends C {\n   ...&gt; @Override\n   ...&gt; C foo(E e) {return this;}\n   ...&gt; }\n|  Error:\n|  E is not abstract and does not override abstract method foo(C) in C\n|  class E extends C {\n|  ^------------------...\n|  Error:\n|  method does not override or implement a method from a supertype\n|  @Override\n|  ^-------^\n</code></pre> <p>\u9006\u53d8\uff1a <pre><code>jshell&gt; class F extends C {\n   ...&gt; @Override\n   ...&gt; C foo(Object o) {return this;}\n   ...&gt; }\n|  Error:\n|  F is not abstract and does not override abstract method foo(C) in C\n|  class F extends C {\n|  ^------------------...\n|  Error:\n|  method does not override or implement a method from a supertype\n|  @Override\n|  ^-------^\n</code></pre></p>"},{"location":"2020-10-19-%F0%9F%8F%8E%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%98/#summary-of-variance-and-inheritance","title":"Summary of variance and inheritance","text":"\u8bed\u8a00 Parameter type Return type C++ \uff08\u81ea1998\u5e74\uff09, Java (\u81eaJ2SE 5.0), D \u4e0d\u53d8 \u534f\u53d8 C# \u4e0d\u53d8 \u4e0d\u53d8"},{"location":"2020-10-19-%F0%9F%8F%8E%E5%8D%8F%E5%8F%98%E3%80%81%E9%80%86%E5%8F%98%E4%B8%8E%E4%B8%8D%E5%8F%98/#_4","title":"\u53c2\u8003","text":"<ul> <li>Covariance and contravariance</li> </ul>"},{"location":"2020-10-31-%F0%9F%A7%B0Xcode%E4%B8%AD%E5%88%9B%E5%BB%BASwift%20Package%E5%B9%B6%E5%9C%A8Target%E4%B8%AD%E4%BD%BF%E7%94%A8/","title":"\ud83e\uddf0Xcode\u4e2d\u521b\u5efaSwift Package\u5e76\u5728Target\u4e2d\u4f7f\u7528","text":"<p>\u9996\u5148\u5728Xcode\u4e0a\u521b\u5efa\u4e00\u4e2a<code>Swift Package</code>\uff0c\u83dc\u5355\u662f<code>File</code> / <code>New</code> / <code>Swift Package</code>\uff1a</p> <p></p> <p>\u9009\u62e9\u4fdd\u5b58\u8def\u5f84\uff1a</p> <p></p> <p>\u6ce8\u610f\u9009\u62e9<code>Add to</code>\uff1a</p> <p></p> <ol> <li>\u9009\u62e9<code>Project</code> / <code>TARGETS</code>\uff0c\u7136\u540e\u9009\u62e9\u9700\u8981\u4f7f\u7528\u6211\u4eec\u521a\u624d\u521b\u5efa\u7684<code>Swift Package</code>\u7684<code>Target</code>\uff0c\u7136\u540e\u9009\u62e9<code>General</code>\u680f\uff0c\u5728<code>Framworks, Libraries, and Embedded Content</code>\u4e2d\u6dfb\u52a0Package\uff0c\u5982\u56fe\uff1a</li> </ol> <p></p> <ol> <li>\u9009\u62e9<code>Build Phases</code>\uff0c\u5728<code>Dependencies</code>\u6dfb\u52a0Package\uff0c\u5982\u56fe\uff1a</li> </ol> <p></p> <p>\u6ca1\u6709\u5176\u4ed6\u95ee\u9898\u7684\u8bdd\uff0c\u60a8\u7684Target\u80fd\u6210\u529f\u6784\u5efa\u4e86\u3002</p>"},{"location":"2020-10-31-%F0%9F%A7%B0Xcode%E4%B8%AD%E5%88%9B%E5%BB%BASwift%20Package%E5%B9%B6%E5%9C%A8Target%E4%B8%AD%E4%BD%BF%E7%94%A8/#reference","title":"Reference","text":"<ol> <li>Organizing Your Code with Local Packages</li> <li>Adding Package Dependencies to Your App</li> </ol>"},{"location":"2021-02-28-%F0%9F%94%A6%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8GDB%E8%B0%83%E8%AF%95Nginx/","title":"2021 02 28 \ud83d\udd26\u5982\u4f55\u4f7f\u7528GDB\u8c03\u8bd5Nginx","text":"<p>\u672c\u6587\u4e3b\u8981\u63cf\u8ff0\u5728<code>CentOS 7</code>\u4e0b\uff0c\u4f7f\u7528gdb\u8c03\u8bd5Nginx</p>"},{"location":"2021-02-28-%F0%9F%94%A6%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8GDB%E8%B0%83%E8%AF%95Nginx/#1","title":"1 \u51c6\u5907","text":"<p>\u4e0b\u8f7dnginx\u53ca\u5176\u4f9d\u8d56\u9879\u76ee\u6e90\u7801\uff0c\u5e76\u89e3\u538b\uff1a</p> <pre><code>curl -OL https://mirrors.sohu.com/nginx/nginx-1.19.7.tar.gz\ntar zxf nginx-1.19.7.tar.gz\ncurl -OL https://ftp.pcre.org/pub/pcre/pcre-8.44.tar.gz\ntar zxf pcre-8.44.tar.gz\ncurl -OL http://zlib.net/zlib-1.2.11.tar.gz\ntar zxf zlib-1.2.11.tar.gz\n</code></pre> <p>\u5b89\u88c5\u6784\u5efa\u5de5\u5177\uff1a</p> <pre><code>yum install gcc make\n</code></pre> <p>\u6784\u5efanginx:</p> <pre><code>cd /opt/app/nginx-1.19.7\n./configure --with-debug --with-cc-opt='-O0 -g' --with-pcre=/opt/app/pcre-8.44 --with-zlib=/opt/app/zlib-1.2.11 --prefix=/opt/app/nginx\nmake &amp;&amp; make install\n</code></pre> <p>\u4fee\u6539nginx\u914d\u7f6e\u6587\u4ef6<code>/opt/app/nginx/conf/nginx.conf</code>:</p> <pre><code># \u6700\u597d\u662f1\uff0c\u4fbf\u4e8e\u65ad\u70b9\u8c03\u8bd5\nworker_processes  1;\n\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    sendfile        on;\n    keepalive_timeout  65;\n    server {\n        listen       8000;\n        server_name  localhost;\n\n        location / {\n            root   html;\n            index  index.html index.htm;\n        }\n\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n    }\n}\n</code></pre> <p>\u542f\u52a8\uff1a</p> <pre><code>/opt/app/nginx/sbin/nginx\n</code></pre> <p>\u4f7f\u7528curl\u8bbf\u95ee:</p> <pre><code>curl -v localhost:8080\n</code></pre> <p>\u82e5\u80fd\u8fd4\u56de<code>200 OK</code>\uff0c\u5219\u5df2\u51c6\u5907\u597d\u8c03\u8bd5\u73af\u5883</p>"},{"location":"2021-02-28-%F0%9F%94%A6%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8GDB%E8%B0%83%E8%AF%95Nginx/#2","title":"2 \u8c03\u8bd5","text":"<p>\u5b89\u88c5\u8c03\u8bd5\u5de5\u5177</p> <pre><code>yum install gdb\n</code></pre> <p>\u627e\u5230nginx worker\u7684\u8fdb\u7a0b\u53f7\uff1a</p> <p>\u4e3a\u4ec0\u4e48\u662f<code>worker</code>\u8fdb\u7a0b\u53f7\u5462\uff1f\u56e0\u4e3a\u5728nginx\u67b6\u6784\u4e2d\uff0c\u8fdb\u7a0b\u7c7b\u578b\u4e3b\u8981\u662f<code>master</code>\u548c<code>worker</code>\u4e24\u7c7b\uff0c\u524d\u8005\u4e3b\u8981\u8d1f\u8d23\u914d\u7f6e\u89e3\u6790\u3001\u91cd\u8f7d\u914d\u7f6e\u3001\u7ef4\u62a4work\u8fdb\u7a0b\u7ec4\u7b49\u804c\u8d23\uff0c\u800c\u540e\u8005\u624d\u662f\u63a5\u6536\u3001\u5904\u7406\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u3002\u66f4\u591a\u79fb\u6b65</p> <pre><code>ps -ef | grep 'nginx: worker process' | grep -v grep\n</code></pre> <p>\u4f8b\u5982:</p> <pre><code>[newad@localhost nginx]$ ps -ef | grep 'nginx: worker process' | grep -v grep\nnewad    12362 12361  0 17:55 ?        00:00:00 nginx: worker process\n</code></pre> <p>\u53ef\u77e5\u8fdb\u7a0b\u53f7\u662f<code>12362</code></p> <p>\u7528gdb\u8fde\u63a5\u4e0anginx worker\u8fdb\u7a0b\uff1a</p> <pre><code>gdb -p 12362\n</code></pre> <p>\u82e5\u8f93\u51fa\u7684\u672b\u5c3e\u662f<code>(gdb)</code>\u5b57\u6837\uff0c\u5219\u8fde\u63a5\u6210\u529f</p> <p>\u5728\u6587\u4ef6<code>ngx_http_core_module.c</code>\u7684<code>1816</code>\u884c\u8bbe\u7f6e\u65ad\u70b9\uff1a</p> <pre><code>(gdb) break src/http/ngx_http_core_module.c:1816\nBreakpoint 1 at 0x4d4944: file src/http/ngx_http_core_module.c, line 1816.\n</code></pre> <p>\u7ee7\u7eed\u8fd0\u884c\u8fdb\u7a0b\uff1a</p> <pre><code>(gdb) continue\nContinuing.\n</code></pre> <p>\u65b0\u5f00\u4e00\u4e2assh\u4f1a\u8bdd\uff0c\u4f7f\u7528curl\u53d1\u8d77\u8bbf\u95ee\uff1a</p> <pre><code>curl -v localhost:8080\n</code></pre> <p>\u56de\u5230gdb\u7684\u4f1a\u8bdd\uff0c\u53ef\u4ee5\u53d1\u73b0\u7a0b\u5e8f\u5728\u521a\u521a\u8bbe\u7f6e\u7684\u65ad\u70b9\u505c\u4f4f\u4e86\uff1a</p> <pre><code>Breakpoint 1, ngx_http_send_header (r=0x1f7db20) at src/http/ngx_http_core_module.c:1816\n1816        if (r-&gt;post_action) {\n</code></pre> <p>\u53ef\u4ee5\u901a\u8fc7\u7ec4\u5408\u952e<code>ctrl x</code>\u548c<code>ctrl a</code>\u8fdb\u5165TUI\u6a21\u5f0f\uff0c\u5b9e\u73b0\u540c\u65f6\u67e5\u770b\u6e90\u4ee3\u7801\u548c\u63a7\u5236\u53f0\uff0c\u5982\u56fe\uff1a</p> <p></p> <p>\u4f7f\u7528<code>p</code>\u547d\u4ee4\uff0c\u6c42\u503c\uff08\u6253\u5370\uff09\u8868\u8fbe\u5f0f\uff1a</p> <pre><code>(gdb) p r-&gt;request_line\n$2 = {len = 14, data = 0x1f844d8 \"GET / HTTP/1.1\\r\\nHost\"}\n</code></pre> <p>\u4f7f\u7528<code>ptype</code>\u547d\u4ee4\uff0c\u6253\u5370struct\u6216\u8005class\u7684\u5b9a\u4e49\uff1a</p> <pre><code>(gdb) ptype ngx_http_request_body_t\ntype = struct {\n    ngx_temp_file_t *temp_file;\n    ngx_chain_t *bufs;\n    ngx_buf_t *buf;\n    off_t rest;\n    off_t received;\n    ngx_chain_t *free;\n    ngx_chain_t *busy;\n    ngx_http_chunked_t *chunked;\n    ngx_http_client_body_handler_pt post_handler;\n}\n</code></pre> <p>\u4f7f\u7528<code>continue</code>\u547d\u4ee4\uff0c\u7ee7\u7eed\u8fd0\u884c\u8fdb\u7a0b\u3002</p>"},{"location":"2021-02-28-%F0%9F%94%A6%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8GDB%E8%B0%83%E8%AF%95Nginx/#3","title":"3 \u53c2\u8003","text":"<ul> <li>http://www.cs.fsu.edu/~baker/ada/gnat/html/gdb_23.html</li> <li>https://stackoverflow.com/questions/10115540/gdb-split-view-with-code</li> <li>https://docs.nginx.com/nginx/admin-guide/monitoring/debugging/#nginx-and-debugging-symbols</li> <li>https://stackoverflow.com/questions/1768620/how-do-i-show-what-fields-a-struct-has-in-gdb</li> </ul>"},{"location":"2021-05-01-%F0%9F%A7%B0EasyConnect%20in%20Dokcer/","title":"2021 05 01 \ud83e\uddf0EasyConnect in Dokcer","text":"<p>Sangfor EasyConnect\u662f\u4e00\u6b3e\u4e13\u6709\u7684VPN\u89e3\u51b3\u65b9\u6848\uff0c\u5b98\u65b9\u652f\u6301\u591a\u79cd\u5e73\u53f0\u7684\u5ba2\u6237\u7aef\uff1b\u4f46\u8be5\u8f6f\u4ef6\u76ee\u524d\u5b58\u5728\u4ee5\u4e0b\u7684\u51e0\u79cd\u884c\u4e3a\uff1a</p> <ol> <li>\u914d\u7f6e\u4e00\u4e2a\u5f00\u673a\u81ea\u52a8\u542f\u52a8\u7684\u5b88\u62a4\u8fdb\u7a0b<code>EasyMonitor</code></li> <li>\u5b89\u88c5CA\u6839\u8bc1\u4e66</li> </ol> <p>\u4e3a\u4e86\u907f\u514d\u4e0a\u8ff0\u4e24\u79cd\u60c5\u51b5\u5bf9\u672c\u5730\u7cfb\u7edf\u9020\u6210\u4e0d\u826f\u5f71\u54cd\uff0c\u5c1d\u8bd5\u5bfb\u627e\u65b9\u6cd5\u5c06EasyConnect\u8fd0\u884c\u5728\u53d7\u63a7\u7684\u5bb9\u5668\u5185\u3002\u6240\u5e78\u5728Hagb/docker-easyconnect\u627e\u5230\u4e86\uff0c\u8be5\u4ed3\u5e93\u4ecb\u7ecd\u4e86\u4e00\u79cd\u5728Docker\u5185\u8fd0\u884cEasyConnect\u7684\u65b9\u6848\u3002\u901a\u8fc7\u8be5\u65b9\u6848\uff0c\u5728\u6b64\u8bb0\u5f55\u4e0b\u6211\u7684\u5b9e\u8df5\u8fc7\u7a0b\u3002</p>"},{"location":"2021-05-01-%F0%9F%A7%B0EasyConnect%20in%20Dokcer/#1","title":"1 \u8fd0\u884c\u5bb9\u5668","text":"<p>\u5728<code>Docker\u5bbf\u4e3b\u673a</code>\u4e3aAlpine Linux\u65f6\uff0c\u6620\u5c04\u5230<code>Docker\u5bbf\u4e3b\u673a</code>\u7684\u7aef\u53e3\uff0c\u65e0\u6cd5\u5728\u5bbf\u4e3b\u673a\u7684\u5916\u90e8\u7f51\u7edc\uff08\u4f8b\u5982\u5bbf\u4e3b\u673a\u6240\u5728\u7684\u5c40\u57df\u7f51\uff09\u8bbf\u95ee\uff0c\u4f46\u53ef\u4ee5\u5728\u5bbf\u4e3b\u673a\u672c\u5730\u8bbf\u95ee\uff1b</p> <p>\u521b\u5efa\u6587\u4ef6\u7528\u4e8e\u4fdd\u5b58\u767b\u5f55\u51ed\u8bc1\uff0c\u4ee5\u5b9e\u73b0auto login\uff1a</p> <pre><code>$ touch ~/.easyconn\n</code></pre> <p>\u4eceDocker\u955c\u50cf<code>hagb/docker-easyconnect:cli</code>\u521b\u5efa\u4e00\u4e2a\u540d\u79f0\u4e3a<code>easyconnect</code>\u7684\u5bb9\u5668\uff0c\u5e76\u4e14\u5c06<code>\u5bb9\u5668\u76841080\u7aef\u53e3</code>\u6620\u5c04\u5230<code>Docker\u5bbf\u4e3b\u673a\u76841080\u7aef\u53e3</code>\uff081080\u53ea\u662f\u4e00\u4e2a\u793a\u4f8b\u503c\uff0c\u53ef\u4ee5\u662f\u5176\u4ed6\u7684\uff1b\u6572\u9ed1\u677f\uff0c\u540e\u7eed\u4f1a\u7528\u5230\uff09\uff1a</p> <pre><code>$ docker run --name easyconnect --device /dev/net/tun --cap-add NET_ADMIN -ti -v $HOME/.easyconn:/root/.easyconn -e EC_VER=7.6.8 -e EXIT=1 -p 1080:1080 hagb/docker-easyconnect:cli\n</code></pre> <p>\u6839\u636e\u63d0\u793a\u8f93\u5165<code>\u670d\u52a1\u5668URL</code>\u3001<code>\u7528\u6237\u540d</code>\u3001<code>\u5bc6\u7801</code>\u3002</p> <p>\u6ce8\u610f\u670d\u52a1\u5668URL\u672b\u5c3e\u4e0d\u9700\u8981\u53cd\u659c\u7ebf\uff08<code>/</code>\uff09\uff0c\u4f8b\u5982\u6b63\u786e\u7684<code>https://vpn_host</code>\u3002</p> <p>\u5982\u679c\u6210\u529f\u767b\u5165\uff0c\u5219\u4f1a\u63d0\u793a\uff1a</p> <pre><code>user \"xx\" login successfully!\n</code></pre>"},{"location":"2021-05-01-%F0%9F%A7%B0EasyConnect%20in%20Dokcer/#2-over-proxy","title":"2 \u6d4f\u89c8\u5668over proxy","text":"<ol> <li> <p>\u6d4f\u89c8\u5668\u8fd0\u884c\u65f6\u52a8\u6001\u914d\u7f6e\u4ee3\u7406\uff0c\u53ef\u4ee5\u901a\u8fc7SwitchyOmega\u6765\u5b9e\u73b0\uff0c\u987b\u5c06Proxy\u8bbe\u7f6e\u4e3a<code>Docker\u5bbf\u4e3b\u673a\u76841080\u7aef\u53e3</code></p> </li> <li> <p>\u6d4f\u89c8\u5668\u542f\u52a8\u65f6\u6307\u5b9a\u4ee3\u7406\uff0c\u82e5\u60a8\u662f\u4f7f\u7528<code>Chromium</code>\u76f8\u5173\uff08\u6bd4\u5982Chrome\uff09\uff0c\u5219\u53ef\u901a\u8fc7\u547d\u4ee4\u884c\u542f\u52a8\uff1a</p> </li> </ol> <pre><code>$ chromium \u2014proxy-server=socks5://${Docker\u5bbf\u4e3b\u673aIP}:1080\n</code></pre>"},{"location":"2021-05-01-%F0%9F%A7%B0EasyConnect%20in%20Dokcer/#3-ssh-over-proxy","title":"3 ssh over proxy","text":"<p>\u82e5\u60a8\u662f\u4f7f\u7528Arch Linux\uff0c\u9700\u8981\u5b89\u88c5openbsd-netcat\uff0c\u800c\u4e0d\u662fgnu-netcat</p> <p>\u7f16\u8f91ssh\u914d\u7f6e\u6587\u4ef6<code>~/.ssh/config</code>\uff0c\u6dfb\u52a0\u5185\u5bb9\uff1a</p> <pre><code>Host 10.1.*\n    ProxyCommand /usr/bin/nc -x ${Docker\u5bbf\u4e3b\u673aIP}:1080 %h %p\n</code></pre> <p>\u4f7f\u5f97\u5728\u901a\u8fc7ssh\u8bbf\u95ee\u5339\u914d<code>10.1.*</code>\uff08\u4ec5\u4ec5\u662f\u793a\u4f8b\uff0c\u9700\u8981\u6839\u636e\u60a8\u7684\u5b9e\u9645\u4f7f\u7528\u60c5\u51b5\u8c03\u6574\uff09\u7684\u4e3b\u673a\u65f6\uff0c\u901a\u8fc7\u4ee3\u7406<code>${Docker\u5bbf\u4e3b\u673aIP}:1080</code></p>"},{"location":"2021-05-01-%F0%9F%A7%B0EasyConnect%20in%20Dokcer/#4-git-over-proxy","title":"4 git over proxy","text":"<p>\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\uff1a</p> <ol> <li> <p>\u82e5git\u4ed3\u5e93\u7684remote\u662f<code>ssh</code>\u534f\u8bae\uff0c\u7f16\u8f91ssh\u914d\u7f6e\u6587\u4ef6<code>~/.ssh/config</code>\uff0c\u6dfb\u52a0\u5185\u5bb9\uff1a</p> <pre><code>Host ${git\u4ed3\u5e93\u57df\u540d}\n    ProxyCommand /usr/bin/nc -x ${Docker\u5bbf\u4e3b\u673aIP}:1080 %h %p\n</code></pre> </li> <li> <p>\u82e5git\u4ed3\u5e93\u7684remote\u662f<code>http</code>\u6216\u8005<code>https</code>\u534f\u8bae\uff0c\u90a3\u4e48\u5728\u4e0eremote\u4ea4\u4e92\u65f6\uff0c\u4e3agit\u547d\u4ee4\u6307\u5b9a\u53d8\u91cf<code>http_proxy</code>\uff0c\u4f8b\u5982\uff1a</p> <pre><code>$ https_proxy=socks5://localhost:1080 git clone http://${git\u4ed3\u5e93\u57df\u540d}/x/x.git\n</code></pre> </li> </ol>"},{"location":"2021-05-01-%F0%9F%A7%B0EasyConnect%20in%20Dokcer/#5-mysql-client-over-proxy","title":"5 MySQL client over proxy","text":"<p>\u56e0\u4e3a\u539f\u751fMySQL client\u4e0d\u652f\u6301socks5\u4ee3\u7406\uff0c\u53ef\u901a\u8fc7\u5176\u4ed6\u5ba2\u6237\u7aef\u6765\u8fbe\u5230\u76ee\u7684\uff1b\u4f8b\u5982mycli\uff0c\u4f46mycli\u76ee\u524d\u6ca1\u6709\u652f\u6301socks5\u4ee3\u7406\uff0c\u6240\u4ee5\u4e5f\u9700\u8981\u91c7\u53d6\u4e00\u4e9b\u989d\u5916\u7684\u63aa\u65bd\u3002</p> <p>\u56e0\u4e3amycli\u57fa\u4e8ePython\u5b9e\u73b0\uff0c\u6545\u53ef\u901a\u8fc7PySocks\u6765\u5bf9\u6574\u4e2a\u6807\u51c6\u5e93\u8fdb\u884c\u7334\u8865\u4e01(Monkey patch)\uff0c\u4f7f\u6240\u6709\u7684socket\u90fd\u901a\u8fc7\u4e00\u4e2a\u4ee3\u7406\u5efa\u7acb\u3002</p> <p>\u5047\u8bbe\u60a8\u662f\u901a\u8fc7brew\u5b89\u88c5\u7684mycli\uff0c\u90a3\u4e48\u9700\u8981\u4fee\u6539<code>/usr/local/bin/mycli</code>\uff0c\u6dfb\u52a0\u5185\u5bb9\uff1a</p> <pre><code>import socket\nimport socks\n\nip = '${Docker\u5bbf\u4e3b\u673aIP}'\nport = 1080\nsocks.setdefaultproxy(socks.PROXY_TYPE_SOCKS5, ip, port)\nsocket.socket = socks.socksocket\n</code></pre> <p>\u4fdd\u5b58\u5373\u53ef\u4f7f\u7528\u3002</p>"},{"location":"2021-05-01-%F0%9F%A7%B0EasyConnect%20in%20Dokcer/#6","title":"6 \u53c2\u8003","text":"<ol> <li>https://zhuanlan.zhihu.com/p/259634641</li> <li>https://www.sangfor.com/en/products/infrastructure/easyconnect</li> <li>https://github.com/Hagb/docker-easyconnect</li> <li>https://docs.docker.com/config/containers/container-networking/</li> <li>https://superuser.com/questions/454210/how-can-i-use-ssh-with-a-socks-5-proxy</li> <li>https://pypi.org/project/PySocks/</li> <li>https://www.mycli.net/</li> <li>https://dev.mysql.com/doc/refman/8.0/en/mysql.html</li> </ol>"},{"location":"2021-07-01-%F0%9F%93%A6VirtualBox%E7%9A%84%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E5%8A%9F%E8%83%BD/","title":"2021 07 01 \ud83d\udce6VirtualBox\u7684\u7aef\u53e3\u8f6c\u53d1\u529f\u80fd","text":"<p>\u5728\u4f7f\u7528VirtualBox\u65f6\uff0c\u82e5\u9700\u8981\u4ece\u4e3b\u673a\u8bbf\u95ee\u865a\u62df\u673a\uff0c\u6211\u901a\u5e38\u7684\u505a\u6cd5\u662f\u6dfb\u52a0\u4e00\u4e2ahost only\u7684\u7f51\u7edc\u9002\u914d\u5668\uff0c\u7136\u540e\u901a\u8fc7\u8fd9\u4e2a\u9002\u914d\u5668\u7684IP\u8bbf\u95ee\u3002</p> <p>\u4f46\u540c\u6837\u7684\u9700\u6c42\u4e5f\u53ef\u901a\u8fc7\u914d\u7f6eNAT\u9002\u914d\u5668\u4e0a\u7684\u7aef\u53e3\u8f6c\u53d1\u89c4\u5219\u6765\u5b9e\u73b0\uff0c\u66f4\u52a0\u8f7b\u91cf\u5316\u3002</p> <p>\u4f8b\u5982\uff0c\u6211\u9700\u8981\u8bbf\u95ee\u865a\u62df\u673a\u768422\u548c53124\u7aef\u53e3\uff0c\u914d\u7f6e\u5982\u4e0b\uff0c\u5373\u53ef\u901a\u8fc7\u8bbf\u95ee<code>127.0.0.1\u768453124\u7aef\u53e3</code>\u6765\u8bbf\u95ee<code>\u865a\u62df\u673a\u768453124</code>\u7aef\u53e3\uff0c\u901a\u8fc7\u8bbf\u95ee<code>127.0.0.1\u768453125\u7aef\u53e3</code>\u6765\u8bbf\u95ee<code>\u865a\u62df\u673a\u768422\u7aef\u53e3</code>\u3002</p> <p></p>"},{"location":"2021-07-11-%F0%9F%93%B7%E5%9C%A8%E6%A0%91%E8%8E%93%E6%B4%BE%E4%B8%8A%E8%AE%BF%E9%97%AEiPhone%E6%8B%8D%E6%91%84%E7%9A%84%E7%85%A7%E7%89%87%E4%B8%8E%E8%A7%86%E9%A2%91/","title":"2021 07 11 \ud83d\udcf7\u5728\u6811\u8393\u6d3e\u4e0a\u8bbf\u95eeiPhone\u62cd\u6444\u7684\u7167\u7247\u4e0e\u89c6\u9891","text":"<p>\u672c\u4eba\u7684iPhone\u7167\u7247\u4e0e\u89c6\u9891\u7684\u4f53\u79ef\u8d85\u8fc7\u4e86\u514d\u8d39iCloud\u63d0\u4f9b\u76845GB\uff0c\u4f46\u53c8\u4e0d\u559c\u6b22\uff08qiong\uff09\u8ba2\u9605iCloud\u7684\u4ed8\u8d39\u6269\u5bb9\u8ba1\u5212\uff0c\u6240\u4ee5\u770b\u770b\u662f\u5426\u80fd\u5c06\u8fd9\u4e9b\u7167\u7247\u4e0e\u89c6\u9891\u5907\u4efd\u5230\u6811\u8393\u6d3e\u6302\u8f7d\u7684\u786c\u76d8\u4e0a\u3002</p> <p>\u786c\u4ef6\u60c5\u51b5\uff1a</p> <ol> <li>\u6811\u8393\u6d3e\u786c\u4ef6\uff1a\u6811\u8393\u6d3e2B</li> <li>\u6811\u8393\u6d3e\u8f6f\u4ef6\uff1aArch Linux ARM</li> <li>iPhone\u786c\u4ef6\uff1aiPhone 11</li> <li>iPhone\u8f6f\u4ef6\uff1a14.6</li> </ol> <p>\u4e0b\u9762\u662f\u6211\u7684\u64cd\u4f5c\u6b65\u9aa4\uff1a</p> <ol> <li> <p>\u4e3a\u4e86\u5b89\u88c5ifuse\uff0c\u9700\u8981\u5b89\u88c5yay\uff0c\u4f46\u6211\u7684\u6811\u8393\u6d3e\u7684pacman\u6e90\u5e76\u672a\u6536\u7eb3yay\uff0c\u6240\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u6863\u6784\u5efa\u540e\u5b89\u88c5\uff1a</p> <pre><code>sudo pacman -S --needed git base-devel\n# \u79d1\u5b66\u4e0a\u7f51\uff0c\u907f\u514d\u7f51\u7edc\u4e0d\u7545\u901a\u5bfc\u81f4\u7684\u65f6\u95f4\u6d6a\u8d39\nexport http_proxy=socks5://127.0.0.1:1080;export https_proxy=socks5://127.0.0.1:1080;export ALL_PROXY=socks5://127.0.0.1:1080\ngit clone https://aur.archlinux.org/yay.git\ncd yay\nmakepkg -si\n</code></pre> </li> <li> <p>\u5b89\u88c5ifuse\uff1a</p> <p><pre><code>yay -S ifuse\n</code></pre>    \u9009\u62e9<code>ifuse</code>\uff0c\u800c\u4e0d\u662f<code>ifuse-git</code>\uff0c\u7136\u540e\u4f1a\u8bf7\u6c42\u5b89\u88c5\u4e00\u4e9b\u4f9d\u8d56\uff0c\u5141\u8bb8\u5373\u53ef\u3002\u7f16\u8bd1\ud83e\uddec\u5b89\u88c5\u9700\u8981\u4e00\u4e9b\u65f6\u95f4\uff0c\u8010\u5fc3\u7b49\u5f85\uff5e</p> </li> <li> <p>\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u8fd0\u884cusbmuxd\u670d\u52a1\uff1a</p> <pre><code>sudo systemctl start usbmuxd.service\n</code></pre> <p>\u82e5\u8fd0\u884c\u6210\u529f\uff0c\u6b64\u65f6\u4f7f\u7528usb\u8fde\u63a5\u6811\u8393\u6d3e\u4e0eiPhone\uff0ciPhone\u4e0a\u4f1a\u5f39\u7a97\u8be2\u95ee\u662f\u5426\u4fe1\u4efb\u8be5\u8ba1\u7b97\u673a\uff0c\u9009\u62e9\u4fe1\u4efb\u5373\u53ef\uff08\u8fd9\u8fd8\u7528\u8bf4\uff1f\ud83d\ude02\uff09</p> </li> <li> <p>\u786e\u8ba4iPhone\u8fde\u63a5\u6210\u529f\uff1a</p> <pre><code>idevicepair validate\n</code></pre> </li> <li> <p>\u521b\u5efa\u4e00\u4e2a\u6302\u8f7d\u70b9\uff1a</p> <pre><code>mkdir ~/phone\n</code></pre> </li> <li> <p>\u6302\u8f7diPhone\u6587\u4ef6\u7cfb\u7edf\uff1a</p> <pre><code>ifuse ~/phone\n</code></pre> </li> <li> <p>\u4f7f\u7528rsync\u540c\u6b65\u5230\u786c\u76d8\uff08\u6302\u8f7d\u70b9\u4e3a/opt/d01/\uff09\uff1a</p> <pre><code>rsync -aP ~/phone/DCIM /opt/d01\n</code></pre> <p>\u6211\u7684\u6811\u8393\u6d3e\u6302\u8f7d\u7684\u786c\u76d8\u662f\u65e0\u81ea\u5e26\u7535\u6e90\u7684\u5916\u7f6e\u7684usb\u786c\u76d8\uff0c\u82e5\u6b64\u65f6\u518d\u540c\u65f6\u8fde\u63a5\u4e0aiPhone\uff0c\u6811\u8393\u6d3e\u7684\u7535\u6e90\u529f\u7387\u4f1a\u4e0d\u8db3\uff0c\u5bfc\u81f4\u65e0\u59a8\u8bbf\u95ee\u786c\u76d8\uff1b\u6240\u4ee5\u6211\u7528\u4e86\u4e00\u4e2a\u81ea\u5e26\u7535\u6e90\u7684usb hub\uff0c\u786c\u76d8\u548ciPhone\u901a\u8fc7hub\u8fde\u63a5\u5230\u6811\u8393\u6d3e\uff0c\u5982\u56fe\uff1a</p> <p></p> </li> <li> <p>\u540c\u6b65\u5b8c\u6210\u540e\uff0c\u5378\u8f7diPhone\u6587\u4ef6\u7cfb\u7edf\uff1a</p> <pre><code>fusermount -u ~/phone\n</code></pre> </li> </ol> <p>\u53c2\u8003\uff1a - https://evanwill.github.io/_drafts/notes/iphone-transfer.html - https://wiki.archlinux.org/title/IOS#Manual_mounting - http://www.ruanyifeng.com/blog/2020/08/rsync.html</p>"},{"location":"2021-08-30-lsof%E4%B9%8B%E5%A4%96%E7%9A%84%E6%9F%A5%E8%AF%A2%E4%BD%BF%E7%94%A8%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E7%9A%84%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%96%B9%E6%B3%95/","title":"2021 08 30 lsof\u4e4b\u5916\u7684\u67e5\u8be2\u4f7f\u7528\u6307\u5b9a\u6587\u4ef6\u7684\u8fdb\u7a0b\u7684\u65b9\u6cd5","text":"<p>\u5728\u4e3b\u673a\u4e0a\u67e5\u770b\u4f7f\u7528\u67d0\u4e2a\u6587\u4ef6\u7684\u4f7f\u7528\u60c5\u51b5\u65f6\uff0c\u53ef\u80fd\u4f1a\u76f4\u63a5\u60f3\u5230\u4f7f\u7528lsof\uff0c\u4f46\u4e0d\u662f\u6240\u6709\u4e3b\u673a\u90fd\u5b89\u88c5\u4e86\u8be5\u5de5\u5177\uff0c\u8fd9\u65f6\u4f60\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4:</p> <pre><code>find /proc -regex '\\/proc\\/[0-9]+\\/fd\\/.*' -type l -lname \"*\u5173\u952e\u8bcd*\" -printf \"%p -&gt; %l\\n\" 2&gt; /dev/null\n</code></pre> <p>\u5b83\u901a\u8fc7\u641c\u7d22<code>\u7c7bUnix\u7cfb\u7edf</code>\u7684process information pseudo-filesystem\uff0c\u6765\u8fbe\u5230\u76ee\u7684</p>"},{"location":"2021-08-30-lsof%E4%B9%8B%E5%A4%96%E7%9A%84%E6%9F%A5%E8%AF%A2%E4%BD%BF%E7%94%A8%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E7%9A%84%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%96%B9%E6%B3%95/#_1","title":"\u53c2\u8003","text":"<ul> <li>proc(5) \u2014 Linux manual page</li> <li>Scott's answer</li> </ul>"},{"location":"2021-09-02-%F0%9F%93%A6%E5%88%A9%E7%94%A8GitHub%20Actions%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BATeX/","title":"2021 09 02 \ud83d\udce6\u5229\u7528GitHub Actions\u81ea\u52a8\u6784\u5efaTeX","text":"<p>\u7b14\u8005\u7ef4\u62a4\u7684\u4e00\u4e9bTeX\u6587\u6863\uff08\u7b80\u5386\u7b49\uff09\u901a\u5e38\u662f\u5728<code>\u5b89\u88c5\u597dTeX\u53d1\u884c\u7248</code>\u7684\u4e3b\u673a\u4e0a\u8fdb\u884c\u7f16\u8f91\u548c\u6784\u5efa\uff0c\u5f53\u65e0\u6cd5\u8bbf\u95ee\u8fd9\u4e9b\u4e3b\u673a\u7684\u65f6\u5019\uff0c\u8be5\u600e\u4e48\u64cd\u4f5c\u5462\uff1f\ud83e\udd14</p> <p>\u8054\u60f3\u5230GitHub\u7684Actions\u529f\u80fd\uff0c\u53ef\u4ee5\u7528\u6765\u505aCI/CD\uff0c\u4e5f\u8bb8\u6709\u620f\u3002\u901a\u8fc7\u641c\u7d22\uff0c\u627e\u5230\u4e86xu-cheng/latex-action\uff0c\u53ef\u4ee5\u8fbe\u5230\u901a\u8fc7<code>git push</code>\u64cd\u4f5c\u6765\u89e6\u53d1\u6784\u5efa\uff0c\u5e76\u5c06\u6784\u5efa\u7684pdf\u6587\u4ef6\u6253\u5305\u653e\u7f6e\u5230<code>Workflow</code>\u7684<code>Artifacts</code>\u4e2d\u3002</p> <p>\u5047\u8bbe\u9700\u8981\u88ab\u7f16\u8bd1\u7684TeX\u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84\u4e3a<code>resume.tex</code>\uff0c\u7f16\u8bd1\u5668\u662f<code>XeLaTeX</code>\uff0c\u90a3\u4e48\u53ef\u4ee5\u7528\u4e0b\u9762\u7684workflow\u63cf\u8ff0\u6587\u4ef6\u6765\u8fbe\u5230\u76ee\u7684\uff1a</p> <pre><code>name: Build LaTeX document\non: [push]\njobs:\n  build_latex:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Set up Git repository\n        uses: actions/checkout@v2\n      - name: Compile LaTeX document\n        uses: xu-cheng/latex-action@v2\n        with:\n          root_file: resume.tex\n          pre_compile: \"fc-list :lang=zh\"\n          latexmk_use_xelatex: true\n      - uses: actions/upload-artifact@v2\n        with:\n          name: PDF\n          path: resume.pdf\n</code></pre> <p>\u653e\u7f6e\u5230\u4ed3\u5e93\u7684<code>.github/workflows/</code>\u8def\u5f84\uff0c\u518d\u89e6\u53d1push\u5373\u53ef\u3002</p>"},{"location":"2021-09-25-%E5%9C%A8macOS%E4%B8%8A%E4%BD%BF%E7%94%A8VS%20Code%E9%98%85%E8%AF%BBOpenJDK%E6%BA%90%E7%A0%81/","title":"2021 09 25 \u5728macOS\u4e0a\u4f7f\u7528VS Code\u9605\u8bfbOpenJDK\u6e90\u7801","text":""},{"location":"2021-09-25-%E5%9C%A8macOS%E4%B8%8A%E4%BD%BF%E7%94%A8VS%20Code%E9%98%85%E8%AF%BBOpenJDK%E6%BA%90%E7%A0%81/#1","title":"1 \u672c\u5730\u73af\u5883","text":"<ul> <li>\u64cd\u4f5c\u7cfb\u7edf\uff1amacOS Big Sur 11.5.2</li> <li>XCode: 13A5155e</li> <li>JDK: openjdk version \"11.0.9\"</li> <li>VS Code: 1.60.2</li> </ul>"},{"location":"2021-09-25-%E5%9C%A8macOS%E4%B8%8A%E4%BD%BF%E7%94%A8VS%20Code%E9%98%85%E8%AF%BBOpenJDK%E6%BA%90%E7%A0%81/#2-openjdk","title":"2 \u4e0b\u8f7dOpenJDK\u5de5\u7a0b","text":"<p>\u521b\u5efa\u4e00\u4e2a<code>\u4e0d\u542b\u7528\u6237\u540d\u76f8\u5173</code>\uff08\u5efa\u8bae\uff09\u7684\u8def\u5f84\uff0c\u4f8b\u5982<code>/opt/source</code>\uff0c\u5c06OpenJDK 11\u7684\u5de5\u7a0b\u514b\u9686\u81f3\u672c\u5730\uff1a</p> <pre><code>cd /opt/source\n</code></pre> <p>\u5c06<code>openjdk/jdk11u</code>\u514b\u9686\u5230\u672c\u5730\uff0c\ud83d\udc22\u9700\u8981\u826f\u597d\u7684\u7f51\u7edc\u73af\u5883\uff0c\u6240\u4ee5\u4f7f\u7528\u672c\u5730\u7684\u4ee3\u7406\uff1b\u82e5\u4e0d\u9700\u8981\u4ee3\u7406\u8bf7\u5ffd\u7565\u7b2c\u4e00\u884c\uff1a</p> <pre><code>https_proxy=socks5://localhost:1080 \\\ngit clone https://github.com/openjdk/jdk11u.git\n</code></pre> <p>\u2615\ufe0f\u5efa\u8bae\u559d\u676f\u6c34\u7b49\u4f1a\u513f\uff0c\u7b49\u514b\u9686\u5b8c\u8fdb\u5165\u4e0b\u4e2a\u6b65\u9aa4\u3002</p>"},{"location":"2021-09-25-%E5%9C%A8macOS%E4%B8%8A%E4%BD%BF%E7%94%A8VS%20Code%E9%98%85%E8%AF%BBOpenJDK%E6%BA%90%E7%A0%81/#3","title":"3 \u4e3a\u6784\u5efa\u505a\u914d\u7f6e","text":"<p>\u5bf9\u4e8e\u6587\u4ef6\u6570\u91cf\u5927\u3001\u7ed3\u6784\u590d\u6742\u7684\u5de5\u7a0b\uff0c\u4e00\u822c\u4f1a\u5f15\u5165\u6784\u5efa\u5de5\u5177\uff0c\u6765\u5b9e\u73b0\u65e5\u5e38\u7684\u5f00\u53d1\u3001\u53d1\u5e03\u6d41\u7a0b\u7684\u6807\u51c6\u5316\uff0c\u5982GNU Make\u3001Apache Maven\u7b49\uff0cOpenJDK 11\u4ea6\u7136\u3002</p> <p>\u5bf9\u4e8e\u5f00\u53d1\u9636\u6bb5\uff0c\u8981\u6c42\u6784\u5efa\u8017\u65f6\u77ed\uff08\u4e0d\u8fdb\u884c\u7a0b\u5ea6\u9ad8\u7684\u4f18\u5316\uff09\u3001\u6784\u5efa\u7ed3\u679c\u4fbf\u4e8e\u8c03\u8bd5\uff08debug\uff09\u3001\u8fd0\u884c\u901f\u5ea6\u53ef\u4ee5\u4e0d\u90a3\u4e48\u5feb\uff1b\u5bf9\u4e8e\u53d1\u5e03\u9636\u6bb5\uff0c\u8981\u6c42\u53ef\u6267\u884c\u6587\u4ef6\u8fd0\u884c\u901f\u5ea6\u5feb\uff0c\u6784\u5efa\u8017\u65f6\u53ef\u4ee5\u7a0d\u5fae\u957f\u70b9\u513f\u3002OpenJDK\u7684\u6784\u5efa\u652f\u6301\u901a\u8fc7\u914d\u7f6e\uff08configure\u811a\u672c\uff09\u53c2\u6570<code>--with-debug-level=&lt;level&gt;</code>\u6765\u6307\u5b9a\u6784\u5efa\u7ed3\u679c\u7684\u8c03\u8bd5\u7ea7\u522b\uff0c\u6765\u5b9e\u73b0\u4e0d\u540c\u9636\u6bb5\u5bf9\u6784\u5efa\u7ed3\u679c\u7684debug\u652f\u6301\u7a0b\u5ea6\u3002</p> <p>\u7531\u4e8e\u672c\u6587\u4ecb\u7ecd\u7684\u662f\u642d\u5efa\u9605\u8bfb\u4ee3\u7801\u73af\u5883\uff0c\u6240\u4ee5\u662f\u5f00\u53d1\u9636\u6bb5\uff0c\u6267\u884c\uff1a</p> <pre><code>cd /opt/source/jdk11u\nbash ./configure \\\n    #\u6307\u5b9a\u672c\u5730\u7684JDK\uff0c\u5bf9\u7248\u672c\u6709\u8981\u6c42 \\\n    --with-boot-jdk=/opt/app/jdk-11.0.9+11/Contents/Home \\\n    #\u82e5\u4ee3\u7801\u4e2d\u5b58\u5728\u7f16\u8bd1\u65f6\u8b66\u544a\uff0c\u4f7f\u7f16\u8bd1\u7ee7\u7eed\u8fdb\u884c\uff0c\u4e0d\u5f53\u505a\u5f02\u5e38 \\\n    --disable-warnings-as-errors \\\n    #\u6307\u5b9a\u8c03\u8bd5\u7b49\u7ea7 \\\n    --with-debug-level=slowdebug \\\n    #\u8c03\u8bd5\u7b26\u53f7\u5c06\u5728\u6784\u5efa\u8fc7\u7a0b\u4e2d\u751f\u6210\uff0c\u5b83\u4eec\u5c06\u88ab\u4fdd\u5b58\u5728\u751f\u6210\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u3002 \\\n    --with-native-debug-symbols=internal\n</code></pre> <p>\u82e5\u672c\u5730\u73af\u5883\u6ee1\u8db3\u6784\u5efa\u9700\u6c42\uff0c\u811a\u672c\u6b63\u5e38\u7ed3\u675f\uff0c\u5426\u5219\u4f1a\u6709\u62a5\u9519\u4fe1\u606f\u3002</p>"},{"location":"2021-09-25-%E5%9C%A8macOS%E4%B8%8A%E4%BD%BF%E7%94%A8VS%20Code%E9%98%85%E8%AF%BBOpenJDK%E6%BA%90%E7%A0%81/#4","title":"4 \u6784\u5efa","text":"<p>\u8fd9\u4e2a\u6b65\u9aa4\u9700\u8981\u5927\u91cf\u7684CPU\u3001\u5185\u5b58\u8d44\u6e90\uff0c\u5efa\u8bae\u5173\u6389\u4e0d\u9700\u8981\u7684\u7a0b\u5e8f\uff0c\u82e5\u662f\u7b14\u7535\u5efa\u8bae\u63a5\u4e0a\u7535\u6e90\uff08\u5f53\u7136\uff0c\u58d5\u673a\u5668\u8bf7\u968f\u610f\ud83d\ude0e\uff09\u3002</p> <p>\u6267\u884c\uff1a</p> <pre><code>CONF=macosx-x86_64-normal-server-slowdebug make all\n</code></pre> <p>\u8fc7\u7a0b\u9700\u8981\u4e00\u4e9b\u65f6\u95f4\uff0c\u2615\ufe0f\u2615\ufe0f\u2615\ufe0f\u591a\u559d\u51e0\u676f\u6c34\uff0c\u7b49\u5b8c\u6210\u518d\u8fdb\u5165\u4e0b\u4e2a\u6b65\u9aa4\u3002</p>"},{"location":"2021-09-25-%E5%9C%A8macOS%E4%B8%8A%E4%BD%BF%E7%94%A8VS%20Code%E9%98%85%E8%AF%BBOpenJDK%E6%BA%90%E7%A0%81/#5-vs-code","title":"5 \u751f\u6210VS Code\u5de5\u4f5c\u7a7a\u95f4","text":"<p>\u6839\u636edoc/ide\u7684\u4ecb\u7ecd\uff0cOpenJDK 11\u7684\u6784\u5efa\u7cfb\u7edf\u652f\u6301\u4e86\u751f\u6210VS Code\u5de5\u4f5c\u7a7a\u95f4\uff0c\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u6765\u652f\u6301\u4e86IDE\u7684\u6807\u51c6\u5316\uff0c\u5927\u9879\u76ee\u5c31\u662f\u4e0d\u4e00\u6837\ud83d\udc4f\u3002</p> <p>\u6267\u884c\uff1a</p> <pre><code>CONF=macosx-x86_64-normal-server-slowdebug make vscode-project\n</code></pre> <p>\u5b8c\u6210\u540e\uff0c\u4f60\u80fd\u770b\u5230\u6587\u4ef6<code>/opt/source/jdk11u/build/macosx-x86_64-normal-server-slowdebug/jdk.code-workspace</code></p>"},{"location":"2021-09-25-%E5%9C%A8macOS%E4%B8%8A%E4%BD%BF%E7%94%A8VS%20Code%E9%98%85%E8%AF%BBOpenJDK%E6%BA%90%E7%A0%81/#6-vs-code","title":"6 \u4f7f\u7528VS Code\u6253\u5f00\u5de5\u7a0b","text":"<p>\u5728\u6253\u5f00\u5de5\u7a0b\u524d\uff0c\u9700\u8981\u5b89\u88c5\u63d2\u4ef6C/C++\uff1a</p> <p></p> <p>\u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\uff0c\u901a\u8fc7<code>File -&gt; Open Workspace...</code>\u6253\u5f00\u6587\u4ef6<code>/opt/source/jdk11u/build/macosx-x86_64-normal-server-slowdebug/jdk.code-workspace</code>\u3002</p>"},{"location":"2021-09-25-%E5%9C%A8macOS%E4%B8%8A%E4%BD%BF%E7%94%A8VS%20Code%E9%98%85%E8%AF%BBOpenJDK%E6%BA%90%E7%A0%81/#7","title":"7 \u65ad\u70b9\u8c03\u8bd5","text":"<p>\u6253\u5f00\u6587\u4ef6<code>/opt/source/jdk11u/src/java.base/share/native/libjli/java.c</code>\uff0c\u5728\u65b9\u6cd5<code>JavaMain</code>\u7684\u7b2c\u4e00\u884c\u4ee3\u7801\u6253\u4e0a\u65ad\u70b9\uff0c\u5982\u56fe\u7684394\u884c\uff1a</p> <p></p> <p>\u5728\u4fa7\u8fb9\u680f\u7684<code>Run and Debug</code>\u4e2d\u9009\u62e9<code>java (Build artifacts)</code>\uff1a</p> <p></p> <p>\u70b9\u51fb\u7eff\u8272\u4e09\u89d2\u5f62\u6309\u94ae\uff0c\u5f00\u59cb\u8fd0\u884c\uff1a</p> <p></p> <p>\u7b49\u5f85\u7a0b\u5e8f\u8fd0\u884c\u5230\u65ad\u70b9\uff1a</p> <p></p>"},{"location":"2021-09-25-%E5%9C%A8macOS%E4%B8%8A%E4%BD%BF%E7%94%A8VS%20Code%E9%98%85%E8%AF%BBOpenJDK%E6%BA%90%E7%A0%81/#8","title":"8 \u53c2\u8003","text":"<ul> <li>win10\u4e0a\u6784\u5efa\u5e76\u8c03\u8bd5openjdk 11</li> <li>doc/building.md</li> </ul>"},{"location":"2022-01-30-%EF%BC%88%E8%AF%91%EF%BC%89%E7%90%86%E8%A7%A3Maven%E7%89%88%E6%9C%AC%E5%8F%B7/","title":"\uff08\u8bd1\uff09\u7406\u89e3Maven\u7248\u672c\u53f7","text":"<p>\u6765\u6e90Oracle\u00ae Fusion Middleware Developing Applications Using Continuous Integration</p> <p>\u5728\u4f7f\u7528Maven\u65f6\uff0c\u7406\u89e3\u5982\u4f55\u4f7f\u7528\u7248\u672c\u53f7\u662f\u975e\u5e38\u91cd\u8981\u7684\u3002\u4e00\u4e2a\u7ecf\u8fc7\u6df1\u601d\u719f\u8651\uff08well thought out\uff09\u7684\u7b56\u7565\u53ef\u4ee5\u5927\u5927\u7b80\u5316\u4f60\u7684\u4f9d\u8d56\u7ba1\u7406\u5de5\u4f5c\u91cf\u3002\u672c\u6587\u4ecb\u7ecd\u4e86\u5173\u4e8e\u7248\u672c\u53f7\u5728Maven\u4e2d\u5982\u4f55\u5de5\u4f5c\u7684\u91cd\u8981\u6982\u5ff5\u3002</p> <p>\u5305\u542b\u4ee5\u4e0b\u4e09\u4e2a\u90e8\u5206\uff1a</p> <ul> <li>Maven\u7248\u672c\u53f7\u5982\u4f55\u5de5\u4f5c</li> <li>SNAPSHOT\u9650\u5b9a\u7b26</li> <li>\u7248\u672c\u8303\u56f4\u5f15\u7528</li> </ul>"},{"location":"2022-01-30-%EF%BC%88%E8%AF%91%EF%BC%89%E7%90%86%E8%A7%A3Maven%E7%89%88%E6%9C%AC%E5%8F%B7/#1-maven","title":"1 Maven\u7248\u672c\u53f7\u5982\u4f55\u5de5\u4f5c","text":"<p>Maven\u7684\u7248\u672c\u7ba1\u7406\u65b9\u6848\uff08scheme\uff09\u4f7f\u7528\u4ee5\u4e0b\u7684\u6807\u51c6\uff1a</p> <ul> <li>MajorVersion</li> <li>MinorVersion</li> <li>IncrementalVersion</li> <li>BuildNumber</li> <li>Qualifier</li> </ul> <p>\u4f8b\u5982\uff1a</p> <ul> <li>MajorVersion: 1.2.1</li> <li>MinorVersion: 2.0</li> <li>IncrementalVersion: 1.2-SNAPSHOT</li> <li>BuildNumber: 1.4.2-12</li> <li>Qualifier: 1.2-beta-2</li> </ul> <p>\u5177\u6709\u9650\u5b9a\u7b26\u7684\u7248\u672c\uff0c\u65e7\u4e8e\u6ca1\u6709\u9650\u5b9a\u7b26\u7684\uff08\u53d1\u5e03\u7248\u672c\uff09\uff0c\u4f8b\u5982\uff1a<code>1.2-beta-2</code>\u65e7\u4e8e<code>1.2</code>\u3002</p> <p>\u5e26\u6709\u4e0d\u540c\u9650\u5b9a\u7b26\u7684\u76f8\u540c\u7248\u672c\uff0c\u5c06\u4f1a\u7528\u57fa\u7840\u7684\u5b57\u7b26\u4e32\u6bd4\u8f83\uff0c\u4f8b\u5982\uff1a<code>1.2-beta-2</code>\u65b0\u4e8e<code>1.2-alpha-6</code>\u3002</p> <p>\u5982\u679c\u4f60\u5728\u9879\u76ee\u7248\u672c\u7ba1\u7406\u65b9\u6848\u4e2d\u6ca1\u6709\u9075\u5faaMaven\u7684\u7248\u672c\u6807\u51c6\uff0c\u90a3\u4e48\u5bf9\u4e8e\u7248\u672c\u6bd4\u8f83\uff0cMaven\u5c06\u6574\u4e2a\u7248\u672c\u89e3\u91ca\u4e3a\u4e00\u4e2a\u7b80\u5355\u7684\u5b57\u7b26\u4e32\u3002Maven\u53ca\u5176\u6838\u5fc3\u63d2\u4ef6\u5c06\u7248\u672c\u6bd4\u8f83\u7528\u4e8e\u591a\u9879\u4efb\u52a1\uff0c\u6700\u91cd\u8981\u7684\u662f\u7528\u4e8e\u53d1\u5e03\u8fc7\u7a0b\u3002</p> <p>\u5982\u679c\u60a8\u4f7f\u7528\u975e\u6807\u51c6\u7684\u7248\u672c\u7ba1\u7406\u65b9\u6848\uff0cMaven\u53d1\u5e03\u548c\u7248\u672c\u63d2\u4ef6\u76ee\u6807\u53ef\u80fd\u4e0d\u4f1a\u4ea7\u751f\u9884\u671f\u7684\u7ed3\u679c\u3002\u56e0\u4e3a\u57fa\u672c\u7684\u5b57\u7b26\u4e32\u6bd4\u8f83\u662f\u5728\u975e\u6807\u51c6\u7684\u7248\u672c\u4e0a\u8fdb\u884c\u7684\uff0c\u6240\u4ee5\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u7248\u672c\u6bd4\u8f83\u4f1a\u9519\u8bef\u5730\u8ba1\u7b97\u7248\u672c\u7684\u987a\u5e8f\u3002</p> <p>\u4f8b\u5982\uff0cMaven\u6309\u4ee5\u4e0b\u987a\u5e8f\u6392\u5217\u7248\u672c\u5217\u8868\uff1a</p> <ul> <li>1.0.1.0</li> <li>1.0.10.1</li> <li>1.0.10.2</li> <li>1.0.9.3</li> </ul> <p>\u7248\u672c<code>1.0.9.3</code>\u5e94\u8be5\u5728<code>1.0.10.1</code>\u548c<code>1.0.10.2</code>\u4e4b\u524d\uff0c\u4f46\u610f\u5916\u7684\u7b2c\u56db\u4e2a\u5b57\u6bb5\uff08<code>.3</code>\uff09\u8feb\u4f7fMaven\u5c06\u7248\u672c\u8bc4\u4f30\u4e3a\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002</p> <p>\u5728Maven\u7248\u672c\u63d2\u4ef6\u4e2d\u53ef\u4ee5\u770b\u5230\u8fd9\u79cd\u5bf9Maven\u5f71\u54cd\u7684\u4f8b\u5b50\u3002Maven\u7248\u672c\u63d2\u4ef6\u63d0\u4f9b\u4e86\u4ee5\u4e0d\u540c\u65b9\u5f0f\u68c0\u67e5\u9879\u76ee\u4f9d\u8d56\u5173\u7cfb\u7684\u76ee\u6807\u3002\u5176\u4e2d\u4e00\u4e2a\u6709\u7528\u7684\u76ee\u6807\u662f<code>versions:dependency-updates-report</code>\uff0c\u5b83\u5c06\u68c0\u67e5\u9879\u76ee\u7684\u4f9d\u8d56\u5c42\u6b21\uff0c\u5e76\u62a5\u544a\u54ea\u4e9b\u9879\u76ee\u6709\u8f83\u65b0\u7684\u7248\u672c\u3002\u5f53\u4f60\u5728\u534f\u8c03\u4e00\u4e2a\u5927\u578b\u53d1\u5e03\u65f6\uff0c\u8fd9\u4e2a\u76ee\u6807\u53ef\u4ee5\u5e2e\u4f60\u627e\u5230\u4f9d\u8d56\u914d\u7f6e\u4e2d\u7684\u9648\u65e7\u5f15\u7528\u3002\u5982\u679cMaven\u9519\u8bef\u5730\u8bc6\u522b\u4e86\u4e00\u4e2a\u8f83\u65b0\u7684\u7248\u672c\uff0c\u90a3\u4e48\u5728\u63d2\u4ef6\u4e2d\u4e5f\u4f1a\u51fa\u73b0\u9519\u8bef\u7684\u62a5\u544a\u3002\u5728\u524d\u9762\u7684\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u82e5\u4f60\u5f53\u524d\u7248\u672c\u662f<code>1.0.10.2</code>\uff0c\u90a3\u4e48\u8fd9\u4e2a\u63d2\u4ef6\u5c06\u4f1a\u5c06<code>1.0.9.3</code>\u62a5\u544a\u6210\u4e00\u4e2a\u8f83\u65b0\u7684\u7248\u672c\u3002</p> <p>\u5982\u679c\u4f60\u6253\u7b97\u5728\u4f60\u7684\u4f9d\u8d56\u5173\u7cfb\u5f15\u7528\u4e2d\u4f7f\u7528\u7248\u672c\u8303\u56f4\uff0c\u7248\u672c\u89e3\u6790\u4e5f\u662f\u975e\u5e38\u91cd\u8981\u7684\u3002\u53c2\u89c1\u7b2c3\u8282\uff0c\u4e86\u89e3\u5173\u4e8e\u7248\u672c\u53d8\u5316\u7684\u4fe1\u606f\u3002</p>"},{"location":"2022-01-30-%EF%BC%88%E8%AF%91%EF%BC%89%E7%90%86%E8%A7%A3Maven%E7%89%88%E6%9C%AC%E5%8F%B7/#2-snapshot","title":"2 SNAPSHOT\u9650\u5b9a\u7b26","text":"<p>Maven\u5bf9\u5f85SNAPSHOT\u9650\u5b9a\u7b26\u7684\u5904\u7406\u65b9\u5f0f\u8ddf\u5176\u4ed6\u6240\u6709\u9650\u5b9a\u7b26\u4e0d\u540c\u3002\u82e5\u4e00\u4e2a\u7248\u672c\u53f7\u4ee5<code>-SNAPSHOT</code>\u7ed3\u5c3e\uff0c\u90a3\u4e48Maven\u4f1a\u8ba4\u4e3a\u5b83\u662f\u76f8\u5173MajorVersion\u3001MinorVersion\u6216IncrementalVersion\u7684 \"\u5c1a\u672a\u53d1\u5e03 \"\u7248\u672c\u3002</p> <p>\u5728\u4e00\u4e2a\u6301\u7eed\u96c6\u6210\u73af\u5883\u4e2d\uff0cSNAPSHOT\u7248\u672c\u5728\u5305\u6210\u96c6\u6210\u6784\u5efa\u7684\u6700\u65b0\u6027\u65b9\u9762\u8d77\u7740\u81f3\u5173\u91cd\u8981\u7684\u4f5c\u7528\uff0c\u540c\u65f6\u5c3d\u91cf\u51cf\u5c11\u6bcf\u4e2a\u96c6\u6210\u6b65\u9aa4\u6240\u9700\u7684\u91cd\u5efa\u91cf\u3002</p> <p>SNAPSHOP\u7248\u672c\u5f15\u7528\u4f7f\u4f9d\u8d56\u9879\u76ee\u6784\u5efa\u65f6\u80fd\u591f\u83b7\u53d6SNAPSHOT\u4f9d\u8d56\u7684\u6700\u65b0\u90e8\u7f72\u5b9e\u4f8b\u3002\u8bf7\u6ce8\u610f\uff0cSNAPSHOT\u662f\u4e0d\u65ad\u53d8\u5316\u7684\u3002\u6bcf\u5f53\u4ee3\u7406\u90e8\u7f72\u5de5\u4ef6\u65f6\uff0c\u5b83\u5c31\u4f1a\u5728\u5171\u4eab\u4ed3\u5e93\u4e2d\u66f4\u65b0\u3002SHAPSHOT\u4f9d\u8d56\u88ab\u91cd\u65b0\u83b7\u53d6\uff0c\u5728\u5f00\u53d1\u8005\u7684\u673a\u5668\u4e0a\uff0c\u6216\u8005\u5b83\u5728\u6bcf\u4e2a\u6784\u5efa\u4e2d\u88ab\u66f4\u65b0\u3002\u8fd9\u786e\u4fdd\u4e86\u4f9d\u8d56\u7684\u66f4\u65b0\u548c\u96c6\u6210\u6700\u65b0\u7684\u53d8\u5316\uff0c\u800c\u4e0d\u9700\u8981\u6539\u9879\u76ee\u4e2d\u7684\u4f9d\u8d56\u5f15\u7528\u914d\u7f6e\u3002</p> <p>\u8bd5\u60f3\uff0c\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u82e5\u4e0d\u4f7f\u7528SNAPSHOT\uff0c\u5219\u6bcf\u6b21\u53d1\u5e03\u90fd\u9700\u8981\u5728\u5de5\u4ef6\u3001\u4f7f\u7528\u5de5\u4ef6\u65b9\uff0c\u81f3\u5c11\u4e24\u4e2a\u5de5\u7a0b\u4e2d\u4fee\u6539\u7248\u672c\u53f7\uff0c\u9ebb\u4e86\ud83d\ude35\u200d\ud83d\udcab</p> <p>\u901a\u5e38\uff0c\u53ea\u6709\u6700\u8fd1\u90e8\u7f72\u7684SNAPSHOT\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u7279\u5b9a\u7248\u672c\u7684\u5de5\u4ef6\u5728\u5de5\u4ef6\u4ed3\u5e93\u4e2d\u88ab\u4fdd\u5b58\u3002\u867d\u7136\u4ed3\u5e93\u53ef\u4ee5\u88ab\u914d\u7f6e\u4e3a\u7ef4\u62a4\u4e00\u4e2a\u6eda\u52a8\u5f52\u6863\uff0c\u5176\u4e2d\u6709\u4e00\u4e9b\u7279\u5b9a\u5de5\u4ef6\u7684\u6700\u65b0\u90e8\u7f72\uff0c\u4f46\u65e7\u7684\u5b9e\u4f8b\u901a\u5e38\u53ea\u7528\u4e8e\u6545\u969c\u6392\u9664\uff0c\u5728\u96c6\u6210\u4e2d\u4e0d\u53d1\u6325\u4efb\u4f55\u4f5c\u7528\u3002</p> <p>\u6301\u7eed\u6784\u5efa\u670d\u52a1\u5668\u5305\u62ec\u5b9a\u4e49\u548c\u6267\u884c\u57fa\u4e8eMaven\u9879\u76ee\u7684\u4f5c\u4e1a\u7684\u80fd\u529b\uff0c\u5982Hudson/Jenkins\uff0c\u53ef\u4ee5\u914d\u7f6e\u4e3a\u8bc6\u522bSNAPSHOT\u5de5\u4ef6\u7684\u66f4\u65b0\uff0c\u7136\u540e\u91cd\u5efa\u5bf9\u66f4\u65b0\u5de5\u4ef6\u6709\u4f9d\u8d56\u6027\u7684\u9879\u76ee\u3002</p>"},{"location":"2022-01-30-%EF%BC%88%E8%AF%91%EF%BC%89%E7%90%86%E8%A7%A3Maven%E7%89%88%E6%9C%AC%E5%8F%B7/#3","title":"3 \u7248\u672c\u8303\u56f4\u5f15\u7528","text":"<p>Maven\u80fd\u6307\u5b9a\u53ef\u63a5\u53d7\u7684\u7248\u672c\u8303\u56f4\u4f5c\u4e3a\u4f9d\u8d56\uff0c\u4e0b\u6807\u663e\u793a\u4e86\u4e00\u7cfb\u5217\u7684\u7248\u672c\u89c4\u683c\u3002</p> \u8303\u56f4 \u542b\u4e49 (,1.0] x &lt;= 1.0 1.0 \u5982\u679c1.0\u4e0d\u53ef\u7528\uff0c\u5b83\u901a\u5e38\u610f\u5473\u77401.0\u6216\u66f4\u9ad8\u7248\u672c\u3002\u4e0d\u540c\u7684Maven\u63d2\u4ef6\u53ef\u80fd\u5bf9\u6b64\u6709\u4e0d\u540c\u7684\u89e3\u91ca\uff0c\u56e0\u6b64\u4f7f\u7528\u5176\u4ed6\u66f4\u5177\u4f53\u7684\u9009\u9879\u66f4\u4e3a\u5b89\u5168\u3002 [1.0] \u6b63\u662f1.0 [1.2,1.3] 1.2 &lt;= x &lt;= 1.3 [1.0,2.0) 1.0 &lt;= x &lt; 2.0 [1.5,) x &gt;= 1.5 (,1.0],[1.2,) x &lt;= 1.0 or x &gt;= 1.2\u3002\u591a\u4e2a\u96c6\u5408\u7528\u9017\u53f7\u9694\u5f00\u3002 (,1.1),(1.1,) \u5982\u679c\u5df2\u77e51.1\u4e0d\u80fd\u4e0e\u5e93\u7ed3\u5408\u4f7f\u7528\uff0c\u8fd9\u5c31\u6392\u9664\u4e861.1 <p>\u5f53Maven\u9047\u5230\u591a\u4e2a\u5339\u914d\u7684\u7248\u672c\u53f7\u65f6\uff0c\u5b83\u4f1a\u4f7f\u7528\u6700\u9ad8\u5339\u914d\u7684\u7248\u672c\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u7248\u672c\u5f15\u7528\u5e94\u8be5\u6839\u636e\u9700\u8981\u6765\u786e\u5b9a\uff0c\u8fd9\u6837Maven\u5c31\u53ef\u4ee5\u914c\u60c5\u9009\u62e9\u65b0\u7684\u4f9d\u8d56\u7248\u672c\uff0c\u4f46\u4e5f\u77e5\u9053\u4f55\u65f6\u5fc5\u987b\u4f7f\u7528\u67d0\u4e2a\u7279\u5b9a\u7684\u7248\u672c\u3002\u8fd9\u8bd5Maven\u80fd\u5728\u8de8\u4f9d\u8d56\u56fe\u7684\u4e0d\u540c\u70b9\u6851\u6307\u5b9a\u4e0d\u540c\u7248\u672c\u7684\u4f9d\u8d56\u65f6\uff0c\u9009\u62e9\u6700\u5408\u9002\u7684\u7248\u672c\u3002\u5f53\u53d1\u751f\u8fd9\u6837\u7684\u51b2\u7a81\u65f6\uff0cMaven\u4f1a\u4ece\u6240\u6709\u5f15\u7528\u4e2d\u9009\u62e9\u6700\u9ad8\u7248\u672c\u3002</p> <p>\u9274\u4e8e\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528\u7248\u672c\u8303\u56f4\uff0c\u4f60\u53ef\u80fd\u4f1a\u60f3\uff0c\u4f7f\u7528SNAPSHOT\u7248\u672c\u662f\u5426\u8fd8\u6709\u7528\u3002\u5c3d\u7ba1\u4f60\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u7248\u672c\u8303\u56f4\u8868\u8fbe\u5f0f\u8fbe\u5230\u4e00\u4e9b\u76f8\u540c\u7684\u7ed3\u679c\uff0c\u4f46\u5728\u6301\u7eed\u6784\u5efa\u7cfb\u7edf\u4e2d\uff0cSNAPSHOT\u7684\u6548\u679c\u66f4\u597d\uff0c\u539f\u56e0\u5982\u4e0b\uff1a</p> <ul> <li>Maven\u5de5\u4ef6\u4ed3\u5e93\u7ba1\u7406\u5668\u5904\u7406SNAPSHOT\u6bd4\u5904\u7406\u4e0b\u4e00\u7248\u672c\u8303\u56f4\u66f4\u6709\u6548\u3002\u56e0\u4e3a\u4e00\u4e2a\u5de5\u4ef6\u5728\u4e00\u5929\u5185\u53ef\u4ee5\u90e8\u7f72\u591a\u6b21\uff0c\u6240\u4ee5\u5b58\u50a8\u5e93\u7ef4\u62a4\u7684\u72ec\u7279\u5b9e\u4f8b\u7684\u6570\u91cf\u4f1a\u8fc5\u901f\u589e\u52a0\u3002</li> <li>\u975eSNAPSHOT\u53d1\u5e03\u7248\u672c\u662f\u4e3a\u4e86\u65e0\u9650\u671f\u5730\u7ef4\u62a4\u3002\u5982\u679c\u4f60\u4e0d\u65ad\u5730\u53d1\u5e03\u65b0\u7684\u7248\u672c\u5e76\u589e\u52a0\u6784\u5efa\u53f7\u6216\u7248\u672c\uff0c\u5b58\u50a8\u9700\u6c42\u5f88\u5feb\u5c31\u4f1a\u53d8\u5f97\u65e0\u6cd5\u7ba1\u7406\u3002\u5b58\u50a8\u4ed3\u5e93\u7ba1\u7406\u5668\u88ab\u8bbe\u8ba1\u4e3a\u629b\u5f03\u65e7\u7684SNAPSHOT\uff0c\u4e3a\u65b0\u7684\u5b9e\u4f8b\u817e\u51fa\u7a7a\u95f4\uff0c\u56e0\u6b64\u6240\u9700\u7684\u5b58\u50a8\u91cf\u4fdd\u6301\u4e0d\u53d8\u3002</li> <li>SNAPSHOT\u4e5f\u80fd\u88abMaven\u548cMaven\u7684\u53d1\u5e03\u6d41\u7a0b\u8bc6\u522b\uff0c\u8fd9\u8ba9\u4f60\u5728\u8fdb\u884c\u53d1\u5e03\u6784\u5efa\u65f6\u83b7\u5f97\u4e86\u4e00\u4e9b\u597d\u5904\u3002</li> </ul>"},{"location":"2022-01-30-%EF%BC%88%E8%AF%91%EF%BC%89%E7%90%86%E8%A7%A3Maven%E7%89%88%E6%9C%AC%E5%8F%B7/#4","title":"4 \u53c2\u8003","text":"<ul> <li>What is Maven?</li> <li>Better Builds with Maven</li> <li>Maven By Example and Maven: The Complete Reference</li> </ul>"},{"location":"2022-07-02-%E4%BD%BF%E7%94%A8Javac%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E5%B7%A5%E7%A8%8B%E4%BE%9D%E8%B5%96/","title":"2022 07 02 \u4f7f\u7528Javac\u65e5\u5fd7\u5206\u6790\u5de5\u7a0b\u4f9d\u8d56","text":"<p>\u6700\u8fd1\u7684\u5de5\u4f5c\u662f\u8fc1\u79fb\u4e00\u4e2a\u5386\u53f2\u9057\u7559\u7684\u5de5\u4ef6\uff08\u672c\u6587\u79f0\u4e4b\u4e3a\u5de5\u4ef6A\uff09\uff0c\u9996\u5148\u9700\u8981\u68b3\u7406\u8fd9\u4e2a\u5de5\u4ef6\u7684\u6d88\u8d39\u8005\u3002\u521d\u6b65\u8ba1\u5212\u6309\u7167\u4e0b\u9762\u6b65\u9aa4\u8fdb\u884c\uff1a</p> <ol> <li>\u5728\u4ee3\u7801\u641c\u7d22\u5f15\u64ce\uff08\u4f8b\u5982zoekt\uff09\u91cc\u641c\u7d22\uff1a<ul> <li>\u5173\u952e\u8bcd\uff1a\u5de5\u4ef6A\u7684java\u6587\u4ef6\u5934\u90e8\u7684import\u5305\u540d</li> <li>\u6587\u4ef6\u7c7b\u578b\uff1ajava \u7136\u540e\u5c06\u6240\u6709\u7ed3\u679c\u7684\u5de5\u7a0b\u540d\u8fdb\u884c\u6392\u91cd\uff0c\u5f97\u5230\u5de5\u4ef6A\u7684\u6240\u6709\u6d88\u8d39\u8005\u5de5\u7a0b\u3002 <p>Q:\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u76f4\u63a5\u641c\u7d22<code>pom.xml</code>\u6587\u4ef6\u4e2d\u641c\u7d22\u5de5\u4ef6A\u7684\u540d\u79f0\u5462\uff1f</p> <p>A:\u56e0\u4e3a\u5b58\u5728\u5de5\u4ef6A\u7684\u6d88\u8d39\u8005\u5de5\u4ef6\u4f20\u9012\u4f9d\u8d56\u5de5\u4ef6A\u7684\u60c5\u51b5\uff0c\u6b64\u79cd\u65b9\u6cd5\u4e0d\u80fd\u8986\u76d6\u4f20\u9012\u4f9d\u8d56\u7684\u573a\u666f\ud83e\udd79</p> </li> </ul> </li> <li>\u4f7f\u7528<code>Intellij IDEA</code>\u6253\u5f00\u6bcf\u4e2a\u6d88\u8d39\u8005\u5de5\u7a0b\uff0c\u4f9d\u6b21\u67e5\u770b\u5de5\u4ef6A\u4e2d\u7684\u670d\u52a1\u63a5\u53e3\uff08interface\uff09\u7684\u4f7f\u7528\uff0c\u83dc\u5355<code>Navigatie&gt;Declaration or Usages</code></li> <li>\u8bb0\u5f55\u5de5\u4ef6A\u7684\u670d\u52a1\u63a5\u53e3\u5b58\u5728\u88ab\u4f7f\u7528\u7684\u65b9\u6cd5\uff08\u540e\u7eed\u5b9e\u73b0\u5bf9\u5e94\u7684\u66ff\u6362\u63a5\u53e3\uff09</li> </ol> <p>\ud83e\udd28\u4e0d\u8fc7\u770b\u7b2c2\u30013\u4e2a\u6b65\u9aa4\u770b\u8d77\u6765\u633a\u82b1\u65f6\u95f4\u7684\uff0c\u8fd8\u6709\u5176\u4ed6\u529e\u6cd5\u5417\uff1f</p> <p>\u76ee\u524d\u60f3\u5230\u7684\u5176\u4ed6\u529e\u6cd5\u5c31\u662f\u4ece\u7f16\u8bd1\u5668\u65e5\u5fd7\u4e0b\u624b\uff0c\u67e5\u5f97\u53ef\u4ee5\u4f7f\u7528<code>-verbose</code>\u9009\u9879\uff0c\u6765\u5b9e\u73b0\uff1a</p> <p>Uses verbose output, which includes information about each class loaded and each source file compiled.</p> <p>\u4e0b\u9762\u901a\u8fc7\u4e00\u4e2ademo\u6765\u6f14\u793a\uff1a</p> <ol> <li> <p>\u4f7f\u7528maven\u521b\u5efa\u5de5\u4ef6A\uff1a</p> <pre><code>\u279c mvn archetype:generate \\\n        -DarchetypeGroupId=org.apache.maven.archetypes \\\n        -DarchetypeArtifactId=maven-archetype-quickstart \\\n        -DarchetypeVersion=RELEASE \\\n        -DgroupId=demo.a \\\n        -DartifactId=demo-a \\\n        -Dversion=0.0.1-SNAPSHOT \\\n        -DinteractiveMode=false\n</code></pre> <p>\u7136\u540e\u6dfb\u52a0dto\u3001service\u7c7b\uff1a</p> <pre><code>\u279c tree src/main/java/\nsrc/main/java/\n\u2514\u2500\u2500 demo\n    \u2514\u2500\u2500 a\n        \u251c\u2500\u2500 dto\n        \u2502\u00a0\u00a0 \u251c\u2500\u2500 ProductDto.java\n        \u2502\u00a0\u00a0 \u2514\u2500\u2500 StockDto.java\n        \u2514\u2500\u2500 service\n            \u251c\u2500\u2500 IProductService.java\n            \u2514\u2500\u2500 impl\n                \u2514\u2500\u2500 ProductServiceImpl.java\n\n5 directories, 4 files\n</code></pre> <p>install \u5230\u672c\u5730\u4ed3\u5e93\uff1a</p> <p><pre><code>\u279c mvn install\n</code></pre> 2. \u4f7f\u7528maven\u521b\u5efa\u6d88\u8d39\u8005\u5de5\u4ef6\uff1a</p> <pre><code>\u279c mvn archetype:generate \\\n        -DarchetypeGroupId=org.apache.maven.archetypes \\\n        -DarchetypeArtifactId=maven-archetype-quickstart \\\n        -DarchetypeVersion=RELEASE \\\n        -DgroupId=demo.consumer \\\n        -DartifactId=demo-consumer \\\n        -Dversion=0.0.1-SNAPSHOT \\\n        -DinteractiveMode=false\n</code></pre> <p>\u5728pom.xml\u6dfb\u52a0<code>\u5de5\u4ef6A\u7684\u4f9d\u8d56</code>\uff1a</p> <pre><code>&lt;dependency&gt;\n&lt;groupId&gt;demo&lt;/groupId&gt;\n&lt;artifactId&gt;demo-a&lt;/artifactId&gt;\n&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u5728App\u7c7bmain\u65b9\u6cd5\u4f7f\u7528<code>demo.a.service.IProductService</code>\uff1a <pre><code>package demo.consumer;\n\nimport demo.a.dto.ProductDto;\nimport demo.a.service.IProductService;\nimport demo.a.service.impl.ProductServiceImpl;\n\n/**\n* Hello world!\n*/\npublic class App {\npublic static void main(String[] args) {\nfinal IProductService productService = new ProductServiceImpl();\nfinal ProductDto productDto = productService.getProductById(\"1\"); // \u6ce8\u610f\u70b91\nSystem.out.println(productDto.price);\n}\n}\n</code></pre></p> <p>\u5728pom.xml\u7684<code>maven-compiler-plugin</code>\u914d\u7f6ejavac\u53c2\u6570<code>-verbose</code>\uff1a <pre><code>&lt;plugin&gt;\n&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n&lt;version&gt;3.8.0&lt;/version&gt;\n&lt;configuration&gt;\n&lt;compilerArgs&gt;\n&lt;arg&gt;-verbose&lt;/arg&gt;\n&lt;/compilerArgs&gt;\n&lt;/configuration&gt;\n&lt;/plugin&gt;\n</code></pre></p> <p>\u6784\u5efa\u5e76\u4e14\u5c06javac\u65e5\u5fd7\u91cd\u5b9a\u5411\u5230\u6587\u4ef6<code>javac.log</code>\uff1a</p> <pre><code>\u279c mvn clean compile 2&gt;javac.log\n</code></pre> </li> <li> <p>\u67e5\u770b\u6587\u4ef6javac.log\uff0c\u4e0d\u96be\u53d1\u73b0\u4f7f\u7528\u5230\u7684\u670d\u52a1\u63a5\u53e3\u7c7b\u53cadto\u7c7b\u90fd\u5728\u65e5\u5fd7\u4e2d\uff1a     <pre><code>\u279c grep -nF /demo/a/ javac.log \n5:[loading /Users/zenuo/.m2/repository/demo/demo-a/0.0.1-SNAPSHOT/demo-a-0.0.1-SNAPSHOT.jar(/demo/a/dto/ProductDto.class)]\n6:[loading /Users/zenuo/.m2/repository/demo/demo-a/0.0.1-SNAPSHOT/demo-a-0.0.1-SNAPSHOT.jar(/demo/a/service/IProductService.class)]\n7:[loading /Users/zenuo/.m2/repository/demo/demo-a/0.0.1-SNAPSHOT/demo-a-0.0.1-SNAPSHOT.jar(/demo/a/service/impl/ProductServiceImpl.class)]\n</code></pre></p> </li> </ol> <p>\ud83e\uddd0\u56de\u5230java\u4ee3\u7801\u4e2d\u7684<code>\u6ce8\u610f\u70b91</code>\uff1a\u8fd9\u79cd\u5199\u6cd5\u663e\u5f0fimport\u4e86<code>demo.a.dto.ProductDto</code>\uff0c\u82e5\u6362\u6210\u4e0d\u663e\u5f0fimport\u7684\u5199\u6cd5\uff0c\u65e5\u5fd7\u4e2d\u662f\u5426\u4ecd\u7136\u5b58\u5728<code>demo.a.dto.ProductDto</code>\u5462\uff1f\u73b0\u5728\u5c06\u4ee3\u7801\u6539\u4e3a\u5982\u4e0b\uff1a</p> <pre><code>package demo.consumer;\n\nimport demo.a.service.IProductService;\nimport demo.a.service.impl.ProductServiceImpl;\n\n/**\n * Hello world!\n */\npublic class App {\npublic static void main(String[] args) {\nfinal IProductService productService = new ProductServiceImpl();\nSystem.out.println(productService.getProductById(\"1\").price);\n}\n}\n</code></pre> <p>\u6784\u5efa\u5e76\u4e14\u5c06javac\u65e5\u5fd7\u91cd\u5b9a\u5411\u5230\u6587\u4ef6<code>javac.log.1</code>\uff1a</p> <pre><code>\u279c mvn clean compile 2&gt;javac.log.1\n</code></pre> <p>\u67e5\u770bjavac.log.1\uff0c\u662f\u4ecd\u7136\u5b58\u5728\u7684\uff0c\u53ea\u662f\u4f4d\u7f6e\u4e0d\u540c\uff1a</p> <pre><code>\u279c grep -nF /demo/a/ javac.log.1  \n5:[loading /Users/zenuo/.m2/repository/demo/demo-a/0.0.1-SNAPSHOT/demo-a-0.0.1-SNAPSHOT.jar(/demo/a/service/IProductService.class)]\n6:[loading /Users/zenuo/.m2/repository/demo/demo-a/0.0.1-SNAPSHOT/demo-a-0.0.1-SNAPSHOT.jar(/demo/a/service/impl/ProductServiceImpl.class)]\n17:[loading /Users/zenuo/.m2/repository/demo/demo-a/0.0.1-SNAPSHOT/demo-a-0.0.1-SNAPSHOT.jar(/demo/a/dto/ProductDto.class)]\n</code></pre> <p>\u5b9e\u4f8b\u4ee3\u7801demo.zip</p>"},{"location":"2022-07-02-%E4%BD%BF%E7%94%A8Javac%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E5%B7%A5%E7%A8%8B%E4%BE%9D%E8%B5%96/#_1","title":"\u53c2\u8003","text":"<ul> <li>Java Platform, Standard Edition Tools Reference</li> <li>trying to capture javac output in bash shell</li> <li>How to create an empty multi module Maven project?</li> </ul>"},{"location":"2022-09-04-%E5%9F%BA%E4%BA%8Eredsocks2%E5%92%8Cpf%E7%9A%84macOS%E9%80%8F%E6%98%8E%E4%BB%A3%E7%90%86/","title":"2022 09 04 \u57fa\u4e8eredsocks2\u548cpf\u7684macOS\u900f\u660e\u4ee3\u7406","text":"<p>\u5751\u70b9\uff1a\u5728\ud83e\uddf0EasyConnect in Dokcer\u4e2d\u8bb0\u5f55\u4e86\u5728\u5bb9\u5668\u4e2d\u8fd0\u884cSangfor EasyConnect\u7684\u6b65\u9aa4\uff0c\u5e76\u901a\u8fc7socks5\u4ee3\u7406\u6765\u5b9e\u73b0VPN\u4f7f\u7528\uff0c\u4f46\u8fd9\u79cd\u65b9\u5f0f\u5177\u6709\u4e00\u4e9b\u5c40\u9650\u6027\uff0c\u4ec5\u5bf9\u652f\u6301\u4e86socks5\u6216http\u4ee3\u7406\u7684\u7a0b\u5e8f\u6709\u7528\u3002\u4e3e\u4e00\u4e2a\u4e0d\u652f\u6301\u7684\u4f8b\u5b50\uff1a\u6211\u5728\u672c\u5730\u6267\u884cJava\u5de5\u7a0b\u7684\u5355\u5143\u6d4b\u8bd5\u65f6\uff0c\u5355\u5143\u6d4b\u8bd5\u4e2d\u6709\u8bbf\u95eezk\u7684\u903b\u8f91\uff0c\u5c3d\u7ba1\u5728JVM\u53c2\u6570\u4e2d\u6dfb\u52a0\u4e86<code>-DsocksProxySet=true -DsocksProxyHost=alpine -DsocksProxyPort=1080</code>\uff0c\u4f46\u5bf9\u8bbf\u95eezk\u5e95\u5c42\u7684nio\u6765\u8bf4\u662f\u65e0\u6548\u7684\ud83d\ude22</p> <p>\u8fd8\u597d\u5728\u641c\u7d22\u5230\u4e86\u8fd9\u4e24\u7bc7\u6587\u7ae0\uff0c\u53d1\u73b0\u53ef\u4ee5\u901a\u8fc7\u900f\u660e\u4ee3\u7406\u6765\u652f\u6301\u8fd9\u79cd\u573a\u666f\uff1a</p> <ul> <li>macos\u4f7f\u7528redsocks\u505a\u900f\u660e\u4ee3\u7406</li> <li>macOS \u900f\u660e\u4ee3\u7406\u914d\u7f6e</li> </ul> <p>\u4e0b\u9762\u662f\u6211\u7684\u64cd\u4f5c\u6b65\u9aa4</p>"},{"location":"2022-09-04-%E5%9F%BA%E4%BA%8Eredsocks2%E5%92%8Cpf%E7%9A%84macOS%E9%80%8F%E6%98%8E%E4%BB%A3%E7%90%86/#1-redsocks","title":"1 \u7f16\u8bd1\u3001\u914d\u7f6eredsocks","text":"<pre><code>$ wget https://github.com/HaoH/redsocks/archive/release-0.68.tar.gz # \u4e0b\u8f7d\u6e90\u7801\n$ tar -zxvf redsocks-release-0.68.tar.gz # \u89e3\u538b\u7f29\n$ cd redsocks-release-0.68\n</code></pre> <p>\u5728\u6211\u7684\u7535\u8111\u73af\u5883\u4e2d\uff0c\u6309\u7167\u6e90\u7801\u5305\u7684\u4ee3\u7801\u6784\u5efa\u7684\u7ed3\u679c\uff0c\u8fd0\u884c\u65f6\u4f1a\u62a5\u9519\uff1a</p> <pre><code>1662282301.374137 err redsocks.c:693 redsocks_connect_relay(...) [192.168.0.103:54303-&gt;10.100.*.*:80]: red_connect_relay failed!!!: Protocol not available\n1662282301.375292 err utils.c:154 red_prepare_relay(...) setsockopt: Protocol not available\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u62a5\u9519\u5728<code>utils.c:154</code>\uff0c\u7ecf\u67e5\u9605\u8d44\u6599\uff0c\u6b64\u79cd\u62a5\u9519\u53ef\u4ee5\u88ab\u5ffd\u7565\uff0c\u6240\u4ee5\u4fee\u6539\u4ee3\u7801\uff1a</p> <pre><code>$ vim utils.c\n</code></pre> <p>\u5c06153\u81f3156\u884c\u6ce8\u91ca\uff0c\u5ffd\u7565setsocketopt\u7684\u62a5\u9519\uff1a <pre><code>        // if (error) {\n        //     log_errno(LOG_ERR, \"setsockopt\");\n        //     goto fail;\n        // }\n</code></pre></p> <pre><code>$ https_proxy=socks5://localhost:1080 make OSX_VERSION=master DISABLE_SHADOWSOCKS=true # \u6784\u5efa\n$ vim redsocks.conf\n</code></pre> <p>\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>base {\n    log_debug = off;\n    log_info = on;\n    log = stderr;\n    daemon = off;\n    redirector = pf;\n    reuseport = off;\n}\n\nredsocks {\n    // redsocks\u7684\u76d1\u542c\u7684\u5730\u5740\u548c\u7aef\u53e3\n    bind = \"127.0.0.1:12345\";\n    // \u4ee3\u7406\u7684\u5730\u5740\u548c\u7aef\u53e3\n    relay = \"192.168.17.128:1080\";\n    type = socks5;\n    autoproxy = 0;\n    timeout = 10;\n}\n</code></pre>"},{"location":"2022-09-04-%E5%9F%BA%E4%BA%8Eredsocks2%E5%92%8Cpf%E7%9A%84macOS%E9%80%8F%E6%98%8E%E4%BB%A3%E7%90%86/#2-pf","title":"2 \u914d\u7f6epf","text":"<p>\u9996\u5148\u6211\u4eec\u9700\u8981\u5b9a\u4e49\u51fa\u9700\u8981\u8f6c\u53d1\u5230\u4ee3\u7406\u7684cidr\u8868\uff0c\u5b58\u653e\u5230\u6587\u4ef6<code>/opt/app/redsocks/forward_cidr.txt</code>\uff0c\u82e5\u9700\u8981\u8f6c\u53d1<code>10.100.0.0/16</code>\u548c<code>10.1.0.0/16</code>\u7f51\u6bb5\u7684IP\u5230\u4ee3\u7406\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>10.100.0.0/16\n10.1.0.0/16\n</code></pre> <p>\u7f16\u8f91<code>/etc/pf.conf</code>\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>scrub-anchor \"com.apple/*\"\n\ntable &lt;forward_cidr&gt; persist file \"/opt/app/redsocks/forward_cidr.txt\"\n\nnat-anchor \"com.apple/*\"\n\nrdr-anchor \"com.apple/*\"\nrdr pass on lo0 proto tcp from any to &lt;forward_cidr&gt; -&gt; 127.0.0.1 port 12345\n\npass out route-to (lo0 127.0.0.1) proto tcp from any to &lt;forward_cidr&gt;\n\ndummynet-anchor \"com.apple/*\"\n\nanchor \"com.apple/*\"\nload anchor \"com.apple\" from \"/etc/pf.anchors/com.apple\"\n</code></pre>"},{"location":"2022-09-04-%E5%9F%BA%E4%BA%8Eredsocks2%E5%92%8Cpf%E7%9A%84macOS%E9%80%8F%E6%98%8E%E4%BB%A3%E7%90%86/#3","title":"3 \u8fd0\u884c","text":"<p>\u542f\u52a8\u7684\u811a\u672c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code># \u542f\u52a8pf\nsudo sysctl -w net.inet.ip.forwarding=1\nsudo pfctl -e\nsudo pfctl -F all\nsudo pfctl -f /etc/pf.conf\n\n# \u542f\u52a8redsocks\nsudo ./redsocks2 -c ./redsocks.conf\n</code></pre> <p>\u4f7f\u7528\u4ee3\u7406\u5b8c\u6210\u4e4b\u540e\uff0c\u4f60\u53ef\u4ee5Ctrl+C\u5173\u95edredsocks\uff0c\u7136\u540e\u7528\u4e0b\u9762\u7684\u811a\u672c\u5173\u95edpf:</p> <pre><code># \u5173\u95edpf\nsudo pfctl -d\nsudo pfctl -F all\n</code></pre>"}]}