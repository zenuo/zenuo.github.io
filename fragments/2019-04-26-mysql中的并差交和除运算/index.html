<!doctype html><html><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>
MySQL中的并、差、交和除运算
</title>
<meta name=generator content="Hugo 0.91.2">
<link rel=stylesheet href="https://zenuo.github.io/css/styles.min.da6e1927bcb6a0faebcb06ab9925c87524b8057860afacf48eab54fcbf9eef18.css" integrity="sha256-2m4ZJ7y2oPrrywarmSXIdSS4BXhgr6z0jqtU/L+e7xg=">
<script async defer data-domain=kaiwern.com src=https://plausible.io/js/plausible.js></script>
<link rel=preconnect href=https://fonts.googleapis.com>
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lora&family=Source+Sans+Pro:wght@400;600&display=swap" rel=stylesheet>
<body class="flex flex-col min-h-screen px-6 max-w-prose md:w-2/3 m-auto"><nav class=mt-8>
<ul id=nav-menu class="w-full flex items-center list-reset">
<li>
<a href=https://zenuo.github.io/>Home</a>
</li>
<li>
<a href=https://zenuo.github.io/fragments/>Fragments</a>
</li>
<li>
<a href=https://zenuo.github.io/about/>About</a>
</li>
<li>
<a href=https://zenuo.github.io/tags/>Tags</a>
</li>
</ul>
</nav>
<main class="flex-1 mt-10 sm:mt-12">
<div>
<header class="mb-8 font-sans-serif">
<div class="text-sm font-gray-700 mb-8">
<p class="uppercase font-semibold">
<a class=text-gray-700 href=/fragments>fragments</a>
</p>
<p>Apr 26, 2019</p>
</div>
<h1 class="text-3xl mb-1 font-semibold">MySQL中的并、差、交和除运算</h1>
<p class="italic text-xs">Last updated at: Apr 26, 2019</p>
</header>
<article class="prose serif mb-16 text-gray-800">
<p>翻译自<a href=http://www.cs.kent.edu/~xlian/old_courses/CSCI4333_2014fall/MySQL-set-operators.pdf>Union, Difference, Intersection, and Division in MySQL</a></p>
<h2 id=构建数据库>构建数据库</h2>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=c1>-- 创建a和b表
</span><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>5</span><span class=p>));</span><span class=w>
</span><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>5</span><span class=p>));</span><span class=w>
</span><span class=w></span><span class=c1>-- 插入数据到a表
</span><span class=c1></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>a</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;A&#39;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>a</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=s1>&#39;B&#39;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>a</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=s1>&#39;C&#39;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>a</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=s1>&#39;D&#39;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=c1>-- 插入数据到b表
</span><span class=c1></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>b</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;A&#39;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>b</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=s1>&#39;C&#39;</span><span class=p>);</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>a</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>x</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>y</span><span class=w>    </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w>    </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w>    </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>C</span><span class=w>    </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>D</span><span class=w>    </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>b</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>x</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>y</span><span class=w>    </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w>    </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w>    </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>C</span><span class=w>    </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span></code></pre></div><h2 id=并集union>并集(Union)</h2>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>UNION</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>b</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>b</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span></code></pre></div><h2 id=差集difference>差集(Difference)</h2>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>b</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>a</span><span class=w>
</span><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>y</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=c1>-- 最高效的方式
</span><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>y</span><span class=w>
</span><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>LEFT</span><span class=w> </span><span class=k>OUTER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span></code></pre></div><h2 id=交集intersection>交集(Intersection)</h2>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>a</span><span class=w>
</span><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>x</span><span class=o>=</span><span class=n>a</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>y</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=c1>-- 最高效的方式
</span><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>y</span><span class=w>
</span><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+------+
</span></code></pre></div><h2 id=构建数据库-1>构建数据库</h2>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=c1>-- 创建c和d表
</span><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>5</span><span class=p>));</span><span class=w>
</span><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=w> </span><span class=nb>INT</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=c1>-- 插入数据到c表
</span><span class=c1></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>c</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;A&#39;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>c</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=s1>&#39;A&#39;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>c</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=s1>&#39;A&#39;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>c</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;B&#39;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>c</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=s1>&#39;B&#39;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>c</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=s1>&#39;C&#39;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>c</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=s1>&#39;D&#39;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=c1>-- 插入数据到d表
</span><span class=c1></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>d</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>d</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>d</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span><span class=w>
</span></code></pre></div><h2 id=除法division>除法(Division)</h2>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>c1</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>y</span><span class=w>
</span><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=n>c1</span><span class=w>
</span><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=w>
</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>d</span><span class=w>
</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>c2</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=n>c2</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c2</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>c1</span><span class=p>.</span><span class=n>y</span><span class=p>));</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>c1</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>y</span><span class=w>
</span><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=n>c1</span><span class=w>
</span><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=w>
</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>d</span><span class=w>
</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=n>c2</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c2</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>c1</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>c2</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>x</span><span class=p>));</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+
</span></code></pre></div><p>不起作用的SQL：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=c1>-- does not work;
</span><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>c1</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>y</span><span class=w>
</span><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=n>c1</span><span class=w>
</span><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=w>
</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=k>LEFT</span><span class=w> </span><span class=k>OUTER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=n>c2</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=w>
</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c2</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>c1</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>c2</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+
</span><span class=c1>-- does not work;
</span><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>c1</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>y</span><span class=w>
</span><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=n>c1</span><span class=w>
</span><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=w>
</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=k>LEFT</span><span class=w> </span><span class=k>OUTER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=n>c2</span><span class=w>
</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=p>(</span><span class=n>d</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>c2</span><span class=p>.</span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>c2</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>c1</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>c2</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+
</span><span class=c1>-- does not work;
</span><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>c1</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>y</span><span class=w>
</span><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=n>c1</span><span class=w>
</span><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=w>
</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=k>LEFT</span><span class=w> </span><span class=k>OUTER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=n>c2</span><span class=w>
</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=p>(</span><span class=n>d</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>c2</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>c2</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>c1</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>c2</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=p>)</span><span class=w> </span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=n>ERROR</span><span class=w> </span><span class=mi>1054</span><span class=w> </span><span class=p>(</span><span class=mi>42</span><span class=n>S22</span><span class=p>):</span><span class=w> </span><span class=k>Unknown</span><span class=w> </span><span class=k>column</span><span class=w> </span><span class=s1>&#39;c1.y&#39;</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=s1>&#39;on clause&#39;</span><span class=w>
</span></code></pre></div><h2 id=参考>参考</h2>
<ul>
<li><a href="https://books.google.com/books?id=-rCvikBWC74C&pg=PA92&lpg=PA92&dq=%E9%9B%86%E5%90%88%E9%99%A4%E6%B3%95&source=bl&ots=IjpuSqQbKP&sig=ACfU3U3VAqwZqkCa3MhDDU8Z4Y_T123tWg&hl=en&sa=X&ved=2ahUKEwioyb-ny-zhAhXpxYsBHZRrCGk4ChDoATALegQIBRAB#v=onepage&q=%E9%9B%86%E5%90%88%E9%99%A4%E6%B3%95&f=false">深入資料庫之美學</a></li>
</ul>
<div class="float-right mb-8">
<p class="text-sm mb-4 font-gray-700 italic">(87 words)</p>
</div>
</article>
</div>
</main>
<hr>
<footer class="w-full text-center p-4 pin-b text-xs text-gray-400">
<p>made with <a href=https://gohugo.io class="underline hover:text-blue-400">Hugo</a> and <a href=https://tailwindcss.com class="underline hover:text-blue-400">TailwindCSS</a></p>
</footer>
</body>
</html>