---
layout: post
---

æ­¤ç¯‡æ–‡ç« ä¸»è¦åŸºäºå¯¹`java.util.function`åŒ…çš„javadocç¿»è¯‘ï¼Œè°ˆè°ˆJavaå¯¹å‡½æ•°å¼ç¼–ç¨‹çš„æ”¯æŒï¼Œäº¦æœ‰åŠ©äºå­¦ä¹ [Stram API](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/stream/package-summary.html)ã€‚

## 1 ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹ï¼Ÿ

åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œå‡½æ•°å¼ç¼–ç¨‹ï¼ˆFunctional programingï¼‰æ˜¯ä¸€ç§å°†è®¡ç®—ï¼ˆComputationï¼‰è§†ä¸ºæ•°å­¦å‡½æ•°çš„è¯„ä¼°ï¼Œé¿å…æ”¹å˜çŠ¶æ€ï¼ˆchanging-stateï¼‰å’Œå¯å˜æ•°æ®ï¼ˆmutable dataï¼‰çš„ç¼–ç¨‹èŒƒå¼ï¼ˆä¸€ç§æ„å»ºè®¡ç®—æœºç¨‹åºç»“æ„å’Œå…ƒç´ çš„æ–¹å¼ï¼‰ã€‚

> In computer science, functional programming is a programming paradigmâ€”a style of building the structure and elements of computer programsâ€”that treats computation as the evaluation of mathematical functions and avoids changing-state and mutable data.
æ‘˜è‡ª[ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Functional_programming)

## 2 java.util.functionåŒ…

Javaè‡ª1.8æ·»åŠ [java.util.function](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/package-summary.html)åŒ…ï¼Œä»¥æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹ï¼›å…¶å°†è®¡ç®—æŠ½è±¡ä¸ºå‡½æ•°å¼æ¥å£ï¼ˆFunctional interfaceï¼‰ï¼Œä¸ºlambdaè¡¨è¾¾å¼ï¼ˆlambda expressionsï¼‰å’Œæ–¹æ³•å¼•ç”¨ï¼ˆmethod referencesï¼‰æä¾›äº†ç›®æ ‡ç±»å‹ã€‚æ¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£å«æœ‰å•ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œç§°ä¸ºè¯¥å‡½æ•°å¼æ¥å£çš„å‡½æ•°å¼æ–¹æ³•ï¼ˆfunctional methodï¼‰ï¼Œlambdaè¡¨è¾¾å¼çš„å‚æ•°å’Œè¿”å›ç±»å‹ä¸ä¹‹åŒ¹é…æˆ–é€‚åº”ã€‚åœ¨å¤šç§ä¸Šä¸‹æ–‡ä¸­ï¼Œå‡½æ•°å¼æ¥å£å¯æä¾›ä¸€ä¸ªç›®æ ‡ç±»å‹ï¼Œå¦‚èµ‹å€¼ã€æ–¹æ³•è°ƒç”¨å’Œè½¬å‹ä¸Šä¸‹æ–‡ï¼š

```java
// èµ‹å€¼ä¸Šä¸‹æ–‡
Predicate<String> p = String::isEmpty;

// æ–¹æ³•è°ƒç”¨ä¸Šä¸‹æ–‡
stream.filter(e -> e.getSize() > 10)...

// è½¬å‹ä¸Šä¸‹æ–‡
stream.map((ToIntFunction) e -> e.getSize())
```

æ­¤åŒ…ä¸­çš„æ¥å£æ˜¯JDKä½¿ç”¨çš„é€šç”¨å‡½æ•°å¼æ¥å£ï¼Œä¹Ÿå¯ä¾›ç”¨æˆ·ä»£ç ä½¿ç”¨ã€‚è™½ç„¶å®ƒä»¬æ²¡æœ‰ç¡®å®šå¯ä»¥é€‚åº”lambdaè¡¨è¾¾å¼çš„ä¸€æ•´å¥—å‡½æ•°å½¢çŠ¶ï¼Œä½†å®ƒä»¬è¶³ä»¥æ»¡è¶³å¸¸è§è¦æ±‚ã€‚ä¸ºç‰¹å®šç›®çš„æä¾›çš„å…¶ä»–åŠŸèƒ½æ¥å£ï¼ˆä¾‹å¦‚[FileFilter](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/FileFilter.html)ï¼‰åœ¨ä½¿ç”¨å®ƒä»¬çš„åŒ…ä¸­å®šä¹‰ã€‚

æ­¤åŒ…ä¸­çš„æ¥å£éƒ½è¢«æ³¨è§£ä¸º[FunctionalInterface](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/FunctionalInterface.html)æ³¨è§£ã€‚æ­¤æ³¨é‡Šä¸æ˜¯ç¼–è¯‘å™¨å°†æ¥å£è¯†åˆ«ä¸ºåŠŸèƒ½æ¥å£çš„å¿…è¦æ¡ä»¶ï¼Œè€Œä»…æ˜¯å¸®åŠ©æ•è·è®¾è®¡æ„å›¾ï¼ˆdesign intentï¼‰å¹¶è·å¾—ç¼–è¯‘å™¨å¸®åŠ©è¯†åˆ«æ„å¤–è¿åè®¾è®¡æ„å›¾çš„å¸®åŠ©ã€‚

å‡½æ•°å¼æ¥å£é€šå¸¸è¡¨ç¤ºç±»ä¼¼å‡½æ•°ï¼ˆfunctionsï¼‰ã€æ“ä½œï¼ˆactionsï¼‰æˆ–è°“è¯ï¼ˆpredicatesï¼‰çš„æŠ½è±¡æ¦‚å¿µã€‚åœ¨è®°å½•å‡½æ•°å¼æ¥å£æˆ–å¼•ç”¨ç±»å‹ä¸ºå‡½æ•°å¼æ¥å£çš„å˜é‡æ—¶ï¼Œé€šå¸¸ç›´æ¥å¼•ç”¨é‚£äº›æŠ½è±¡æ¦‚å¿µï¼Œä¾‹å¦‚ç”¨â€œè¿™ä¸ªå‡½æ•°â€è€Œä¸æ˜¯â€œè¿™ä¸ªå¯¹è±¡è¡¨ç¤ºçš„å‡½æ•°â€ã€‚å½“ä¸€ä¸ªAPIæ–¹æ³•ä»¥ä¾‹å¦‚â€œå°†æä¾›çš„å‡½æ•°åº”ç”¨äº...â€è¿™ç§æ–¹å¼æ¥å—æˆ–è¿”å›å‡½æ•°å¼æ¥å£æ—¶ï¼Œè¿™è¢«ç†è§£ä¸€ä¸ªå¯¹å®ç°é€‚å½“å‡½æ•°å¼æ¥å£çš„å¯¹è±¡çš„énullå¼•ç”¨ï¼Œé™¤éæ˜ç¡®åˆ¶å®šäº†æ½œåœ¨çš„æ— æ•ˆæ€§ã€‚

æ­¤åŒ…ä¸­çš„å‡½æ•°å¼æ¥å£éµå¾ªå¯æ‹“å±•çš„å‘½åçº¦å®šï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

- åŸºæœ¬å‡½æ•°å½¢å¼ï¼ˆfunction shapesï¼‰ï¼ŒåŒ…æ‹¬[Function](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Function.html)ï¼ˆä»Tåˆ°Rçš„ä¸€å…ƒå‡½æ•°ï¼‰ï¼Œ[Consumer](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Consumer.html)ï¼ˆä»Tåˆ°voidçš„ä¸€å…ƒå‡½æ•°ï¼‰ï¼Œ[Predicate](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Predicate.html)ï¼ˆä»Tåˆ°booleançš„ä¸€å…ƒå‡½æ•°ï¼‰å’Œ[Supplier](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Supplier.html)ï¼ˆåˆ°Rçš„0å…ƒå‡½æ•°ï¼‰ã€‚

- å«æœ‰åŸºäºæœ€å¸¸ç”¨çš„æ–¹å¼çš„è‡ªç„¶å…ƒæ•°çš„å‡½æ•°å½¢å¼ã€‚å¯é€šè¿‡å…ƒæ•°ï¼ˆ[Arity](https://en.wikipedia.org/wiki/Arity)ï¼‰å‰ç¼€ä¿®æ”¹åŸºæœ¬å½¢å¼ä»¥è¡¨ç¤ºä¸åŒçš„å…ƒæ•°ï¼Œå¦‚[BiFunction](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/BiFunction.html)ï¼ˆä»Tå’ŒUåˆ°Rçš„äºŒå…ƒå‡½æ•°ï¼‰ä¸­æ‰€ç¤ºã€‚

- æ´¾ç”Ÿå‡½æ•°å½¢å¼ï¼Œå®ƒä»¬æ‹“å±•äº†åŸºæœ¬å‡½æ•°å½¢å¼ï¼ŒåŒ…æ‹¬[UnaryOperator](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/UnaryOperator.html)ï¼ˆæ‹“å±•äº†[Function](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Function.html)ï¼‰å’Œ[BinaryOperator](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/BinaryOperator.html)ï¼ˆæ‹“å±•äº†[BiFunction](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/BiFunction.html)ï¼‰ã€‚

- å‡½æ•°å¼æ¥å£çš„ç±»å‹å‚æ•°å¯ä»¥ä¸“ç”¨ä¸å…·æœ‰ç±»å‹å‰ç¼€çš„åŸºæœ¬ç±»å‹ï¼ˆprimitivesï¼‰ã€‚ä¸ºå…·æœ‰æ³›å‹è¿”å›ç±»å‹å’Œæ³›å‹å‚æ•°çš„ç±»å‹ä¸“é—¨åŒ–ï¼ˆspecializeï¼‰è¿”å›ç±»å‹ï¼Œæˆ‘ä»¬åŠ ä¸Šå‰ç¼€ToXxxï¼Œå¦‚[ToIntFunction](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/ToIntFunction.html)ä¸­æ‰€ç¤ºã€‚å¦å¤–ï¼Œç±»å‹å‚æ•°ä»å·¦åˆ°å³æ˜¯ä¸“é—¨åŒ–çš„ï¼Œä¾‹å¦‚[DoubleConsumer](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/DoubleConsumer.html)å’Œ[ObjIntConsumer](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/ObjIntConsumer.html)ï¼ˆç±»å‹å‰ç¼€`Obj`è¢«ç”¨äºè¡¨ç¤ºæˆ‘ä»¬ä¸æƒ³ä¸“é—¨åŒ–æ­¤å‚æ•°ï¼Œä½†å¸Œæœ›ä¸“é—¨åŒ–ä¸‹ä¸€ä¸ªå‚æ•°ï¼‰ã€‚å¯ä»¥ç»“åˆè¿™äº›æ¨¡å¼ï¼Œå¦‚[IntToDoubleFunction](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/IntToDoubleFunction.html)ä¸­æ‰€ç¤ºã€‚

- è‹¥æ‰€æœ‰å‚æ•°éƒ½æœ‰ä¸“é—¨åŒ–å‰ç¼€ï¼Œåˆ™å¯ä»¥çœç•¥å…ƒæ•°å‰ç¼€ï¼Œå¦‚[ObjIntConsumer](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/ObjIntConsumer.html)ä¸­æ‰€ç¤ºã€‚

## 3 Lambdaè¡¨è¾¾å¼

Java 8 å¼•å…¥çš„åŠŸèƒ½ä¸­ï¼Œæœ€è®©äººæœŸç›¼çš„æ˜¯lambdaè¡¨è¾¾å¼ã€‚Lambdaè¡¨è¾¾å¼ä»¥å­—é¢é‡çš„å½¢å¼æŠŠå°‘é‡ä»£ç ç›´æ¥å†™åœ¨ç¨‹åºä¸­ï¼Œè€Œä¸”è®©Javaç¼–ç¨‹æ›´ç¬¦åˆå‡½æ•°å¼é£æ ¼ã€‚å…¶å®ï¼Œlambdaè¡¨è¾¾å¼çš„å¾ˆå¤šåŠŸèƒ½éƒ½èƒ½ä½¿ç”¨å›è°ƒå’Œå¤„ç†ç¨‹åºç­‰æ¨¡å¼æ¥å®ç°ï¼Œä½†ä½¿ç”¨çš„å¥æ³•æ€»æ˜¯éå¸¸å†—é•¿ï¼Œå°¤å…¶æ˜¯ï¼Œå°±ç®—åªéœ€è¦åœ¨å›è°ƒä¸­ç¼–å†™ä¸€è¡Œä»£ç ï¼Œä¹Ÿè¦å®Œæ•´å®šä¹‰ä¸€ä¸ªæ–°ç±»å‹ã€‚Lambdaè¡¨è¾¾å¼çš„å¥æ³•æ˜¯ä¸€ä¸ªå‚æ•°åˆ—è¡¨å’Œæ–¹æ³•ä¸»ä½“ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```
(p, q) -> { /* æ–¹æ³•ä¸»ä½“ */}
```

è¿™ç§å¥æ³•èƒ½é€šè¿‡ä¸€ç§ååˆ†ç´§å‡‘çš„æ–¹å¼è¡¨ç¤ºç®€å•çš„æ–¹æ³•ï¼Œè€Œä¸”èƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šé¿å…ä½¿ç”¨åŒ¿åç±»ã€‚ç»„æˆæ–¹æ³•çš„å„ä¸ªéƒ¨åˆ†ï¼Œlambdaè¡¨è¾¾å¼å‡ ä¹éƒ½æœ‰ï¼Œä¸è¿‡æ˜¾ç„¶ï¼Œlambdaè¡¨è¾¾å¼æ²¡æœ‰åç§°ï¼Œæœ‰äº›å‘å¼€ç€å–œæ¬¢å§lambdaè¡¨è¾¾å¼å½“æˆâ€œåŒ¿åæ–¹æ³•â€ã€‚

ä¸Šéƒ¨åˆ†æˆ‘ä»¬çŸ¥é“å‡½æ•°å¼æ¥å£åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œæœ‰äº›å¼€å‘è€…å–œæ¬¢ä½¿ç”¨â€œå•ä¸€æŠ½è±¡æ–¹æ³•â€ï¼ˆSingle Abstract Method, SAMï¼‰ç±»å‹è¿™ä¸ªå±äºè¡¨ç¤ºlambdaè¡¨è¾¾å¼è½¬æ¢å¾—åˆ°çš„æ¥å£ç±»å‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒ¿åç±»æˆ–å…·åç±»æ¥å®ç°å®ƒï¼Œä½†Javaä»1.8å¼€å§‹æ”¯æŒlambdaè¡¨ç¤ºå¼ï¼Œä½¿æ‚¨å¯ä»¥æ›´ç´§å‡‘åœ°è¡¨è¾¾å•æ–¹æ³•ç±»çš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬åŸºäº`java.util.function.BiFunction`å®ç°ä¸€ä¸ªæ•´æ•°åŠ æ³•å‡½æ•°ï¼Œè‹¥ä½¿ç”¨å…·åç±»ï¼Œæ‚¨å¯èƒ½ä¼šè¿™æ ·å†™ï¼š 

```java
import java.util.function.BiFunction;

public final class AddFunction implements BiFunction<Integer, Integer, Integer> {
    @Override
    public Integer apply(Integer first, Integer second) {
        return first + second;
    }
}
```

æ˜¯ä¸æ˜¯ä»£ç é‡è¾ƒå¤§ï¼Ÿä½¿ç”¨lambdaï¼Œæˆ‘ä»¬å¯ä»¥ä»¥åŒ¿åç±»çš„æ–¹å¼å®ç°`AddFunction`åŒæ ·çš„å‡½æ•°åŒ–å®ä¾‹ï¼Œå¦‚ä¸‹ï¼š

```java
BiFunction<Integer, Integer, Integer> addFunction
        = (first, second) -> (first + second);
```

æ˜¯ä¸æ˜¯æ¸…çˆ½ğŸƒäº†å¾ˆå¤šï¼Ÿ

`javac`é‡åˆ°lambda è¡¨è¾¾å¼æ—¶ä¼šæŠŠå®ƒè§£é‡Šä¸ºä¸€ä¸ªæ–¹æ³•çš„ä¸»ä½“ï¼Œè¿™ä¸ªæ–¹æ³•å…·æœ‰ç‰¹å®šçš„ç­¾åã€‚ä¸è¿‡ï¼Œæ˜¯é‚£ä¸ªæ–¹æ³•å‘¢ï¼Ÿ

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œjavacä¼šæŸ¥çœ‹å‘¨å›´çš„ä»£ç ï¼Œlambda è¡¨è¾¾å¼å¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ‰ç®—æ˜¯åˆæ³•çš„Javaä»£ç ï¼š

- lambda è¡¨è¾¾å¼å¿…é¡»å‡ºç°åœ¨æœŸæœ›ä½¿ç”¨æ¥å£ç±»å‹å®ä¾‹çš„åœ°æ–¹ï¼›
- æœŸæœ›ä½¿ç”¨çš„æ¥å£ç±»å‹å¿…é¡»åªæœ‰ä¸€ä¸ªå¼ºåˆ¶æ–¹æ³•ï¼›
- è¿™ä¸ªå¼ºåˆ¶æ–¹æ³•çš„ç­¾åè¦å®Œå…¨åŒ¹é…lambdaè¡¨è¾¾å¼ã€‚

å¦‚æœæ»¡è¶³ä¸Šè¿°æ¡ä»¶ï¼Œç¼–è¯‘å™¨ä¼šåˆ›å»ºä¸€ä¸ªç±»å‹ï¼Œå®ç°æœŸæœ›ä½¿ç”¨çš„æ¥å£ï¼Œç„¶åæŠŠlambdaè¡¨è¾¾å¼çš„ä¸»ä½“å½“ä½œå¼ºåˆ¶æ–¹æ³•çš„å®ç°ã€‚è¯´çš„ç¨å¾®å¤æ‚ç‚¹ï¼Œè¿™ä¸ªä½œæ˜¯ä¸ºäº†ä¿æŒJavaç±»å‹ç³»ç»Ÿçš„åä¹‰ï¼ˆåŸºäºåç§°ï¼‰çº¯ç²¹æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œlambdaè¡¨è¾¾å¼ä¼šè¢«è½¬æ¢æˆæ­£ç¡®æ¥å£ç±»å‹çš„å®ä¾‹ã€‚

## 4 å‚è€ƒ

- [Functional programming](https://en.wikipedia.org/wiki/Functional_programming)
- [Imperative programming](https://en.wikipedia.org/wiki/Imperative_programming)
- [Lambda expressions](https://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html)
- [Scala school](https://twitter.github.io/scala_school/)
- [å…ƒæ•°-ç»´åŸºç™¾ç§‘](https://zh.wikipedia.org/wiki/%E5%85%83%E6%95%B0)
