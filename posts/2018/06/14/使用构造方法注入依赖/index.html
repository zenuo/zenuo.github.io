<!doctype html><html><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>使用构造方法注入依赖</title><meta name=generator content="Hugo 0.112.3"><link rel=stylesheet href="https://zenuo.github.io/css/styles.min.da6e1927bcb6a0faebcb06ab9925c87524b8057860afacf48eab54fcbf9eef18.css" integrity="sha256-2m4ZJ7y2oPrrywarmSXIdSS4BXhgr6z0jqtU/L+e7xg="><script async defer data-domain=kaiwern.com src=https://plausible.io/js/plausible.js></script>
<link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Lora&family=Source+Sans+Pro:wght@400;600&display=swap" rel=stylesheet><body class="flex flex-col min-h-screen px-6 max-w-prose md:w-2/3 m-auto"><nav class=mt-8><ul id=nav-menu class="w-full flex items-center list-reset"><li><a href=https://zenuo.github.io/>Home</a></li><li><a href=https://zenuo.github.io/fragments/>Fragments</a></li><li><a href=https://zenuo.github.io/about/>About</a></li><li><a href=https://zenuo.github.io/tags/>Tags</a></li></ul></nav><main class="flex-1 mt-10 sm:mt-12"><header class="mb-8 font-sans-serif"><div class="text-sm font-gray-700 mb-8"><p class="uppercase font-semibold"><a class=text-gray-700 href=/posts>posts</a></p><p>Jun 14, 2018</p></div><h1 class="title mb-2">使用构造方法注入依赖</h1><p class="text-sm font-gray-700 mb-4 italic">Estimated Reading Time: 1 minutes (55 words)</p><div id=tags></div></header><article class="prose serif mb-12 text-gray-800"><h2 id=1-什么是依赖注入>1 什么是依赖注入</h2><p>在软件工程中，依赖注入是一种对象提供另一对象的依赖性的技术。依赖关系是可以使用的对象（服务）。注入是将依赖关系传递给将使用它的依赖对象（客户端）。</p><h2 id=2-为什么使用构造方法注入>2 为什么使用构造方法注入</h2><p>使用Spring提供的@Autowired注解，我们可以通过标记构造方法(constructor)、域(field)、setter方法和配置方法(config methods)来实现依赖注入。我们使用较多的是标记域的方式，这使得客户端可以创建该类的不合法的实例，不利于问题排查和测试，这一点在Oliver Gierke的Why field injection is evil的文章中已有说明。</p><h2 id=3-如何使用构造方法注入>3 如何使用构造方法注入</h2><p>结合<a href=https://projectlombok.org/>Lombok</a>注解使用构造方法注入可简化代码：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Service</span>
</span></span><span class=line><span class=cl><span class=nd>@Slf4j</span>
</span></span><span class=line><span class=cl><span class=nd>@RequiredArgsConstructor</span><span class=o>(</span><span class=n>onConstructor</span> <span class=o>=</span> <span class=nd>@__</span><span class=o>(</span><span class=nd>@Autowired</span><span class=o>))</span>   <span class=c1>//注意点1
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>OssSyncService</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>final</span> <span class=nd>@NonNull</span>  <span class=c1>//注意点2
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>OssSyncObjectRepository</span> <span class=n>ossSyncObjectRepository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>final</span> <span class=nd>@NonNull</span>
</span></span><span class=line><span class=cl>    <span class=n>OssSyncInfoRepository</span> <span class=n>ossSyncInfoRepository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>final</span> <span class=nd>@NonNull</span>
</span></span><span class=line><span class=cl>    <span class=n>S3Config</span> <span class=n>s3Config</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=c1>//其余省略
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><ul><li>注意点1-类前标注@RequiredArgsConstructor(onConstructor = @__(@Autowired))</li><li>注意点2-依赖的Bean使用private final修饰符和@NonNull注解</li></ul><h2 id=4-参考>4 参考</h2><ul><li><a href=http://olivergierke.de/2013/11/why-field-injection-is-evil/>http://olivergierke.de/2013/11/why-field-injection-is-evil/</a></li><li><a href=https://wiki.yziyz.xin:82/wiki/%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC>https://wiki.yziyz.xin:82/wiki/%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC</a></li><li><a href=https://en.wikipedia.org/wiki/Dependency_injection>https://en.wikipedia.org/wiki/Dependency_injection</a></li><li><a href=https://docs.spring.io/spring-boot/docs/current/reference/html/using-boot-spring-beans-and-dependency-injection.html>https://docs.spring.io/spring-boot/docs/current/reference/html/using-boot-spring-beans-and-dependency-injection.html</a></li><li><a href=https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/factory/annotation/Autowired.html>https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/factory/annotation/Autowired.html</a></li></ul></article></main><hr><footer class="w-full text-center p-4 pin-b text-xs text-gray-400"><p>made with <a href=https://gohugo.io class="underline hover:text-blue-400">Hugo</a> and <a href=https://tailwindcss.com class="underline hover:text-blue-400">TailwindCSS</a></p></footer></body></html>