<!doctype html><html><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>ğŸåå˜ã€é€†å˜ä¸ä¸å˜</title><meta name=generator content="Hugo 0.112.3"><link rel=stylesheet href="https://zenuo.github.io/css/styles.min.da6e1927bcb6a0faebcb06ab9925c87524b8057860afacf48eab54fcbf9eef18.css" integrity="sha256-2m4ZJ7y2oPrrywarmSXIdSS4BXhgr6z0jqtU/L+e7xg="><script async defer data-domain=kaiwern.com src=https://plausible.io/js/plausible.js></script>
<link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Lora&family=Source+Sans+Pro:wght@400;600&display=swap" rel=stylesheet><body class="flex flex-col min-h-screen px-6 max-w-prose md:w-2/3 m-auto"><nav class=mt-8><ul id=nav-menu class="w-full flex items-center list-reset"><li><a href=https://zenuo.github.io/>Home</a></li><li><a href=https://zenuo.github.io/fragments/>Fragments</a></li><li><a href=https://zenuo.github.io/about/>About</a></li><li><a href=https://zenuo.github.io/tags/>Tags</a></li></ul></nav><main class="flex-1 mt-10 sm:mt-12"><header class="mb-8 font-sans-serif"><div class="text-sm font-gray-700 mb-8"><p class="uppercase font-semibold"><a class=text-gray-700 href=/posts>posts</a></p><p>Oct 19, 2020</p></div><h1 class="title mb-2">ğŸåå˜ã€é€†å˜ä¸ä¸å˜</h1><p class="text-sm font-gray-700 mb-4 italic">Estimated Reading Time: 2 minutes (322 words)</p><div id=tags></div></header><article class="prose serif mb-12 text-gray-800"><h2 id=formal-definition>Formal definition</h2><p>æ‘˜è‡ª<a href=https://176.122.157.231:5004/wiki/Covariance_and_contravariance_(computer_science)>Covariance_and_contravariance_(computer_science)</a>ï¼š</p><blockquote><p>Within the type system of a programming language, a <code>typing rule</code> or a<code> type constructor</code> is:</p></blockquote><ul><li><em>covariant</em> if it preserves the <a href=https://176.122.157.231:5004/wiki/Subtype>rdering of types (â‰¤)</a>, which orders types from more specific to more generic;</li><li><em>contravariant</em> if it reverses this ordering;</li><li>bivariant if both of these apply (i.e., both <code>I&lt;A></code> â‰¤ <code>I&lt;B></code> and <code>I&lt;B></code> â‰¤ <code>I&lt;A></code> at the same time);[1]</li><li>variant if covariant, contravariant or bivariant;</li><li>invariant or nonvariant if not variant.</li></ul><h2 id=åå˜>åå˜</h2><p>é¦–å…ˆè€ƒè™‘æ•°ç»„ç±»å‹æ„é€ å™¨ï¼š ä»Animalç±»å‹ï¼Œå¯ä»¥å¾—åˆ°<code>Animal[]</code>ï¼ˆâ€œanimalæ•°ç»„â€ï¼‰ã€‚ æ˜¯å¦å¯ä»¥æŠŠå®ƒå½“ä½œ</p><ul><li>åå˜ï¼ša <code>Cat[]</code> is an <code>Animal[]</code></li><li>é€†å˜ï¼šan <code>Animal[]</code> is a <code>Cat[]</code></li><li>ä¸å˜ï¼šan <code>Animal[]</code> is not a <code>Cat[]</code> and a <code>Cat[]</code> is not an <code>Animal[]</code></li></ul><h3 id=javaä¸­çš„åå˜æ•°ç»„>Javaä¸­çš„åå˜æ•°ç»„</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// a æ˜¯å•å…ƒç´ çš„ String æ•°ç»„
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>String</span><span class=o>[]</span> <span class=n>a</span> <span class=o>=</span> <span class=k>new</span> <span class=n>String</span><span class=o>[</span><span class=mi>1</span><span class=o>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// b æ˜¯ Object çš„æ•°ç»„
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>Object</span><span class=o>[]</span> <span class=n>b</span> <span class=o>=</span> <span class=n>a</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// å‘ b ä¸­èµ‹ä¸€ä¸ªæ•´æ•°ã€‚å¦‚æœ b ç¡®å®æ˜¯ Object çš„æ•°ç»„ï¼Œè¿™æ˜¯å¯èƒ½çš„ï¼›ç„¶è€Œå®ƒå…¶å®æ˜¯ä¸ª String çš„æ•°ç»„ï¼Œå› æ­¤ä¼šå‘ç”Ÿ java.lang.ArrayStoreException
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>b</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span> <span class=o>=</span> <span class=mi>1</span><span class=o>;</span>
</span></span></code></pre></div><h2 id=oopä¸­çš„ç»§æ‰¿>OOPä¸­çš„ç»§æ‰¿</h2><blockquote><p>å½“ä¸€ä¸ªå­ç±»<a href=https://176.122.157.231:3457/wiki/%E9%87%8D%E5%86%99>é‡å†™</a>ä¸€ä¸ªè¶…ç±»çš„æ–¹æ³•æ—¶ï¼Œç¼–è¯‘å™¨å¿…é¡»æ£€æŸ¥é‡å†™æ–¹æ³•æ˜¯å¦å…·æœ‰æ­£ç¡®çš„ç±»å‹ã€‚è™½ç„¶ä¸€äº›è¯­è¨€è¦æ±‚ç±»å‹å¿…é¡»ä¸è¶…ç±»ç›¸åŒï¼Œä½†å…è®¸é‡å†™æ–¹æ³•æœ‰ä¸€ä¸ªâ€œæ›´å¥½çš„â€ç±»å‹ä¹Ÿæ˜¯ç±»å‹å®‰å…¨çš„ã€‚å¯¹äºå¤§éƒ¨åˆ†çš„æ–¹æ³•å­ç±»åŒ–è§„åˆ™æ¥è¯´ï¼Œè¿™è¦æ±‚è¿”å›å€¼çš„ç±»å‹å¿…é¡»æ›´å…·ä½“ï¼Œä¹Ÿå°±æ˜¯<code>åå˜</code>ï¼Œè€Œä¸”æ¥å—æ›´å®½æ³›çš„å‚æ•°ç±»å‹ï¼Œä¹Ÿå°±æ˜¯<code>é€†å˜</code>ã€‚</p></blockquote><p><img src=/img/be914bff8d5611a54aa47597.png alt=be914bff8d5611a54aa47597.png></p><p>ä»¥ä¸‹è®¨è®ºåŸºäºJavaè¯­æ³•ï¼Œ<code>æŠ½è±¡ç±»C</code>å¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>jshell</span><span class=o>&gt;</span> <span class=kd>abstract</span> <span class=kd>class</span> <span class=nc>C</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>   <span class=o>...&gt;</span> <span class=kd>abstract</span> <span class=n>C</span> <span class=nf>foo</span><span class=o>(</span><span class=n>C</span> <span class=n>c</span><span class=o>);</span>
</span></span><span class=line><span class=cl>   <span class=o>...&gt;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>|</span>  <span class=n>replaced</span> <span class=kd>class</span> <span class=nc>C</span>
</span></span></code></pre></div><h3 id=è¿”å›å€¼çš„åå˜>è¿”å›å€¼çš„åå˜</h3><p>åœ¨å…è®¸åå˜è¿”å›å€¼çš„è¯­è¨€ä¸­, å­ç±»å¯ä»¥é‡å†™<code>foo</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ›´å…·ä½“çš„ç±»å‹ï¼š</p><pre tabindex=0><code>jshell&gt; class D extends C {
   ...&gt; @Override
   ...&gt; D foo(C c) {return this;}
   ...&gt; }
|  created class D
</code></pre><h3 id=æ–¹æ³•å‚æ•°çš„åå˜ä¸é€†å˜>æ–¹æ³•å‚æ•°çš„åå˜ä¸é€†å˜</h3><p>å…è®¸å‚æ•°åå˜ã€é€†å˜çš„é¢å‘å¯¹è±¡è¯­è¨€å¹¶ä¸å¤šâ€”â€”Javaä¼šæŠŠå®ƒå½“æˆä¸€ä¸ªå‡½æ•°é‡è½½ï¼š</p><p>åå˜ï¼š</p><pre tabindex=0><code>jshell&gt; class E extends C {
   ...&gt; @Override
   ...&gt; C foo(E e) {return this;}
   ...&gt; }
|  Error:
|  E is not abstract and does not override abstract method foo(C) in C
|  class E extends C {
|  ^------------------...
|  Error:
|  method does not override or implement a method from a supertype
|  @Override
|  ^-------^
</code></pre><p>é€†å˜ï¼š</p><pre tabindex=0><code>jshell&gt; class F extends C {
   ...&gt; @Override
   ...&gt; C foo(Object o) {return this;}
   ...&gt; }
|  Error:
|  F is not abstract and does not override abstract method foo(C) in C
|  class F extends C {
|  ^------------------...
|  Error:
|  method does not override or implement a method from a supertype
|  @Override
|  ^-------^
</code></pre><h4 id=summary-of-variance-and-inheritance>Summary of variance and inheritance</h4><table><thead><tr><th style=text-align:left>è¯­è¨€</th><th style=text-align:right>Parameter type</th><th style=text-align:center>Return type</th></tr></thead><tbody><tr><td style=text-align:left>C++ ï¼ˆè‡ª1998å¹´ï¼‰, Java (è‡ªJ2SE 5.0), D</td><td style=text-align:right>ä¸å˜</td><td style=text-align:center>åå˜</td></tr><tr><td style=text-align:left>C#</td><td style=text-align:right>ä¸å˜</td><td style=text-align:center>ä¸å˜</td></tr></tbody></table><h2 id=å‚è€ƒ>å‚è€ƒ</h2><ul><li><a href=https://176.122.157.231:5004/wiki/Covariance_and_contravariance_(computer_science)>Covariance and contravariance</a></li></ul></article></main><hr><footer class="w-full text-center p-4 pin-b text-xs text-gray-400"><p>made with <a href=https://gohugo.io class="underline hover:text-blue-400">Hugo</a> and <a href=https://tailwindcss.com class="underline hover:text-blue-400">TailwindCSS</a></p></footer></body></html>